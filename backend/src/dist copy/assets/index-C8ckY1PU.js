(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(o){if(o.ep)return;o.ep=!0;const u=t(o);fetch(o.href,u)}})();function vv(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ed={exports:{}},zl={},td={exports:{}},Lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm;function nT(){if(Dm)return Lt;Dm=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),L=Symbol.iterator;function I(se){return se===null||typeof se!="object"?null:(se=L&&se[L]||se["@@iterator"],typeof se=="function"?se:null)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,N={};function U(se,ye,He){this.props=se,this.context=ye,this.refs=N,this.updater=He||D}U.prototype.isReactComponent={},U.prototype.setState=function(se,ye){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,ye,"setState")},U.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function Y(){}Y.prototype=U.prototype;function X(se,ye,He){this.props=se,this.context=ye,this.refs=N,this.updater=He||D}var ce=X.prototype=new Y;ce.constructor=X,F(ce,U.prototype),ce.isPureReactComponent=!0;var fe=Array.isArray,me=Object.prototype.hasOwnProperty,we={current:null},H={key:!0,ref:!0,__self:!0,__source:!0};function B(se,ye,He){var Ye,mt={},wt=null,et=null;if(ye!=null)for(Ye in ye.ref!==void 0&&(et=ye.ref),ye.key!==void 0&&(wt=""+ye.key),ye)me.call(ye,Ye)&&!H.hasOwnProperty(Ye)&&(mt[Ye]=ye[Ye]);var vt=arguments.length-2;if(vt===1)mt.children=He;else if(1<vt){for(var Rt=Array(vt),Kt=0;Kt<vt;Kt++)Rt[Kt]=arguments[Kt+2];mt.children=Rt}if(se&&se.defaultProps)for(Ye in vt=se.defaultProps,vt)mt[Ye]===void 0&&(mt[Ye]=vt[Ye]);return{$$typeof:r,type:se,key:wt,ref:et,props:mt,_owner:we.current}}function z(se,ye){return{$$typeof:r,type:se.type,key:ye,ref:se.ref,props:se.props,_owner:se._owner}}function Q(se){return typeof se=="object"&&se!==null&&se.$$typeof===r}function re(se){var ye={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(He){return ye[He]})}var le=/\/+/g;function J(se,ye){return typeof se=="object"&&se!==null&&se.key!=null?re(""+se.key):ye.toString(36)}function pt(se,ye,He,Ye,mt){var wt=typeof se;(wt==="undefined"||wt==="boolean")&&(se=null);var et=!1;if(se===null)et=!0;else switch(wt){case"string":case"number":et=!0;break;case"object":switch(se.$$typeof){case r:case e:et=!0}}if(et)return et=se,mt=mt(et),se=Ye===""?"."+J(et,0):Ye,fe(mt)?(He="",se!=null&&(He=se.replace(le,"$&/")+"/"),pt(mt,ye,He,"",function(Kt){return Kt})):mt!=null&&(Q(mt)&&(mt=z(mt,He+(!mt.key||et&&et.key===mt.key?"":(""+mt.key).replace(le,"$&/")+"/")+se)),ye.push(mt)),1;if(et=0,Ye=Ye===""?".":Ye+":",fe(se))for(var vt=0;vt<se.length;vt++){wt=se[vt];var Rt=Ye+J(wt,vt);et+=pt(wt,ye,He,Rt,mt)}else if(Rt=I(se),typeof Rt=="function")for(se=Rt.call(se),vt=0;!(wt=se.next()).done;)wt=wt.value,Rt=Ye+J(wt,vt++),et+=pt(wt,ye,He,Rt,mt);else if(wt==="object")throw ye=String(se),Error("Objects are not valid as a React child (found: "+(ye==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":ye)+"). If you meant to render a collection of children, use an array instead.");return et}function Jt(se,ye,He){if(se==null)return se;var Ye=[],mt=0;return pt(se,Ye,"","",function(wt){return ye.call(He,wt,mt++)}),Ye}function At(se){if(se._status===-1){var ye=se._result;ye=ye(),ye.then(function(He){(se._status===0||se._status===-1)&&(se._status=1,se._result=He)},function(He){(se._status===0||se._status===-1)&&(se._status=2,se._result=He)}),se._status===-1&&(se._status=0,se._result=ye)}if(se._status===1)return se._result.default;throw se._result}var dt={current:null},Ue={transition:null},Ke={ReactCurrentDispatcher:dt,ReactCurrentBatchConfig:Ue,ReactCurrentOwner:we};function Be(){throw Error("act(...) is not supported in production builds of React.")}return Lt.Children={map:Jt,forEach:function(se,ye,He){Jt(se,function(){ye.apply(this,arguments)},He)},count:function(se){var ye=0;return Jt(se,function(){ye++}),ye},toArray:function(se){return Jt(se,function(ye){return ye})||[]},only:function(se){if(!Q(se))throw Error("React.Children.only expected to receive a single React element child.");return se}},Lt.Component=U,Lt.Fragment=t,Lt.Profiler=o,Lt.PureComponent=X,Lt.StrictMode=i,Lt.Suspense=T,Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ke,Lt.act=Be,Lt.cloneElement=function(se,ye,He){if(se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+se+".");var Ye=F({},se.props),mt=se.key,wt=se.ref,et=se._owner;if(ye!=null){if(ye.ref!==void 0&&(wt=ye.ref,et=we.current),ye.key!==void 0&&(mt=""+ye.key),se.type&&se.type.defaultProps)var vt=se.type.defaultProps;for(Rt in ye)me.call(ye,Rt)&&!H.hasOwnProperty(Rt)&&(Ye[Rt]=ye[Rt]===void 0&&vt!==void 0?vt[Rt]:ye[Rt])}var Rt=arguments.length-2;if(Rt===1)Ye.children=He;else if(1<Rt){vt=Array(Rt);for(var Kt=0;Kt<Rt;Kt++)vt[Kt]=arguments[Kt+2];Ye.children=vt}return{$$typeof:r,type:se.type,key:mt,ref:wt,props:Ye,_owner:et}},Lt.createContext=function(se){return se={$$typeof:h,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},se.Provider={$$typeof:u,_context:se},se.Consumer=se},Lt.createElement=B,Lt.createFactory=function(se){var ye=B.bind(null,se);return ye.type=se,ye},Lt.createRef=function(){return{current:null}},Lt.forwardRef=function(se){return{$$typeof:g,render:se}},Lt.isValidElement=Q,Lt.lazy=function(se){return{$$typeof:_,_payload:{_status:-1,_result:se},_init:At}},Lt.memo=function(se,ye){return{$$typeof:m,type:se,compare:ye===void 0?null:ye}},Lt.startTransition=function(se){var ye=Ue.transition;Ue.transition={};try{se()}finally{Ue.transition=ye}},Lt.unstable_act=Be,Lt.useCallback=function(se,ye){return dt.current.useCallback(se,ye)},Lt.useContext=function(se){return dt.current.useContext(se)},Lt.useDebugValue=function(){},Lt.useDeferredValue=function(se){return dt.current.useDeferredValue(se)},Lt.useEffect=function(se,ye){return dt.current.useEffect(se,ye)},Lt.useId=function(){return dt.current.useId()},Lt.useImperativeHandle=function(se,ye,He){return dt.current.useImperativeHandle(se,ye,He)},Lt.useInsertionEffect=function(se,ye){return dt.current.useInsertionEffect(se,ye)},Lt.useLayoutEffect=function(se,ye){return dt.current.useLayoutEffect(se,ye)},Lt.useMemo=function(se,ye){return dt.current.useMemo(se,ye)},Lt.useReducer=function(se,ye,He){return dt.current.useReducer(se,ye,He)},Lt.useRef=function(se){return dt.current.useRef(se)},Lt.useState=function(se){return dt.current.useState(se)},Lt.useSyncExternalStore=function(se,ye,He){return dt.current.useSyncExternalStore(se,ye,He)},Lt.useTransition=function(){return dt.current.useTransition()},Lt.version="18.3.1",Lt}var Lm;function rp(){return Lm||(Lm=1,td.exports=nT()),td.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Om;function iT(){if(Om)return zl;Om=1;var r=rp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function h(g,T,m){var _,L={},I=null,D=null;m!==void 0&&(I=""+m),T.key!==void 0&&(I=""+T.key),T.ref!==void 0&&(D=T.ref);for(_ in T)i.call(T,_)&&!u.hasOwnProperty(_)&&(L[_]=T[_]);if(g&&g.defaultProps)for(_ in T=g.defaultProps,T)L[_]===void 0&&(L[_]=T[_]);return{$$typeof:e,type:g,key:I,ref:D,props:L,_owner:o.current}}return zl.Fragment=t,zl.jsx=h,zl.jsxs=h,zl}var Nm;function sT(){return Nm||(Nm=1,ed.exports=iT()),ed.exports}var he=sT(),pe=rp();const Ql=vv(pe);var Ec={},rd={exports:{}},Vn={},nd={exports:{}},id={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fm;function oT(){return Fm||(Fm=1,function(r){function e(Ue,Ke){var Be=Ue.length;Ue.push(Ke);e:for(;0<Be;){var se=Be-1>>>1,ye=Ue[se];if(0<o(ye,Ke))Ue[se]=Ke,Ue[Be]=ye,Be=se;else break e}}function t(Ue){return Ue.length===0?null:Ue[0]}function i(Ue){if(Ue.length===0)return null;var Ke=Ue[0],Be=Ue.pop();if(Be!==Ke){Ue[0]=Be;e:for(var se=0,ye=Ue.length,He=ye>>>1;se<He;){var Ye=2*(se+1)-1,mt=Ue[Ye],wt=Ye+1,et=Ue[wt];if(0>o(mt,Be))wt<ye&&0>o(et,mt)?(Ue[se]=et,Ue[wt]=Be,se=wt):(Ue[se]=mt,Ue[Ye]=Be,se=Ye);else if(wt<ye&&0>o(et,Be))Ue[se]=et,Ue[wt]=Be,se=wt;else break e}}return Ke}function o(Ue,Ke){var Be=Ue.sortIndex-Ke.sortIndex;return Be!==0?Be:Ue.id-Ke.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;r.unstable_now=function(){return u.now()}}else{var h=Date,g=h.now();r.unstable_now=function(){return h.now()-g}}var T=[],m=[],_=1,L=null,I=3,D=!1,F=!1,N=!1,U=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ce(Ue){for(var Ke=t(m);Ke!==null;){if(Ke.callback===null)i(m);else if(Ke.startTime<=Ue)i(m),Ke.sortIndex=Ke.expirationTime,e(T,Ke);else break;Ke=t(m)}}function fe(Ue){if(N=!1,ce(Ue),!F)if(t(T)!==null)F=!0,At(me);else{var Ke=t(m);Ke!==null&&dt(fe,Ke.startTime-Ue)}}function me(Ue,Ke){F=!1,N&&(N=!1,Y(B),B=-1),D=!0;var Be=I;try{for(ce(Ke),L=t(T);L!==null&&(!(L.expirationTime>Ke)||Ue&&!re());){var se=L.callback;if(typeof se=="function"){L.callback=null,I=L.priorityLevel;var ye=se(L.expirationTime<=Ke);Ke=r.unstable_now(),typeof ye=="function"?L.callback=ye:L===t(T)&&i(T),ce(Ke)}else i(T);L=t(T)}if(L!==null)var He=!0;else{var Ye=t(m);Ye!==null&&dt(fe,Ye.startTime-Ke),He=!1}return He}finally{L=null,I=Be,D=!1}}var we=!1,H=null,B=-1,z=5,Q=-1;function re(){return!(r.unstable_now()-Q<z)}function le(){if(H!==null){var Ue=r.unstable_now();Q=Ue;var Ke=!0;try{Ke=H(!0,Ue)}finally{Ke?J():(we=!1,H=null)}}else we=!1}var J;if(typeof X=="function")J=function(){X(le)};else if(typeof MessageChannel<"u"){var pt=new MessageChannel,Jt=pt.port2;pt.port1.onmessage=le,J=function(){Jt.postMessage(null)}}else J=function(){U(le,0)};function At(Ue){H=Ue,we||(we=!0,J())}function dt(Ue,Ke){B=U(function(){Ue(r.unstable_now())},Ke)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Ue){Ue.callback=null},r.unstable_continueExecution=function(){F||D||(F=!0,At(me))},r.unstable_forceFrameRate=function(Ue){0>Ue||125<Ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<Ue?Math.floor(1e3/Ue):5},r.unstable_getCurrentPriorityLevel=function(){return I},r.unstable_getFirstCallbackNode=function(){return t(T)},r.unstable_next=function(Ue){switch(I){case 1:case 2:case 3:var Ke=3;break;default:Ke=I}var Be=I;I=Ke;try{return Ue()}finally{I=Be}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Ue,Ke){switch(Ue){case 1:case 2:case 3:case 4:case 5:break;default:Ue=3}var Be=I;I=Ue;try{return Ke()}finally{I=Be}},r.unstable_scheduleCallback=function(Ue,Ke,Be){var se=r.unstable_now();switch(typeof Be=="object"&&Be!==null?(Be=Be.delay,Be=typeof Be=="number"&&0<Be?se+Be:se):Be=se,Ue){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=Be+ye,Ue={id:_++,callback:Ke,priorityLevel:Ue,startTime:Be,expirationTime:ye,sortIndex:-1},Be>se?(Ue.sortIndex=Be,e(m,Ue),t(T)===null&&Ue===t(m)&&(N?(Y(B),B=-1):N=!0,dt(fe,Be-se))):(Ue.sortIndex=ye,e(T,Ue),F||D||(F=!0,At(me))),Ue},r.unstable_shouldYield=re,r.unstable_wrapCallback=function(Ue){var Ke=I;return function(){var Be=I;I=Ke;try{return Ue.apply(this,arguments)}finally{I=Be}}}}(id)),id}var Mm;function aT(){return Mm||(Mm=1,nd.exports=oT()),nd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Um;function lT(){if(Um)return Vn;Um=1;var r=rp(),e=aT();function t(n){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function u(n,s){h(n,s),h(n+"Capture",s)}function h(n,s){for(o[n]=s,n=0;n<s.length;n++)i.add(s[n])}var g=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),T=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_={},L={};function I(n){return T.call(L,n)?!0:T.call(_,n)?!1:m.test(n)?L[n]=!0:(_[n]=!0,!1)}function D(n,s,l,p){if(l!==null&&l.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return p?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function F(n,s,l,p){if(s===null||typeof s>"u"||D(n,s,l,p))return!0;if(p)return!1;if(l!==null)switch(l.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function N(n,s,l,p,E,A,O){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=p,this.attributeNamespace=E,this.mustUseProperty=l,this.propertyName=n,this.type=s,this.sanitizeURL=A,this.removeEmptyString=O}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){U[n]=new N(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var s=n[0];U[s]=new N(s,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){U[n]=new N(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){U[n]=new N(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){U[n]=new N(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){U[n]=new N(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){U[n]=new N(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){U[n]=new N(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){U[n]=new N(n,5,!1,n.toLowerCase(),null,!1,!1)});var Y=/[\-:]([a-z])/g;function X(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var s=n.replace(Y,X);U[s]=new N(s,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var s=n.replace(Y,X);U[s]=new N(s,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var s=n.replace(Y,X);U[s]=new N(s,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){U[n]=new N(n,1,!1,n.toLowerCase(),null,!1,!1)}),U.xlinkHref=new N("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){U[n]=new N(n,1,!1,n.toLowerCase(),null,!0,!0)});function ce(n,s,l,p){var E=U.hasOwnProperty(s)?U[s]:null;(E!==null?E.type!==0:p||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(F(s,l,E,p)&&(l=null),p||E===null?I(s)&&(l===null?n.removeAttribute(s):n.setAttribute(s,""+l)):E.mustUseProperty?n[E.propertyName]=l===null?E.type===3?!1:"":l:(s=E.attributeName,p=E.attributeNamespace,l===null?n.removeAttribute(s):(E=E.type,l=E===3||E===4&&l===!0?"":""+l,p?n.setAttributeNS(p,s,l):n.setAttribute(s,l))))}var fe=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,me=Symbol.for("react.element"),we=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),Q=Symbol.for("react.provider"),re=Symbol.for("react.context"),le=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),pt=Symbol.for("react.suspense_list"),Jt=Symbol.for("react.memo"),At=Symbol.for("react.lazy"),dt=Symbol.for("react.offscreen"),Ue=Symbol.iterator;function Ke(n){return n===null||typeof n!="object"?null:(n=Ue&&n[Ue]||n["@@iterator"],typeof n=="function"?n:null)}var Be=Object.assign,se;function ye(n){if(se===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);se=s&&s[1]||""}return`
`+se+n}var He=!1;function Ye(n,s){if(!n||He)return"";He=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(Te){var p=Te}Reflect.construct(n,[],s)}else{try{s.call()}catch(Te){p=Te}n.call(s.prototype)}else{try{throw Error()}catch(Te){p=Te}n()}}catch(Te){if(Te&&p&&typeof Te.stack=="string"){for(var E=Te.stack.split(`
`),A=p.stack.split(`
`),O=E.length-1,Z=A.length-1;1<=O&&0<=Z&&E[O]!==A[Z];)Z--;for(;1<=O&&0<=Z;O--,Z--)if(E[O]!==A[Z]){if(O!==1||Z!==1)do if(O--,Z--,0>Z||E[O]!==A[Z]){var ne=`
`+E[O].replace(" at new "," at ");return n.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",n.displayName)),ne}while(1<=O&&0<=Z);break}}}finally{He=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?ye(n):""}function mt(n){switch(n.tag){case 5:return ye(n.type);case 16:return ye("Lazy");case 13:return ye("Suspense");case 19:return ye("SuspenseList");case 0:case 2:case 15:return n=Ye(n.type,!1),n;case 11:return n=Ye(n.type.render,!1),n;case 1:return n=Ye(n.type,!0),n;default:return""}}function wt(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case H:return"Fragment";case we:return"Portal";case z:return"Profiler";case B:return"StrictMode";case J:return"Suspense";case pt:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case re:return(n.displayName||"Context")+".Consumer";case Q:return(n._context.displayName||"Context")+".Provider";case le:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Jt:return s=n.displayName||null,s!==null?s:wt(n.type)||"Memo";case At:s=n._payload,n=n._init;try{return wt(n(s))}catch{}}return null}function et(n){var s=n.type;switch(n.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=s.render,n=n.displayName||n.name||"",s.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wt(s);case 8:return s===B?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function vt(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Rt(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Kt(n){var s=Rt(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,s),p=""+n[s];if(!n.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var E=l.get,A=l.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return E.call(this)},set:function(O){p=""+O,A.call(this,O)}}),Object.defineProperty(n,s,{enumerable:l.enumerable}),{getValue:function(){return p},setValue:function(O){p=""+O},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function br(n){n._valueTracker||(n._valueTracker=Kt(n))}function bn(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var l=s.getValue(),p="";return n&&(p=Rt(n)?n.checked?"true":"false":n.value),n=p,n!==l?(s.setValue(n),!0):!1}function or(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function tn(n,s){var l=s.checked;return Be({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function lr(n,s){var l=s.defaultValue==null?"":s.defaultValue,p=s.checked!=null?s.checked:s.defaultChecked;l=vt(s.value!=null?s.value:l),n._wrapperState={initialChecked:p,initialValue:l,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function Gn(n,s){s=s.checked,s!=null&&ce(n,"checked",s,!1)}function kr(n,s){Gn(n,s);var l=vt(s.value),p=s.type;if(l!=null)p==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(p==="submit"||p==="reset"){n.removeAttribute("value");return}s.hasOwnProperty("value")?Vi(n,s.type,l):s.hasOwnProperty("defaultValue")&&Vi(n,s.type,vt(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(n.defaultChecked=!!s.defaultChecked)}function dr(n,s,l){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var p=s.type;if(!(p!=="submit"&&p!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+n._wrapperState.initialValue,l||s===n.value||(n.value=s),n.defaultValue=s}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function Vi(n,s,l){(s!=="number"||or(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var q=Array.isArray;function ue(n,s,l,p){if(n=n.options,s){s={};for(var E=0;E<l.length;E++)s["$"+l[E]]=!0;for(l=0;l<n.length;l++)E=s.hasOwnProperty("$"+n[l].value),n[l].selected!==E&&(n[l].selected=E),E&&p&&(n[l].defaultSelected=!0)}else{for(l=""+vt(l),s=null,E=0;E<n.length;E++){if(n[E].value===l){n[E].selected=!0,p&&(n[E].defaultSelected=!0);return}s!==null||n[E].disabled||(s=n[E])}s!==null&&(s.selected=!0)}}function W(n,s){if(s.dangerouslySetInnerHTML!=null)throw Error(t(91));return Be({},s,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function k(n,s){var l=s.value;if(l==null){if(l=s.children,s=s.defaultValue,l!=null){if(s!=null)throw Error(t(92));if(q(l)){if(1<l.length)throw Error(t(93));l=l[0]}s=l}s==null&&(s=""),l=s}n._wrapperState={initialValue:vt(l)}}function j(n,s){var l=vt(s.value),p=vt(s.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),s.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),p!=null&&(n.defaultValue=""+p)}function $(n){var s=n.textContent;s===n._wrapperState.initialValue&&s!==""&&s!==null&&(n.value=s)}function ee(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function te(n,s){return n==null||n==="http://www.w3.org/1999/xhtml"?ee(s):n==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ae,_e=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,l,p,E){MSApp.execUnsafeLocalFunction(function(){return n(s,l,p,E)})}:n}(function(n,s){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=s;else{for(ae=ae||document.createElement("div"),ae.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=ae.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;s.firstChild;)n.appendChild(s.firstChild)}});function Ie(n,s){if(s){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=s;return}}n.textContent=s}var Ce={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Re=["Webkit","ms","Moz","O"];Object.keys(Ce).forEach(function(n){Re.forEach(function(s){s=s+n.charAt(0).toUpperCase()+n.substring(1),Ce[s]=Ce[n]})});function Ne(n,s,l){return s==null||typeof s=="boolean"||s===""?"":l||typeof s!="number"||s===0||Ce.hasOwnProperty(n)&&Ce[n]?(""+s).trim():s+"px"}function ke(n,s){n=n.style;for(var l in s)if(s.hasOwnProperty(l)){var p=l.indexOf("--")===0,E=Ne(l,s[l],p);l==="float"&&(l="cssFloat"),p?n.setProperty(l,E):n[l]=E}}var ze=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function De(n,s){if(s){if(ze[n]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(t(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(t(61))}if(s.style!=null&&typeof s.style!="object")throw Error(t(62))}}function Qe(n,s){if(n.indexOf("-")===-1)return typeof s.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $e=null;function lt(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var bt=null,st=null,Nt=null;function Pt(n){if(n=Il(n)){if(typeof bt!="function")throw Error(t(280));var s=n.stateNode;s&&(s=Nu(s),bt(n.stateNode,n.type,s))}}function gt(n){st?Nt?Nt.push(n):Nt=[n]:st=n}function kt(){if(st){var n=st,s=Nt;if(Nt=st=null,Pt(n),s)for(n=0;n<s.length;n++)Pt(s[n])}}function Ft(n,s){return n(s)}function pr(){}var Zt=!1;function qt(n,s,l){if(Zt)return n(s,l);Zt=!0;try{return Ft(n,s,l)}finally{Zt=!1,(st!==null||Nt!==null)&&(pr(),kt())}}function Dt(n,s){var l=n.stateNode;if(l===null)return null;var p=Nu(l);if(p===null)return null;l=p[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(n=n.type,p=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!p;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(t(231,s,typeof l));return l}var nr=!1;if(g)try{var rr={};Object.defineProperty(rr,"passive",{get:function(){nr=!0}}),window.addEventListener("test",rr,rr),window.removeEventListener("test",rr,rr)}catch{nr=!1}function tr(n,s,l,p,E,A,O,Z,ne){var Te=Array.prototype.slice.call(arguments,3);try{s.apply(l,Te)}catch(Oe){this.onError(Oe)}}var Ht=!1,Yr=null,gr=!1,Dr=null,Ar={onError:function(n){Ht=!0,Yr=n}};function jr(n,s,l,p,E,A,O,Z,ne){Ht=!1,Yr=null,tr.apply(Ar,arguments)}function cn(n,s,l,p,E,A,O,Z,ne){if(jr.apply(this,arguments),Ht){if(Ht){var Te=Yr;Ht=!1,Yr=null}else throw Error(t(198));gr||(gr=!0,Dr=Te)}}function _r(n){var s=n,l=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,s.flags&4098&&(l=s.return),n=s.return;while(n)}return s.tag===3?l:null}function wn(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function Er(n){if(_r(n)!==n)throw Error(t(188))}function oi(n){var s=n.alternate;if(!s){if(s=_r(n),s===null)throw Error(t(188));return s!==n?null:n}for(var l=n,p=s;;){var E=l.return;if(E===null)break;var A=E.alternate;if(A===null){if(p=E.return,p!==null){l=p;continue}break}if(E.child===A.child){for(A=E.child;A;){if(A===l)return Er(E),n;if(A===p)return Er(E),s;A=A.sibling}throw Error(t(188))}if(l.return!==p.return)l=E,p=A;else{for(var O=!1,Z=E.child;Z;){if(Z===l){O=!0,l=E,p=A;break}if(Z===p){O=!0,p=E,l=A;break}Z=Z.sibling}if(!O){for(Z=A.child;Z;){if(Z===l){O=!0,l=A,p=E;break}if(Z===p){O=!0,p=A,l=E;break}Z=Z.sibling}if(!O)throw Error(t(189))}}if(l.alternate!==p)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?n:s}function Se(n){return n=oi(n),n!==null?Tr(n):null}function Tr(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var s=Tr(n);if(s!==null)return s;n=n.sibling}return null}var kn=e.unstable_scheduleCallback,Kn=e.unstable_cancelCallback,fn=e.unstable_shouldYield,hs=e.unstable_requestPaint,Yt=e.unstable_now,ds=e.unstable_getCurrentPriorityLevel,wi=e.unstable_ImmediatePriority,Dn=e.unstable_UserBlockingPriority,rn=e.unstable_NormalPriority,Hn=e.unstable_LowPriority,zs=e.unstable_IdlePriority,$n=null,Lr=null;function ai(n){if(Lr&&typeof Lr.onCommitFiberRoot=="function")try{Lr.onCommitFiberRoot($n,n,void 0,(n.current.flags&128)===128)}catch{}}var Or=Math.clz32?Math.clz32:ji,Bi=Math.log,Si=Math.LN2;function ji(n){return n>>>=0,n===0?32:31-(Bi(n)/Si|0)|0}var zi=64,Gi=4194304;function Ki(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Hi(n,s){var l=n.pendingLanes;if(l===0)return 0;var p=0,E=n.suspendedLanes,A=n.pingedLanes,O=l&268435455;if(O!==0){var Z=O&~E;Z!==0?p=Ki(Z):(A&=O,A!==0&&(p=Ki(A)))}else O=l&~E,O!==0?p=Ki(O):A!==0&&(p=Ki(A));if(p===0)return 0;if(s!==0&&s!==p&&!(s&E)&&(E=p&-p,A=s&-s,E>=A||E===16&&(A&4194240)!==0))return s;if(p&4&&(p|=l&16),s=n.entangledLanes,s!==0)for(n=n.entanglements,s&=p;0<s;)l=31-Or(s),E=1<<l,p|=n[l],s&=~E;return p}function yl(n,s){switch(n){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ai(n,s){for(var l=n.suspendedLanes,p=n.pingedLanes,E=n.expirationTimes,A=n.pendingLanes;0<A;){var O=31-Or(A),Z=1<<O,ne=E[O];ne===-1?(!(Z&l)||Z&p)&&(E[O]=yl(Z,s)):ne<=s&&(n.expiredLanes|=Z),A&=~Z}}function Sn(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function ps(){var n=zi;return zi<<=1,!(zi&4194240)&&(zi=64),n}function $i(n){for(var s=[],l=0;31>l;l++)s.push(n);return s}function Wi(n,s,l){n.pendingLanes|=s,s!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,s=31-Or(s),n[s]=l}function er(n,s){var l=n.pendingLanes&~s;n.pendingLanes=s,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=s,n.mutableReadLanes&=s,n.entangledLanes&=s,s=n.entanglements;var p=n.eventTimes;for(n=n.expirationTimes;0<l;){var E=31-Or(l),A=1<<E;s[E]=0,p[E]=-1,n[E]=-1,l&=~A}}function qi(n,s){var l=n.entangledLanes|=s;for(n=n.entanglements;l;){var p=31-Or(l),E=1<<p;E&s|n[p]&s&&(n[p]|=s),l&=~E}}var Ot=0;function Yi(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var ma,gs,va,ya,Oo,No=!1,li=[],zr=null,Wn=null,qn=null,Qi=new Map,Ln=new Map,ui=[],_l="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _a(n,s){switch(n){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":Wn=null;break;case"mouseover":case"mouseout":qn=null;break;case"pointerover":case"pointerout":Qi.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ln.delete(s.pointerId)}}function hn(n,s,l,p,E,A){return n===null||n.nativeEvent!==A?(n={blockedOn:s,domEventName:l,eventSystemFlags:p,nativeEvent:A,targetContainers:[E]},s!==null&&(s=Il(s),s!==null&&gs(s)),n):(n.eventSystemFlags|=p,s=n.targetContainers,E!==null&&s.indexOf(E)===-1&&s.push(E),n)}function El(n,s,l,p,E){switch(s){case"focusin":return zr=hn(zr,n,s,l,p,E),!0;case"dragenter":return Wn=hn(Wn,n,s,l,p,E),!0;case"mouseover":return qn=hn(qn,n,s,l,p,E),!0;case"pointerover":var A=E.pointerId;return Qi.set(A,hn(Qi.get(A)||null,n,s,l,p,E)),!0;case"gotpointercapture":return A=E.pointerId,Ln.set(A,hn(Ln.get(A)||null,n,s,l,p,E)),!0}return!1}function Ea(n){var s=Go(n.target);if(s!==null){var l=_r(s);if(l!==null){if(s=l.tag,s===13){if(s=wn(l),s!==null){n.blockedOn=s,Oo(n.priority,function(){va(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ri(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var l=ys(n.domEventName,n.eventSystemFlags,s[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var p=new l.constructor(l.type,l);$e=p,l.target.dispatchEvent(p),$e=null}else return s=Il(l),s!==null&&gs(s),n.blockedOn=l,!1;s.shift()}return!0}function ms(n,s,l){Ri(n)&&l.delete(s)}function Ta(){No=!1,zr!==null&&Ri(zr)&&(zr=null),Wn!==null&&Ri(Wn)&&(Wn=null),qn!==null&&Ri(qn)&&(qn=null),Qi.forEach(ms),Ln.forEach(ms)}function Yn(n,s){n.blockedOn===s&&(n.blockedOn=null,No||(No=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ta)))}function Qn(n){function s(E){return Yn(E,n)}if(0<li.length){Yn(li[0],n);for(var l=1;l<li.length;l++){var p=li[l];p.blockedOn===n&&(p.blockedOn=null)}}for(zr!==null&&Yn(zr,n),Wn!==null&&Yn(Wn,n),qn!==null&&Yn(qn,n),Qi.forEach(s),Ln.forEach(s),l=0;l<ui.length;l++)p=ui[l],p.blockedOn===n&&(p.blockedOn=null);for(;0<ui.length&&(l=ui[0],l.blockedOn===null);)Ea(l),l.blockedOn===null&&ui.shift()}var Ii=fe.ReactCurrentBatchConfig,Xi=!0;function Qt(n,s,l,p){var E=Ot,A=Ii.transition;Ii.transition=null;try{Ot=1,Fo(n,s,l,p)}finally{Ot=E,Ii.transition=A}}function xa(n,s,l,p){var E=Ot,A=Ii.transition;Ii.transition=null;try{Ot=4,Fo(n,s,l,p)}finally{Ot=E,Ii.transition=A}}function Fo(n,s,l,p){if(Xi){var E=ys(n,s,l,p);if(E===null)es(n,s,p,vs,l),_a(n,p);else if(El(E,n,s,l,p))p.stopPropagation();else if(_a(n,p),s&4&&-1<_l.indexOf(n)){for(;E!==null;){var A=Il(E);if(A!==null&&ma(A),A=ys(n,s,l,p),A===null&&es(n,s,p,vs,l),A===E)break;E=A}E!==null&&p.stopPropagation()}else es(n,s,p,null,l)}}var vs=null;function ys(n,s,l,p){if(vs=null,n=lt(p),n=Go(n),n!==null)if(s=_r(n),s===null)n=null;else if(l=s.tag,l===13){if(n=wn(s),n!==null)return n;n=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null);return vs=n,null}function Mo(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ds()){case wi:return 1;case Dn:return 4;case rn:case Hn:return 16;case zs:return 536870912;default:return 16}default:return 16}}var dn=null,Gs=null,nn=null;function Ks(){if(nn)return nn;var n,s=Gs,l=s.length,p,E="value"in dn?dn.value:dn.textContent,A=E.length;for(n=0;n<l&&s[n]===E[n];n++);var O=l-n;for(p=1;p<=O&&s[l-p]===E[A-p];p++);return nn=E.slice(n,1<p?1-p:void 0)}function Ji(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function An(){return!0}function Uo(){return!1}function Nr(n){function s(l,p,E,A,O){this._reactName=l,this._targetInst=E,this.type=p,this.nativeEvent=A,this.target=O,this.currentTarget=null;for(var Z in n)n.hasOwnProperty(Z)&&(l=n[Z],this[Z]=l?l(A):A[Z]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?An:Uo,this.isPropagationStopped=Uo,this}return Be(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=An)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=An)},persist:function(){},isPersistent:An}),s}var Xn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hs=Nr(Xn),Jn=Be({},Xn,{view:0,detail:0}),wa=Nr(Jn),Qr,Gr,Zi,_s=Be({},Jn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zn,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Zi&&(Zi&&n.type==="mousemove"?(Qr=n.screenX-Zi.screenX,Gr=n.screenY-Zi.screenY):Gr=Qr=0,Zi=n),Qr)},movementY:function(n){return"movementY"in n?n.movementY:Gr}}),$s=Nr(_s),Vo=Be({},_s,{dataTransfer:0}),Sa=Nr(Vo),Et=Be({},Jn,{relatedTarget:0}),Ws=Nr(Et),ci=Be({},Xn,{animationName:0,elapsedTime:0,pseudoElement:0}),fi=Nr(ci),Aa=Be({},Xn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ra=Nr(Aa),qs=Be({},Xn,{data:0}),Ys=Nr(qs),Qs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jo(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=Bo[n])?!!s[n]:!1}function Zn(){return jo}var c=Be({},Jn,{key:function(n){if(n.key){var s=Qs[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Ji(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?xr[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zn,charCode:function(n){return n.type==="keypress"?Ji(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ji(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),S=Nr(c),b=Be({},_s,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),V=Nr(b),de=Be({},Jn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zn}),xe=Nr(de),Ge=Be({},Xn,{propertyName:0,elapsedTime:0,pseudoElement:0}),jt=Nr(Ge),Rr=Be({},_s,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Mt=Nr(Rr),Fr=[9,13,27,32],wr=g&&"CompositionEvent"in window,Rn=null;g&&"documentMode"in document&&(Rn=document.documentMode);var In=g&&"TextEvent"in window&&!Rn,Es=g&&(!wr||Rn&&8<Rn&&11>=Rn),Xs=" ",Tu=!1;function xu(n,s){switch(n){case"keyup":return Fr.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ia(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Js=!1;function Mf(n,s){switch(n){case"compositionend":return Ia(s);case"keypress":return s.which!==32?null:(Tu=!0,Xs);case"textInput":return n=s.data,n===Xs&&Tu?null:n;default:return null}}function Uf(n,s){if(Js)return n==="compositionend"||!wr&&xu(n,s)?(n=Ks(),nn=Gs=dn=null,Js=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Es&&s.locale!=="ko"?null:s.data;default:return null}}var Vf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wu(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!Vf[n.type]:s==="textarea"}function Tl(n,s,l,p){gt(p),s=ws(s,"onChange"),0<s.length&&(l=new Hs("onChange","change",null,l,p),n.push({event:l,listeners:s}))}var Ts=null,zo=null;function Zs(n){Mr(n,0)}function Ca(n){var s=La(n);if(bn(s))return n}function Bf(n,s){if(n==="change")return s}var Su=!1;if(g){var xl;if(g){var Pa="oninput"in document;if(!Pa){var Au=document.createElement("div");Au.setAttribute("oninput","return;"),Pa=typeof Au.oninput=="function"}xl=Pa}else xl=!1;Su=xl&&(!document.documentMode||9<document.documentMode)}function Ru(){Ts&&(Ts.detachEvent("onpropertychange",Iu),zo=Ts=null)}function Iu(n){if(n.propertyName==="value"&&Ca(zo)){var s=[];Tl(s,zo,n,lt(n)),qt(Zs,s)}}function jf(n,s,l){n==="focusin"?(Ru(),Ts=s,zo=l,Ts.attachEvent("onpropertychange",Iu)):n==="focusout"&&Ru()}function Cu(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ca(zo)}function Pu(n,s){if(n==="click")return Ca(s)}function zf(n,s){if(n==="input"||n==="change")return Ca(s)}function Gf(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var ei=typeof Object.is=="function"?Object.is:Gf;function eo(n,s){if(ei(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var l=Object.keys(n),p=Object.keys(s);if(l.length!==p.length)return!1;for(p=0;p<l.length;p++){var E=l[p];if(!T.call(s,E)||!ei(n[E],s[E]))return!1}return!0}function wl(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function bu(n,s){var l=wl(n);n=0;for(var p;l;){if(l.nodeType===3){if(p=n+l.textContent.length,n<=s&&p>=s)return{node:l,offset:s-n};n=p}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=wl(l)}}function Ir(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?Ir(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function Sl(){for(var n=window,s=or();s instanceof n.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)n=s.contentWindow;else break;s=or(n.document)}return s}function ba(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}function Kf(n){var s=Sl(),l=n.focusedElem,p=n.selectionRange;if(s!==l&&l&&l.ownerDocument&&Ir(l.ownerDocument.documentElement,l)){if(p!==null&&ba(l)){if(s=p.start,n=p.end,n===void 0&&(n=s),"selectionStart"in l)l.selectionStart=s,l.selectionEnd=Math.min(n,l.value.length);else if(n=(s=l.ownerDocument||document)&&s.defaultView||window,n.getSelection){n=n.getSelection();var E=l.textContent.length,A=Math.min(p.start,E);p=p.end===void 0?A:Math.min(p.end,E),!n.extend&&A>p&&(E=p,p=A,A=E),E=bu(l,A);var O=bu(l,p);E&&O&&(n.rangeCount!==1||n.anchorNode!==E.node||n.anchorOffset!==E.offset||n.focusNode!==O.node||n.focusOffset!==O.offset)&&(s=s.createRange(),s.setStart(E.node,E.offset),n.removeAllRanges(),A>p?(n.addRange(s),n.extend(O.node,O.offset)):(s.setEnd(O.node,O.offset),n.addRange(s)))}}for(s=[],n=l;n=n.parentNode;)n.nodeType===1&&s.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<s.length;l++)n=s[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var ku=g&&"documentMode"in document&&11>=document.documentMode,R=null,x=null,v=null,d=!1;function a(n,s,l){var p=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;d||R==null||R!==or(p)||(p=R,"selectionStart"in p&&ba(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),v&&eo(v,p)||(v=p,p=ws(x,"onSelect"),0<p.length&&(s=new Hs("onSelect","select",null,s,l),n.push({event:s,listeners:p}),s.target=R)))}function f(n,s){var l={};return l[n.toLowerCase()]=s.toLowerCase(),l["Webkit"+n]="webkit"+s,l["Moz"+n]="moz"+s,l}var y={animationend:f("Animation","AnimationEnd"),animationiteration:f("Animation","AnimationIteration"),animationstart:f("Animation","AnimationStart"),transitionend:f("Transition","TransitionEnd")},w={},C={};g&&(C=document.createElement("div").style,"AnimationEvent"in window||(delete y.animationend.animation,delete y.animationiteration.animation,delete y.animationstart.animation),"TransitionEvent"in window||delete y.transitionend.transition);function P(n){if(w[n])return w[n];if(!y[n])return n;var s=y[n],l;for(l in s)if(s.hasOwnProperty(l)&&l in C)return w[n]=s[l];return n}var M=P("animationend"),G=P("animationiteration"),K=P("animationstart"),ie=P("transitionend"),Ee=new Map,be="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fe(n,s){Ee.set(n,s),u(s,[n])}for(var Xe=0;Xe<be.length;Xe++){var We=be[Xe],ot=We.toLowerCase(),ut=We[0].toUpperCase()+We.slice(1);Fe(ot,"on"+ut)}Fe(M,"onAnimationEnd"),Fe(G,"onAnimationIteration"),Fe(K,"onAnimationStart"),Fe("dblclick","onDoubleClick"),Fe("focusin","onFocus"),Fe("focusout","onBlur"),Fe(ie,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var It="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ur=new Set("cancel close invalid load scroll toggle".split(" ").concat(It));function pn(n,s,l){var p=n.type||"unknown-event";n.currentTarget=l,cn(p,s,void 0,n),n.currentTarget=null}function Mr(n,s){s=(s&4)!==0;for(var l=0;l<n.length;l++){var p=n[l],E=p.event;p=p.listeners;e:{var A=void 0;if(s)for(var O=p.length-1;0<=O;O--){var Z=p[O],ne=Z.instance,Te=Z.currentTarget;if(Z=Z.listener,ne!==A&&E.isPropagationStopped())break e;pn(E,Z,Te),A=ne}else for(O=0;O<p.length;O++){if(Z=p[O],ne=Z.instance,Te=Z.currentTarget,Z=Z.listener,ne!==A&&E.isPropagationStopped())break e;pn(E,Z,Te),A=ne}}}if(gr)throw n=Dr,gr=!1,Dr=null,n}function Vt(n,s){var l=s[Qf];l===void 0&&(l=s[Qf]=new Set);var p=n+"__bubble";l.has(p)||(xs(s,n,2,!1),l.add(p))}function rt(n,s,l){var p=0;s&&(p|=4),xs(l,n,p,s)}var Tt="_reactListening"+Math.random().toString(36).slice(2);function ir(n){if(!n[Tt]){n[Tt]=!0,i.forEach(function(l){l!=="selectionchange"&&(ur.has(l)||rt(l,!1,n),rt(l,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[Tt]||(s[Tt]=!0,rt("selectionchange",!1,s))}}function xs(n,s,l,p){switch(Mo(s)){case 1:var E=Qt;break;case 4:E=xa;break;default:E=Fo}l=E.bind(null,s,l,n),E=void 0,!nr||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(E=!0),p?E!==void 0?n.addEventListener(s,l,{capture:!0,passive:E}):n.addEventListener(s,l,!0):E!==void 0?n.addEventListener(s,l,{passive:E}):n.addEventListener(s,l,!1)}function es(n,s,l,p,E){var A=p;if(!(s&1)&&!(s&2)&&p!==null)e:for(;;){if(p===null)return;var O=p.tag;if(O===3||O===4){var Z=p.stateNode.containerInfo;if(Z===E||Z.nodeType===8&&Z.parentNode===E)break;if(O===4)for(O=p.return;O!==null;){var ne=O.tag;if((ne===3||ne===4)&&(ne=O.stateNode.containerInfo,ne===E||ne.nodeType===8&&ne.parentNode===E))return;O=O.return}for(;Z!==null;){if(O=Go(Z),O===null)return;if(ne=O.tag,ne===5||ne===6){p=A=O;continue e}Z=Z.parentNode}}p=p.return}qt(function(){var Te=A,Oe=lt(l),Ve=[];e:{var Le=Ee.get(n);if(Le!==void 0){var qe=Hs,tt=n;switch(n){case"keypress":if(Ji(l)===0)break e;case"keydown":case"keyup":qe=S;break;case"focusin":tt="focus",qe=Ws;break;case"focusout":tt="blur",qe=Ws;break;case"beforeblur":case"afterblur":qe=Ws;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=$s;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=Sa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=xe;break;case M:case G:case K:qe=fi;break;case ie:qe=jt;break;case"scroll":qe=wa;break;case"wheel":qe=Mt;break;case"copy":case"cut":case"paste":qe=Ra;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=V}var nt=(s&4)!==0,Cr=!nt&&n==="scroll",ge=nt?Le!==null?Le+"Capture":null:Le;nt=[];for(var oe=Te,ve;oe!==null;){ve=oe;var je=ve.stateNode;if(ve.tag===5&&je!==null&&(ve=je,ge!==null&&(je=Dt(oe,ge),je!=null&&nt.push(Ci(oe,je,ve)))),Cr)break;oe=oe.return}0<nt.length&&(Le=new qe(Le,tt,null,l,Oe),Ve.push({event:Le,listeners:nt}))}}if(!(s&7)){e:{if(Le=n==="mouseover"||n==="pointerover",qe=n==="mouseout"||n==="pointerout",Le&&l!==$e&&(tt=l.relatedTarget||l.fromElement)&&(Go(tt)||tt[Ss]))break e;if((qe||Le)&&(Le=Oe.window===Oe?Oe:(Le=Oe.ownerDocument)?Le.defaultView||Le.parentWindow:window,qe?(tt=l.relatedTarget||l.toElement,qe=Te,tt=tt?Go(tt):null,tt!==null&&(Cr=_r(tt),tt!==Cr||tt.tag!==5&&tt.tag!==6)&&(tt=null)):(qe=null,tt=Te),qe!==tt)){if(nt=$s,je="onMouseLeave",ge="onMouseEnter",oe="mouse",(n==="pointerout"||n==="pointerover")&&(nt=V,je="onPointerLeave",ge="onPointerEnter",oe="pointer"),Cr=qe==null?Le:La(qe),ve=tt==null?Le:La(tt),Le=new nt(je,oe+"leave",qe,l,Oe),Le.target=Cr,Le.relatedTarget=ve,je=null,Go(Oe)===Te&&(nt=new nt(ge,oe+"enter",tt,l,Oe),nt.target=ve,nt.relatedTarget=Cr,je=nt),Cr=je,qe&&tt)t:{for(nt=qe,ge=tt,oe=0,ve=nt;ve;ve=to(ve))oe++;for(ve=0,je=ge;je;je=to(je))ve++;for(;0<oe-ve;)nt=to(nt),oe--;for(;0<ve-oe;)ge=to(ge),ve--;for(;oe--;){if(nt===ge||ge!==null&&nt===ge.alternate)break t;nt=to(nt),ge=to(ge)}nt=null}else nt=null;qe!==null&&ro(Ve,Le,qe,nt,!1),tt!==null&&Cr!==null&&ro(Ve,Cr,tt,nt,!0)}}e:{if(Le=Te?La(Te):window,qe=Le.nodeName&&Le.nodeName.toLowerCase(),qe==="select"||qe==="input"&&Le.type==="file")var it=Bf;else if(wu(Le))if(Su)it=zf;else{it=Cu;var ct=jf}else(qe=Le.nodeName)&&qe.toLowerCase()==="input"&&(Le.type==="checkbox"||Le.type==="radio")&&(it=Pu);if(it&&(it=it(n,Te))){Tl(Ve,it,l,Oe);break e}ct&&ct(n,Le,Te),n==="focusout"&&(ct=Le._wrapperState)&&ct.controlled&&Le.type==="number"&&Vi(Le,"number",Le.value)}switch(ct=Te?La(Te):window,n){case"focusin":(wu(ct)||ct.contentEditable==="true")&&(R=ct,x=Te,v=null);break;case"focusout":v=x=R=null;break;case"mousedown":d=!0;break;case"contextmenu":case"mouseup":case"dragend":d=!1,a(Ve,l,Oe);break;case"selectionchange":if(ku)break;case"keydown":case"keyup":a(Ve,l,Oe)}var ft;if(wr)e:{switch(n){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else Js?xu(n,l)&&(yt="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(yt="onCompositionStart");yt&&(Es&&l.locale!=="ko"&&(Js||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&Js&&(ft=Ks()):(dn=Oe,Gs="value"in dn?dn.value:dn.textContent,Js=!0)),ct=ws(Te,yt),0<ct.length&&(yt=new Ys(yt,n,null,l,Oe),Ve.push({event:yt,listeners:ct}),ft?yt.data=ft:(ft=Ia(l),ft!==null&&(yt.data=ft)))),(ft=In?Mf(n,l):Uf(n,l))&&(Te=ws(Te,"onBeforeInput"),0<Te.length&&(Oe=new Ys("onBeforeInput","beforeinput",null,l,Oe),Ve.push({event:Oe,listeners:Te}),Oe.data=ft))}Mr(Ve,s)})}function Ci(n,s,l){return{instance:n,listener:s,currentTarget:l}}function ws(n,s){for(var l=s+"Capture",p=[];n!==null;){var E=n,A=E.stateNode;E.tag===5&&A!==null&&(E=A,A=Dt(n,l),A!=null&&p.unshift(Ci(n,A,E)),A=Dt(n,s),A!=null&&p.push(Ci(n,A,E))),n=n.return}return p}function to(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function ro(n,s,l,p,E){for(var A=s._reactName,O=[];l!==null&&l!==p;){var Z=l,ne=Z.alternate,Te=Z.stateNode;if(ne!==null&&ne===p)break;Z.tag===5&&Te!==null&&(Z=Te,E?(ne=Dt(l,A),ne!=null&&O.unshift(Ci(l,ne,Z))):E||(ne=Dt(l,A),ne!=null&&O.push(Ci(l,ne,Z)))),l=l.return}O.length!==0&&n.push({event:s,listeners:O})}var Al=/\r\n?/g,Du=/\u0000|\uFFFD/g;function Lu(n){return(typeof n=="string"?n:""+n).replace(Al,`
`).replace(Du,"")}function ka(n,s,l){if(s=Lu(s),Lu(n)!==s&&l)throw Error(t(425))}function Ou(){}var Hf=null,$f=null;function Wf(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var qf=typeof setTimeout=="function"?setTimeout:void 0,vE=typeof clearTimeout=="function"?clearTimeout:void 0,Jp=typeof Promise=="function"?Promise:void 0,yE=typeof queueMicrotask=="function"?queueMicrotask:typeof Jp<"u"?function(n){return Jp.resolve(null).then(n).catch(_E)}:qf;function _E(n){setTimeout(function(){throw n})}function Yf(n,s){var l=s,p=0;do{var E=l.nextSibling;if(n.removeChild(l),E&&E.nodeType===8)if(l=E.data,l==="/$"){if(p===0){n.removeChild(E),Qn(s);return}p--}else l!=="$"&&l!=="$?"&&l!=="$!"||p++;l=E}while(l);Qn(s)}function no(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return n}function Zp(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return n;s--}else l==="/$"&&s++}n=n.previousSibling}return null}var Da=Math.random().toString(36).slice(2),ts="__reactFiber$"+Da,Rl="__reactProps$"+Da,Ss="__reactContainer$"+Da,Qf="__reactEvents$"+Da,EE="__reactListeners$"+Da,TE="__reactHandles$"+Da;function Go(n){var s=n[ts];if(s)return s;for(var l=n.parentNode;l;){if(s=l[Ss]||l[ts]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(n=Zp(n);n!==null;){if(l=n[ts])return l;n=Zp(n)}return s}n=l,l=n.parentNode}return null}function Il(n){return n=n[ts]||n[Ss],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function La(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function Nu(n){return n[Rl]||null}var Xf=[],Oa=-1;function io(n){return{current:n}}function ar(n){0>Oa||(n.current=Xf[Oa],Xf[Oa]=null,Oa--)}function sr(n,s){Oa++,Xf[Oa]=n.current,n.current=s}var so={},gn=io(so),On=io(!1),Ko=so;function Na(n,s){var l=n.type.contextTypes;if(!l)return so;var p=n.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===s)return p.__reactInternalMemoizedMaskedChildContext;var E={},A;for(A in l)E[A]=s[A];return p&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=E),E}function Nn(n){return n=n.childContextTypes,n!=null}function Fu(){ar(On),ar(gn)}function eg(n,s,l){if(gn.current!==so)throw Error(t(168));sr(gn,s),sr(On,l)}function tg(n,s,l){var p=n.stateNode;if(s=s.childContextTypes,typeof p.getChildContext!="function")return l;p=p.getChildContext();for(var E in p)if(!(E in s))throw Error(t(108,et(n)||"Unknown",E));return Be({},l,p)}function Mu(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||so,Ko=gn.current,sr(gn,n),sr(On,On.current),!0}function rg(n,s,l){var p=n.stateNode;if(!p)throw Error(t(169));l?(n=tg(n,s,Ko),p.__reactInternalMemoizedMergedChildContext=n,ar(On),ar(gn),sr(gn,n)):ar(On),sr(On,l)}var As=null,Uu=!1,Jf=!1;function ng(n){As===null?As=[n]:As.push(n)}function xE(n){Uu=!0,ng(n)}function oo(){if(!Jf&&As!==null){Jf=!0;var n=0,s=Ot;try{var l=As;for(Ot=1;n<l.length;n++){var p=l[n];do p=p(!0);while(p!==null)}As=null,Uu=!1}catch(E){throw As!==null&&(As=As.slice(n+1)),kn(wi,oo),E}finally{Ot=s,Jf=!1}}return null}var Fa=[],Ma=0,Vu=null,Bu=0,hi=[],di=0,Ho=null,Rs=1,Is="";function $o(n,s){Fa[Ma++]=Bu,Fa[Ma++]=Vu,Vu=n,Bu=s}function ig(n,s,l){hi[di++]=Rs,hi[di++]=Is,hi[di++]=Ho,Ho=n;var p=Rs;n=Is;var E=32-Or(p)-1;p&=~(1<<E),l+=1;var A=32-Or(s)+E;if(30<A){var O=E-E%5;A=(p&(1<<O)-1).toString(32),p>>=O,E-=O,Rs=1<<32-Or(s)+E|l<<E|p,Is=A+n}else Rs=1<<A|l<<E|p,Is=n}function Zf(n){n.return!==null&&($o(n,1),ig(n,1,0))}function eh(n){for(;n===Vu;)Vu=Fa[--Ma],Fa[Ma]=null,Bu=Fa[--Ma],Fa[Ma]=null;for(;n===Ho;)Ho=hi[--di],hi[di]=null,Is=hi[--di],hi[di]=null,Rs=hi[--di],hi[di]=null}var ti=null,ri=null,cr=!1,Pi=null;function sg(n,s){var l=vi(5,null,null,0);l.elementType="DELETED",l.stateNode=s,l.return=n,s=n.deletions,s===null?(n.deletions=[l],n.flags|=16):s.push(l)}function og(n,s){switch(n.tag){case 5:var l=n.type;return s=s.nodeType!==1||l.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(n.stateNode=s,ti=n,ri=no(s.firstChild),!0):!1;case 6:return s=n.pendingProps===""||s.nodeType!==3?null:s,s!==null?(n.stateNode=s,ti=n,ri=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(l=Ho!==null?{id:Rs,overflow:Is}:null,n.memoizedState={dehydrated:s,treeContext:l,retryLane:1073741824},l=vi(18,null,null,0),l.stateNode=s,l.return=n,n.child=l,ti=n,ri=null,!0):!1;default:return!1}}function th(n){return(n.mode&1)!==0&&(n.flags&128)===0}function rh(n){if(cr){var s=ri;if(s){var l=s;if(!og(n,s)){if(th(n))throw Error(t(418));s=no(l.nextSibling);var p=ti;s&&og(n,s)?sg(p,l):(n.flags=n.flags&-4097|2,cr=!1,ti=n)}}else{if(th(n))throw Error(t(418));n.flags=n.flags&-4097|2,cr=!1,ti=n}}}function ag(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ti=n}function ju(n){if(n!==ti)return!1;if(!cr)return ag(n),cr=!0,!1;var s;if((s=n.tag!==3)&&!(s=n.tag!==5)&&(s=n.type,s=s!=="head"&&s!=="body"&&!Wf(n.type,n.memoizedProps)),s&&(s=ri)){if(th(n))throw lg(),Error(t(418));for(;s;)sg(n,s),s=no(s.nextSibling)}if(ag(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,s=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(s===0){ri=no(n.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++}n=n.nextSibling}ri=null}}else ri=ti?no(n.stateNode.nextSibling):null;return!0}function lg(){for(var n=ri;n;)n=no(n.nextSibling)}function Ua(){ri=ti=null,cr=!1}function nh(n){Pi===null?Pi=[n]:Pi.push(n)}var wE=fe.ReactCurrentBatchConfig;function Cl(n,s,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var p=l.stateNode}if(!p)throw Error(t(147,n));var E=p,A=""+n;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===A?s.ref:(s=function(O){var Z=E.refs;O===null?delete Z[A]:Z[A]=O},s._stringRef=A,s)}if(typeof n!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,n))}return n}function zu(n,s){throw n=Object.prototype.toString.call(s),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n))}function ug(n){var s=n._init;return s(n._payload)}function cg(n){function s(ge,oe){if(n){var ve=ge.deletions;ve===null?(ge.deletions=[oe],ge.flags|=16):ve.push(oe)}}function l(ge,oe){if(!n)return null;for(;oe!==null;)s(ge,oe),oe=oe.sibling;return null}function p(ge,oe){for(ge=new Map;oe!==null;)oe.key!==null?ge.set(oe.key,oe):ge.set(oe.index,oe),oe=oe.sibling;return ge}function E(ge,oe){return ge=go(ge,oe),ge.index=0,ge.sibling=null,ge}function A(ge,oe,ve){return ge.index=ve,n?(ve=ge.alternate,ve!==null?(ve=ve.index,ve<oe?(ge.flags|=2,oe):ve):(ge.flags|=2,oe)):(ge.flags|=1048576,oe)}function O(ge){return n&&ge.alternate===null&&(ge.flags|=2),ge}function Z(ge,oe,ve,je){return oe===null||oe.tag!==6?(oe=qh(ve,ge.mode,je),oe.return=ge,oe):(oe=E(oe,ve),oe.return=ge,oe)}function ne(ge,oe,ve,je){var it=ve.type;return it===H?Oe(ge,oe,ve.props.children,je,ve.key):oe!==null&&(oe.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===At&&ug(it)===oe.type)?(je=E(oe,ve.props),je.ref=Cl(ge,oe,ve),je.return=ge,je):(je=hc(ve.type,ve.key,ve.props,null,ge.mode,je),je.ref=Cl(ge,oe,ve),je.return=ge,je)}function Te(ge,oe,ve,je){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==ve.containerInfo||oe.stateNode.implementation!==ve.implementation?(oe=Yh(ve,ge.mode,je),oe.return=ge,oe):(oe=E(oe,ve.children||[]),oe.return=ge,oe)}function Oe(ge,oe,ve,je,it){return oe===null||oe.tag!==7?(oe=ea(ve,ge.mode,je,it),oe.return=ge,oe):(oe=E(oe,ve),oe.return=ge,oe)}function Ve(ge,oe,ve){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=qh(""+oe,ge.mode,ve),oe.return=ge,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case me:return ve=hc(oe.type,oe.key,oe.props,null,ge.mode,ve),ve.ref=Cl(ge,null,oe),ve.return=ge,ve;case we:return oe=Yh(oe,ge.mode,ve),oe.return=ge,oe;case At:var je=oe._init;return Ve(ge,je(oe._payload),ve)}if(q(oe)||Ke(oe))return oe=ea(oe,ge.mode,ve,null),oe.return=ge,oe;zu(ge,oe)}return null}function Le(ge,oe,ve,je){var it=oe!==null?oe.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number")return it!==null?null:Z(ge,oe,""+ve,je);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case me:return ve.key===it?ne(ge,oe,ve,je):null;case we:return ve.key===it?Te(ge,oe,ve,je):null;case At:return it=ve._init,Le(ge,oe,it(ve._payload),je)}if(q(ve)||Ke(ve))return it!==null?null:Oe(ge,oe,ve,je,null);zu(ge,ve)}return null}function qe(ge,oe,ve,je,it){if(typeof je=="string"&&je!==""||typeof je=="number")return ge=ge.get(ve)||null,Z(oe,ge,""+je,it);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case me:return ge=ge.get(je.key===null?ve:je.key)||null,ne(oe,ge,je,it);case we:return ge=ge.get(je.key===null?ve:je.key)||null,Te(oe,ge,je,it);case At:var ct=je._init;return qe(ge,oe,ve,ct(je._payload),it)}if(q(je)||Ke(je))return ge=ge.get(ve)||null,Oe(oe,ge,je,it,null);zu(oe,je)}return null}function tt(ge,oe,ve,je){for(var it=null,ct=null,ft=oe,yt=oe=0,Zr=null;ft!==null&&yt<ve.length;yt++){ft.index>yt?(Zr=ft,ft=null):Zr=ft.sibling;var Wt=Le(ge,ft,ve[yt],je);if(Wt===null){ft===null&&(ft=Zr);break}n&&ft&&Wt.alternate===null&&s(ge,ft),oe=A(Wt,oe,yt),ct===null?it=Wt:ct.sibling=Wt,ct=Wt,ft=Zr}if(yt===ve.length)return l(ge,ft),cr&&$o(ge,yt),it;if(ft===null){for(;yt<ve.length;yt++)ft=Ve(ge,ve[yt],je),ft!==null&&(oe=A(ft,oe,yt),ct===null?it=ft:ct.sibling=ft,ct=ft);return cr&&$o(ge,yt),it}for(ft=p(ge,ft);yt<ve.length;yt++)Zr=qe(ft,ge,yt,ve[yt],je),Zr!==null&&(n&&Zr.alternate!==null&&ft.delete(Zr.key===null?yt:Zr.key),oe=A(Zr,oe,yt),ct===null?it=Zr:ct.sibling=Zr,ct=Zr);return n&&ft.forEach(function(mo){return s(ge,mo)}),cr&&$o(ge,yt),it}function nt(ge,oe,ve,je){var it=Ke(ve);if(typeof it!="function")throw Error(t(150));if(ve=it.call(ve),ve==null)throw Error(t(151));for(var ct=it=null,ft=oe,yt=oe=0,Zr=null,Wt=ve.next();ft!==null&&!Wt.done;yt++,Wt=ve.next()){ft.index>yt?(Zr=ft,ft=null):Zr=ft.sibling;var mo=Le(ge,ft,Wt.value,je);if(mo===null){ft===null&&(ft=Zr);break}n&&ft&&mo.alternate===null&&s(ge,ft),oe=A(mo,oe,yt),ct===null?it=mo:ct.sibling=mo,ct=mo,ft=Zr}if(Wt.done)return l(ge,ft),cr&&$o(ge,yt),it;if(ft===null){for(;!Wt.done;yt++,Wt=ve.next())Wt=Ve(ge,Wt.value,je),Wt!==null&&(oe=A(Wt,oe,yt),ct===null?it=Wt:ct.sibling=Wt,ct=Wt);return cr&&$o(ge,yt),it}for(ft=p(ge,ft);!Wt.done;yt++,Wt=ve.next())Wt=qe(ft,ge,yt,Wt.value,je),Wt!==null&&(n&&Wt.alternate!==null&&ft.delete(Wt.key===null?yt:Wt.key),oe=A(Wt,oe,yt),ct===null?it=Wt:ct.sibling=Wt,ct=Wt);return n&&ft.forEach(function(rT){return s(ge,rT)}),cr&&$o(ge,yt),it}function Cr(ge,oe,ve,je){if(typeof ve=="object"&&ve!==null&&ve.type===H&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case me:e:{for(var it=ve.key,ct=oe;ct!==null;){if(ct.key===it){if(it=ve.type,it===H){if(ct.tag===7){l(ge,ct.sibling),oe=E(ct,ve.props.children),oe.return=ge,ge=oe;break e}}else if(ct.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===At&&ug(it)===ct.type){l(ge,ct.sibling),oe=E(ct,ve.props),oe.ref=Cl(ge,ct,ve),oe.return=ge,ge=oe;break e}l(ge,ct);break}else s(ge,ct);ct=ct.sibling}ve.type===H?(oe=ea(ve.props.children,ge.mode,je,ve.key),oe.return=ge,ge=oe):(je=hc(ve.type,ve.key,ve.props,null,ge.mode,je),je.ref=Cl(ge,oe,ve),je.return=ge,ge=je)}return O(ge);case we:e:{for(ct=ve.key;oe!==null;){if(oe.key===ct)if(oe.tag===4&&oe.stateNode.containerInfo===ve.containerInfo&&oe.stateNode.implementation===ve.implementation){l(ge,oe.sibling),oe=E(oe,ve.children||[]),oe.return=ge,ge=oe;break e}else{l(ge,oe);break}else s(ge,oe);oe=oe.sibling}oe=Yh(ve,ge.mode,je),oe.return=ge,ge=oe}return O(ge);case At:return ct=ve._init,Cr(ge,oe,ct(ve._payload),je)}if(q(ve))return tt(ge,oe,ve,je);if(Ke(ve))return nt(ge,oe,ve,je);zu(ge,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"?(ve=""+ve,oe!==null&&oe.tag===6?(l(ge,oe.sibling),oe=E(oe,ve),oe.return=ge,ge=oe):(l(ge,oe),oe=qh(ve,ge.mode,je),oe.return=ge,ge=oe),O(ge)):l(ge,oe)}return Cr}var Va=cg(!0),fg=cg(!1),Gu=io(null),Ku=null,Ba=null,ih=null;function sh(){ih=Ba=Ku=null}function oh(n){var s=Gu.current;ar(Gu),n._currentValue=s}function ah(n,s,l){for(;n!==null;){var p=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,p!==null&&(p.childLanes|=s)):p!==null&&(p.childLanes&s)!==s&&(p.childLanes|=s),n===l)break;n=n.return}}function ja(n,s){Ku=n,ih=Ba=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&s&&(Fn=!0),n.firstContext=null)}function pi(n){var s=n._currentValue;if(ih!==n)if(n={context:n,memoizedValue:s,next:null},Ba===null){if(Ku===null)throw Error(t(308));Ba=n,Ku.dependencies={lanes:0,firstContext:n}}else Ba=Ba.next=n;return s}var Wo=null;function lh(n){Wo===null?Wo=[n]:Wo.push(n)}function hg(n,s,l,p){var E=s.interleaved;return E===null?(l.next=l,lh(s)):(l.next=E.next,E.next=l),s.interleaved=l,Cs(n,p)}function Cs(n,s){n.lanes|=s;var l=n.alternate;for(l!==null&&(l.lanes|=s),l=n,n=n.return;n!==null;)n.childLanes|=s,l=n.alternate,l!==null&&(l.childLanes|=s),l=n,n=n.return;return l.tag===3?l.stateNode:null}var ao=!1;function uh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dg(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ps(n,s){return{eventTime:n,lane:s,tag:0,payload:null,callback:null,next:null}}function lo(n,s,l){var p=n.updateQueue;if(p===null)return null;if(p=p.shared,$t&2){var E=p.pending;return E===null?s.next=s:(s.next=E.next,E.next=s),p.pending=s,Cs(n,l)}return E=p.interleaved,E===null?(s.next=s,lh(p)):(s.next=E.next,E.next=s),p.interleaved=s,Cs(n,l)}function Hu(n,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194240)!==0)){var p=s.lanes;p&=n.pendingLanes,l|=p,s.lanes=l,qi(n,l)}}function pg(n,s){var l=n.updateQueue,p=n.alternate;if(p!==null&&(p=p.updateQueue,l===p)){var E=null,A=null;if(l=l.firstBaseUpdate,l!==null){do{var O={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};A===null?E=A=O:A=A.next=O,l=l.next}while(l!==null);A===null?E=A=s:A=A.next=s}else E=A=s;l={baseState:p.baseState,firstBaseUpdate:E,lastBaseUpdate:A,shared:p.shared,effects:p.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=s:n.next=s,l.lastBaseUpdate=s}function $u(n,s,l,p){var E=n.updateQueue;ao=!1;var A=E.firstBaseUpdate,O=E.lastBaseUpdate,Z=E.shared.pending;if(Z!==null){E.shared.pending=null;var ne=Z,Te=ne.next;ne.next=null,O===null?A=Te:O.next=Te,O=ne;var Oe=n.alternate;Oe!==null&&(Oe=Oe.updateQueue,Z=Oe.lastBaseUpdate,Z!==O&&(Z===null?Oe.firstBaseUpdate=Te:Z.next=Te,Oe.lastBaseUpdate=ne))}if(A!==null){var Ve=E.baseState;O=0,Oe=Te=ne=null,Z=A;do{var Le=Z.lane,qe=Z.eventTime;if((p&Le)===Le){Oe!==null&&(Oe=Oe.next={eventTime:qe,lane:0,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null});e:{var tt=n,nt=Z;switch(Le=s,qe=l,nt.tag){case 1:if(tt=nt.payload,typeof tt=="function"){Ve=tt.call(qe,Ve,Le);break e}Ve=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=nt.payload,Le=typeof tt=="function"?tt.call(qe,Ve,Le):tt,Le==null)break e;Ve=Be({},Ve,Le);break e;case 2:ao=!0}}Z.callback!==null&&Z.lane!==0&&(n.flags|=64,Le=E.effects,Le===null?E.effects=[Z]:Le.push(Z))}else qe={eventTime:qe,lane:Le,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Oe===null?(Te=Oe=qe,ne=Ve):Oe=Oe.next=qe,O|=Le;if(Z=Z.next,Z===null){if(Z=E.shared.pending,Z===null)break;Le=Z,Z=Le.next,Le.next=null,E.lastBaseUpdate=Le,E.shared.pending=null}}while(!0);if(Oe===null&&(ne=Ve),E.baseState=ne,E.firstBaseUpdate=Te,E.lastBaseUpdate=Oe,s=E.shared.interleaved,s!==null){E=s;do O|=E.lane,E=E.next;while(E!==s)}else A===null&&(E.shared.lanes=0);Qo|=O,n.lanes=O,n.memoizedState=Ve}}function gg(n,s,l){if(n=s.effects,s.effects=null,n!==null)for(s=0;s<n.length;s++){var p=n[s],E=p.callback;if(E!==null){if(p.callback=null,p=l,typeof E!="function")throw Error(t(191,E));E.call(p)}}}var Pl={},rs=io(Pl),bl=io(Pl),kl=io(Pl);function qo(n){if(n===Pl)throw Error(t(174));return n}function ch(n,s){switch(sr(kl,s),sr(bl,n),sr(rs,Pl),n=s.nodeType,n){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:te(null,"");break;default:n=n===8?s.parentNode:s,s=n.namespaceURI||null,n=n.tagName,s=te(s,n)}ar(rs),sr(rs,s)}function za(){ar(rs),ar(bl),ar(kl)}function mg(n){qo(kl.current);var s=qo(rs.current),l=te(s,n.type);s!==l&&(sr(bl,n),sr(rs,l))}function fh(n){bl.current===n&&(ar(rs),ar(bl))}var mr=io(0);function Wu(n){for(var s=n;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var hh=[];function dh(){for(var n=0;n<hh.length;n++)hh[n]._workInProgressVersionPrimary=null;hh.length=0}var qu=fe.ReactCurrentDispatcher,ph=fe.ReactCurrentBatchConfig,Yo=0,vr=null,Kr=null,Xr=null,Yu=!1,Dl=!1,Ll=0,SE=0;function mn(){throw Error(t(321))}function gh(n,s){if(s===null)return!1;for(var l=0;l<s.length&&l<n.length;l++)if(!ei(n[l],s[l]))return!1;return!0}function mh(n,s,l,p,E,A){if(Yo=A,vr=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,qu.current=n===null||n.memoizedState===null?CE:PE,n=l(p,E),Dl){A=0;do{if(Dl=!1,Ll=0,25<=A)throw Error(t(301));A+=1,Xr=Kr=null,s.updateQueue=null,qu.current=bE,n=l(p,E)}while(Dl)}if(qu.current=Ju,s=Kr!==null&&Kr.next!==null,Yo=0,Xr=Kr=vr=null,Yu=!1,s)throw Error(t(300));return n}function vh(){var n=Ll!==0;return Ll=0,n}function ns(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xr===null?vr.memoizedState=Xr=n:Xr=Xr.next=n,Xr}function gi(){if(Kr===null){var n=vr.alternate;n=n!==null?n.memoizedState:null}else n=Kr.next;var s=Xr===null?vr.memoizedState:Xr.next;if(s!==null)Xr=s,Kr=n;else{if(n===null)throw Error(t(310));Kr=n,n={memoizedState:Kr.memoizedState,baseState:Kr.baseState,baseQueue:Kr.baseQueue,queue:Kr.queue,next:null},Xr===null?vr.memoizedState=Xr=n:Xr=Xr.next=n}return Xr}function Ol(n,s){return typeof s=="function"?s(n):s}function yh(n){var s=gi(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=n;var p=Kr,E=p.baseQueue,A=l.pending;if(A!==null){if(E!==null){var O=E.next;E.next=A.next,A.next=O}p.baseQueue=E=A,l.pending=null}if(E!==null){A=E.next,p=p.baseState;var Z=O=null,ne=null,Te=A;do{var Oe=Te.lane;if((Yo&Oe)===Oe)ne!==null&&(ne=ne.next={lane:0,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),p=Te.hasEagerState?Te.eagerState:n(p,Te.action);else{var Ve={lane:Oe,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null};ne===null?(Z=ne=Ve,O=p):ne=ne.next=Ve,vr.lanes|=Oe,Qo|=Oe}Te=Te.next}while(Te!==null&&Te!==A);ne===null?O=p:ne.next=Z,ei(p,s.memoizedState)||(Fn=!0),s.memoizedState=p,s.baseState=O,s.baseQueue=ne,l.lastRenderedState=p}if(n=l.interleaved,n!==null){E=n;do A=E.lane,vr.lanes|=A,Qo|=A,E=E.next;while(E!==n)}else E===null&&(l.lanes=0);return[s.memoizedState,l.dispatch]}function _h(n){var s=gi(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=n;var p=l.dispatch,E=l.pending,A=s.memoizedState;if(E!==null){l.pending=null;var O=E=E.next;do A=n(A,O.action),O=O.next;while(O!==E);ei(A,s.memoizedState)||(Fn=!0),s.memoizedState=A,s.baseQueue===null&&(s.baseState=A),l.lastRenderedState=A}return[A,p]}function vg(){}function yg(n,s){var l=vr,p=gi(),E=s(),A=!ei(p.memoizedState,E);if(A&&(p.memoizedState=E,Fn=!0),p=p.queue,Eh(Tg.bind(null,l,p,n),[n]),p.getSnapshot!==s||A||Xr!==null&&Xr.memoizedState.tag&1){if(l.flags|=2048,Nl(9,Eg.bind(null,l,p,E,s),void 0,null),Jr===null)throw Error(t(349));Yo&30||_g(l,s,E)}return E}function _g(n,s,l){n.flags|=16384,n={getSnapshot:s,value:l},s=vr.updateQueue,s===null?(s={lastEffect:null,stores:null},vr.updateQueue=s,s.stores=[n]):(l=s.stores,l===null?s.stores=[n]:l.push(n))}function Eg(n,s,l,p){s.value=l,s.getSnapshot=p,xg(s)&&wg(n)}function Tg(n,s,l){return l(function(){xg(s)&&wg(n)})}function xg(n){var s=n.getSnapshot;n=n.value;try{var l=s();return!ei(n,l)}catch{return!0}}function wg(n){var s=Cs(n,1);s!==null&&Li(s,n,1,-1)}function Sg(n){var s=ns();return typeof n=="function"&&(n=n()),s.memoizedState=s.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ol,lastRenderedState:n},s.queue=n,n=n.dispatch=IE.bind(null,vr,n),[s.memoizedState,n]}function Nl(n,s,l,p){return n={tag:n,create:s,destroy:l,deps:p,next:null},s=vr.updateQueue,s===null?(s={lastEffect:null,stores:null},vr.updateQueue=s,s.lastEffect=n.next=n):(l=s.lastEffect,l===null?s.lastEffect=n.next=n:(p=l.next,l.next=n,n.next=p,s.lastEffect=n)),n}function Ag(){return gi().memoizedState}function Qu(n,s,l,p){var E=ns();vr.flags|=n,E.memoizedState=Nl(1|s,l,void 0,p===void 0?null:p)}function Xu(n,s,l,p){var E=gi();p=p===void 0?null:p;var A=void 0;if(Kr!==null){var O=Kr.memoizedState;if(A=O.destroy,p!==null&&gh(p,O.deps)){E.memoizedState=Nl(s,l,A,p);return}}vr.flags|=n,E.memoizedState=Nl(1|s,l,A,p)}function Rg(n,s){return Qu(8390656,8,n,s)}function Eh(n,s){return Xu(2048,8,n,s)}function Ig(n,s){return Xu(4,2,n,s)}function Cg(n,s){return Xu(4,4,n,s)}function Pg(n,s){if(typeof s=="function")return n=n(),s(n),function(){s(null)};if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function bg(n,s,l){return l=l!=null?l.concat([n]):null,Xu(4,4,Pg.bind(null,s,n),l)}function Th(){}function kg(n,s){var l=gi();s=s===void 0?null:s;var p=l.memoizedState;return p!==null&&s!==null&&gh(s,p[1])?p[0]:(l.memoizedState=[n,s],n)}function Dg(n,s){var l=gi();s=s===void 0?null:s;var p=l.memoizedState;return p!==null&&s!==null&&gh(s,p[1])?p[0]:(n=n(),l.memoizedState=[n,s],n)}function Lg(n,s,l){return Yo&21?(ei(l,s)||(l=ps(),vr.lanes|=l,Qo|=l,n.baseState=!0),s):(n.baseState&&(n.baseState=!1,Fn=!0),n.memoizedState=l)}function AE(n,s){var l=Ot;Ot=l!==0&&4>l?l:4,n(!0);var p=ph.transition;ph.transition={};try{n(!1),s()}finally{Ot=l,ph.transition=p}}function Og(){return gi().memoizedState}function RE(n,s,l){var p=ho(n);if(l={lane:p,action:l,hasEagerState:!1,eagerState:null,next:null},Ng(n))Fg(s,l);else if(l=hg(n,s,l,p),l!==null){var E=Pn();Li(l,n,p,E),Mg(l,s,p)}}function IE(n,s,l){var p=ho(n),E={lane:p,action:l,hasEagerState:!1,eagerState:null,next:null};if(Ng(n))Fg(s,E);else{var A=n.alternate;if(n.lanes===0&&(A===null||A.lanes===0)&&(A=s.lastRenderedReducer,A!==null))try{var O=s.lastRenderedState,Z=A(O,l);if(E.hasEagerState=!0,E.eagerState=Z,ei(Z,O)){var ne=s.interleaved;ne===null?(E.next=E,lh(s)):(E.next=ne.next,ne.next=E),s.interleaved=E;return}}catch{}finally{}l=hg(n,s,E,p),l!==null&&(E=Pn(),Li(l,n,p,E),Mg(l,s,p))}}function Ng(n){var s=n.alternate;return n===vr||s!==null&&s===vr}function Fg(n,s){Dl=Yu=!0;var l=n.pending;l===null?s.next=s:(s.next=l.next,l.next=s),n.pending=s}function Mg(n,s,l){if(l&4194240){var p=s.lanes;p&=n.pendingLanes,l|=p,s.lanes=l,qi(n,l)}}var Ju={readContext:pi,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useInsertionEffect:mn,useLayoutEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useMutableSource:mn,useSyncExternalStore:mn,useId:mn,unstable_isNewReconciler:!1},CE={readContext:pi,useCallback:function(n,s){return ns().memoizedState=[n,s===void 0?null:s],n},useContext:pi,useEffect:Rg,useImperativeHandle:function(n,s,l){return l=l!=null?l.concat([n]):null,Qu(4194308,4,Pg.bind(null,s,n),l)},useLayoutEffect:function(n,s){return Qu(4194308,4,n,s)},useInsertionEffect:function(n,s){return Qu(4,2,n,s)},useMemo:function(n,s){var l=ns();return s=s===void 0?null:s,n=n(),l.memoizedState=[n,s],n},useReducer:function(n,s,l){var p=ns();return s=l!==void 0?l(s):s,p.memoizedState=p.baseState=s,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:s},p.queue=n,n=n.dispatch=RE.bind(null,vr,n),[p.memoizedState,n]},useRef:function(n){var s=ns();return n={current:n},s.memoizedState=n},useState:Sg,useDebugValue:Th,useDeferredValue:function(n){return ns().memoizedState=n},useTransition:function(){var n=Sg(!1),s=n[0];return n=AE.bind(null,n[1]),ns().memoizedState=n,[s,n]},useMutableSource:function(){},useSyncExternalStore:function(n,s,l){var p=vr,E=ns();if(cr){if(l===void 0)throw Error(t(407));l=l()}else{if(l=s(),Jr===null)throw Error(t(349));Yo&30||_g(p,s,l)}E.memoizedState=l;var A={value:l,getSnapshot:s};return E.queue=A,Rg(Tg.bind(null,p,A,n),[n]),p.flags|=2048,Nl(9,Eg.bind(null,p,A,l,s),void 0,null),l},useId:function(){var n=ns(),s=Jr.identifierPrefix;if(cr){var l=Is,p=Rs;l=(p&~(1<<32-Or(p)-1)).toString(32)+l,s=":"+s+"R"+l,l=Ll++,0<l&&(s+="H"+l.toString(32)),s+=":"}else l=SE++,s=":"+s+"r"+l.toString(32)+":";return n.memoizedState=s},unstable_isNewReconciler:!1},PE={readContext:pi,useCallback:kg,useContext:pi,useEffect:Eh,useImperativeHandle:bg,useInsertionEffect:Ig,useLayoutEffect:Cg,useMemo:Dg,useReducer:yh,useRef:Ag,useState:function(){return yh(Ol)},useDebugValue:Th,useDeferredValue:function(n){var s=gi();return Lg(s,Kr.memoizedState,n)},useTransition:function(){var n=yh(Ol)[0],s=gi().memoizedState;return[n,s]},useMutableSource:vg,useSyncExternalStore:yg,useId:Og,unstable_isNewReconciler:!1},bE={readContext:pi,useCallback:kg,useContext:pi,useEffect:Eh,useImperativeHandle:bg,useInsertionEffect:Ig,useLayoutEffect:Cg,useMemo:Dg,useReducer:_h,useRef:Ag,useState:function(){return _h(Ol)},useDebugValue:Th,useDeferredValue:function(n){var s=gi();return Kr===null?s.memoizedState=n:Lg(s,Kr.memoizedState,n)},useTransition:function(){var n=_h(Ol)[0],s=gi().memoizedState;return[n,s]},useMutableSource:vg,useSyncExternalStore:yg,useId:Og,unstable_isNewReconciler:!1};function bi(n,s){if(n&&n.defaultProps){s=Be({},s),n=n.defaultProps;for(var l in n)s[l]===void 0&&(s[l]=n[l]);return s}return s}function xh(n,s,l,p){s=n.memoizedState,l=l(p,s),l=l==null?s:Be({},s,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Zu={isMounted:function(n){return(n=n._reactInternals)?_r(n)===n:!1},enqueueSetState:function(n,s,l){n=n._reactInternals;var p=Pn(),E=ho(n),A=Ps(p,E);A.payload=s,l!=null&&(A.callback=l),s=lo(n,A,E),s!==null&&(Li(s,n,E,p),Hu(s,n,E))},enqueueReplaceState:function(n,s,l){n=n._reactInternals;var p=Pn(),E=ho(n),A=Ps(p,E);A.tag=1,A.payload=s,l!=null&&(A.callback=l),s=lo(n,A,E),s!==null&&(Li(s,n,E,p),Hu(s,n,E))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var l=Pn(),p=ho(n),E=Ps(l,p);E.tag=2,s!=null&&(E.callback=s),s=lo(n,E,p),s!==null&&(Li(s,n,p,l),Hu(s,n,p))}};function Ug(n,s,l,p,E,A,O){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(p,A,O):s.prototype&&s.prototype.isPureReactComponent?!eo(l,p)||!eo(E,A):!0}function Vg(n,s,l){var p=!1,E=so,A=s.contextType;return typeof A=="object"&&A!==null?A=pi(A):(E=Nn(s)?Ko:gn.current,p=s.contextTypes,A=(p=p!=null)?Na(n,E):so),s=new s(l,A),n.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Zu,n.stateNode=s,s._reactInternals=n,p&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=E,n.__reactInternalMemoizedMaskedChildContext=A),s}function Bg(n,s,l,p){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,p),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,p),s.state!==n&&Zu.enqueueReplaceState(s,s.state,null)}function wh(n,s,l,p){var E=n.stateNode;E.props=l,E.state=n.memoizedState,E.refs={},uh(n);var A=s.contextType;typeof A=="object"&&A!==null?E.context=pi(A):(A=Nn(s)?Ko:gn.current,E.context=Na(n,A)),E.state=n.memoizedState,A=s.getDerivedStateFromProps,typeof A=="function"&&(xh(n,s,A,l),E.state=n.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(s=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),s!==E.state&&Zu.enqueueReplaceState(E,E.state,null),$u(n,l,E,p),E.state=n.memoizedState),typeof E.componentDidMount=="function"&&(n.flags|=4194308)}function Ga(n,s){try{var l="",p=s;do l+=mt(p),p=p.return;while(p);var E=l}catch(A){E=`
Error generating stack: `+A.message+`
`+A.stack}return{value:n,source:s,stack:E,digest:null}}function Sh(n,s,l){return{value:n,source:null,stack:l??null,digest:s??null}}function Ah(n,s){try{console.error(s.value)}catch(l){setTimeout(function(){throw l})}}var kE=typeof WeakMap=="function"?WeakMap:Map;function jg(n,s,l){l=Ps(-1,l),l.tag=3,l.payload={element:null};var p=s.value;return l.callback=function(){oc||(oc=!0,Bh=p),Ah(n,s)},l}function zg(n,s,l){l=Ps(-1,l),l.tag=3;var p=n.type.getDerivedStateFromError;if(typeof p=="function"){var E=s.value;l.payload=function(){return p(E)},l.callback=function(){Ah(n,s)}}var A=n.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(l.callback=function(){Ah(n,s),typeof p!="function"&&(co===null?co=new Set([this]):co.add(this));var O=s.stack;this.componentDidCatch(s.value,{componentStack:O!==null?O:""})}),l}function Gg(n,s,l){var p=n.pingCache;if(p===null){p=n.pingCache=new kE;var E=new Set;p.set(s,E)}else E=p.get(s),E===void 0&&(E=new Set,p.set(s,E));E.has(l)||(E.add(l),n=HE.bind(null,n,s,l),s.then(n,n))}function Kg(n){do{var s;if((s=n.tag===13)&&(s=n.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return n;n=n.return}while(n!==null);return null}function Hg(n,s,l,p,E){return n.mode&1?(n.flags|=65536,n.lanes=E,n):(n===s?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(s=Ps(-1,1),s.tag=2,lo(l,s,1))),l.lanes|=1),n)}var DE=fe.ReactCurrentOwner,Fn=!1;function Cn(n,s,l,p){s.child=n===null?fg(s,null,l,p):Va(s,n.child,l,p)}function $g(n,s,l,p,E){l=l.render;var A=s.ref;return ja(s,E),p=mh(n,s,l,p,A,E),l=vh(),n!==null&&!Fn?(s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~E,bs(n,s,E)):(cr&&l&&Zf(s),s.flags|=1,Cn(n,s,p,E),s.child)}function Wg(n,s,l,p,E){if(n===null){var A=l.type;return typeof A=="function"&&!Wh(A)&&A.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(s.tag=15,s.type=A,qg(n,s,A,p,E)):(n=hc(l.type,null,p,s,s.mode,E),n.ref=s.ref,n.return=s,s.child=n)}if(A=n.child,!(n.lanes&E)){var O=A.memoizedProps;if(l=l.compare,l=l!==null?l:eo,l(O,p)&&n.ref===s.ref)return bs(n,s,E)}return s.flags|=1,n=go(A,p),n.ref=s.ref,n.return=s,s.child=n}function qg(n,s,l,p,E){if(n!==null){var A=n.memoizedProps;if(eo(A,p)&&n.ref===s.ref)if(Fn=!1,s.pendingProps=p=A,(n.lanes&E)!==0)n.flags&131072&&(Fn=!0);else return s.lanes=n.lanes,bs(n,s,E)}return Rh(n,s,l,p,E)}function Yg(n,s,l){var p=s.pendingProps,E=p.children,A=n!==null?n.memoizedState:null;if(p.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},sr(Ha,ni),ni|=l;else{if(!(l&1073741824))return n=A!==null?A.baseLanes|l:l,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:n,cachePool:null,transitions:null},s.updateQueue=null,sr(Ha,ni),ni|=n,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=A!==null?A.baseLanes:l,sr(Ha,ni),ni|=p}else A!==null?(p=A.baseLanes|l,s.memoizedState=null):p=l,sr(Ha,ni),ni|=p;return Cn(n,s,E,l),s.child}function Qg(n,s){var l=s.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(s.flags|=512,s.flags|=2097152)}function Rh(n,s,l,p,E){var A=Nn(l)?Ko:gn.current;return A=Na(s,A),ja(s,E),l=mh(n,s,l,p,A,E),p=vh(),n!==null&&!Fn?(s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~E,bs(n,s,E)):(cr&&p&&Zf(s),s.flags|=1,Cn(n,s,l,E),s.child)}function Xg(n,s,l,p,E){if(Nn(l)){var A=!0;Mu(s)}else A=!1;if(ja(s,E),s.stateNode===null)tc(n,s),Vg(s,l,p),wh(s,l,p,E),p=!0;else if(n===null){var O=s.stateNode,Z=s.memoizedProps;O.props=Z;var ne=O.context,Te=l.contextType;typeof Te=="object"&&Te!==null?Te=pi(Te):(Te=Nn(l)?Ko:gn.current,Te=Na(s,Te));var Oe=l.getDerivedStateFromProps,Ve=typeof Oe=="function"||typeof O.getSnapshotBeforeUpdate=="function";Ve||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(Z!==p||ne!==Te)&&Bg(s,O,p,Te),ao=!1;var Le=s.memoizedState;O.state=Le,$u(s,p,O,E),ne=s.memoizedState,Z!==p||Le!==ne||On.current||ao?(typeof Oe=="function"&&(xh(s,l,Oe,p),ne=s.memoizedState),(Z=ao||Ug(s,l,Z,p,Le,ne,Te))?(Ve||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(s.flags|=4194308)):(typeof O.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=p,s.memoizedState=ne),O.props=p,O.state=ne,O.context=Te,p=Z):(typeof O.componentDidMount=="function"&&(s.flags|=4194308),p=!1)}else{O=s.stateNode,dg(n,s),Z=s.memoizedProps,Te=s.type===s.elementType?Z:bi(s.type,Z),O.props=Te,Ve=s.pendingProps,Le=O.context,ne=l.contextType,typeof ne=="object"&&ne!==null?ne=pi(ne):(ne=Nn(l)?Ko:gn.current,ne=Na(s,ne));var qe=l.getDerivedStateFromProps;(Oe=typeof qe=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(Z!==Ve||Le!==ne)&&Bg(s,O,p,ne),ao=!1,Le=s.memoizedState,O.state=Le,$u(s,p,O,E);var tt=s.memoizedState;Z!==Ve||Le!==tt||On.current||ao?(typeof qe=="function"&&(xh(s,l,qe,p),tt=s.memoizedState),(Te=ao||Ug(s,l,Te,p,Le,tt,ne)||!1)?(Oe||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(p,tt,ne),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(p,tt,ne)),typeof O.componentDidUpdate=="function"&&(s.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof O.componentDidUpdate!="function"||Z===n.memoizedProps&&Le===n.memoizedState||(s.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||Z===n.memoizedProps&&Le===n.memoizedState||(s.flags|=1024),s.memoizedProps=p,s.memoizedState=tt),O.props=p,O.state=tt,O.context=ne,p=Te):(typeof O.componentDidUpdate!="function"||Z===n.memoizedProps&&Le===n.memoizedState||(s.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||Z===n.memoizedProps&&Le===n.memoizedState||(s.flags|=1024),p=!1)}return Ih(n,s,l,p,A,E)}function Ih(n,s,l,p,E,A){Qg(n,s);var O=(s.flags&128)!==0;if(!p&&!O)return E&&rg(s,l,!1),bs(n,s,A);p=s.stateNode,DE.current=s;var Z=O&&typeof l.getDerivedStateFromError!="function"?null:p.render();return s.flags|=1,n!==null&&O?(s.child=Va(s,n.child,null,A),s.child=Va(s,null,Z,A)):Cn(n,s,Z,A),s.memoizedState=p.state,E&&rg(s,l,!0),s.child}function Jg(n){var s=n.stateNode;s.pendingContext?eg(n,s.pendingContext,s.pendingContext!==s.context):s.context&&eg(n,s.context,!1),ch(n,s.containerInfo)}function Zg(n,s,l,p,E){return Ua(),nh(E),s.flags|=256,Cn(n,s,l,p),s.child}var Ch={dehydrated:null,treeContext:null,retryLane:0};function Ph(n){return{baseLanes:n,cachePool:null,transitions:null}}function em(n,s,l){var p=s.pendingProps,E=mr.current,A=!1,O=(s.flags&128)!==0,Z;if((Z=O)||(Z=n!==null&&n.memoizedState===null?!1:(E&2)!==0),Z?(A=!0,s.flags&=-129):(n===null||n.memoizedState!==null)&&(E|=1),sr(mr,E&1),n===null)return rh(s),n=s.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(s.mode&1?n.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(O=p.children,n=p.fallback,A?(p=s.mode,A=s.child,O={mode:"hidden",children:O},!(p&1)&&A!==null?(A.childLanes=0,A.pendingProps=O):A=dc(O,p,0,null),n=ea(n,p,l,null),A.return=s,n.return=s,A.sibling=n,s.child=A,s.child.memoizedState=Ph(l),s.memoizedState=Ch,n):bh(s,O));if(E=n.memoizedState,E!==null&&(Z=E.dehydrated,Z!==null))return LE(n,s,O,p,Z,E,l);if(A){A=p.fallback,O=s.mode,E=n.child,Z=E.sibling;var ne={mode:"hidden",children:p.children};return!(O&1)&&s.child!==E?(p=s.child,p.childLanes=0,p.pendingProps=ne,s.deletions=null):(p=go(E,ne),p.subtreeFlags=E.subtreeFlags&14680064),Z!==null?A=go(Z,A):(A=ea(A,O,l,null),A.flags|=2),A.return=s,p.return=s,p.sibling=A,s.child=p,p=A,A=s.child,O=n.child.memoizedState,O=O===null?Ph(l):{baseLanes:O.baseLanes|l,cachePool:null,transitions:O.transitions},A.memoizedState=O,A.childLanes=n.childLanes&~l,s.memoizedState=Ch,p}return A=n.child,n=A.sibling,p=go(A,{mode:"visible",children:p.children}),!(s.mode&1)&&(p.lanes=l),p.return=s,p.sibling=null,n!==null&&(l=s.deletions,l===null?(s.deletions=[n],s.flags|=16):l.push(n)),s.child=p,s.memoizedState=null,p}function bh(n,s){return s=dc({mode:"visible",children:s},n.mode,0,null),s.return=n,n.child=s}function ec(n,s,l,p){return p!==null&&nh(p),Va(s,n.child,null,l),n=bh(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function LE(n,s,l,p,E,A,O){if(l)return s.flags&256?(s.flags&=-257,p=Sh(Error(t(422))),ec(n,s,O,p)):s.memoizedState!==null?(s.child=n.child,s.flags|=128,null):(A=p.fallback,E=s.mode,p=dc({mode:"visible",children:p.children},E,0,null),A=ea(A,E,O,null),A.flags|=2,p.return=s,A.return=s,p.sibling=A,s.child=p,s.mode&1&&Va(s,n.child,null,O),s.child.memoizedState=Ph(O),s.memoizedState=Ch,A);if(!(s.mode&1))return ec(n,s,O,null);if(E.data==="$!"){if(p=E.nextSibling&&E.nextSibling.dataset,p)var Z=p.dgst;return p=Z,A=Error(t(419)),p=Sh(A,p,void 0),ec(n,s,O,p)}if(Z=(O&n.childLanes)!==0,Fn||Z){if(p=Jr,p!==null){switch(O&-O){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=E&(p.suspendedLanes|O)?0:E,E!==0&&E!==A.retryLane&&(A.retryLane=E,Cs(n,E),Li(p,n,E,-1))}return $h(),p=Sh(Error(t(421))),ec(n,s,O,p)}return E.data==="$?"?(s.flags|=128,s.child=n.child,s=$E.bind(null,n),E._reactRetry=s,null):(n=A.treeContext,ri=no(E.nextSibling),ti=s,cr=!0,Pi=null,n!==null&&(hi[di++]=Rs,hi[di++]=Is,hi[di++]=Ho,Rs=n.id,Is=n.overflow,Ho=s),s=bh(s,p.children),s.flags|=4096,s)}function tm(n,s,l){n.lanes|=s;var p=n.alternate;p!==null&&(p.lanes|=s),ah(n.return,s,l)}function kh(n,s,l,p,E){var A=n.memoizedState;A===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:p,tail:l,tailMode:E}:(A.isBackwards=s,A.rendering=null,A.renderingStartTime=0,A.last=p,A.tail=l,A.tailMode=E)}function rm(n,s,l){var p=s.pendingProps,E=p.revealOrder,A=p.tail;if(Cn(n,s,p.children,l),p=mr.current,p&2)p=p&1|2,s.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&tm(n,l,s);else if(n.tag===19)tm(n,l,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}p&=1}if(sr(mr,p),!(s.mode&1))s.memoizedState=null;else switch(E){case"forwards":for(l=s.child,E=null;l!==null;)n=l.alternate,n!==null&&Wu(n)===null&&(E=l),l=l.sibling;l=E,l===null?(E=s.child,s.child=null):(E=l.sibling,l.sibling=null),kh(s,!1,E,l,A);break;case"backwards":for(l=null,E=s.child,s.child=null;E!==null;){if(n=E.alternate,n!==null&&Wu(n)===null){s.child=E;break}n=E.sibling,E.sibling=l,l=E,E=n}kh(s,!0,l,null,A);break;case"together":kh(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function tc(n,s){!(s.mode&1)&&n!==null&&(n.alternate=null,s.alternate=null,s.flags|=2)}function bs(n,s,l){if(n!==null&&(s.dependencies=n.dependencies),Qo|=s.lanes,!(l&s.childLanes))return null;if(n!==null&&s.child!==n.child)throw Error(t(153));if(s.child!==null){for(n=s.child,l=go(n,n.pendingProps),s.child=l,l.return=s;n.sibling!==null;)n=n.sibling,l=l.sibling=go(n,n.pendingProps),l.return=s;l.sibling=null}return s.child}function OE(n,s,l){switch(s.tag){case 3:Jg(s),Ua();break;case 5:mg(s);break;case 1:Nn(s.type)&&Mu(s);break;case 4:ch(s,s.stateNode.containerInfo);break;case 10:var p=s.type._context,E=s.memoizedProps.value;sr(Gu,p._currentValue),p._currentValue=E;break;case 13:if(p=s.memoizedState,p!==null)return p.dehydrated!==null?(sr(mr,mr.current&1),s.flags|=128,null):l&s.child.childLanes?em(n,s,l):(sr(mr,mr.current&1),n=bs(n,s,l),n!==null?n.sibling:null);sr(mr,mr.current&1);break;case 19:if(p=(l&s.childLanes)!==0,n.flags&128){if(p)return rm(n,s,l);s.flags|=128}if(E=s.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),sr(mr,mr.current),p)break;return null;case 22:case 23:return s.lanes=0,Yg(n,s,l)}return bs(n,s,l)}var nm,Dh,im,sm;nm=function(n,s){for(var l=s.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},Dh=function(){},im=function(n,s,l,p){var E=n.memoizedProps;if(E!==p){n=s.stateNode,qo(rs.current);var A=null;switch(l){case"input":E=tn(n,E),p=tn(n,p),A=[];break;case"select":E=Be({},E,{value:void 0}),p=Be({},p,{value:void 0}),A=[];break;case"textarea":E=W(n,E),p=W(n,p),A=[];break;default:typeof E.onClick!="function"&&typeof p.onClick=="function"&&(n.onclick=Ou)}De(l,p);var O;l=null;for(Te in E)if(!p.hasOwnProperty(Te)&&E.hasOwnProperty(Te)&&E[Te]!=null)if(Te==="style"){var Z=E[Te];for(O in Z)Z.hasOwnProperty(O)&&(l||(l={}),l[O]="")}else Te!=="dangerouslySetInnerHTML"&&Te!=="children"&&Te!=="suppressContentEditableWarning"&&Te!=="suppressHydrationWarning"&&Te!=="autoFocus"&&(o.hasOwnProperty(Te)?A||(A=[]):(A=A||[]).push(Te,null));for(Te in p){var ne=p[Te];if(Z=E!=null?E[Te]:void 0,p.hasOwnProperty(Te)&&ne!==Z&&(ne!=null||Z!=null))if(Te==="style")if(Z){for(O in Z)!Z.hasOwnProperty(O)||ne&&ne.hasOwnProperty(O)||(l||(l={}),l[O]="");for(O in ne)ne.hasOwnProperty(O)&&Z[O]!==ne[O]&&(l||(l={}),l[O]=ne[O])}else l||(A||(A=[]),A.push(Te,l)),l=ne;else Te==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,Z=Z?Z.__html:void 0,ne!=null&&Z!==ne&&(A=A||[]).push(Te,ne)):Te==="children"?typeof ne!="string"&&typeof ne!="number"||(A=A||[]).push(Te,""+ne):Te!=="suppressContentEditableWarning"&&Te!=="suppressHydrationWarning"&&(o.hasOwnProperty(Te)?(ne!=null&&Te==="onScroll"&&Vt("scroll",n),A||Z===ne||(A=[])):(A=A||[]).push(Te,ne))}l&&(A=A||[]).push("style",l);var Te=A;(s.updateQueue=Te)&&(s.flags|=4)}},sm=function(n,s,l,p){l!==p&&(s.flags|=4)};function Fl(n,s){if(!cr)switch(n.tailMode){case"hidden":s=n.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:p.sibling=null}}function vn(n){var s=n.alternate!==null&&n.alternate.child===n.child,l=0,p=0;if(s)for(var E=n.child;E!==null;)l|=E.lanes|E.childLanes,p|=E.subtreeFlags&14680064,p|=E.flags&14680064,E.return=n,E=E.sibling;else for(E=n.child;E!==null;)l|=E.lanes|E.childLanes,p|=E.subtreeFlags,p|=E.flags,E.return=n,E=E.sibling;return n.subtreeFlags|=p,n.childLanes=l,s}function NE(n,s,l){var p=s.pendingProps;switch(eh(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vn(s),null;case 1:return Nn(s.type)&&Fu(),vn(s),null;case 3:return p=s.stateNode,za(),ar(On),ar(gn),dh(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(n===null||n.child===null)&&(ju(s)?s.flags|=4:n===null||n.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Pi!==null&&(Gh(Pi),Pi=null))),Dh(n,s),vn(s),null;case 5:fh(s);var E=qo(kl.current);if(l=s.type,n!==null&&s.stateNode!=null)im(n,s,l,p,E),n.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!p){if(s.stateNode===null)throw Error(t(166));return vn(s),null}if(n=qo(rs.current),ju(s)){p=s.stateNode,l=s.type;var A=s.memoizedProps;switch(p[ts]=s,p[Rl]=A,n=(s.mode&1)!==0,l){case"dialog":Vt("cancel",p),Vt("close",p);break;case"iframe":case"object":case"embed":Vt("load",p);break;case"video":case"audio":for(E=0;E<It.length;E++)Vt(It[E],p);break;case"source":Vt("error",p);break;case"img":case"image":case"link":Vt("error",p),Vt("load",p);break;case"details":Vt("toggle",p);break;case"input":lr(p,A),Vt("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!A.multiple},Vt("invalid",p);break;case"textarea":k(p,A),Vt("invalid",p)}De(l,A),E=null;for(var O in A)if(A.hasOwnProperty(O)){var Z=A[O];O==="children"?typeof Z=="string"?p.textContent!==Z&&(A.suppressHydrationWarning!==!0&&ka(p.textContent,Z,n),E=["children",Z]):typeof Z=="number"&&p.textContent!==""+Z&&(A.suppressHydrationWarning!==!0&&ka(p.textContent,Z,n),E=["children",""+Z]):o.hasOwnProperty(O)&&Z!=null&&O==="onScroll"&&Vt("scroll",p)}switch(l){case"input":br(p),dr(p,A,!0);break;case"textarea":br(p),$(p);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(p.onclick=Ou)}p=E,s.updateQueue=p,p!==null&&(s.flags|=4)}else{O=E.nodeType===9?E:E.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=ee(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=O.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof p.is=="string"?n=O.createElement(l,{is:p.is}):(n=O.createElement(l),l==="select"&&(O=n,p.multiple?O.multiple=!0:p.size&&(O.size=p.size))):n=O.createElementNS(n,l),n[ts]=s,n[Rl]=p,nm(n,s,!1,!1),s.stateNode=n;e:{switch(O=Qe(l,p),l){case"dialog":Vt("cancel",n),Vt("close",n),E=p;break;case"iframe":case"object":case"embed":Vt("load",n),E=p;break;case"video":case"audio":for(E=0;E<It.length;E++)Vt(It[E],n);E=p;break;case"source":Vt("error",n),E=p;break;case"img":case"image":case"link":Vt("error",n),Vt("load",n),E=p;break;case"details":Vt("toggle",n),E=p;break;case"input":lr(n,p),E=tn(n,p),Vt("invalid",n);break;case"option":E=p;break;case"select":n._wrapperState={wasMultiple:!!p.multiple},E=Be({},p,{value:void 0}),Vt("invalid",n);break;case"textarea":k(n,p),E=W(n,p),Vt("invalid",n);break;default:E=p}De(l,E),Z=E;for(A in Z)if(Z.hasOwnProperty(A)){var ne=Z[A];A==="style"?ke(n,ne):A==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,ne!=null&&_e(n,ne)):A==="children"?typeof ne=="string"?(l!=="textarea"||ne!=="")&&Ie(n,ne):typeof ne=="number"&&Ie(n,""+ne):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(o.hasOwnProperty(A)?ne!=null&&A==="onScroll"&&Vt("scroll",n):ne!=null&&ce(n,A,ne,O))}switch(l){case"input":br(n),dr(n,p,!1);break;case"textarea":br(n),$(n);break;case"option":p.value!=null&&n.setAttribute("value",""+vt(p.value));break;case"select":n.multiple=!!p.multiple,A=p.value,A!=null?ue(n,!!p.multiple,A,!1):p.defaultValue!=null&&ue(n,!!p.multiple,p.defaultValue,!0);break;default:typeof E.onClick=="function"&&(n.onclick=Ou)}switch(l){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return vn(s),null;case 6:if(n&&s.stateNode!=null)sm(n,s,n.memoizedProps,p);else{if(typeof p!="string"&&s.stateNode===null)throw Error(t(166));if(l=qo(kl.current),qo(rs.current),ju(s)){if(p=s.stateNode,l=s.memoizedProps,p[ts]=s,(A=p.nodeValue!==l)&&(n=ti,n!==null))switch(n.tag){case 3:ka(p.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&ka(p.nodeValue,l,(n.mode&1)!==0)}A&&(s.flags|=4)}else p=(l.nodeType===9?l:l.ownerDocument).createTextNode(p),p[ts]=s,s.stateNode=p}return vn(s),null;case 13:if(ar(mr),p=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(cr&&ri!==null&&s.mode&1&&!(s.flags&128))lg(),Ua(),s.flags|=98560,A=!1;else if(A=ju(s),p!==null&&p.dehydrated!==null){if(n===null){if(!A)throw Error(t(318));if(A=s.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(t(317));A[ts]=s}else Ua(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;vn(s),A=!1}else Pi!==null&&(Gh(Pi),Pi=null),A=!0;if(!A)return s.flags&65536?s:null}return s.flags&128?(s.lanes=l,s):(p=p!==null,p!==(n!==null&&n.memoizedState!==null)&&p&&(s.child.flags|=8192,s.mode&1&&(n===null||mr.current&1?Hr===0&&(Hr=3):$h())),s.updateQueue!==null&&(s.flags|=4),vn(s),null);case 4:return za(),Dh(n,s),n===null&&ir(s.stateNode.containerInfo),vn(s),null;case 10:return oh(s.type._context),vn(s),null;case 17:return Nn(s.type)&&Fu(),vn(s),null;case 19:if(ar(mr),A=s.memoizedState,A===null)return vn(s),null;if(p=(s.flags&128)!==0,O=A.rendering,O===null)if(p)Fl(A,!1);else{if(Hr!==0||n!==null&&n.flags&128)for(n=s.child;n!==null;){if(O=Wu(n),O!==null){for(s.flags|=128,Fl(A,!1),p=O.updateQueue,p!==null&&(s.updateQueue=p,s.flags|=4),s.subtreeFlags=0,p=l,l=s.child;l!==null;)A=l,n=p,A.flags&=14680066,O=A.alternate,O===null?(A.childLanes=0,A.lanes=n,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=O.childLanes,A.lanes=O.lanes,A.child=O.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=O.memoizedProps,A.memoizedState=O.memoizedState,A.updateQueue=O.updateQueue,A.type=O.type,n=O.dependencies,A.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return sr(mr,mr.current&1|2),s.child}n=n.sibling}A.tail!==null&&Yt()>$a&&(s.flags|=128,p=!0,Fl(A,!1),s.lanes=4194304)}else{if(!p)if(n=Wu(O),n!==null){if(s.flags|=128,p=!0,l=n.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),Fl(A,!0),A.tail===null&&A.tailMode==="hidden"&&!O.alternate&&!cr)return vn(s),null}else 2*Yt()-A.renderingStartTime>$a&&l!==1073741824&&(s.flags|=128,p=!0,Fl(A,!1),s.lanes=4194304);A.isBackwards?(O.sibling=s.child,s.child=O):(l=A.last,l!==null?l.sibling=O:s.child=O,A.last=O)}return A.tail!==null?(s=A.tail,A.rendering=s,A.tail=s.sibling,A.renderingStartTime=Yt(),s.sibling=null,l=mr.current,sr(mr,p?l&1|2:l&1),s):(vn(s),null);case 22:case 23:return Hh(),p=s.memoizedState!==null,n!==null&&n.memoizedState!==null!==p&&(s.flags|=8192),p&&s.mode&1?ni&1073741824&&(vn(s),s.subtreeFlags&6&&(s.flags|=8192)):vn(s),null;case 24:return null;case 25:return null}throw Error(t(156,s.tag))}function FE(n,s){switch(eh(s),s.tag){case 1:return Nn(s.type)&&Fu(),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return za(),ar(On),ar(gn),dh(),n=s.flags,n&65536&&!(n&128)?(s.flags=n&-65537|128,s):null;case 5:return fh(s),null;case 13:if(ar(mr),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(t(340));Ua()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return ar(mr),null;case 4:return za(),null;case 10:return oh(s.type._context),null;case 22:case 23:return Hh(),null;case 24:return null;default:return null}}var rc=!1,yn=!1,ME=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function Ka(n,s){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(p){Sr(n,s,p)}else l.current=null}function Lh(n,s,l){try{l()}catch(p){Sr(n,s,p)}}var om=!1;function UE(n,s){if(Hf=Xi,n=Sl(),ba(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var p=l.getSelection&&l.getSelection();if(p&&p.rangeCount!==0){l=p.anchorNode;var E=p.anchorOffset,A=p.focusNode;p=p.focusOffset;try{l.nodeType,A.nodeType}catch{l=null;break e}var O=0,Z=-1,ne=-1,Te=0,Oe=0,Ve=n,Le=null;t:for(;;){for(var qe;Ve!==l||E!==0&&Ve.nodeType!==3||(Z=O+E),Ve!==A||p!==0&&Ve.nodeType!==3||(ne=O+p),Ve.nodeType===3&&(O+=Ve.nodeValue.length),(qe=Ve.firstChild)!==null;)Le=Ve,Ve=qe;for(;;){if(Ve===n)break t;if(Le===l&&++Te===E&&(Z=O),Le===A&&++Oe===p&&(ne=O),(qe=Ve.nextSibling)!==null)break;Ve=Le,Le=Ve.parentNode}Ve=qe}l=Z===-1||ne===-1?null:{start:Z,end:ne}}else l=null}l=l||{start:0,end:0}}else l=null;for($f={focusedElem:n,selectionRange:l},Xi=!1,Ze=s;Ze!==null;)if(s=Ze,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Ze=n;else for(;Ze!==null;){s=Ze;try{var tt=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(tt!==null){var nt=tt.memoizedProps,Cr=tt.memoizedState,ge=s.stateNode,oe=ge.getSnapshotBeforeUpdate(s.elementType===s.type?nt:bi(s.type,nt),Cr);ge.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var ve=s.stateNode.containerInfo;ve.nodeType===1?ve.textContent="":ve.nodeType===9&&ve.documentElement&&ve.removeChild(ve.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(je){Sr(s,s.return,je)}if(n=s.sibling,n!==null){n.return=s.return,Ze=n;break}Ze=s.return}return tt=om,om=!1,tt}function Ml(n,s,l){var p=s.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var E=p=p.next;do{if((E.tag&n)===n){var A=E.destroy;E.destroy=void 0,A!==void 0&&Lh(s,l,A)}E=E.next}while(E!==p)}}function nc(n,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&n)===n){var p=l.create;l.destroy=p()}l=l.next}while(l!==s)}}function Oh(n){var s=n.ref;if(s!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof s=="function"?s(n):s.current=n}}function am(n){var s=n.alternate;s!==null&&(n.alternate=null,am(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&(delete s[ts],delete s[Rl],delete s[Qf],delete s[EE],delete s[TE])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function lm(n){return n.tag===5||n.tag===3||n.tag===4}function um(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||lm(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Nh(n,s,l){var p=n.tag;if(p===5||p===6)n=n.stateNode,s?l.nodeType===8?l.parentNode.insertBefore(n,s):l.insertBefore(n,s):(l.nodeType===8?(s=l.parentNode,s.insertBefore(n,l)):(s=l,s.appendChild(n)),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Ou));else if(p!==4&&(n=n.child,n!==null))for(Nh(n,s,l),n=n.sibling;n!==null;)Nh(n,s,l),n=n.sibling}function Fh(n,s,l){var p=n.tag;if(p===5||p===6)n=n.stateNode,s?l.insertBefore(n,s):l.appendChild(n);else if(p!==4&&(n=n.child,n!==null))for(Fh(n,s,l),n=n.sibling;n!==null;)Fh(n,s,l),n=n.sibling}var sn=null,ki=!1;function uo(n,s,l){for(l=l.child;l!==null;)cm(n,s,l),l=l.sibling}function cm(n,s,l){if(Lr&&typeof Lr.onCommitFiberUnmount=="function")try{Lr.onCommitFiberUnmount($n,l)}catch{}switch(l.tag){case 5:yn||Ka(l,s);case 6:var p=sn,E=ki;sn=null,uo(n,s,l),sn=p,ki=E,sn!==null&&(ki?(n=sn,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):sn.removeChild(l.stateNode));break;case 18:sn!==null&&(ki?(n=sn,l=l.stateNode,n.nodeType===8?Yf(n.parentNode,l):n.nodeType===1&&Yf(n,l),Qn(n)):Yf(sn,l.stateNode));break;case 4:p=sn,E=ki,sn=l.stateNode.containerInfo,ki=!0,uo(n,s,l),sn=p,ki=E;break;case 0:case 11:case 14:case 15:if(!yn&&(p=l.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){E=p=p.next;do{var A=E,O=A.destroy;A=A.tag,O!==void 0&&(A&2||A&4)&&Lh(l,s,O),E=E.next}while(E!==p)}uo(n,s,l);break;case 1:if(!yn&&(Ka(l,s),p=l.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=l.memoizedProps,p.state=l.memoizedState,p.componentWillUnmount()}catch(Z){Sr(l,s,Z)}uo(n,s,l);break;case 21:uo(n,s,l);break;case 22:l.mode&1?(yn=(p=yn)||l.memoizedState!==null,uo(n,s,l),yn=p):uo(n,s,l);break;default:uo(n,s,l)}}function fm(n){var s=n.updateQueue;if(s!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new ME),s.forEach(function(p){var E=WE.bind(null,n,p);l.has(p)||(l.add(p),p.then(E,E))})}}function Di(n,s){var l=s.deletions;if(l!==null)for(var p=0;p<l.length;p++){var E=l[p];try{var A=n,O=s,Z=O;e:for(;Z!==null;){switch(Z.tag){case 5:sn=Z.stateNode,ki=!1;break e;case 3:sn=Z.stateNode.containerInfo,ki=!0;break e;case 4:sn=Z.stateNode.containerInfo,ki=!0;break e}Z=Z.return}if(sn===null)throw Error(t(160));cm(A,O,E),sn=null,ki=!1;var ne=E.alternate;ne!==null&&(ne.return=null),E.return=null}catch(Te){Sr(E,s,Te)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)hm(s,n),s=s.sibling}function hm(n,s){var l=n.alternate,p=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Di(s,n),is(n),p&4){try{Ml(3,n,n.return),nc(3,n)}catch(nt){Sr(n,n.return,nt)}try{Ml(5,n,n.return)}catch(nt){Sr(n,n.return,nt)}}break;case 1:Di(s,n),is(n),p&512&&l!==null&&Ka(l,l.return);break;case 5:if(Di(s,n),is(n),p&512&&l!==null&&Ka(l,l.return),n.flags&32){var E=n.stateNode;try{Ie(E,"")}catch(nt){Sr(n,n.return,nt)}}if(p&4&&(E=n.stateNode,E!=null)){var A=n.memoizedProps,O=l!==null?l.memoizedProps:A,Z=n.type,ne=n.updateQueue;if(n.updateQueue=null,ne!==null)try{Z==="input"&&A.type==="radio"&&A.name!=null&&Gn(E,A),Qe(Z,O);var Te=Qe(Z,A);for(O=0;O<ne.length;O+=2){var Oe=ne[O],Ve=ne[O+1];Oe==="style"?ke(E,Ve):Oe==="dangerouslySetInnerHTML"?_e(E,Ve):Oe==="children"?Ie(E,Ve):ce(E,Oe,Ve,Te)}switch(Z){case"input":kr(E,A);break;case"textarea":j(E,A);break;case"select":var Le=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!A.multiple;var qe=A.value;qe!=null?ue(E,!!A.multiple,qe,!1):Le!==!!A.multiple&&(A.defaultValue!=null?ue(E,!!A.multiple,A.defaultValue,!0):ue(E,!!A.multiple,A.multiple?[]:"",!1))}E[Rl]=A}catch(nt){Sr(n,n.return,nt)}}break;case 6:if(Di(s,n),is(n),p&4){if(n.stateNode===null)throw Error(t(162));E=n.stateNode,A=n.memoizedProps;try{E.nodeValue=A}catch(nt){Sr(n,n.return,nt)}}break;case 3:if(Di(s,n),is(n),p&4&&l!==null&&l.memoizedState.isDehydrated)try{Qn(s.containerInfo)}catch(nt){Sr(n,n.return,nt)}break;case 4:Di(s,n),is(n);break;case 13:Di(s,n),is(n),E=n.child,E.flags&8192&&(A=E.memoizedState!==null,E.stateNode.isHidden=A,!A||E.alternate!==null&&E.alternate.memoizedState!==null||(Vh=Yt())),p&4&&fm(n);break;case 22:if(Oe=l!==null&&l.memoizedState!==null,n.mode&1?(yn=(Te=yn)||Oe,Di(s,n),yn=Te):Di(s,n),is(n),p&8192){if(Te=n.memoizedState!==null,(n.stateNode.isHidden=Te)&&!Oe&&n.mode&1)for(Ze=n,Oe=n.child;Oe!==null;){for(Ve=Ze=Oe;Ze!==null;){switch(Le=Ze,qe=Le.child,Le.tag){case 0:case 11:case 14:case 15:Ml(4,Le,Le.return);break;case 1:Ka(Le,Le.return);var tt=Le.stateNode;if(typeof tt.componentWillUnmount=="function"){p=Le,l=Le.return;try{s=p,tt.props=s.memoizedProps,tt.state=s.memoizedState,tt.componentWillUnmount()}catch(nt){Sr(p,l,nt)}}break;case 5:Ka(Le,Le.return);break;case 22:if(Le.memoizedState!==null){gm(Ve);continue}}qe!==null?(qe.return=Le,Ze=qe):gm(Ve)}Oe=Oe.sibling}e:for(Oe=null,Ve=n;;){if(Ve.tag===5){if(Oe===null){Oe=Ve;try{E=Ve.stateNode,Te?(A=E.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(Z=Ve.stateNode,ne=Ve.memoizedProps.style,O=ne!=null&&ne.hasOwnProperty("display")?ne.display:null,Z.style.display=Ne("display",O))}catch(nt){Sr(n,n.return,nt)}}}else if(Ve.tag===6){if(Oe===null)try{Ve.stateNode.nodeValue=Te?"":Ve.memoizedProps}catch(nt){Sr(n,n.return,nt)}}else if((Ve.tag!==22&&Ve.tag!==23||Ve.memoizedState===null||Ve===n)&&Ve.child!==null){Ve.child.return=Ve,Ve=Ve.child;continue}if(Ve===n)break e;for(;Ve.sibling===null;){if(Ve.return===null||Ve.return===n)break e;Oe===Ve&&(Oe=null),Ve=Ve.return}Oe===Ve&&(Oe=null),Ve.sibling.return=Ve.return,Ve=Ve.sibling}}break;case 19:Di(s,n),is(n),p&4&&fm(n);break;case 21:break;default:Di(s,n),is(n)}}function is(n){var s=n.flags;if(s&2){try{e:{for(var l=n.return;l!==null;){if(lm(l)){var p=l;break e}l=l.return}throw Error(t(160))}switch(p.tag){case 5:var E=p.stateNode;p.flags&32&&(Ie(E,""),p.flags&=-33);var A=um(n);Fh(n,A,E);break;case 3:case 4:var O=p.stateNode.containerInfo,Z=um(n);Nh(n,Z,O);break;default:throw Error(t(161))}}catch(ne){Sr(n,n.return,ne)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function VE(n,s,l){Ze=n,dm(n)}function dm(n,s,l){for(var p=(n.mode&1)!==0;Ze!==null;){var E=Ze,A=E.child;if(E.tag===22&&p){var O=E.memoizedState!==null||rc;if(!O){var Z=E.alternate,ne=Z!==null&&Z.memoizedState!==null||yn;Z=rc;var Te=yn;if(rc=O,(yn=ne)&&!Te)for(Ze=E;Ze!==null;)O=Ze,ne=O.child,O.tag===22&&O.memoizedState!==null?mm(E):ne!==null?(ne.return=O,Ze=ne):mm(E);for(;A!==null;)Ze=A,dm(A),A=A.sibling;Ze=E,rc=Z,yn=Te}pm(n)}else E.subtreeFlags&8772&&A!==null?(A.return=E,Ze=A):pm(n)}}function pm(n){for(;Ze!==null;){var s=Ze;if(s.flags&8772){var l=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:yn||nc(5,s);break;case 1:var p=s.stateNode;if(s.flags&4&&!yn)if(l===null)p.componentDidMount();else{var E=s.elementType===s.type?l.memoizedProps:bi(s.type,l.memoizedProps);p.componentDidUpdate(E,l.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var A=s.updateQueue;A!==null&&gg(s,A,p);break;case 3:var O=s.updateQueue;if(O!==null){if(l=null,s.child!==null)switch(s.child.tag){case 5:l=s.child.stateNode;break;case 1:l=s.child.stateNode}gg(s,O,l)}break;case 5:var Z=s.stateNode;if(l===null&&s.flags&4){l=Z;var ne=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":ne.autoFocus&&l.focus();break;case"img":ne.src&&(l.src=ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var Te=s.alternate;if(Te!==null){var Oe=Te.memoizedState;if(Oe!==null){var Ve=Oe.dehydrated;Ve!==null&&Qn(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}yn||s.flags&512&&Oh(s)}catch(Le){Sr(s,s.return,Le)}}if(s===n){Ze=null;break}if(l=s.sibling,l!==null){l.return=s.return,Ze=l;break}Ze=s.return}}function gm(n){for(;Ze!==null;){var s=Ze;if(s===n){Ze=null;break}var l=s.sibling;if(l!==null){l.return=s.return,Ze=l;break}Ze=s.return}}function mm(n){for(;Ze!==null;){var s=Ze;try{switch(s.tag){case 0:case 11:case 15:var l=s.return;try{nc(4,s)}catch(ne){Sr(s,l,ne)}break;case 1:var p=s.stateNode;if(typeof p.componentDidMount=="function"){var E=s.return;try{p.componentDidMount()}catch(ne){Sr(s,E,ne)}}var A=s.return;try{Oh(s)}catch(ne){Sr(s,A,ne)}break;case 5:var O=s.return;try{Oh(s)}catch(ne){Sr(s,O,ne)}}}catch(ne){Sr(s,s.return,ne)}if(s===n){Ze=null;break}var Z=s.sibling;if(Z!==null){Z.return=s.return,Ze=Z;break}Ze=s.return}}var BE=Math.ceil,ic=fe.ReactCurrentDispatcher,Mh=fe.ReactCurrentOwner,mi=fe.ReactCurrentBatchConfig,$t=0,Jr=null,Ur=null,on=0,ni=0,Ha=io(0),Hr=0,Ul=null,Qo=0,sc=0,Uh=0,Vl=null,Mn=null,Vh=0,$a=1/0,ks=null,oc=!1,Bh=null,co=null,ac=!1,fo=null,lc=0,Bl=0,jh=null,uc=-1,cc=0;function Pn(){return $t&6?Yt():uc!==-1?uc:uc=Yt()}function ho(n){return n.mode&1?$t&2&&on!==0?on&-on:wE.transition!==null?(cc===0&&(cc=ps()),cc):(n=Ot,n!==0||(n=window.event,n=n===void 0?16:Mo(n.type)),n):1}function Li(n,s,l,p){if(50<Bl)throw Bl=0,jh=null,Error(t(185));Wi(n,l,p),(!($t&2)||n!==Jr)&&(n===Jr&&(!($t&2)&&(sc|=l),Hr===4&&po(n,on)),Un(n,p),l===1&&$t===0&&!(s.mode&1)&&($a=Yt()+500,Uu&&oo()))}function Un(n,s){var l=n.callbackNode;Ai(n,s);var p=Hi(n,n===Jr?on:0);if(p===0)l!==null&&Kn(l),n.callbackNode=null,n.callbackPriority=0;else if(s=p&-p,n.callbackPriority!==s){if(l!=null&&Kn(l),s===1)n.tag===0?xE(ym.bind(null,n)):ng(ym.bind(null,n)),yE(function(){!($t&6)&&oo()}),l=null;else{switch(Yi(p)){case 1:l=wi;break;case 4:l=Dn;break;case 16:l=rn;break;case 536870912:l=zs;break;default:l=rn}l=Rm(l,vm.bind(null,n))}n.callbackPriority=s,n.callbackNode=l}}function vm(n,s){if(uc=-1,cc=0,$t&6)throw Error(t(327));var l=n.callbackNode;if(Wa()&&n.callbackNode!==l)return null;var p=Hi(n,n===Jr?on:0);if(p===0)return null;if(p&30||p&n.expiredLanes||s)s=fc(n,p);else{s=p;var E=$t;$t|=2;var A=Em();(Jr!==n||on!==s)&&(ks=null,$a=Yt()+500,Jo(n,s));do try{GE();break}catch(Z){_m(n,Z)}while(!0);sh(),ic.current=A,$t=E,Ur!==null?s=0:(Jr=null,on=0,s=Hr)}if(s!==0){if(s===2&&(E=Sn(n),E!==0&&(p=E,s=zh(n,E))),s===1)throw l=Ul,Jo(n,0),po(n,p),Un(n,Yt()),l;if(s===6)po(n,p);else{if(E=n.current.alternate,!(p&30)&&!jE(E)&&(s=fc(n,p),s===2&&(A=Sn(n),A!==0&&(p=A,s=zh(n,A))),s===1))throw l=Ul,Jo(n,0),po(n,p),Un(n,Yt()),l;switch(n.finishedWork=E,n.finishedLanes=p,s){case 0:case 1:throw Error(t(345));case 2:Zo(n,Mn,ks);break;case 3:if(po(n,p),(p&130023424)===p&&(s=Vh+500-Yt(),10<s)){if(Hi(n,0)!==0)break;if(E=n.suspendedLanes,(E&p)!==p){Pn(),n.pingedLanes|=n.suspendedLanes&E;break}n.timeoutHandle=qf(Zo.bind(null,n,Mn,ks),s);break}Zo(n,Mn,ks);break;case 4:if(po(n,p),(p&4194240)===p)break;for(s=n.eventTimes,E=-1;0<p;){var O=31-Or(p);A=1<<O,O=s[O],O>E&&(E=O),p&=~A}if(p=E,p=Yt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*BE(p/1960))-p,10<p){n.timeoutHandle=qf(Zo.bind(null,n,Mn,ks),p);break}Zo(n,Mn,ks);break;case 5:Zo(n,Mn,ks);break;default:throw Error(t(329))}}}return Un(n,Yt()),n.callbackNode===l?vm.bind(null,n):null}function zh(n,s){var l=Vl;return n.current.memoizedState.isDehydrated&&(Jo(n,s).flags|=256),n=fc(n,s),n!==2&&(s=Mn,Mn=l,s!==null&&Gh(s)),n}function Gh(n){Mn===null?Mn=n:Mn.push.apply(Mn,n)}function jE(n){for(var s=n;;){if(s.flags&16384){var l=s.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var p=0;p<l.length;p++){var E=l[p],A=E.getSnapshot;E=E.value;try{if(!ei(A(),E))return!1}catch{return!1}}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function po(n,s){for(s&=~Uh,s&=~sc,n.suspendedLanes|=s,n.pingedLanes&=~s,n=n.expirationTimes;0<s;){var l=31-Or(s),p=1<<l;n[l]=-1,s&=~p}}function ym(n){if($t&6)throw Error(t(327));Wa();var s=Hi(n,0);if(!(s&1))return Un(n,Yt()),null;var l=fc(n,s);if(n.tag!==0&&l===2){var p=Sn(n);p!==0&&(s=p,l=zh(n,p))}if(l===1)throw l=Ul,Jo(n,0),po(n,s),Un(n,Yt()),l;if(l===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=s,Zo(n,Mn,ks),Un(n,Yt()),null}function Kh(n,s){var l=$t;$t|=1;try{return n(s)}finally{$t=l,$t===0&&($a=Yt()+500,Uu&&oo())}}function Xo(n){fo!==null&&fo.tag===0&&!($t&6)&&Wa();var s=$t;$t|=1;var l=mi.transition,p=Ot;try{if(mi.transition=null,Ot=1,n)return n()}finally{Ot=p,mi.transition=l,$t=s,!($t&6)&&oo()}}function Hh(){ni=Ha.current,ar(Ha)}function Jo(n,s){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,vE(l)),Ur!==null)for(l=Ur.return;l!==null;){var p=l;switch(eh(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Fu();break;case 3:za(),ar(On),ar(gn),dh();break;case 5:fh(p);break;case 4:za();break;case 13:ar(mr);break;case 19:ar(mr);break;case 10:oh(p.type._context);break;case 22:case 23:Hh()}l=l.return}if(Jr=n,Ur=n=go(n.current,null),on=ni=s,Hr=0,Ul=null,Uh=sc=Qo=0,Mn=Vl=null,Wo!==null){for(s=0;s<Wo.length;s++)if(l=Wo[s],p=l.interleaved,p!==null){l.interleaved=null;var E=p.next,A=l.pending;if(A!==null){var O=A.next;A.next=E,p.next=O}l.pending=p}Wo=null}return n}function _m(n,s){do{var l=Ur;try{if(sh(),qu.current=Ju,Yu){for(var p=vr.memoizedState;p!==null;){var E=p.queue;E!==null&&(E.pending=null),p=p.next}Yu=!1}if(Yo=0,Xr=Kr=vr=null,Dl=!1,Ll=0,Mh.current=null,l===null||l.return===null){Hr=1,Ul=s,Ur=null;break}e:{var A=n,O=l.return,Z=l,ne=s;if(s=on,Z.flags|=32768,ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var Te=ne,Oe=Z,Ve=Oe.tag;if(!(Oe.mode&1)&&(Ve===0||Ve===11||Ve===15)){var Le=Oe.alternate;Le?(Oe.updateQueue=Le.updateQueue,Oe.memoizedState=Le.memoizedState,Oe.lanes=Le.lanes):(Oe.updateQueue=null,Oe.memoizedState=null)}var qe=Kg(O);if(qe!==null){qe.flags&=-257,Hg(qe,O,Z,A,s),qe.mode&1&&Gg(A,Te,s),s=qe,ne=Te;var tt=s.updateQueue;if(tt===null){var nt=new Set;nt.add(ne),s.updateQueue=nt}else tt.add(ne);break e}else{if(!(s&1)){Gg(A,Te,s),$h();break e}ne=Error(t(426))}}else if(cr&&Z.mode&1){var Cr=Kg(O);if(Cr!==null){!(Cr.flags&65536)&&(Cr.flags|=256),Hg(Cr,O,Z,A,s),nh(Ga(ne,Z));break e}}A=ne=Ga(ne,Z),Hr!==4&&(Hr=2),Vl===null?Vl=[A]:Vl.push(A),A=O;do{switch(A.tag){case 3:A.flags|=65536,s&=-s,A.lanes|=s;var ge=jg(A,ne,s);pg(A,ge);break e;case 1:Z=ne;var oe=A.type,ve=A.stateNode;if(!(A.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||ve!==null&&typeof ve.componentDidCatch=="function"&&(co===null||!co.has(ve)))){A.flags|=65536,s&=-s,A.lanes|=s;var je=zg(A,Z,s);pg(A,je);break e}}A=A.return}while(A!==null)}xm(l)}catch(it){s=it,Ur===l&&l!==null&&(Ur=l=l.return);continue}break}while(!0)}function Em(){var n=ic.current;return ic.current=Ju,n===null?Ju:n}function $h(){(Hr===0||Hr===3||Hr===2)&&(Hr=4),Jr===null||!(Qo&268435455)&&!(sc&268435455)||po(Jr,on)}function fc(n,s){var l=$t;$t|=2;var p=Em();(Jr!==n||on!==s)&&(ks=null,Jo(n,s));do try{zE();break}catch(E){_m(n,E)}while(!0);if(sh(),$t=l,ic.current=p,Ur!==null)throw Error(t(261));return Jr=null,on=0,Hr}function zE(){for(;Ur!==null;)Tm(Ur)}function GE(){for(;Ur!==null&&!fn();)Tm(Ur)}function Tm(n){var s=Am(n.alternate,n,ni);n.memoizedProps=n.pendingProps,s===null?xm(n):Ur=s,Mh.current=null}function xm(n){var s=n;do{var l=s.alternate;if(n=s.return,s.flags&32768){if(l=FE(l,s),l!==null){l.flags&=32767,Ur=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Hr=6,Ur=null;return}}else if(l=NE(l,s,ni),l!==null){Ur=l;return}if(s=s.sibling,s!==null){Ur=s;return}Ur=s=n}while(s!==null);Hr===0&&(Hr=5)}function Zo(n,s,l){var p=Ot,E=mi.transition;try{mi.transition=null,Ot=1,KE(n,s,l,p)}finally{mi.transition=E,Ot=p}return null}function KE(n,s,l,p){do Wa();while(fo!==null);if($t&6)throw Error(t(327));l=n.finishedWork;var E=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var A=l.lanes|l.childLanes;if(er(n,A),n===Jr&&(Ur=Jr=null,on=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||ac||(ac=!0,Rm(rn,function(){return Wa(),null})),A=(l.flags&15990)!==0,l.subtreeFlags&15990||A){A=mi.transition,mi.transition=null;var O=Ot;Ot=1;var Z=$t;$t|=4,Mh.current=null,UE(n,l),hm(l,n),Kf($f),Xi=!!Hf,$f=Hf=null,n.current=l,VE(l),hs(),$t=Z,Ot=O,mi.transition=A}else n.current=l;if(ac&&(ac=!1,fo=n,lc=E),A=n.pendingLanes,A===0&&(co=null),ai(l.stateNode),Un(n,Yt()),s!==null)for(p=n.onRecoverableError,l=0;l<s.length;l++)E=s[l],p(E.value,{componentStack:E.stack,digest:E.digest});if(oc)throw oc=!1,n=Bh,Bh=null,n;return lc&1&&n.tag!==0&&Wa(),A=n.pendingLanes,A&1?n===jh?Bl++:(Bl=0,jh=n):Bl=0,oo(),null}function Wa(){if(fo!==null){var n=Yi(lc),s=mi.transition,l=Ot;try{if(mi.transition=null,Ot=16>n?16:n,fo===null)var p=!1;else{if(n=fo,fo=null,lc=0,$t&6)throw Error(t(331));var E=$t;for($t|=4,Ze=n.current;Ze!==null;){var A=Ze,O=A.child;if(Ze.flags&16){var Z=A.deletions;if(Z!==null){for(var ne=0;ne<Z.length;ne++){var Te=Z[ne];for(Ze=Te;Ze!==null;){var Oe=Ze;switch(Oe.tag){case 0:case 11:case 15:Ml(8,Oe,A)}var Ve=Oe.child;if(Ve!==null)Ve.return=Oe,Ze=Ve;else for(;Ze!==null;){Oe=Ze;var Le=Oe.sibling,qe=Oe.return;if(am(Oe),Oe===Te){Ze=null;break}if(Le!==null){Le.return=qe,Ze=Le;break}Ze=qe}}}var tt=A.alternate;if(tt!==null){var nt=tt.child;if(nt!==null){tt.child=null;do{var Cr=nt.sibling;nt.sibling=null,nt=Cr}while(nt!==null)}}Ze=A}}if(A.subtreeFlags&2064&&O!==null)O.return=A,Ze=O;else e:for(;Ze!==null;){if(A=Ze,A.flags&2048)switch(A.tag){case 0:case 11:case 15:Ml(9,A,A.return)}var ge=A.sibling;if(ge!==null){ge.return=A.return,Ze=ge;break e}Ze=A.return}}var oe=n.current;for(Ze=oe;Ze!==null;){O=Ze;var ve=O.child;if(O.subtreeFlags&2064&&ve!==null)ve.return=O,Ze=ve;else e:for(O=oe;Ze!==null;){if(Z=Ze,Z.flags&2048)try{switch(Z.tag){case 0:case 11:case 15:nc(9,Z)}}catch(it){Sr(Z,Z.return,it)}if(Z===O){Ze=null;break e}var je=Z.sibling;if(je!==null){je.return=Z.return,Ze=je;break e}Ze=Z.return}}if($t=E,oo(),Lr&&typeof Lr.onPostCommitFiberRoot=="function")try{Lr.onPostCommitFiberRoot($n,n)}catch{}p=!0}return p}finally{Ot=l,mi.transition=s}}return!1}function wm(n,s,l){s=Ga(l,s),s=jg(n,s,1),n=lo(n,s,1),s=Pn(),n!==null&&(Wi(n,1,s),Un(n,s))}function Sr(n,s,l){if(n.tag===3)wm(n,n,l);else for(;s!==null;){if(s.tag===3){wm(s,n,l);break}else if(s.tag===1){var p=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(co===null||!co.has(p))){n=Ga(l,n),n=zg(s,n,1),s=lo(s,n,1),n=Pn(),s!==null&&(Wi(s,1,n),Un(s,n));break}}s=s.return}}function HE(n,s,l){var p=n.pingCache;p!==null&&p.delete(s),s=Pn(),n.pingedLanes|=n.suspendedLanes&l,Jr===n&&(on&l)===l&&(Hr===4||Hr===3&&(on&130023424)===on&&500>Yt()-Vh?Jo(n,0):Uh|=l),Un(n,s)}function Sm(n,s){s===0&&(n.mode&1?(s=Gi,Gi<<=1,!(Gi&130023424)&&(Gi=4194304)):s=1);var l=Pn();n=Cs(n,s),n!==null&&(Wi(n,s,l),Un(n,l))}function $E(n){var s=n.memoizedState,l=0;s!==null&&(l=s.retryLane),Sm(n,l)}function WE(n,s){var l=0;switch(n.tag){case 13:var p=n.stateNode,E=n.memoizedState;E!==null&&(l=E.retryLane);break;case 19:p=n.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(s),Sm(n,l)}var Am;Am=function(n,s,l){if(n!==null)if(n.memoizedProps!==s.pendingProps||On.current)Fn=!0;else{if(!(n.lanes&l)&&!(s.flags&128))return Fn=!1,OE(n,s,l);Fn=!!(n.flags&131072)}else Fn=!1,cr&&s.flags&1048576&&ig(s,Bu,s.index);switch(s.lanes=0,s.tag){case 2:var p=s.type;tc(n,s),n=s.pendingProps;var E=Na(s,gn.current);ja(s,l),E=mh(null,s,p,n,E,l);var A=vh();return s.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Nn(p)?(A=!0,Mu(s)):A=!1,s.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,uh(s),E.updater=Zu,s.stateNode=E,E._reactInternals=s,wh(s,p,n,l),s=Ih(null,s,p,!0,A,l)):(s.tag=0,cr&&A&&Zf(s),Cn(null,s,E,l),s=s.child),s;case 16:p=s.elementType;e:{switch(tc(n,s),n=s.pendingProps,E=p._init,p=E(p._payload),s.type=p,E=s.tag=YE(p),n=bi(p,n),E){case 0:s=Rh(null,s,p,n,l);break e;case 1:s=Xg(null,s,p,n,l);break e;case 11:s=$g(null,s,p,n,l);break e;case 14:s=Wg(null,s,p,bi(p.type,n),l);break e}throw Error(t(306,p,""))}return s;case 0:return p=s.type,E=s.pendingProps,E=s.elementType===p?E:bi(p,E),Rh(n,s,p,E,l);case 1:return p=s.type,E=s.pendingProps,E=s.elementType===p?E:bi(p,E),Xg(n,s,p,E,l);case 3:e:{if(Jg(s),n===null)throw Error(t(387));p=s.pendingProps,A=s.memoizedState,E=A.element,dg(n,s),$u(s,p,null,l);var O=s.memoizedState;if(p=O.element,A.isDehydrated)if(A={element:p,isDehydrated:!1,cache:O.cache,pendingSuspenseBoundaries:O.pendingSuspenseBoundaries,transitions:O.transitions},s.updateQueue.baseState=A,s.memoizedState=A,s.flags&256){E=Ga(Error(t(423)),s),s=Zg(n,s,p,l,E);break e}else if(p!==E){E=Ga(Error(t(424)),s),s=Zg(n,s,p,l,E);break e}else for(ri=no(s.stateNode.containerInfo.firstChild),ti=s,cr=!0,Pi=null,l=fg(s,null,p,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Ua(),p===E){s=bs(n,s,l);break e}Cn(n,s,p,l)}s=s.child}return s;case 5:return mg(s),n===null&&rh(s),p=s.type,E=s.pendingProps,A=n!==null?n.memoizedProps:null,O=E.children,Wf(p,E)?O=null:A!==null&&Wf(p,A)&&(s.flags|=32),Qg(n,s),Cn(n,s,O,l),s.child;case 6:return n===null&&rh(s),null;case 13:return em(n,s,l);case 4:return ch(s,s.stateNode.containerInfo),p=s.pendingProps,n===null?s.child=Va(s,null,p,l):Cn(n,s,p,l),s.child;case 11:return p=s.type,E=s.pendingProps,E=s.elementType===p?E:bi(p,E),$g(n,s,p,E,l);case 7:return Cn(n,s,s.pendingProps,l),s.child;case 8:return Cn(n,s,s.pendingProps.children,l),s.child;case 12:return Cn(n,s,s.pendingProps.children,l),s.child;case 10:e:{if(p=s.type._context,E=s.pendingProps,A=s.memoizedProps,O=E.value,sr(Gu,p._currentValue),p._currentValue=O,A!==null)if(ei(A.value,O)){if(A.children===E.children&&!On.current){s=bs(n,s,l);break e}}else for(A=s.child,A!==null&&(A.return=s);A!==null;){var Z=A.dependencies;if(Z!==null){O=A.child;for(var ne=Z.firstContext;ne!==null;){if(ne.context===p){if(A.tag===1){ne=Ps(-1,l&-l),ne.tag=2;var Te=A.updateQueue;if(Te!==null){Te=Te.shared;var Oe=Te.pending;Oe===null?ne.next=ne:(ne.next=Oe.next,Oe.next=ne),Te.pending=ne}}A.lanes|=l,ne=A.alternate,ne!==null&&(ne.lanes|=l),ah(A.return,l,s),Z.lanes|=l;break}ne=ne.next}}else if(A.tag===10)O=A.type===s.type?null:A.child;else if(A.tag===18){if(O=A.return,O===null)throw Error(t(341));O.lanes|=l,Z=O.alternate,Z!==null&&(Z.lanes|=l),ah(O,l,s),O=A.sibling}else O=A.child;if(O!==null)O.return=A;else for(O=A;O!==null;){if(O===s){O=null;break}if(A=O.sibling,A!==null){A.return=O.return,O=A;break}O=O.return}A=O}Cn(n,s,E.children,l),s=s.child}return s;case 9:return E=s.type,p=s.pendingProps.children,ja(s,l),E=pi(E),p=p(E),s.flags|=1,Cn(n,s,p,l),s.child;case 14:return p=s.type,E=bi(p,s.pendingProps),E=bi(p.type,E),Wg(n,s,p,E,l);case 15:return qg(n,s,s.type,s.pendingProps,l);case 17:return p=s.type,E=s.pendingProps,E=s.elementType===p?E:bi(p,E),tc(n,s),s.tag=1,Nn(p)?(n=!0,Mu(s)):n=!1,ja(s,l),Vg(s,p,E),wh(s,p,E,l),Ih(null,s,p,!0,n,l);case 19:return rm(n,s,l);case 22:return Yg(n,s,l)}throw Error(t(156,s.tag))};function Rm(n,s){return kn(n,s)}function qE(n,s,l,p){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vi(n,s,l,p){return new qE(n,s,l,p)}function Wh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function YE(n){if(typeof n=="function")return Wh(n)?1:0;if(n!=null){if(n=n.$$typeof,n===le)return 11;if(n===Jt)return 14}return 2}function go(n,s){var l=n.alternate;return l===null?(l=vi(n.tag,s,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=s,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,s=n.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function hc(n,s,l,p,E,A){var O=2;if(p=n,typeof n=="function")Wh(n)&&(O=1);else if(typeof n=="string")O=5;else e:switch(n){case H:return ea(l.children,E,A,s);case B:O=8,E|=8;break;case z:return n=vi(12,l,s,E|2),n.elementType=z,n.lanes=A,n;case J:return n=vi(13,l,s,E),n.elementType=J,n.lanes=A,n;case pt:return n=vi(19,l,s,E),n.elementType=pt,n.lanes=A,n;case dt:return dc(l,E,A,s);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Q:O=10;break e;case re:O=9;break e;case le:O=11;break e;case Jt:O=14;break e;case At:O=16,p=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return s=vi(O,l,s,E),s.elementType=n,s.type=p,s.lanes=A,s}function ea(n,s,l,p){return n=vi(7,n,p,s),n.lanes=l,n}function dc(n,s,l,p){return n=vi(22,n,p,s),n.elementType=dt,n.lanes=l,n.stateNode={isHidden:!1},n}function qh(n,s,l){return n=vi(6,n,null,s),n.lanes=l,n}function Yh(n,s,l){return s=vi(4,n.children!==null?n.children:[],n.key,s),s.lanes=l,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}function QE(n,s,l,p,E){this.tag=s,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$i(0),this.expirationTimes=$i(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$i(0),this.identifierPrefix=p,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function Qh(n,s,l,p,E,A,O,Z,ne){return n=new QE(n,s,l,Z,ne),s===1?(s=1,A===!0&&(s|=8)):s=0,A=vi(3,null,null,s),n.current=A,A.stateNode=n,A.memoizedState={element:p,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},uh(A),n}function XE(n,s,l){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:we,key:p==null?null:""+p,children:n,containerInfo:s,implementation:l}}function Im(n){if(!n)return so;n=n._reactInternals;e:{if(_r(n)!==n||n.tag!==1)throw Error(t(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Nn(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(t(171))}if(n.tag===1){var l=n.type;if(Nn(l))return tg(n,l,s)}return s}function Cm(n,s,l,p,E,A,O,Z,ne){return n=Qh(l,p,!0,n,E,A,O,Z,ne),n.context=Im(null),l=n.current,p=Pn(),E=ho(l),A=Ps(p,E),A.callback=s??null,lo(l,A,E),n.current.lanes=E,Wi(n,E,p),Un(n,p),n}function pc(n,s,l,p){var E=s.current,A=Pn(),O=ho(E);return l=Im(l),s.context===null?s.context=l:s.pendingContext=l,s=Ps(A,O),s.payload={element:n},p=p===void 0?null:p,p!==null&&(s.callback=p),n=lo(E,s,O),n!==null&&(Li(n,E,O,A),Hu(n,E,O)),O}function gc(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Pm(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<s?l:s}}function Xh(n,s){Pm(n,s),(n=n.alternate)&&Pm(n,s)}function JE(){return null}var bm=typeof reportError=="function"?reportError:function(n){console.error(n)};function Jh(n){this._internalRoot=n}mc.prototype.render=Jh.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(t(409));pc(n,s,null,null)},mc.prototype.unmount=Jh.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;Xo(function(){pc(null,n,null,null)}),s[Ss]=null}};function mc(n){this._internalRoot=n}mc.prototype.unstable_scheduleHydration=function(n){if(n){var s=ya();n={blockedOn:null,target:n,priority:s};for(var l=0;l<ui.length&&s!==0&&s<ui[l].priority;l++);ui.splice(l,0,n),l===0&&Ea(n)}};function Zh(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function vc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function km(){}function ZE(n,s,l,p,E){if(E){if(typeof p=="function"){var A=p;p=function(){var Te=gc(O);A.call(Te)}}var O=Cm(s,p,n,0,null,!1,!1,"",km);return n._reactRootContainer=O,n[Ss]=O.current,ir(n.nodeType===8?n.parentNode:n),Xo(),O}for(;E=n.lastChild;)n.removeChild(E);if(typeof p=="function"){var Z=p;p=function(){var Te=gc(ne);Z.call(Te)}}var ne=Qh(n,0,!1,null,null,!1,!1,"",km);return n._reactRootContainer=ne,n[Ss]=ne.current,ir(n.nodeType===8?n.parentNode:n),Xo(function(){pc(s,ne,l,p)}),ne}function yc(n,s,l,p,E){var A=l._reactRootContainer;if(A){var O=A;if(typeof E=="function"){var Z=E;E=function(){var ne=gc(O);Z.call(ne)}}pc(s,O,n,E)}else O=ZE(l,s,n,E,p);return gc(O)}ma=function(n){switch(n.tag){case 3:var s=n.stateNode;if(s.current.memoizedState.isDehydrated){var l=Ki(s.pendingLanes);l!==0&&(qi(s,l|1),Un(s,Yt()),!($t&6)&&($a=Yt()+500,oo()))}break;case 13:Xo(function(){var p=Cs(n,1);if(p!==null){var E=Pn();Li(p,n,1,E)}}),Xh(n,1)}},gs=function(n){if(n.tag===13){var s=Cs(n,134217728);if(s!==null){var l=Pn();Li(s,n,134217728,l)}Xh(n,134217728)}},va=function(n){if(n.tag===13){var s=ho(n),l=Cs(n,s);if(l!==null){var p=Pn();Li(l,n,s,p)}Xh(n,s)}},ya=function(){return Ot},Oo=function(n,s){var l=Ot;try{return Ot=n,s()}finally{Ot=l}},bt=function(n,s,l){switch(s){case"input":if(kr(n,l),s=l.name,l.type==="radio"&&s!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<l.length;s++){var p=l[s];if(p!==n&&p.form===n.form){var E=Nu(p);if(!E)throw Error(t(90));bn(p),kr(p,E)}}}break;case"textarea":j(n,l);break;case"select":s=l.value,s!=null&&ue(n,!!l.multiple,s,!1)}},Ft=Kh,pr=Xo;var eT={usingClientEntryPoint:!1,Events:[Il,La,Nu,gt,kt,Kh]},jl={findFiberByHostInstance:Go,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tT={bundleType:jl.bundleType,version:jl.version,rendererPackageName:jl.rendererPackageName,rendererConfig:jl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fe.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Se(n),n===null?null:n.stateNode},findFiberByHostInstance:jl.findFiberByHostInstance||JE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_c.isDisabled&&_c.supportsFiber)try{$n=_c.inject(tT),Lr=_c}catch{}}return Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eT,Vn.createPortal=function(n,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zh(s))throw Error(t(200));return XE(n,s,null,l)},Vn.createRoot=function(n,s){if(!Zh(n))throw Error(t(299));var l=!1,p="",E=bm;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onRecoverableError!==void 0&&(E=s.onRecoverableError)),s=Qh(n,1,!1,null,null,l,!1,p,E),n[Ss]=s.current,ir(n.nodeType===8?n.parentNode:n),new Jh(s)},Vn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=Se(s),n=n===null?null:n.stateNode,n},Vn.flushSync=function(n){return Xo(n)},Vn.hydrate=function(n,s,l){if(!vc(s))throw Error(t(200));return yc(null,n,s,!0,l)},Vn.hydrateRoot=function(n,s,l){if(!Zh(n))throw Error(t(405));var p=l!=null&&l.hydratedSources||null,E=!1,A="",O=bm;if(l!=null&&(l.unstable_strictMode===!0&&(E=!0),l.identifierPrefix!==void 0&&(A=l.identifierPrefix),l.onRecoverableError!==void 0&&(O=l.onRecoverableError)),s=Cm(s,null,n,1,l??null,E,!1,A,O),n[Ss]=s.current,ir(n),p)for(n=0;n<p.length;n++)l=p[n],E=l._getVersion,E=E(l._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[l,E]:s.mutableSourceEagerHydrationData.push(l,E);return new mc(s)},Vn.render=function(n,s,l){if(!vc(s))throw Error(t(200));return yc(null,n,s,!1,l)},Vn.unmountComponentAtNode=function(n){if(!vc(n))throw Error(t(40));return n._reactRootContainer?(Xo(function(){yc(null,null,n,!1,function(){n._reactRootContainer=null,n[Ss]=null})}),!0):!1},Vn.unstable_batchedUpdates=Kh,Vn.unstable_renderSubtreeIntoContainer=function(n,s,l,p){if(!vc(l))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return yc(n,s,l,!1,p)},Vn.version="18.3.1-next-f1338f8080-20240426",Vn}var Vm;function uT(){if(Vm)return rd.exports;Vm=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),rd.exports=lT(),rd.exports}var Bm;function cT(){if(Bm)return Ec;Bm=1;var r=uT();return Ec.createRoot=r.createRoot,Ec.hydrateRoot=r.hydrateRoot,Ec}var fT=cT();const jm=r=>{let e;const t=new Set,i=(m,_)=>{const L=typeof m=="function"?m(e):m;if(!Object.is(L,e)){const I=e;e=_??(typeof L!="object"||L===null)?L:Object.assign({},e,L),t.forEach(D=>D(e,I))}},o=()=>e,g={setState:i,getState:o,getInitialState:()=>T,subscribe:m=>(t.add(m),()=>t.delete(m))},T=e=r(i,o,g);return g},hT=r=>r?jm(r):jm,dT=r=>r;function pT(r,e=dT){const t=Ql.useSyncExternalStore(r.subscribe,()=>e(r.getState()),()=>e(r.getInitialState()));return Ql.useDebugValue(t),t}const zm=r=>{const e=hT(r),t=i=>pT(e,i);return Object.assign(t,e),t},gT=r=>r?zm(r):zm;function yv(r,e){return function(){return r.apply(e,arguments)}}const{toString:mT}=Object.prototype,{getPrototypeOf:np}=Object,uf=(r=>e=>{const t=mT.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Fi=r=>(r=r.toLowerCase(),e=>uf(e)===r),cf=r=>e=>typeof e===r,{isArray:ul}=Array,nu=cf("undefined");function vT(r){return r!==null&&!nu(r)&&r.constructor!==null&&!nu(r.constructor)&&si(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const _v=Fi("ArrayBuffer");function yT(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&_v(r.buffer),e}const _T=cf("string"),si=cf("function"),Ev=cf("number"),ff=r=>r!==null&&typeof r=="object",ET=r=>r===!0||r===!1,bc=r=>{if(uf(r)!=="object")return!1;const e=np(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},TT=Fi("Date"),xT=Fi("File"),wT=Fi("Blob"),ST=Fi("FileList"),AT=r=>ff(r)&&si(r.pipe),RT=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||si(r.append)&&((e=uf(r))==="formdata"||e==="object"&&si(r.toString)&&r.toString()==="[object FormData]"))},IT=Fi("URLSearchParams"),[CT,PT,bT,kT]=["ReadableStream","Request","Response","Headers"].map(Fi),DT=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fu(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let i,o;if(typeof r!="object"&&(r=[r]),ul(r))for(i=0,o=r.length;i<o;i++)e.call(null,r[i],i,r);else{const u=t?Object.getOwnPropertyNames(r):Object.keys(r),h=u.length;let g;for(i=0;i<h;i++)g=u[i],e.call(null,r[g],g,r)}}function Tv(r,e){e=e.toLowerCase();const t=Object.keys(r);let i=t.length,o;for(;i-- >0;)if(o=t[i],e===o.toLowerCase())return o;return null}const ra=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,xv=r=>!nu(r)&&r!==ra;function xd(){const{caseless:r}=xv(this)&&this||{},e={},t=(i,o)=>{const u=r&&Tv(e,o)||o;bc(e[u])&&bc(i)?e[u]=xd(e[u],i):bc(i)?e[u]=xd({},i):ul(i)?e[u]=i.slice():e[u]=i};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&fu(arguments[i],t);return e}const LT=(r,e,t,{allOwnKeys:i}={})=>(fu(e,(o,u)=>{t&&si(o)?r[u]=yv(o,t):r[u]=o},{allOwnKeys:i}),r),OT=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),NT=(r,e,t,i)=>{r.prototype=Object.create(e.prototype,i),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},FT=(r,e,t,i)=>{let o,u,h;const g={};if(e=e||{},r==null)return e;do{for(o=Object.getOwnPropertyNames(r),u=o.length;u-- >0;)h=o[u],(!i||i(h,r,e))&&!g[h]&&(e[h]=r[h],g[h]=!0);r=t!==!1&&np(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},MT=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;const i=r.indexOf(e,t);return i!==-1&&i===t},UT=r=>{if(!r)return null;if(ul(r))return r;let e=r.length;if(!Ev(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},VT=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&np(Uint8Array)),BT=(r,e)=>{const i=(r&&r[Symbol.iterator]).call(r);let o;for(;(o=i.next())&&!o.done;){const u=o.value;e.call(r,u[0],u[1])}},jT=(r,e)=>{let t;const i=[];for(;(t=r.exec(e))!==null;)i.push(t);return i},zT=Fi("HTMLFormElement"),GT=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,o){return i.toUpperCase()+o}),Gm=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),KT=Fi("RegExp"),wv=(r,e)=>{const t=Object.getOwnPropertyDescriptors(r),i={};fu(t,(o,u)=>{let h;(h=e(o,u,r))!==!1&&(i[u]=h||o)}),Object.defineProperties(r,i)},HT=r=>{wv(r,(e,t)=>{if(si(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=r[t];if(si(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},$T=(r,e)=>{const t={},i=o=>{o.forEach(u=>{t[u]=!0})};return ul(r)?i(r):i(String(r).split(e)),t},WT=()=>{},qT=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e,sd="abcdefghijklmnopqrstuvwxyz",Km="0123456789",Sv={DIGIT:Km,ALPHA:sd,ALPHA_DIGIT:sd+sd.toUpperCase()+Km},YT=(r=16,e=Sv.ALPHA_DIGIT)=>{let t="";const{length:i}=e;for(;r--;)t+=e[Math.random()*i|0];return t};function QT(r){return!!(r&&si(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const XT=r=>{const e=new Array(10),t=(i,o)=>{if(ff(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[o]=i;const u=ul(i)?[]:{};return fu(i,(h,g)=>{const T=t(h,o+1);!nu(T)&&(u[g]=T)}),e[o]=void 0,u}}return i};return t(r,0)},JT=Fi("AsyncFunction"),ZT=r=>r&&(ff(r)||si(r))&&si(r.then)&&si(r.catch),Av=((r,e)=>r?setImmediate:e?((t,i)=>(ra.addEventListener("message",({source:o,data:u})=>{o===ra&&u===t&&i.length&&i.shift()()},!1),o=>{i.push(o),ra.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",si(ra.postMessage)),ex=typeof queueMicrotask<"u"?queueMicrotask.bind(ra):typeof process<"u"&&process.nextTick||Av,Ae={isArray:ul,isArrayBuffer:_v,isBuffer:vT,isFormData:RT,isArrayBufferView:yT,isString:_T,isNumber:Ev,isBoolean:ET,isObject:ff,isPlainObject:bc,isReadableStream:CT,isRequest:PT,isResponse:bT,isHeaders:kT,isUndefined:nu,isDate:TT,isFile:xT,isBlob:wT,isRegExp:KT,isFunction:si,isStream:AT,isURLSearchParams:IT,isTypedArray:VT,isFileList:ST,forEach:fu,merge:xd,extend:LT,trim:DT,stripBOM:OT,inherits:NT,toFlatObject:FT,kindOf:uf,kindOfTest:Fi,endsWith:MT,toArray:UT,forEachEntry:BT,matchAll:jT,isHTMLForm:zT,hasOwnProperty:Gm,hasOwnProp:Gm,reduceDescriptors:wv,freezeMethods:HT,toObjectSet:$T,toCamelCase:GT,noop:WT,toFiniteNumber:qT,findKey:Tv,global:ra,isContextDefined:xv,ALPHABET:Sv,generateString:YT,isSpecCompliantForm:QT,toJSONObject:XT,isAsyncFn:JT,isThenable:ZT,setImmediate:Av,asap:ex};function Ct(r,e,t,i,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),o&&(this.response=o,this.status=o.status?o.status:null)}Ae.inherits(Ct,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ae.toJSONObject(this.config),code:this.code,status:this.status}}});const Rv=Ct.prototype,Iv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{Iv[r]={value:r}});Object.defineProperties(Ct,Iv);Object.defineProperty(Rv,"isAxiosError",{value:!0});Ct.from=(r,e,t,i,o,u)=>{const h=Object.create(Rv);return Ae.toFlatObject(r,h,function(T){return T!==Error.prototype},g=>g!=="isAxiosError"),Ct.call(h,r.message,e,t,i,o),h.cause=r,h.name=r.name,u&&Object.assign(h,u),h};const tx=null;function wd(r){return Ae.isPlainObject(r)||Ae.isArray(r)}function Cv(r){return Ae.endsWith(r,"[]")?r.slice(0,-2):r}function Hm(r,e,t){return r?r.concat(e).map(function(o,u){return o=Cv(o),!t&&u?"["+o+"]":o}).join(t?".":""):e}function rx(r){return Ae.isArray(r)&&!r.some(wd)}const nx=Ae.toFlatObject(Ae,{},null,function(e){return/^is[A-Z]/.test(e)});function hf(r,e,t){if(!Ae.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=Ae.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(N,U){return!Ae.isUndefined(U[N])});const i=t.metaTokens,o=t.visitor||_,u=t.dots,h=t.indexes,T=(t.Blob||typeof Blob<"u"&&Blob)&&Ae.isSpecCompliantForm(e);if(!Ae.isFunction(o))throw new TypeError("visitor must be a function");function m(F){if(F===null)return"";if(Ae.isDate(F))return F.toISOString();if(!T&&Ae.isBlob(F))throw new Ct("Blob is not supported. Use a Buffer instead.");return Ae.isArrayBuffer(F)||Ae.isTypedArray(F)?T&&typeof Blob=="function"?new Blob([F]):Buffer.from(F):F}function _(F,N,U){let Y=F;if(F&&!U&&typeof F=="object"){if(Ae.endsWith(N,"{}"))N=i?N:N.slice(0,-2),F=JSON.stringify(F);else if(Ae.isArray(F)&&rx(F)||(Ae.isFileList(F)||Ae.endsWith(N,"[]"))&&(Y=Ae.toArray(F)))return N=Cv(N),Y.forEach(function(ce,fe){!(Ae.isUndefined(ce)||ce===null)&&e.append(h===!0?Hm([N],fe,u):h===null?N:N+"[]",m(ce))}),!1}return wd(F)?!0:(e.append(Hm(U,N,u),m(F)),!1)}const L=[],I=Object.assign(nx,{defaultVisitor:_,convertValue:m,isVisitable:wd});function D(F,N){if(!Ae.isUndefined(F)){if(L.indexOf(F)!==-1)throw Error("Circular reference detected in "+N.join("."));L.push(F),Ae.forEach(F,function(Y,X){(!(Ae.isUndefined(Y)||Y===null)&&o.call(e,Y,Ae.isString(X)?X.trim():X,N,I))===!0&&D(Y,N?N.concat(X):[X])}),L.pop()}}if(!Ae.isObject(r))throw new TypeError("data must be an object");return D(r),e}function $m(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function ip(r,e){this._pairs=[],r&&hf(r,this,e)}const Pv=ip.prototype;Pv.append=function(e,t){this._pairs.push([e,t])};Pv.toString=function(e){const t=e?function(i){return e.call(this,i,$m)}:$m;return this._pairs.map(function(o){return t(o[0])+"="+t(o[1])},"").join("&")};function ix(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function bv(r,e,t){if(!e)return r;const i=t&&t.encode||ix;Ae.isFunction(t)&&(t={serialize:t});const o=t&&t.serialize;let u;if(o?u=o(e,t):u=Ae.isURLSearchParams(e)?e.toString():new ip(e,t).toString(i),u){const h=r.indexOf("#");h!==-1&&(r=r.slice(0,h)),r+=(r.indexOf("?")===-1?"?":"&")+u}return r}class Wm{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ae.forEach(this.handlers,function(i){i!==null&&e(i)})}}const kv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},sx=typeof URLSearchParams<"u"?URLSearchParams:ip,ox=typeof FormData<"u"?FormData:null,ax=typeof Blob<"u"?Blob:null,lx={isBrowser:!0,classes:{URLSearchParams:sx,FormData:ox,Blob:ax},protocols:["http","https","file","blob","url","data"]},sp=typeof window<"u"&&typeof document<"u",Sd=typeof navigator=="object"&&navigator||void 0,ux=sp&&(!Sd||["ReactNative","NativeScript","NS"].indexOf(Sd.product)<0),cx=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",fx=sp&&window.location.href||"http://localhost",hx=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sp,hasStandardBrowserEnv:ux,hasStandardBrowserWebWorkerEnv:cx,navigator:Sd,origin:fx},Symbol.toStringTag,{value:"Module"})),xn={...hx,...lx};function dx(r,e){return hf(r,new xn.classes.URLSearchParams,Object.assign({visitor:function(t,i,o,u){return xn.isNode&&Ae.isBuffer(t)?(this.append(i,t.toString("base64")),!1):u.defaultVisitor.apply(this,arguments)}},e))}function px(r){return Ae.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function gx(r){const e={},t=Object.keys(r);let i;const o=t.length;let u;for(i=0;i<o;i++)u=t[i],e[u]=r[u];return e}function Dv(r){function e(t,i,o,u){let h=t[u++];if(h==="__proto__")return!0;const g=Number.isFinite(+h),T=u>=t.length;return h=!h&&Ae.isArray(o)?o.length:h,T?(Ae.hasOwnProp(o,h)?o[h]=[o[h],i]:o[h]=i,!g):((!o[h]||!Ae.isObject(o[h]))&&(o[h]=[]),e(t,i,o[h],u)&&Ae.isArray(o[h])&&(o[h]=gx(o[h])),!g)}if(Ae.isFormData(r)&&Ae.isFunction(r.entries)){const t={};return Ae.forEachEntry(r,(i,o)=>{e(px(i),o,t,0)}),t}return null}function mx(r,e,t){if(Ae.isString(r))try{return(e||JSON.parse)(r),Ae.trim(r)}catch(i){if(i.name!=="SyntaxError")throw i}return(0,JSON.stringify)(r)}const hu={transitional:kv,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",o=i.indexOf("application/json")>-1,u=Ae.isObject(e);if(u&&Ae.isHTMLForm(e)&&(e=new FormData(e)),Ae.isFormData(e))return o?JSON.stringify(Dv(e)):e;if(Ae.isArrayBuffer(e)||Ae.isBuffer(e)||Ae.isStream(e)||Ae.isFile(e)||Ae.isBlob(e)||Ae.isReadableStream(e))return e;if(Ae.isArrayBufferView(e))return e.buffer;if(Ae.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let g;if(u){if(i.indexOf("application/x-www-form-urlencoded")>-1)return dx(e,this.formSerializer).toString();if((g=Ae.isFileList(e))||i.indexOf("multipart/form-data")>-1){const T=this.env&&this.env.FormData;return hf(g?{"files[]":e}:e,T&&new T,this.formSerializer)}}return u||o?(t.setContentType("application/json",!1),mx(e)):e}],transformResponse:[function(e){const t=this.transitional||hu.transitional,i=t&&t.forcedJSONParsing,o=this.responseType==="json";if(Ae.isResponse(e)||Ae.isReadableStream(e))return e;if(e&&Ae.isString(e)&&(i&&!this.responseType||o)){const h=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(g){if(h)throw g.name==="SyntaxError"?Ct.from(g,Ct.ERR_BAD_RESPONSE,this,null,this.response):g}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xn.classes.FormData,Blob:xn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ae.forEach(["delete","get","head","post","put","patch"],r=>{hu.headers[r]={}});const vx=Ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),yx=r=>{const e={};let t,i,o;return r&&r.split(`
`).forEach(function(h){o=h.indexOf(":"),t=h.substring(0,o).trim().toLowerCase(),i=h.substring(o+1).trim(),!(!t||e[t]&&vx[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},qm=Symbol("internals");function Gl(r){return r&&String(r).trim().toLowerCase()}function kc(r){return r===!1||r==null?r:Ae.isArray(r)?r.map(kc):String(r)}function _x(r){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(r);)e[i[1]]=i[2];return e}const Ex=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function od(r,e,t,i,o){if(Ae.isFunction(i))return i.call(this,e,t);if(o&&(e=t),!!Ae.isString(e)){if(Ae.isString(i))return e.indexOf(i)!==-1;if(Ae.isRegExp(i))return i.test(e)}}function Tx(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function xx(r,e){const t=Ae.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(r,i+t,{value:function(o,u,h){return this[i].call(this,e,o,u,h)},configurable:!0})})}class jn{constructor(e){e&&this.set(e)}set(e,t,i){const o=this;function u(g,T,m){const _=Gl(T);if(!_)throw new Error("header name must be a non-empty string");const L=Ae.findKey(o,_);(!L||o[L]===void 0||m===!0||m===void 0&&o[L]!==!1)&&(o[L||T]=kc(g))}const h=(g,T)=>Ae.forEach(g,(m,_)=>u(m,_,T));if(Ae.isPlainObject(e)||e instanceof this.constructor)h(e,t);else if(Ae.isString(e)&&(e=e.trim())&&!Ex(e))h(yx(e),t);else if(Ae.isHeaders(e))for(const[g,T]of e.entries())u(T,g,i);else e!=null&&u(t,e,i);return this}get(e,t){if(e=Gl(e),e){const i=Ae.findKey(this,e);if(i){const o=this[i];if(!t)return o;if(t===!0)return _x(o);if(Ae.isFunction(t))return t.call(this,o,i);if(Ae.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Gl(e),e){const i=Ae.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||od(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let o=!1;function u(h){if(h=Gl(h),h){const g=Ae.findKey(i,h);g&&(!t||od(i,i[g],g,t))&&(delete i[g],o=!0)}}return Ae.isArray(e)?e.forEach(u):u(e),o}clear(e){const t=Object.keys(this);let i=t.length,o=!1;for(;i--;){const u=t[i];(!e||od(this,this[u],u,e,!0))&&(delete this[u],o=!0)}return o}normalize(e){const t=this,i={};return Ae.forEach(this,(o,u)=>{const h=Ae.findKey(i,u);if(h){t[h]=kc(o),delete t[u];return}const g=e?Tx(u):String(u).trim();g!==u&&delete t[u],t[g]=kc(o),i[g]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Ae.forEach(this,(i,o)=>{i!=null&&i!==!1&&(t[o]=e&&Ae.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(o=>i.set(o)),i}static accessor(e){const i=(this[qm]=this[qm]={accessors:{}}).accessors,o=this.prototype;function u(h){const g=Gl(h);i[g]||(xx(o,h),i[g]=!0)}return Ae.isArray(e)?e.forEach(u):u(e),this}}jn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ae.reduceDescriptors(jn.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(i){this[t]=i}}});Ae.freezeMethods(jn);function ad(r,e){const t=this||hu,i=e||t,o=jn.from(i.headers);let u=i.data;return Ae.forEach(r,function(g){u=g.call(t,u,o.normalize(),e?e.status:void 0)}),o.normalize(),u}function Lv(r){return!!(r&&r.__CANCEL__)}function cl(r,e,t){Ct.call(this,r??"canceled",Ct.ERR_CANCELED,e,t),this.name="CanceledError"}Ae.inherits(cl,Ct,{__CANCEL__:!0});function Ov(r,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?r(t):e(new Ct("Request failed with status code "+t.status,[Ct.ERR_BAD_REQUEST,Ct.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function wx(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function Sx(r,e){r=r||10;const t=new Array(r),i=new Array(r);let o=0,u=0,h;return e=e!==void 0?e:1e3,function(T){const m=Date.now(),_=i[u];h||(h=m),t[o]=T,i[o]=m;let L=u,I=0;for(;L!==o;)I+=t[L++],L=L%r;if(o=(o+1)%r,o===u&&(u=(u+1)%r),m-h<e)return;const D=_&&m-_;return D?Math.round(I*1e3/D):void 0}}function Ax(r,e){let t=0,i=1e3/e,o,u;const h=(m,_=Date.now())=>{t=_,o=null,u&&(clearTimeout(u),u=null),r.apply(null,m)};return[(...m)=>{const _=Date.now(),L=_-t;L>=i?h(m,_):(o=m,u||(u=setTimeout(()=>{u=null,h(o)},i-L)))},()=>o&&h(o)]}const Hc=(r,e,t=3)=>{let i=0;const o=Sx(50,250);return Ax(u=>{const h=u.loaded,g=u.lengthComputable?u.total:void 0,T=h-i,m=o(T),_=h<=g;i=h;const L={loaded:h,total:g,progress:g?h/g:void 0,bytes:T,rate:m||void 0,estimated:m&&g&&_?(g-h)/m:void 0,event:u,lengthComputable:g!=null,[e?"download":"upload"]:!0};r(L)},t)},Ym=(r,e)=>{const t=r!=null;return[i=>e[0]({lengthComputable:t,total:r,loaded:i}),e[1]]},Qm=r=>(...e)=>Ae.asap(()=>r(...e)),Rx=xn.hasStandardBrowserEnv?((r,e)=>t=>(t=new URL(t,xn.origin),r.protocol===t.protocol&&r.host===t.host&&(e||r.port===t.port)))(new URL(xn.origin),xn.navigator&&/(msie|trident)/i.test(xn.navigator.userAgent)):()=>!0,Ix=xn.hasStandardBrowserEnv?{write(r,e,t,i,o,u){const h=[r+"="+encodeURIComponent(e)];Ae.isNumber(t)&&h.push("expires="+new Date(t).toGMTString()),Ae.isString(i)&&h.push("path="+i),Ae.isString(o)&&h.push("domain="+o),u===!0&&h.push("secure"),document.cookie=h.join("; ")},read(r){const e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Cx(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Px(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function Nv(r,e){return r&&!Cx(e)?Px(r,e):e}const Xm=r=>r instanceof jn?{...r}:r;function aa(r,e){e=e||{};const t={};function i(m,_,L,I){return Ae.isPlainObject(m)&&Ae.isPlainObject(_)?Ae.merge.call({caseless:I},m,_):Ae.isPlainObject(_)?Ae.merge({},_):Ae.isArray(_)?_.slice():_}function o(m,_,L,I){if(Ae.isUndefined(_)){if(!Ae.isUndefined(m))return i(void 0,m,L,I)}else return i(m,_,L,I)}function u(m,_){if(!Ae.isUndefined(_))return i(void 0,_)}function h(m,_){if(Ae.isUndefined(_)){if(!Ae.isUndefined(m))return i(void 0,m)}else return i(void 0,_)}function g(m,_,L){if(L in e)return i(m,_);if(L in r)return i(void 0,m)}const T={url:u,method:u,data:u,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:g,headers:(m,_,L)=>o(Xm(m),Xm(_),L,!0)};return Ae.forEach(Object.keys(Object.assign({},r,e)),function(_){const L=T[_]||o,I=L(r[_],e[_],_);Ae.isUndefined(I)&&L!==g||(t[_]=I)}),t}const Fv=r=>{const e=aa({},r);let{data:t,withXSRFToken:i,xsrfHeaderName:o,xsrfCookieName:u,headers:h,auth:g}=e;e.headers=h=jn.from(h),e.url=bv(Nv(e.baseURL,e.url),r.params,r.paramsSerializer),g&&h.set("Authorization","Basic "+btoa((g.username||"")+":"+(g.password?unescape(encodeURIComponent(g.password)):"")));let T;if(Ae.isFormData(t)){if(xn.hasStandardBrowserEnv||xn.hasStandardBrowserWebWorkerEnv)h.setContentType(void 0);else if((T=h.getContentType())!==!1){const[m,..._]=T?T.split(";").map(L=>L.trim()).filter(Boolean):[];h.setContentType([m||"multipart/form-data",..._].join("; "))}}if(xn.hasStandardBrowserEnv&&(i&&Ae.isFunction(i)&&(i=i(e)),i||i!==!1&&Rx(e.url))){const m=o&&u&&Ix.read(u);m&&h.set(o,m)}return e},bx=typeof XMLHttpRequest<"u",kx=bx&&function(r){return new Promise(function(t,i){const o=Fv(r);let u=o.data;const h=jn.from(o.headers).normalize();let{responseType:g,onUploadProgress:T,onDownloadProgress:m}=o,_,L,I,D,F;function N(){D&&D(),F&&F(),o.cancelToken&&o.cancelToken.unsubscribe(_),o.signal&&o.signal.removeEventListener("abort",_)}let U=new XMLHttpRequest;U.open(o.method.toUpperCase(),o.url,!0),U.timeout=o.timeout;function Y(){if(!U)return;const ce=jn.from("getAllResponseHeaders"in U&&U.getAllResponseHeaders()),me={data:!g||g==="text"||g==="json"?U.responseText:U.response,status:U.status,statusText:U.statusText,headers:ce,config:r,request:U};Ov(function(H){t(H),N()},function(H){i(H),N()},me),U=null}"onloadend"in U?U.onloadend=Y:U.onreadystatechange=function(){!U||U.readyState!==4||U.status===0&&!(U.responseURL&&U.responseURL.indexOf("file:")===0)||setTimeout(Y)},U.onabort=function(){U&&(i(new Ct("Request aborted",Ct.ECONNABORTED,r,U)),U=null)},U.onerror=function(){i(new Ct("Network Error",Ct.ERR_NETWORK,r,U)),U=null},U.ontimeout=function(){let fe=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const me=o.transitional||kv;o.timeoutErrorMessage&&(fe=o.timeoutErrorMessage),i(new Ct(fe,me.clarifyTimeoutError?Ct.ETIMEDOUT:Ct.ECONNABORTED,r,U)),U=null},u===void 0&&h.setContentType(null),"setRequestHeader"in U&&Ae.forEach(h.toJSON(),function(fe,me){U.setRequestHeader(me,fe)}),Ae.isUndefined(o.withCredentials)||(U.withCredentials=!!o.withCredentials),g&&g!=="json"&&(U.responseType=o.responseType),m&&([I,F]=Hc(m,!0),U.addEventListener("progress",I)),T&&U.upload&&([L,D]=Hc(T),U.upload.addEventListener("progress",L),U.upload.addEventListener("loadend",D)),(o.cancelToken||o.signal)&&(_=ce=>{U&&(i(!ce||ce.type?new cl(null,r,U):ce),U.abort(),U=null)},o.cancelToken&&o.cancelToken.subscribe(_),o.signal&&(o.signal.aborted?_():o.signal.addEventListener("abort",_)));const X=wx(o.url);if(X&&xn.protocols.indexOf(X)===-1){i(new Ct("Unsupported protocol "+X+":",Ct.ERR_BAD_REQUEST,r));return}U.send(u||null)})},Dx=(r,e)=>{const{length:t}=r=r?r.filter(Boolean):[];if(e||t){let i=new AbortController,o;const u=function(m){if(!o){o=!0,g();const _=m instanceof Error?m:this.reason;i.abort(_ instanceof Ct?_:new cl(_ instanceof Error?_.message:_))}};let h=e&&setTimeout(()=>{h=null,u(new Ct(`timeout ${e} of ms exceeded`,Ct.ETIMEDOUT))},e);const g=()=>{r&&(h&&clearTimeout(h),h=null,r.forEach(m=>{m.unsubscribe?m.unsubscribe(u):m.removeEventListener("abort",u)}),r=null)};r.forEach(m=>m.addEventListener("abort",u));const{signal:T}=i;return T.unsubscribe=()=>Ae.asap(g),T}},Lx=function*(r,e){let t=r.byteLength;if(t<e){yield r;return}let i=0,o;for(;i<t;)o=i+e,yield r.slice(i,o),i=o},Ox=async function*(r,e){for await(const t of Nx(r))yield*Lx(t,e)},Nx=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const e=r.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},Jm=(r,e,t,i)=>{const o=Ox(r,e);let u=0,h,g=T=>{h||(h=!0,i&&i(T))};return new ReadableStream({async pull(T){try{const{done:m,value:_}=await o.next();if(m){g(),T.close();return}let L=_.byteLength;if(t){let I=u+=L;t(I)}T.enqueue(new Uint8Array(_))}catch(m){throw g(m),m}},cancel(T){return g(T),o.return()}},{highWaterMark:2})},df=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Mv=df&&typeof ReadableStream=="function",Fx=df&&(typeof TextEncoder=="function"?(r=>e=>r.encode(e))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),Uv=(r,...e)=>{try{return!!r(...e)}catch{return!1}},Mx=Mv&&Uv(()=>{let r=!1;const e=new Request(xn.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!e}),Zm=64*1024,Ad=Mv&&Uv(()=>Ae.isReadableStream(new Response("").body)),$c={stream:Ad&&(r=>r.body)};df&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!$c[e]&&($c[e]=Ae.isFunction(r[e])?t=>t[e]():(t,i)=>{throw new Ct(`Response type '${e}' is not supported`,Ct.ERR_NOT_SUPPORT,i)})})})(new Response);const Ux=async r=>{if(r==null)return 0;if(Ae.isBlob(r))return r.size;if(Ae.isSpecCompliantForm(r))return(await new Request(xn.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(Ae.isArrayBufferView(r)||Ae.isArrayBuffer(r))return r.byteLength;if(Ae.isURLSearchParams(r)&&(r=r+""),Ae.isString(r))return(await Fx(r)).byteLength},Vx=async(r,e)=>{const t=Ae.toFiniteNumber(r.getContentLength());return t??Ux(e)},Bx=df&&(async r=>{let{url:e,method:t,data:i,signal:o,cancelToken:u,timeout:h,onDownloadProgress:g,onUploadProgress:T,responseType:m,headers:_,withCredentials:L="same-origin",fetchOptions:I}=Fv(r);m=m?(m+"").toLowerCase():"text";let D=Dx([o,u&&u.toAbortSignal()],h),F;const N=D&&D.unsubscribe&&(()=>{D.unsubscribe()});let U;try{if(T&&Mx&&t!=="get"&&t!=="head"&&(U=await Vx(_,i))!==0){let me=new Request(e,{method:"POST",body:i,duplex:"half"}),we;if(Ae.isFormData(i)&&(we=me.headers.get("content-type"))&&_.setContentType(we),me.body){const[H,B]=Ym(U,Hc(Qm(T)));i=Jm(me.body,Zm,H,B)}}Ae.isString(L)||(L=L?"include":"omit");const Y="credentials"in Request.prototype;F=new Request(e,{...I,signal:D,method:t.toUpperCase(),headers:_.normalize().toJSON(),body:i,duplex:"half",credentials:Y?L:void 0});let X=await fetch(F);const ce=Ad&&(m==="stream"||m==="response");if(Ad&&(g||ce&&N)){const me={};["status","statusText","headers"].forEach(z=>{me[z]=X[z]});const we=Ae.toFiniteNumber(X.headers.get("content-length")),[H,B]=g&&Ym(we,Hc(Qm(g),!0))||[];X=new Response(Jm(X.body,Zm,H,()=>{B&&B(),N&&N()}),me)}m=m||"text";let fe=await $c[Ae.findKey($c,m)||"text"](X,r);return!ce&&N&&N(),await new Promise((me,we)=>{Ov(me,we,{data:fe,headers:jn.from(X.headers),status:X.status,statusText:X.statusText,config:r,request:F})})}catch(Y){throw N&&N(),Y&&Y.name==="TypeError"&&/fetch/i.test(Y.message)?Object.assign(new Ct("Network Error",Ct.ERR_NETWORK,r,F),{cause:Y.cause||Y}):Ct.from(Y,Y&&Y.code,r,F)}}),Rd={http:tx,xhr:kx,fetch:Bx};Ae.forEach(Rd,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const e0=r=>`- ${r}`,jx=r=>Ae.isFunction(r)||r===null||r===!1,Vv={getAdapter:r=>{r=Ae.isArray(r)?r:[r];const{length:e}=r;let t,i;const o={};for(let u=0;u<e;u++){t=r[u];let h;if(i=t,!jx(t)&&(i=Rd[(h=String(t)).toLowerCase()],i===void 0))throw new Ct(`Unknown adapter '${h}'`);if(i)break;o[h||"#"+u]=i}if(!i){const u=Object.entries(o).map(([g,T])=>`adapter ${g} `+(T===!1?"is not supported by the environment":"is not available in the build"));let h=e?u.length>1?`since :
`+u.map(e0).join(`
`):" "+e0(u[0]):"as no adapter specified";throw new Ct("There is no suitable adapter to dispatch the request "+h,"ERR_NOT_SUPPORT")}return i},adapters:Rd};function ld(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new cl(null,r)}function t0(r){return ld(r),r.headers=jn.from(r.headers),r.data=ad.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),Vv.getAdapter(r.adapter||hu.adapter)(r).then(function(i){return ld(r),i.data=ad.call(r,r.transformResponse,i),i.headers=jn.from(i.headers),i},function(i){return Lv(i)||(ld(r),i&&i.response&&(i.response.data=ad.call(r,r.transformResponse,i.response),i.response.headers=jn.from(i.response.headers))),Promise.reject(i)})}const Bv="1.7.9",pf={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{pf[r]=function(i){return typeof i===r||"a"+(e<1?"n ":" ")+r}});const r0={};pf.transitional=function(e,t,i){function o(u,h){return"[Axios v"+Bv+"] Transitional option '"+u+"'"+h+(i?". "+i:"")}return(u,h,g)=>{if(e===!1)throw new Ct(o(h," has been removed"+(t?" in "+t:"")),Ct.ERR_DEPRECATED);return t&&!r0[h]&&(r0[h]=!0,console.warn(o(h," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(u,h,g):!0}};pf.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function zx(r,e,t){if(typeof r!="object")throw new Ct("options must be an object",Ct.ERR_BAD_OPTION_VALUE);const i=Object.keys(r);let o=i.length;for(;o-- >0;){const u=i[o],h=e[u];if(h){const g=r[u],T=g===void 0||h(g,u,r);if(T!==!0)throw new Ct("option "+u+" must be "+T,Ct.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Ct("Unknown option "+u,Ct.ERR_BAD_OPTION)}}const Dc={assertOptions:zx,validators:pf},ss=Dc.validators;class sa{constructor(e){this.defaults=e,this.interceptors={request:new Wm,response:new Wm}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const u=o.stack?o.stack.replace(/^.+\n/,""):"";try{i.stack?u&&!String(i.stack).endsWith(u.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+u):i.stack=u}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=aa(this.defaults,t);const{transitional:i,paramsSerializer:o,headers:u}=t;i!==void 0&&Dc.assertOptions(i,{silentJSONParsing:ss.transitional(ss.boolean),forcedJSONParsing:ss.transitional(ss.boolean),clarifyTimeoutError:ss.transitional(ss.boolean)},!1),o!=null&&(Ae.isFunction(o)?t.paramsSerializer={serialize:o}:Dc.assertOptions(o,{encode:ss.function,serialize:ss.function},!0)),Dc.assertOptions(t,{baseUrl:ss.spelling("baseURL"),withXsrfToken:ss.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let h=u&&Ae.merge(u.common,u[t.method]);u&&Ae.forEach(["delete","get","head","post","put","patch","common"],F=>{delete u[F]}),t.headers=jn.concat(h,u);const g=[];let T=!0;this.interceptors.request.forEach(function(N){typeof N.runWhen=="function"&&N.runWhen(t)===!1||(T=T&&N.synchronous,g.unshift(N.fulfilled,N.rejected))});const m=[];this.interceptors.response.forEach(function(N){m.push(N.fulfilled,N.rejected)});let _,L=0,I;if(!T){const F=[t0.bind(this),void 0];for(F.unshift.apply(F,g),F.push.apply(F,m),I=F.length,_=Promise.resolve(t);L<I;)_=_.then(F[L++],F[L++]);return _}I=g.length;let D=t;for(L=0;L<I;){const F=g[L++],N=g[L++];try{D=F(D)}catch(U){N.call(this,U);break}}try{_=t0.call(this,D)}catch(F){return Promise.reject(F)}for(L=0,I=m.length;L<I;)_=_.then(m[L++],m[L++]);return _}getUri(e){e=aa(this.defaults,e);const t=Nv(e.baseURL,e.url);return bv(t,e.params,e.paramsSerializer)}}Ae.forEach(["delete","get","head","options"],function(e){sa.prototype[e]=function(t,i){return this.request(aa(i||{},{method:e,url:t,data:(i||{}).data}))}});Ae.forEach(["post","put","patch"],function(e){function t(i){return function(u,h,g){return this.request(aa(g||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:u,data:h}))}}sa.prototype[e]=t(),sa.prototype[e+"Form"]=t(!0)});class op{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(u){t=u});const i=this;this.promise.then(o=>{if(!i._listeners)return;let u=i._listeners.length;for(;u-- >0;)i._listeners[u](o);i._listeners=null}),this.promise.then=o=>{let u;const h=new Promise(g=>{i.subscribe(g),u=g}).then(o);return h.cancel=function(){i.unsubscribe(u)},h},e(function(u,h,g){i.reason||(i.reason=new cl(u,h,g),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new op(function(o){e=o}),cancel:e}}}function Gx(r){return function(t){return r.apply(null,t)}}function Kx(r){return Ae.isObject(r)&&r.isAxiosError===!0}const Id={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Id).forEach(([r,e])=>{Id[e]=r});function jv(r){const e=new sa(r),t=yv(sa.prototype.request,e);return Ae.extend(t,sa.prototype,e,{allOwnKeys:!0}),Ae.extend(t,e,null,{allOwnKeys:!0}),t.create=function(o){return jv(aa(r,o))},t}const Br=jv(hu);Br.Axios=sa;Br.CanceledError=cl;Br.CancelToken=op;Br.isCancel=Lv;Br.VERSION=Bv;Br.toFormData=hf;Br.AxiosError=Ct;Br.Cancel=Br.CanceledError;Br.all=function(e){return Promise.all(e)};Br.spread=Gx;Br.isAxiosError=Kx;Br.mergeConfig=aa;Br.AxiosHeaders=jn;Br.formToJSON=r=>Dv(Ae.isHTMLForm(r)?new FormData(r):r);Br.getAdapter=Vv.getAdapter;Br.HttpStatusCode=Id;Br.default=Br;const Tc=Br.create({baseURL:"http://localhost:5001/api",withCredentials:!0});let Hx={data:""},$x=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||Hx,Wx=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,qx=/\/\*[^]*?\*\/|  +/g,n0=/\n+/g,_o=(r,e)=>{let t="",i="",o="";for(let u in r){let h=r[u];u[0]=="@"?u[1]=="i"?t=u+" "+h+";":i+=u[1]=="f"?_o(h,u):u+"{"+_o(h,u[1]=="k"?"":e)+"}":typeof h=="object"?i+=_o(h,e?e.replace(/([^,])+/g,g=>u.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,T=>/&/.test(T)?T.replace(/&/g,g):g?g+" "+T:T)):u):h!=null&&(u=/^--/.test(u)?u:u.replace(/[A-Z]/g,"-$&").toLowerCase(),o+=_o.p?_o.p(u,h):u+":"+h+";")}return t+(e&&o?e+"{"+o+"}":o)+i},Ds={},zv=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+zv(r[t]);return e}return r},Yx=(r,e,t,i,o)=>{let u=zv(r),h=Ds[u]||(Ds[u]=(T=>{let m=0,_=11;for(;m<T.length;)_=101*_+T.charCodeAt(m++)>>>0;return"go"+_})(u));if(!Ds[h]){let T=u!==r?r:(m=>{let _,L,I=[{}];for(;_=Wx.exec(m.replace(qx,""));)_[4]?I.shift():_[3]?(L=_[3].replace(n0," ").trim(),I.unshift(I[0][L]=I[0][L]||{})):I[0][_[1]]=_[2].replace(n0," ").trim();return I[0]})(r);Ds[h]=_o(o?{["@keyframes "+h]:T}:T,t?"":"."+h)}let g=t&&Ds.g?Ds.g:null;return t&&(Ds.g=Ds[h]),((T,m,_,L)=>{L?m.data=m.data.replace(L,T):m.data.indexOf(T)===-1&&(m.data=_?T+m.data:m.data+T)})(Ds[h],e,i,g),h},Qx=(r,e,t)=>r.reduce((i,o,u)=>{let h=e[u];if(h&&h.call){let g=h(t),T=g&&g.props&&g.props.className||/^go/.test(g)&&g;h=T?"."+T:g&&typeof g=="object"?g.props?"":_o(g,""):g===!1?"":g}return i+o+(h??"")},"");function gf(r){let e=this||{},t=r.call?r(e.p):r;return Yx(t.unshift?t.raw?Qx(t,[].slice.call(arguments,1),e.p):t.reduce((i,o)=>Object.assign(i,o&&o.call?o(e.p):o),{}):t,$x(e.target),e.g,e.o,e.k)}let Gv,Cd,Pd;gf.bind({g:1});let Fs=gf.bind({k:1});function Xx(r,e,t,i){_o.p=e,Gv=r,Cd=t,Pd=i}function Do(r,e){let t=this||{};return function(){let i=arguments;function o(u,h){let g=Object.assign({},u),T=g.className||o.className;t.p=Object.assign({theme:Cd&&Cd()},g),t.o=/ *go\d+/.test(T),g.className=gf.apply(t,i)+(T?" "+T:"");let m=r;return r[0]&&(m=g.as||r,delete g.as),Pd&&m[0]&&Pd(g),Gv(m,g)}return o}}var Jx=r=>typeof r=="function",Wc=(r,e)=>Jx(r)?r(e):r,Zx=(()=>{let r=0;return()=>(++r).toString()})(),Kv=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");r=!e||e.matches}return r}})(),ew=20,Lc=new Map,tw=1e3,i0=r=>{if(Lc.has(r))return;let e=setTimeout(()=>{Lc.delete(r),fa({type:4,toastId:r})},tw);Lc.set(r,e)},rw=r=>{let e=Lc.get(r);e&&clearTimeout(e)},bd=(r,e)=>{switch(e.type){case 0:return{...r,toasts:[e.toast,...r.toasts].slice(0,ew)};case 1:return e.toast.id&&rw(e.toast.id),{...r,toasts:r.toasts.map(u=>u.id===e.toast.id?{...u,...e.toast}:u)};case 2:let{toast:t}=e;return r.toasts.find(u=>u.id===t.id)?bd(r,{type:1,toast:t}):bd(r,{type:0,toast:t});case 3:let{toastId:i}=e;return i?i0(i):r.toasts.forEach(u=>{i0(u.id)}),{...r,toasts:r.toasts.map(u=>u.id===i||i===void 0?{...u,visible:!1}:u)};case 4:return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(u=>u.id!==e.toastId)};case 5:return{...r,pausedAt:e.time};case 6:let o=e.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(u=>({...u,pauseDuration:u.pauseDuration+o}))}}},Oc=[],Nc={toasts:[],pausedAt:void 0},fa=r=>{Nc=bd(Nc,r),Oc.forEach(e=>{e(Nc)})},nw={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},iw=(r={})=>{let[e,t]=pe.useState(Nc);pe.useEffect(()=>(Oc.push(t),()=>{let o=Oc.indexOf(t);o>-1&&Oc.splice(o,1)}),[e]);let i=e.toasts.map(o=>{var u,h;return{...r,...r[o.type],...o,duration:o.duration||((u=r[o.type])==null?void 0:u.duration)||(r==null?void 0:r.duration)||nw[o.type],style:{...r.style,...(h=r[o.type])==null?void 0:h.style,...o.style}}});return{...e,toasts:i}},sw=(r,e="blank",t)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Zx()}),du=r=>(e,t)=>{let i=sw(e,r,t);return fa({type:2,toast:i}),i.id},ii=(r,e)=>du("blank")(r,e);ii.error=du("error");ii.success=du("success");ii.loading=du("loading");ii.custom=du("custom");ii.dismiss=r=>{fa({type:3,toastId:r})};ii.remove=r=>fa({type:4,toastId:r});ii.promise=(r,e,t)=>{let i=ii.loading(e.loading,{...t,...t==null?void 0:t.loading});return r.then(o=>(ii.success(Wc(e.success,o),{id:i,...t,...t==null?void 0:t.success}),o)).catch(o=>{ii.error(Wc(e.error,o),{id:i,...t,...t==null?void 0:t.error})}),r};var ow=(r,e)=>{fa({type:1,toast:{id:r,height:e}})},aw=()=>{fa({type:5,time:Date.now()})},lw=r=>{let{toasts:e,pausedAt:t}=iw(r);pe.useEffect(()=>{if(t)return;let u=Date.now(),h=e.map(g=>{if(g.duration===1/0)return;let T=(g.duration||0)+g.pauseDuration-(u-g.createdAt);if(T<0){g.visible&&ii.dismiss(g.id);return}return setTimeout(()=>ii.dismiss(g.id),T)});return()=>{h.forEach(g=>g&&clearTimeout(g))}},[e,t]);let i=pe.useCallback(()=>{t&&fa({type:6,time:Date.now()})},[t]),o=pe.useCallback((u,h)=>{let{reverseOrder:g=!1,gutter:T=8,defaultPosition:m}=h||{},_=e.filter(D=>(D.position||m)===(u.position||m)&&D.height),L=_.findIndex(D=>D.id===u.id),I=_.filter((D,F)=>F<L&&D.visible).length;return _.filter(D=>D.visible).slice(...g?[I+1]:[0,I]).reduce((D,F)=>D+(F.height||0)+T,0)},[e]);return{toasts:e,handlers:{updateHeight:ow,startPause:aw,endPause:i,calculateOffset:o}}},uw=Fs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,cw=Fs`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,fw=Fs`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,hw=Do("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${uw} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${cw} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${fw} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,dw=Fs`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,pw=Do("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${dw} 1s linear infinite;
`,gw=Fs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,mw=Fs`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,vw=Do("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${gw} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${mw} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,yw=Do("div")`
  position: absolute;
`,_w=Do("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Ew=Fs`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Tw=Do("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Ew} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,xw=({toast:r})=>{let{icon:e,type:t,iconTheme:i}=r;return e!==void 0?typeof e=="string"?pe.createElement(Tw,null,e):e:t==="blank"?null:pe.createElement(_w,null,pe.createElement(pw,{...i}),t!=="loading"&&pe.createElement(yw,null,t==="error"?pe.createElement(hw,{...i}):pe.createElement(vw,{...i})))},ww=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Sw=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,Aw="0%{opacity:0;} 100%{opacity:1;}",Rw="0%{opacity:1;} 100%{opacity:0;}",Iw=Do("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Cw=Do("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Pw=(r,e)=>{let t=r.includes("top")?1:-1,[i,o]=Kv()?[Aw,Rw]:[ww(t),Sw(t)];return{animation:e?`${Fs(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Fs(o)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},bw=pe.memo(({toast:r,position:e,style:t,children:i})=>{let o=r.height?Pw(r.position||e||"top-center",r.visible):{opacity:0},u=pe.createElement(xw,{toast:r}),h=pe.createElement(Cw,{...r.ariaProps},Wc(r.message,r));return pe.createElement(Iw,{className:r.className,style:{...o,...t,...r.style}},typeof i=="function"?i({icon:u,message:h}):pe.createElement(pe.Fragment,null,u,h))});Xx(pe.createElement);var kw=({id:r,className:e,style:t,onHeightUpdate:i,children:o})=>{let u=pe.useCallback(h=>{if(h){let g=()=>{let T=h.getBoundingClientRect().height;i(r,T)};g(),new MutationObserver(g).observe(h,{subtree:!0,childList:!0,characterData:!0})}},[r,i]);return pe.createElement("div",{ref:u,className:e,style:t},o)},Dw=(r,e)=>{let t=r.includes("top"),i=t?{top:0}:{bottom:0},o=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Kv()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...i,...o}},Lw=gf`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,xc=16,Ow=({reverseOrder:r,position:e="top-center",toastOptions:t,gutter:i,children:o,containerStyle:u,containerClassName:h})=>{let{toasts:g,handlers:T}=lw(t);return pe.createElement("div",{style:{position:"fixed",zIndex:9999,top:xc,left:xc,right:xc,bottom:xc,pointerEvents:"none",...u},className:h,onMouseEnter:T.startPause,onMouseLeave:T.endPause},g.map(m=>{let _=m.position||e,L=T.calculateOffset(m,{reverseOrder:r,gutter:i,defaultPosition:e}),I=Dw(_,L);return pe.createElement(kw,{id:m.id,key:m.id,onHeightUpdate:T.updateHeight,className:m.visible?Lw:"",style:I},m.type==="custom"?Wc(m.message,m):o?o(m):pe.createElement(bw,{toast:m,position:_}))}))},Oi=ii;const pu=gT(r=>({authUser:null,isSigningUp:!1,isLoggingIn:!1,isUpdatingProfile:!1,isCheckingAuth:!0,checkAuth:async()=>{try{const e=await Tc.get("/auth/check");r({authUser:e.data})}catch(e){console.log("Error in checkAuth:",e),r({authUser:null})}finally{r({isCheckingAuth:!1})}},signup:async e=>{r({isSigningUp:!0});try{const t=await Tc.post("/auth/signup",e);r({authUser:t.data}),Oi.success("Account created successfully")}catch(t){Oi.error(t.response.data.message)}finally{r({isSigningUp:!1})}},login:async e=>{r({isLoggingIn:!0});try{const t=await Tc.post("/auth/login",e);r({authUser:t.data}),Oi.success("Logged in successfully")}catch(t){Oi.error(t.response.data.message)}finally{r({isLoggingIn:!1})}},logout:async()=>{try{await Tc.post("/auth/logout"),r({authUser:null}),Oi.success("logged out successfully")}catch(e){Oi.error(e.response.data.message)}}}));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Hv=(...r)=>r.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=pe.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:o="",children:u,iconNode:h,...g},T)=>pe.createElement("svg",{ref:T,...Fw,width:e,height:e,stroke:r,strokeWidth:i?Number(t)*24/Number(e):t,className:Hv("lucide",o),...g},[...h.map(([m,_])=>pe.createElement(m,_)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=(r,e)=>{const t=pe.forwardRef(({className:i,...o},u)=>pe.createElement(Mw,{ref:u,iconNode:e,className:Hv(`lucide-${Nw(r)}`,i),...o}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=xi("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=xi("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=xi("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=xi("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=xi("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qv=xi("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=xi("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=xi("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=xi("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=xi("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=xi("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=xi("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);var Kl={},s0;function Gw(){if(s0)return Kl;s0=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.parse=h,Kl.serialize=m;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,u=(()=>{const I=function(){};return I.prototype=Object.create(null),I})();function h(I,D){const F=new u,N=I.length;if(N<2)return F;const U=(D==null?void 0:D.decode)||_;let Y=0;do{const X=I.indexOf("=",Y);if(X===-1)break;const ce=I.indexOf(";",Y),fe=ce===-1?N:ce;if(X>fe){Y=I.lastIndexOf(";",X-1)+1;continue}const me=g(I,Y,X),we=T(I,X,me),H=I.slice(me,we);if(F[H]===void 0){let B=g(I,X+1,fe),z=T(I,fe,B);const Q=U(I.slice(B,z));F[H]=Q}Y=fe+1}while(Y<N);return F}function g(I,D,F){do{const N=I.charCodeAt(D);if(N!==32&&N!==9)return D}while(++D<F);return F}function T(I,D,F){for(;D>F;){const N=I.charCodeAt(--D);if(N!==32&&N!==9)return D+1}return F}function m(I,D,F){const N=(F==null?void 0:F.encode)||encodeURIComponent;if(!r.test(I))throw new TypeError(`argument name is invalid: ${I}`);const U=N(D);if(!e.test(U))throw new TypeError(`argument val is invalid: ${D}`);let Y=I+"="+U;if(!F)return Y;if(F.maxAge!==void 0){if(!Number.isInteger(F.maxAge))throw new TypeError(`option maxAge is invalid: ${F.maxAge}`);Y+="; Max-Age="+F.maxAge}if(F.domain){if(!t.test(F.domain))throw new TypeError(`option domain is invalid: ${F.domain}`);Y+="; Domain="+F.domain}if(F.path){if(!i.test(F.path))throw new TypeError(`option path is invalid: ${F.path}`);Y+="; Path="+F.path}if(F.expires){if(!L(F.expires)||!Number.isFinite(F.expires.valueOf()))throw new TypeError(`option expires is invalid: ${F.expires}`);Y+="; Expires="+F.expires.toUTCString()}if(F.httpOnly&&(Y+="; HttpOnly"),F.secure&&(Y+="; Secure"),F.partitioned&&(Y+="; Partitioned"),F.priority)switch(typeof F.priority=="string"?F.priority.toLowerCase():void 0){case"low":Y+="; Priority=Low";break;case"medium":Y+="; Priority=Medium";break;case"high":Y+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${F.priority}`)}if(F.sameSite)switch(typeof F.sameSite=="string"?F.sameSite.toLowerCase():F.sameSite){case!0:case"strict":Y+="; SameSite=Strict";break;case"lax":Y+="; SameSite=Lax";break;case"none":Y+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${F.sameSite}`)}return Y}function _(I){if(I.indexOf("%")===-1)return I;try{return decodeURIComponent(I)}catch{return I}}function L(I){return o.call(I)==="[object Date]"}return Kl}Gw();/**
 * react-router v7.0.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var o0="popstate";function Kw(r={}){function e(i,o){let{pathname:u,search:h,hash:g}=i.location;return kd("",{pathname:u,search:h,hash:g},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(i,o){return typeof o=="string"?o:iu(o)}return $w(e,t,null,r)}function hr(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function Ti(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Hw(){return Math.random().toString(36).substring(2,10)}function a0(r,e){return{usr:r.state,key:r.key,idx:e}}function kd(r,e,t=null,i){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?fl(e):e,state:t,key:e&&e.key||i||Hw()}}function iu({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function fl(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let i=r.indexOf("?");i>=0&&(e.search=r.substring(i),r=r.substring(0,i)),r&&(e.pathname=r)}return e}function $w(r,e,t,i={}){let{window:o=document.defaultView,v5Compat:u=!1}=i,h=o.history,g="POP",T=null,m=_();m==null&&(m=0,h.replaceState({...h.state,idx:m},""));function _(){return(h.state||{idx:null}).idx}function L(){g="POP";let U=_(),Y=U==null?null:U-m;m=U,T&&T({action:g,location:N.location,delta:Y})}function I(U,Y){g="PUSH";let X=kd(N.location,U,Y);m=_()+1;let ce=a0(X,m),fe=N.createHref(X);try{h.pushState(ce,"",fe)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;o.location.assign(fe)}u&&T&&T({action:g,location:N.location,delta:1})}function D(U,Y){g="REPLACE";let X=kd(N.location,U,Y);m=_();let ce=a0(X,m),fe=N.createHref(X);h.replaceState(ce,"",fe),u&&T&&T({action:g,location:N.location,delta:0})}function F(U){let Y=o.location.origin!=="null"?o.location.origin:o.location.href,X=typeof U=="string"?U:iu(U);return X=X.replace(/ $/,"%20"),hr(Y,`No window.location.(origin|href) available to create URL for href: ${X}`),new URL(X,Y)}let N={get action(){return g},get location(){return r(o,h)},listen(U){if(T)throw new Error("A history only accepts one active listener");return o.addEventListener(o0,L),T=U,()=>{o.removeEventListener(o0,L),T=null}},createHref(U){return e(o,U)},createURL:F,encodeLocation(U){let Y=F(U);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:I,replace:D,go(U){return h.go(U)}};return N}function Jv(r,e,t="/"){return Ww(r,e,t,!1)}function Ww(r,e,t,i){let o=typeof e=="string"?fl(e):e,u=Ao(o.pathname||"/",t);if(u==null)return null;let h=Zv(r);qw(h);let g=null;for(let T=0;g==null&&T<h.length;++T){let m=sS(u);g=nS(h[T],m,i)}return g}function Zv(r,e=[],t=[],i=""){let o=(u,h,g)=>{let T={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};T.relativePath.startsWith("/")&&(hr(T.relativePath.startsWith(i),`Absolute route path "${T.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),T.relativePath=T.relativePath.slice(i.length));let m=Ls([i,T.relativePath]),_=t.concat(T);u.children&&u.children.length>0&&(hr(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Zv(u.children,e,_,m)),!(u.path==null&&!u.index)&&e.push({path:m,score:tS(m,u.index),routesMeta:_})};return r.forEach((u,h)=>{var g;if(u.path===""||!((g=u.path)!=null&&g.includes("?")))o(u,h);else for(let T of ey(u.path))o(u,h,T)}),e}function ey(r){let e=r.split("/");if(e.length===0)return[];let[t,...i]=e,o=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return o?[u,""]:[u];let h=ey(i.join("/")),g=[];return g.push(...h.map(T=>T===""?u:[u,T].join("/"))),o&&g.push(...h),g.map(T=>r.startsWith("/")&&T===""?"/":T)}function qw(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:rS(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var Yw=/^:[\w-]+$/,Qw=3,Xw=2,Jw=1,Zw=10,eS=-2,l0=r=>r==="*";function tS(r,e){let t=r.split("/"),i=t.length;return t.some(l0)&&(i+=eS),e&&(i+=Xw),t.filter(o=>!l0(o)).reduce((o,u)=>o+(Yw.test(u)?Qw:u===""?Jw:Zw),i)}function rS(r,e){return r.length===e.length&&r.slice(0,-1).every((i,o)=>i===e[o])?r[r.length-1]-e[e.length-1]:0}function nS(r,e,t=!1){let{routesMeta:i}=r,o={},u="/",h=[];for(let g=0;g<i.length;++g){let T=i[g],m=g===i.length-1,_=u==="/"?e:e.slice(u.length)||"/",L=qc({path:T.relativePath,caseSensitive:T.caseSensitive,end:m},_),I=T.route;if(!L&&m&&t&&!i[i.length-1].route.index&&(L=qc({path:T.relativePath,caseSensitive:T.caseSensitive,end:!1},_)),!L)return null;Object.assign(o,L.params),h.push({params:o,pathname:Ls([u,L.pathname]),pathnameBase:uS(Ls([u,L.pathnameBase])),route:I}),L.pathnameBase!=="/"&&(u=Ls([u,L.pathnameBase]))}return h}function qc(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,i]=iS(r.path,r.caseSensitive,r.end),o=e.match(t);if(!o)return null;let u=o[0],h=u.replace(/(.)\/+$/,"$1"),g=o.slice(1);return{params:i.reduce((m,{paramName:_,isOptional:L},I)=>{if(_==="*"){let F=g[I]||"";h=u.slice(0,u.length-F.length).replace(/(.)\/+$/,"$1")}const D=g[I];return L&&!D?m[_]=void 0:m[_]=(D||"").replace(/%2F/g,"/"),m},{}),pathname:u,pathnameBase:h,pattern:r}}function iS(r,e=!1,t=!0){Ti(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let i=[],o="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,g,T)=>(i.push({paramName:g,isOptional:T!=null}),T?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(i.push({paramName:"*"}),o+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":r!==""&&r!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function sS(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ti(!1,`The URL path "${r}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function Ao(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=r.charAt(t);return i&&i!=="/"?null:r.slice(t)||"/"}function oS(r,e="/"){let{pathname:t,search:i="",hash:o=""}=typeof r=="string"?fl(r):r;return{pathname:t?t.startsWith("/")?t:aS(t,e):e,search:cS(i),hash:fS(o)}}function aS(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function ud(r,e,t,i){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function lS(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function lp(r){let e=lS(r);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function up(r,e,t,i=!1){let o;typeof r=="string"?o=fl(r):(o={...r},hr(!o.pathname||!o.pathname.includes("?"),ud("?","pathname","search",o)),hr(!o.pathname||!o.pathname.includes("#"),ud("#","pathname","hash",o)),hr(!o.search||!o.search.includes("#"),ud("#","search","hash",o)));let u=r===""||o.pathname==="",h=u?"/":o.pathname,g;if(h==null)g=t;else{let L=e.length-1;if(!i&&h.startsWith("..")){let I=h.split("/");for(;I[0]==="..";)I.shift(),L-=1;o.pathname=I.join("/")}g=L>=0?e[L]:"/"}let T=oS(o,g),m=h&&h!=="/"&&h.endsWith("/"),_=(u||h===".")&&t.endsWith("/");return!T.pathname.endsWith("/")&&(m||_)&&(T.pathname+="/"),T}var Ls=r=>r.join("/").replace(/\/\/+/g,"/"),uS=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),cS=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,fS=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function hS(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var ty=["POST","PUT","PATCH","DELETE"];new Set(ty);var dS=["GET",...ty];new Set(dS);var hl=pe.createContext(null);hl.displayName="DataRouter";var mf=pe.createContext(null);mf.displayName="DataRouterState";var ry=pe.createContext({isTransitioning:!1});ry.displayName="ViewTransition";var pS=pe.createContext(new Map);pS.displayName="Fetchers";var gS=pe.createContext(null);gS.displayName="Await";var Mi=pe.createContext(null);Mi.displayName="Navigation";var gu=pe.createContext(null);gu.displayName="Location";var Ui=pe.createContext({outlet:null,matches:[],isDataRoute:!1});Ui.displayName="Route";var cp=pe.createContext(null);cp.displayName="RouteError";function mS(r,{relative:e}={}){hr(dl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=pe.useContext(Mi),{hash:o,pathname:u,search:h}=mu(r,{relative:e}),g=u;return t!=="/"&&(g=u==="/"?t:Ls([t,u])),i.createHref({pathname:g,search:h,hash:o})}function dl(){return pe.useContext(gu)!=null}function js(){return hr(dl(),"useLocation() may be used only in the context of a <Router> component."),pe.useContext(gu).location}var ny="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function iy(r){pe.useContext(Mi).static||pe.useLayoutEffect(r)}function vf(){let{isDataRoute:r}=pe.useContext(Ui);return r?bS():vS()}function vS(){hr(dl(),"useNavigate() may be used only in the context of a <Router> component.");let r=pe.useContext(hl),{basename:e,navigator:t}=pe.useContext(Mi),{matches:i}=pe.useContext(Ui),{pathname:o}=js(),u=JSON.stringify(lp(i)),h=pe.useRef(!1);return iy(()=>{h.current=!0}),pe.useCallback((T,m={})=>{if(Ti(h.current,ny),!h.current)return;if(typeof T=="number"){t.go(T);return}let _=up(T,JSON.parse(u),o,m.relative==="path");r==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Ls([e,_.pathname])),(m.replace?t.replace:t.push)(_,m.state,m)},[e,t,u,o,r])}pe.createContext(null);function yS(){let{matches:r}=pe.useContext(Ui),e=r[r.length-1];return e?e.params:{}}function mu(r,{relative:e}={}){let{matches:t}=pe.useContext(Ui),{pathname:i}=js(),o=JSON.stringify(lp(t));return pe.useMemo(()=>up(r,JSON.parse(o),i,e==="path"),[r,o,i,e])}function _S(r,e){return sy(r,e)}function sy(r,e,t,i){var Y;hr(dl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=pe.useContext(Mi),{matches:u}=pe.useContext(Ui),h=u[u.length-1],g=h?h.params:{},T=h?h.pathname:"/",m=h?h.pathnameBase:"/",_=h&&h.route;{let X=_&&_.path||"";oy(T,!_||X.endsWith("*")||X.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${T}" (under <Route path="${X}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${X}"> to <Route path="${X==="/"?"*":`${X}/*`}">.`)}let L=js(),I;if(e){let X=typeof e=="string"?fl(e):e;hr(m==="/"||((Y=X.pathname)==null?void 0:Y.startsWith(m)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${X.pathname}" was given in the \`location\` prop.`),I=X}else I=L;let D=I.pathname||"/",F=D;if(m!=="/"){let X=m.replace(/^\//,"").split("/");F="/"+D.replace(/^\//,"").split("/").slice(X.length).join("/")}let N=Jv(r,{pathname:F});Ti(_||N!=null,`No routes matched location "${I.pathname}${I.search}${I.hash}" `),Ti(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${I.pathname}${I.search}${I.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let U=SS(N&&N.map(X=>Object.assign({},X,{params:Object.assign({},g,X.params),pathname:Ls([m,o.encodeLocation?o.encodeLocation(X.pathname).pathname:X.pathname]),pathnameBase:X.pathnameBase==="/"?m:Ls([m,o.encodeLocation?o.encodeLocation(X.pathnameBase).pathname:X.pathnameBase])})),u,t,i);return e&&U?pe.createElement(gu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...I},navigationType:"POP"}},U):U}function ES(){let r=PS(),e=hS(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},h=null;return console.error("Error handled by React Router default ErrorBoundary:",r),h=pe.createElement(pe.Fragment,null,pe.createElement("p",null," Hey developer "),pe.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",pe.createElement("code",{style:u},"ErrorBoundary")," or"," ",pe.createElement("code",{style:u},"errorElement")," prop on your route.")),pe.createElement(pe.Fragment,null,pe.createElement("h2",null,"Unexpected Application Error!"),pe.createElement("h3",{style:{fontStyle:"italic"}},e),t?pe.createElement("pre",{style:o},t):null,h)}var TS=pe.createElement(ES,null),xS=class extends pe.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?pe.createElement(Ui.Provider,{value:this.props.routeContext},pe.createElement(cp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function wS({routeContext:r,match:e,children:t}){let i=pe.useContext(hl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),pe.createElement(Ui.Provider,{value:r},t)}function SS(r,e=[],t=null,i=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let o=r,u=t==null?void 0:t.errors;if(u!=null){let T=o.findIndex(m=>m.route.id&&(u==null?void 0:u[m.route.id])!==void 0);hr(T>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),o=o.slice(0,Math.min(o.length,T+1))}let h=!1,g=-1;if(t)for(let T=0;T<o.length;T++){let m=o[T];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(g=T),m.route.id){let{loaderData:_,errors:L}=t,I=m.route.loader&&!_.hasOwnProperty(m.route.id)&&(!L||L[m.route.id]===void 0);if(m.route.lazy||I){h=!0,g>=0?o=o.slice(0,g+1):o=[o[0]];break}}}return o.reduceRight((T,m,_)=>{let L,I=!1,D=null,F=null;t&&(L=u&&m.route.id?u[m.route.id]:void 0,D=m.route.errorElement||TS,h&&(g<0&&_===0?(oy("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),I=!0,F=null):g===_&&(I=!0,F=m.route.hydrateFallbackElement||null)));let N=e.concat(o.slice(0,_+1)),U=()=>{let Y;return L?Y=D:I?Y=F:m.route.Component?Y=pe.createElement(m.route.Component,null):m.route.element?Y=m.route.element:Y=T,pe.createElement(wS,{match:m,routeContext:{outlet:T,matches:N,isDataRoute:t!=null},children:Y})};return t&&(m.route.ErrorBoundary||m.route.errorElement||_===0)?pe.createElement(xS,{location:t.location,revalidation:t.revalidation,component:D,error:L,children:U(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):U()},null)}function fp(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AS(r){let e=pe.useContext(hl);return hr(e,fp(r)),e}function RS(r){let e=pe.useContext(mf);return hr(e,fp(r)),e}function IS(r){let e=pe.useContext(Ui);return hr(e,fp(r)),e}function hp(r){let e=IS(r),t=e.matches[e.matches.length-1];return hr(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function CS(){return hp("useRouteId")}function PS(){var i;let r=pe.useContext(cp),e=RS("useRouteError"),t=hp("useRouteError");return r!==void 0?r:(i=e.errors)==null?void 0:i[t]}function bS(){let{router:r}=AS("useNavigate"),e=hp("useNavigate"),t=pe.useRef(!1);return iy(()=>{t.current=!0}),pe.useCallback(async(o,u={})=>{Ti(t.current,ny),t.current&&(typeof o=="number"?r.navigate(o):await r.navigate(o,{fromRouteId:e,...u}))},[r,e])}var u0={};function oy(r,e,t){!e&&!u0[r]&&(u0[r]=!0,Ti(!1,t))}pe.memo(kS);function kS({routes:r,future:e,state:t}){return sy(r,void 0,t,e)}function qa({to:r,replace:e,state:t,relative:i}){hr(dl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=pe.useContext(Mi);Ti(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=pe.useContext(Ui),{pathname:h}=js(),g=vf(),T=up(r,lp(u),h,i==="path"),m=JSON.stringify(T);return pe.useEffect(()=>{g(JSON.parse(m),{replace:e,state:t,relative:i})},[g,m,i,e,t]),null}function yo(r){hr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function DS({basename:r="/",children:e=null,location:t,navigationType:i="POP",navigator:o,static:u=!1}){hr(!dl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=r.replace(/^\/*/,"/"),g=pe.useMemo(()=>({basename:h,navigator:o,static:u,future:{}}),[h,o,u]);typeof t=="string"&&(t=fl(t));let{pathname:T="/",search:m="",hash:_="",state:L=null,key:I="default"}=t,D=pe.useMemo(()=>{let F=Ao(T,h);return F==null?null:{location:{pathname:F,search:m,hash:_,state:L,key:I},navigationType:i}},[h,T,m,_,L,I,i]);return Ti(D!=null,`<Router basename="${h}"> is not able to match the URL "${T}${m}${_}" because it does not start with the basename, so the <Router> won't render anything.`),D==null?null:pe.createElement(Mi.Provider,{value:g},pe.createElement(gu.Provider,{children:e,value:D}))}function LS({children:r,location:e}){return _S(Dd(r),e)}function Dd(r,e=[]){let t=[];return pe.Children.forEach(r,(i,o)=>{if(!pe.isValidElement(i))return;let u=[...e,o];if(i.type===pe.Fragment){t.push.apply(t,Dd(i.props.children,u));return}hr(i.type===yo,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hr(!i.props.index||!i.props.children,"An index route cannot have child routes.");let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=Dd(i.props.children,u)),t.push(h)}),t}var Fc="get",Mc="application/x-www-form-urlencoded";function yf(r){return r!=null&&typeof r.tagName=="string"}function OS(r){return yf(r)&&r.tagName.toLowerCase()==="button"}function NS(r){return yf(r)&&r.tagName.toLowerCase()==="form"}function FS(r){return yf(r)&&r.tagName.toLowerCase()==="input"}function MS(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function US(r,e){return r.button===0&&(!e||e==="_self")&&!MS(r)}function Ld(r=""){return new URLSearchParams(typeof r=="string"||Array.isArray(r)||r instanceof URLSearchParams?r:Object.keys(r).reduce((e,t)=>{let i=r[t];return e.concat(Array.isArray(i)?i.map(o=>[t,o]):[[t,i]])},[]))}function VS(r,e){let t=Ld(r);return e&&e.forEach((i,o)=>{t.has(o)||e.getAll(o).forEach(u=>{t.append(o,u)})}),t}var wc=null;function BS(){if(wc===null)try{new FormData(document.createElement("form"),0),wc=!1}catch{wc=!0}return wc}var jS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function cd(r){return r!=null&&!jS.has(r)?(Ti(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Mc}"`),null):r}function zS(r,e){let t,i,o,u,h;if(NS(r)){let g=r.getAttribute("action");i=g?Ao(g,e):null,t=r.getAttribute("method")||Fc,o=cd(r.getAttribute("enctype"))||Mc,u=new FormData(r)}else if(OS(r)||FS(r)&&(r.type==="submit"||r.type==="image")){let g=r.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let T=r.getAttribute("formaction")||g.getAttribute("action");if(i=T?Ao(T,e):null,t=r.getAttribute("formmethod")||g.getAttribute("method")||Fc,o=cd(r.getAttribute("formenctype"))||cd(g.getAttribute("enctype"))||Mc,u=new FormData(g,r),!BS()){let{name:m,type:_,value:L}=r;if(_==="image"){let I=m?`${m}.`:"";u.append(`${I}x`,"0"),u.append(`${I}y`,"0")}else m&&u.append(m,L)}}else{if(yf(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Fc,i=null,o=Mc,h=r}return u&&o==="text/plain"&&(h=u,u=void 0),{action:i,method:t.toLowerCase(),encType:o,formData:u,body:h}}function dp(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}async function GS(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function KS(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function HS(r,e,t){let i=await Promise.all(r.map(async o=>{let u=e.routes[o.route.id];if(u){let h=await GS(u,t);return h.links?h.links():[]}return[]}));return YS(i.flat(1).filter(KS).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function c0(r,e,t,i,o,u){let h=(T,m)=>t[m]?T.route.id!==t[m].route.id:!0,g=(T,m)=>{var _;return t[m].pathname!==T.pathname||((_=t[m].route.path)==null?void 0:_.endsWith("*"))&&t[m].params["*"]!==T.params["*"]};return u==="assets"?e.filter((T,m)=>h(T,m)||g(T,m)):u==="data"?e.filter((T,m)=>{var L;let _=i.routes[T.route.id];if(!_||!_.hasLoader)return!1;if(h(T,m)||g(T,m))return!0;if(T.route.shouldRevalidate){let I=T.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((L=t[0])==null?void 0:L.params)||{},nextUrl:new URL(r,window.origin),nextParams:T.params,defaultShouldRevalidate:!0});if(typeof I=="boolean")return I}return!0}):[]}function $S(r,e){return WS(r.map(t=>{let i=e.routes[t.route.id];if(!i)return[];let o=[i.module];return i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function WS(r){return[...new Set(r)]}function qS(r){let e={},t=Object.keys(r).sort();for(let i of t)e[i]=r[i];return e}function YS(r,e){let t=new Set;return new Set(e),r.reduce((i,o)=>{let u=JSON.stringify(qS(o));return t.has(u)||(t.add(u),i.push({key:u,link:o})),i},[])}function QS(r){let e=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function XS(){let r=pe.useContext(hl);return dp(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function JS(){let r=pe.useContext(mf);return dp(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var pp=pe.createContext(void 0);pp.displayName="FrameworkContext";function ay(){let r=pe.useContext(pp);return dp(r,"You must render this element inside a <HydratedRouter> element"),r}function ZS(r,e){let t=pe.useContext(pp),[i,o]=pe.useState(!1),[u,h]=pe.useState(!1),{onFocus:g,onBlur:T,onMouseEnter:m,onMouseLeave:_,onTouchStart:L}=e,I=pe.useRef(null);pe.useEffect(()=>{if(r==="render"&&h(!0),r==="viewport"){let N=Y=>{Y.forEach(X=>{h(X.isIntersecting)})},U=new IntersectionObserver(N,{threshold:.5});return I.current&&U.observe(I.current),()=>{U.disconnect()}}},[r]),pe.useEffect(()=>{if(i){let N=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(N)}}},[i]);let D=()=>{o(!0)},F=()=>{o(!1),h(!1)};return t?r!=="intent"?[u,I,{}]:[u,I,{onFocus:Hl(g,D),onBlur:Hl(T,F),onMouseEnter:Hl(m,D),onMouseLeave:Hl(_,F),onTouchStart:Hl(L,D)}]:[!1,I,{}]}function Hl(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function e1({page:r,...e}){let{router:t}=XS(),i=pe.useMemo(()=>Jv(t.routes,r,t.basename),[t.routes,r,t.basename]);return i?pe.createElement(r1,{page:r,matches:i,...e}):(console.warn(`Tried to prefetch ${r} but no routes matched.`),null)}function t1(r){let{manifest:e,routeModules:t}=ay(),[i,o]=pe.useState([]);return pe.useEffect(()=>{let u=!1;return HS(r,e,t).then(h=>{u||o(h)}),()=>{u=!0}},[r,e,t]),i}function r1({page:r,matches:e,...t}){let i=js(),{manifest:o,routeModules:u}=ay(),{loaderData:h,matches:g}=JS(),T=pe.useMemo(()=>c0(r,e,g,o,i,"data"),[r,e,g,o,i]),m=pe.useMemo(()=>c0(r,e,g,o,i,"assets"),[r,e,g,o,i]),_=pe.useMemo(()=>{if(r===i.pathname+i.search+i.hash)return[];let D=new Set,F=!1;if(e.forEach(U=>{var X;let Y=o.routes[U.route.id];!Y||!Y.hasLoader||(!T.some(ce=>ce.route.id===U.route.id)&&U.route.id in h&&((X=u[U.route.id])!=null&&X.shouldRevalidate)||Y.hasClientLoader?F=!0:D.add(U.route.id))}),D.size===0)return[];let N=QS(r);return F&&D.size>0&&N.searchParams.set("_routes",e.filter(U=>D.has(U.route.id)).map(U=>U.route.id).join(",")),[N.pathname+N.search]},[h,i,o,T,e,r,u]),L=pe.useMemo(()=>$S(m,o),[m,o]),I=t1(m);return pe.createElement(pe.Fragment,null,_.map(D=>pe.createElement("link",{key:D,rel:"prefetch",as:"fetch",href:D,...t})),L.map(D=>pe.createElement("link",{key:D,rel:"modulepreload",href:D,...t})),I.map(({key:D,link:F})=>pe.createElement("link",{key:D,...F})))}function n1(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var ly=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ly&&(window.__reactRouterVersion="7.0.2")}catch{}function i1({basename:r,children:e,window:t}){let i=pe.useRef();i.current==null&&(i.current=Kw({window:t,v5Compat:!0}));let o=i.current,[u,h]=pe.useState({action:o.action,location:o.location}),g=pe.useCallback(T=>{pe.startTransition(()=>h(T))},[h]);return pe.useLayoutEffect(()=>o.listen(g),[o,g]),pe.createElement(DS,{basename:r,children:e,location:u.location,navigationType:u.action,navigator:o})}var uy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oa=pe.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:o,reloadDocument:u,replace:h,state:g,target:T,to:m,preventScrollReset:_,viewTransition:L,...I},D){let{basename:F}=pe.useContext(Mi),N=typeof m=="string"&&uy.test(m),U,Y=!1;if(typeof m=="string"&&N&&(U=m,ly))try{let z=new URL(window.location.href),Q=m.startsWith("//")?new URL(z.protocol+m):new URL(m),re=Ao(Q.pathname,F);Q.origin===z.origin&&re!=null?m=re+Q.search+Q.hash:Y=!0}catch{Ti(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let X=mS(m,{relative:o}),[ce,fe,me]=ZS(i,I),we=l1(m,{replace:h,state:g,target:T,preventScrollReset:_,relative:o,viewTransition:L});function H(z){e&&e(z),z.defaultPrevented||we(z)}let B=pe.createElement("a",{...I,...me,href:U||X,onClick:Y||u?e:H,ref:n1(D,fe),target:T,"data-discover":!N&&t==="render"?"true":void 0});return ce&&!N?pe.createElement(pe.Fragment,null,B,pe.createElement(e1,{page:X})):B});oa.displayName="Link";var s1=pe.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:o=!1,style:u,to:h,viewTransition:g,children:T,...m},_){let L=mu(h,{relative:m.relative}),I=js(),D=pe.useContext(mf),{navigator:F,basename:N}=pe.useContext(Mi),U=D!=null&&p1(L)&&g===!0,Y=F.encodeLocation?F.encodeLocation(L).pathname:L.pathname,X=I.pathname,ce=D&&D.navigation&&D.navigation.location?D.navigation.location.pathname:null;t||(X=X.toLowerCase(),ce=ce?ce.toLowerCase():null,Y=Y.toLowerCase()),ce&&N&&(ce=Ao(ce,N)||ce);const fe=Y!=="/"&&Y.endsWith("/")?Y.length-1:Y.length;let me=X===Y||!o&&X.startsWith(Y)&&X.charAt(fe)==="/",we=ce!=null&&(ce===Y||!o&&ce.startsWith(Y)&&ce.charAt(Y.length)==="/"),H={isActive:me,isPending:we,isTransitioning:U},B=me?e:void 0,z;typeof i=="function"?z=i(H):z=[i,me?"active":null,we?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let Q=typeof u=="function"?u(H):u;return pe.createElement(oa,{...m,"aria-current":B,className:z,ref:_,style:Q,to:h,viewTransition:g},typeof T=="function"?T(H):T)});s1.displayName="NavLink";var o1=pe.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:o,state:u,method:h=Fc,action:g,onSubmit:T,relative:m,preventScrollReset:_,viewTransition:L,...I},D)=>{let F=h1(),N=d1(g,{relative:m}),U=h.toLowerCase()==="get"?"get":"post",Y=typeof g=="string"&&uy.test(g),X=ce=>{if(T&&T(ce),ce.defaultPrevented)return;ce.preventDefault();let fe=ce.nativeEvent.submitter,me=(fe==null?void 0:fe.getAttribute("formmethod"))||h;F(fe||ce.currentTarget,{fetcherKey:e,method:me,navigate:t,replace:o,state:u,relative:m,preventScrollReset:_,viewTransition:L})};return pe.createElement("form",{ref:D,method:U,action:N,onSubmit:i?T:X,...I,"data-discover":!Y&&r==="render"?"true":void 0})});o1.displayName="Form";function a1(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cy(r){let e=pe.useContext(hl);return hr(e,a1(r)),e}function l1(r,{target:e,replace:t,state:i,preventScrollReset:o,relative:u,viewTransition:h}={}){let g=vf(),T=js(),m=mu(r,{relative:u});return pe.useCallback(_=>{if(US(_,e)){_.preventDefault();let L=t!==void 0?t:iu(T)===iu(m);g(r,{replace:L,state:i,preventScrollReset:o,relative:u,viewTransition:h})}},[T,g,m,t,i,e,r,o,u,h])}function u1(r){Ti(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=pe.useRef(Ld(r)),t=pe.useRef(!1),i=js(),o=pe.useMemo(()=>VS(i.search,t.current?null:e.current),[i.search]),u=vf(),h=pe.useCallback((g,T)=>{const m=Ld(typeof g=="function"?g(o):g);t.current=!0,u("?"+m,T)},[u,o]);return[o,h]}var c1=0,f1=()=>`__${String(++c1)}__`;function h1(){let{router:r}=cy("useSubmit"),{basename:e}=pe.useContext(Mi),t=CS();return pe.useCallback(async(i,o={})=>{let{action:u,method:h,encType:g,formData:T,body:m}=zS(i,e);if(o.navigate===!1){let _=o.fetcherKey||f1();await r.fetch(_,t,o.action||u,{preventScrollReset:o.preventScrollReset,formData:T,body:m,formMethod:o.method||h,formEncType:o.encType||g,flushSync:o.flushSync})}else await r.navigate(o.action||u,{preventScrollReset:o.preventScrollReset,formData:T,body:m,formMethod:o.method||h,formEncType:o.encType||g,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,e,t])}function d1(r,{relative:e}={}){let{basename:t}=pe.useContext(Mi),i=pe.useContext(Ui);hr(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),u={...mu(r||".",{relative:e})},h=js();if(r==null){u.search=h.search;let g=new URLSearchParams(u.search),T=g.getAll("index");if(T.some(_=>_==="")){g.delete("index"),T.filter(L=>L).forEach(L=>g.append("index",L));let _=g.toString();u.search=_?`?${_}`:""}}return(!r||r===".")&&o.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:Ls([t,u.pathname])),iu(u)}function p1(r,e={}){let t=pe.useContext(ry);hr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=cy("useViewTransitionState"),o=mu(r,{relative:e.relative});if(!t.isTransitioning)return!1;let u=Ao(t.currentLocation.pathname,i)||t.currentLocation.pathname,h=Ao(t.nextLocation.pathname,i)||t.nextLocation.pathname;return qc(o.pathname,h)!=null||qc(o.pathname,u)!=null}new TextEncoder;const g1=()=>{const{logout:r,authUser:e}=pu();return he.jsx("header",{className:`bg-base-100 border-b border-base-300 w-full top-0 z-40 \r
    backdrop-blur-lg bg-base-100/80`,children:he.jsx("div",{className:"container mx-auto px-4 h-16",children:he.jsxs("div",{className:"flex items-center justify-between h-full",children:[he.jsx("div",{className:"flex items-center gap-8",children:he.jsxs(oa,{to:"/",className:"flex items-center gap-2.5 hover:opacity-80 transition-all",children:[he.jsxs("div",{className:"size-9 rounded-lg bg-primary/10 flex items-center justify-center",children:[" ",he.jsx(zw,{className:"w-15 h-15 text-primary"})]}),he.jsx("h1",{className:"text-lg font-bold",children:"NITC Stream"})]})}),he.jsxs("div",{className:"flex items-center gap-2",children:[he.jsxs(oa,{to:"/settings",className:`
              btn btn-sm gap-2 transition-colors
              
              `,children:[he.jsx(jw,{className:"w-4 h-4"}),he.jsx("span",{className:"hidden sm:inline",children:"Settings"})]}),e&&he.jsxs(he.Fragment,{children:[he.jsxs(oa,{to:"/profile",className:"btn btn-sm gap-2",children:[he.jsx(Xv,{className:"size-5"}),he.jsx("span",{className:"hidden sm:inline",children:"Profile"})]}),he.jsxs("button",{className:"flex gap-2 items-center",onClick:r,children:[he.jsx(Bw,{className:"size-5"}),he.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})]})})})};var f0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fy=function(r){const e=[];let t=0;for(let i=0;i<r.length;i++){let o=r.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<r.length&&(r.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(r.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},m1=function(r){const e=[];let t=0,i=0;for(;t<r.length;){const o=r[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const u=r[t++];e[i++]=String.fromCharCode((o&31)<<6|u&63)}else if(o>239&&o<365){const u=r[t++],h=r[t++],g=r[t++],T=((o&7)<<18|(u&63)<<12|(h&63)<<6|g&63)-65536;e[i++]=String.fromCharCode(55296+(T>>10)),e[i++]=String.fromCharCode(56320+(T&1023))}else{const u=r[t++],h=r[t++];e[i++]=String.fromCharCode((o&15)<<12|(u&63)<<6|h&63)}}return e.join("")},hy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<r.length;o+=3){const u=r[o],h=o+1<r.length,g=h?r[o+1]:0,T=o+2<r.length,m=T?r[o+2]:0,_=u>>2,L=(u&3)<<4|g>>4;let I=(g&15)<<2|m>>6,D=m&63;T||(D=64,h||(I=64)),i.push(t[_],t[L],t[I],t[D])}return i.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(fy(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):m1(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<r.length;){const u=t[r.charAt(o++)],g=o<r.length?t[r.charAt(o)]:0;++o;const m=o<r.length?t[r.charAt(o)]:64;++o;const L=o<r.length?t[r.charAt(o)]:64;if(++o,u==null||g==null||m==null||L==null)throw new v1;const I=u<<2|g>>4;if(i.push(I),m!==64){const D=g<<4&240|m>>2;if(i.push(D),L!==64){const F=m<<6&192|L;i.push(F)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class v1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const y1=function(r){const e=fy(r);return hy.encodeByteArray(e,!0)},Yc=function(r){return y1(r).replace(/\./g,"")},_1=function(r){try{return hy.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1=()=>E1().__FIREBASE_DEFAULTS__,x1=()=>{if(typeof process>"u"||typeof f0>"u")return;const r=f0.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},w1=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&_1(r[1]);return e&&JSON.parse(e)},gp=()=>{try{return T1()||x1()||w1()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},S1=r=>{var e,t;return(t=(e=gp())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},A1=r=>{const e=S1(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},dy=()=>{var r;return(r=gp())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=r.iat||0,u=r.sub||r.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Yc(JSON.stringify(t)),Yc(JSON.stringify(h)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function P1(){var r;const e=(r=gp())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function b1(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function k1(){return!P1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function py(){try{return typeof indexedDB=="object"}catch{return!1}}function gy(){return new Promise((r,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),r(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var u;e(((u=o.error)===null||u===void 0?void 0:u.message)||"")}}catch(t){e(t)}})}function D1(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1="FirebaseError";class Lo extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=L1,Object.setPrototypeOf(this,Lo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_f.prototype.create)}}class _f{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,u=this.errors[e],h=u?O1(u,i):"Error",g=`${this.serviceName}: ${h} (${o}).`;return new Lo(o,g,i)}}function O1(r,e){return r.replace(N1,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const N1=/\{\$([^}]+)}/g;function Od(r,e){if(r===e)return!0;const t=Object.keys(r),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const u=r[o],h=e[o];if(h0(u)&&h0(h)){if(!Od(u,h))return!1}else if(u!==h)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function h0(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1=1e3,M1=2,U1=4*60*60*1e3,V1=.5;function d0(r,e=F1,t=M1){const i=e*Math.pow(t,r),o=Math.round(V1*i*(Math.random()-.5)*2);return Math.min(U1,i+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function el(r){return r&&r._delegate?r._delegate:r}class Ms{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new R1;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(u){if(o)return null;throw u}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(z1(e))try{this.getOrInitializeService({instanceIdentifier:ta})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:o});i.resolve(u)}catch{}}}}clearInstance(e=ta){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ta){return this.instances.has(e)}getOptions(e=ta){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,h]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(u);i===g&&h.resolve(o)}return o}onInit(e,t){var i;const o=this.normalizeInstanceIdentifier(t),u=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;u.add(e),this.onInitCallbacks.set(o,u);const h=this.instances.get(o);return h&&e(h,o),()=>{u.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:j1(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ta){return this.component?this.component.multipleInstances?e:ta:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function j1(r){return r===ta?void 0:r}function z1(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new B1(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Gt||(Gt={}));const K1={debug:Gt.DEBUG,verbose:Gt.VERBOSE,info:Gt.INFO,warn:Gt.WARN,error:Gt.ERROR,silent:Gt.SILENT},H1=Gt.INFO,$1={[Gt.DEBUG]:"log",[Gt.VERBOSE]:"log",[Gt.INFO]:"info",[Gt.WARN]:"warn",[Gt.ERROR]:"error"},W1=(r,e,...t)=>{if(e<r.logLevel)return;const i=new Date().toISOString(),o=$1[e];if(o)console[o](`[${i}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mp{constructor(e){this.name=e,this._logLevel=H1,this._logHandler=W1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Gt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?K1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Gt.DEBUG,...e),this._logHandler(this,Gt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Gt.VERBOSE,...e),this._logHandler(this,Gt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Gt.INFO,...e),this._logHandler(this,Gt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Gt.WARN,...e),this._logHandler(this,Gt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Gt.ERROR,...e),this._logHandler(this,Gt.ERROR,...e)}}const q1=(r,e)=>e.some(t=>r instanceof t);let p0,g0;function Y1(){return p0||(p0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Q1(){return g0||(g0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const my=new WeakMap,Nd=new WeakMap,vy=new WeakMap,fd=new WeakMap,vp=new WeakMap;function X1(r){const e=new Promise((t,i)=>{const o=()=>{r.removeEventListener("success",u),r.removeEventListener("error",h)},u=()=>{t(To(r.result)),o()},h=()=>{i(r.error),o()};r.addEventListener("success",u),r.addEventListener("error",h)});return e.then(t=>{t instanceof IDBCursor&&my.set(t,r)}).catch(()=>{}),vp.set(e,r),e}function J1(r){if(Nd.has(r))return;const e=new Promise((t,i)=>{const o=()=>{r.removeEventListener("complete",u),r.removeEventListener("error",h),r.removeEventListener("abort",h)},u=()=>{t(),o()},h=()=>{i(r.error||new DOMException("AbortError","AbortError")),o()};r.addEventListener("complete",u),r.addEventListener("error",h),r.addEventListener("abort",h)});Nd.set(r,e)}let Fd={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Nd.get(r);if(e==="objectStoreNames")return r.objectStoreNames||vy.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return To(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function Z1(r){Fd=r(Fd)}function eA(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=r.call(hd(this),e,...t);return vy.set(i,e.sort?e.sort():[e]),To(i)}:Q1().includes(r)?function(...e){return r.apply(hd(this),e),To(my.get(this))}:function(...e){return To(r.apply(hd(this),e))}}function tA(r){return typeof r=="function"?eA(r):(r instanceof IDBTransaction&&J1(r),q1(r,Y1())?new Proxy(r,Fd):r)}function To(r){if(r instanceof IDBRequest)return X1(r);if(fd.has(r))return fd.get(r);const e=tA(r);return e!==r&&(fd.set(r,e),vp.set(e,r)),e}const hd=r=>vp.get(r);function yy(r,e,{blocked:t,upgrade:i,blocking:o,terminated:u}={}){const h=indexedDB.open(r,e),g=To(h);return i&&h.addEventListener("upgradeneeded",T=>{i(To(h.result),T.oldVersion,T.newVersion,To(h.transaction),T)}),t&&h.addEventListener("blocked",T=>t(T.oldVersion,T.newVersion,T)),g.then(T=>{u&&T.addEventListener("close",()=>u()),o&&T.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),g}const rA=["get","getKey","getAll","getAllKeys","count"],nA=["put","add","delete","clear"],dd=new Map;function m0(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(dd.get(e))return dd.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=nA.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||rA.includes(t)))return;const u=async function(h,...g){const T=this.transaction(h,o?"readwrite":"readonly");let m=T.store;return i&&(m=m.index(g.shift())),(await Promise.all([m[t](...g),o&&T.done]))[0]};return dd.set(e,u),u}Z1(r=>({...r,get:(e,t,i)=>m0(e,t)||r.get(e,t,i),has:(e,t)=>!!m0(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(sA(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function sA(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Md="@firebase/app",v0="0.10.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=new mp("@firebase/app"),oA="@firebase/app-compat",aA="@firebase/analytics-compat",lA="@firebase/analytics",uA="@firebase/app-check-compat",cA="@firebase/app-check",fA="@firebase/auth",hA="@firebase/auth-compat",dA="@firebase/database",pA="@firebase/data-connect",gA="@firebase/database-compat",mA="@firebase/functions",vA="@firebase/functions-compat",yA="@firebase/installations",_A="@firebase/installations-compat",EA="@firebase/messaging",TA="@firebase/messaging-compat",xA="@firebase/performance",wA="@firebase/performance-compat",SA="@firebase/remote-config",AA="@firebase/remote-config-compat",RA="@firebase/storage",IA="@firebase/storage-compat",CA="@firebase/firestore",PA="@firebase/vertexai",bA="@firebase/firestore-compat",kA="firebase",DA="11.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud="[DEFAULT]",LA={[Md]:"fire-core",[oA]:"fire-core-compat",[lA]:"fire-analytics",[aA]:"fire-analytics-compat",[cA]:"fire-app-check",[uA]:"fire-app-check-compat",[fA]:"fire-auth",[hA]:"fire-auth-compat",[dA]:"fire-rtdb",[pA]:"fire-data-connect",[gA]:"fire-rtdb-compat",[mA]:"fire-fn",[vA]:"fire-fn-compat",[yA]:"fire-iid",[_A]:"fire-iid-compat",[EA]:"fire-fcm",[TA]:"fire-fcm-compat",[xA]:"fire-perf",[wA]:"fire-perf-compat",[SA]:"fire-rc",[AA]:"fire-rc-compat",[RA]:"fire-gcs",[IA]:"fire-gcs-compat",[CA]:"fire-fst",[bA]:"fire-fst-compat",[PA]:"fire-vertex","fire-js":"fire-js",[kA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=new Map,OA=new Map,Vd=new Map;function y0(r,e){try{r.container.addComponent(e)}catch(t){Us.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Ro(r){const e=r.name;if(Vd.has(e))return Us.debug(`There were multiple attempts to register component ${e}.`),!1;Vd.set(e,r);for(const t of Qc.values())y0(t,r);for(const t of OA.values())y0(t,r);return!0}function yp(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xo=new _f("app","Firebase",NA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ms("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA=DA;function _y(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Ud,automaticDataCollectionEnabled:!1},e),o=i.name;if(typeof o!="string"||!o)throw xo.create("bad-app-name",{appName:String(o)});if(t||(t=dy()),!t)throw xo.create("no-options");const u=Qc.get(o);if(u){if(Od(t,u.options)&&Od(i,u.config))return u;throw xo.create("duplicate-app",{appName:o})}const h=new G1(o);for(const T of Vd.values())h.addComponent(T);const g=new FA(t,i,h);return Qc.set(o,g),g}function UA(r=Ud){const e=Qc.get(r);if(!e&&r===Ud&&dy())return _y();if(!e)throw xo.create("no-app",{appName:r});return e}function as(r,e,t){var i;let o=(i=LA[r])!==null&&i!==void 0?i:r;t&&(o+=`-${t}`);const u=o.match(/\s|\//),h=e.match(/\s|\//);if(u||h){const g=[`Unable to register library "${o}" with version "${e}":`];u&&g.push(`library name "${o}" contains illegal characters (whitespace or "/")`),u&&h&&g.push("and"),h&&g.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Us.warn(g.join(" "));return}Ro(new Ms(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="firebase-heartbeat-database",BA=1,su="firebase-heartbeat-store";let pd=null;function Ey(){return pd||(pd=yy(VA,BA,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(su)}catch(t){console.warn(t)}}}}).catch(r=>{throw xo.create("idb-open",{originalErrorMessage:r.message})})),pd}async function jA(r){try{const t=(await Ey()).transaction(su),i=await t.objectStore(su).get(Ty(r));return await t.done,i}catch(e){if(e instanceof Lo)Us.warn(e.message);else{const t=xo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Us.warn(t.message)}}}async function _0(r,e){try{const i=(await Ey()).transaction(su,"readwrite");await i.objectStore(su).put(e,Ty(r)),await i.done}catch(t){if(t instanceof Lo)Us.warn(t.message);else{const i=xo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Us.warn(i.message)}}}function Ty(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA=1024,GA=30*24*60*60*1e3;class KA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new $A(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),u=E0();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===u||this._heartbeatsCache.heartbeats.some(h=>h.date===u)?void 0:(this._heartbeatsCache.heartbeats.push({date:u,agent:o}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(h=>{const g=new Date(h.date).valueOf();return Date.now()-g<=GA}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Us.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=E0(),{heartbeatsToSend:i,unsentEntries:o}=HA(this._heartbeatsCache.heartbeats),u=Yc(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(t){return Us.warn(t),""}}}function E0(){return new Date().toISOString().substring(0,10)}function HA(r,e=zA){const t=[];let i=r.slice();for(const o of r){const u=t.find(h=>h.agent===o.agent);if(u){if(u.dates.push(o.date),T0(t)>e){u.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),T0(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class $A{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return py()?gy().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await jA(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return _0(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return _0(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function T0(r){return Yc(JSON.stringify({version:2,heartbeats:r})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(r){Ro(new Ms("platform-logger",e=>new iA(e),"PRIVATE")),Ro(new Ms("heartbeat",e=>new KA(e),"PRIVATE")),as(Md,v0,r),as(Md,v0,"esm2017"),as("fire-js","")}WA("");var qA="firebase",YA="11.2.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */as(qA,YA,"app");var x0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wo,xy;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(H,B){function z(){}z.prototype=B.prototype,H.D=B.prototype,H.prototype=new z,H.prototype.constructor=H,H.C=function(Q,re,le){for(var J=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)J[pt-2]=arguments[pt];return B.prototype[re].apply(Q,J)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(H,B,z){z||(z=0);var Q=Array(16);if(typeof B=="string")for(var re=0;16>re;++re)Q[re]=B.charCodeAt(z++)|B.charCodeAt(z++)<<8|B.charCodeAt(z++)<<16|B.charCodeAt(z++)<<24;else for(re=0;16>re;++re)Q[re]=B[z++]|B[z++]<<8|B[z++]<<16|B[z++]<<24;B=H.g[0],z=H.g[1],re=H.g[2];var le=H.g[3],J=B+(le^z&(re^le))+Q[0]+3614090360&4294967295;B=z+(J<<7&4294967295|J>>>25),J=le+(re^B&(z^re))+Q[1]+3905402710&4294967295,le=B+(J<<12&4294967295|J>>>20),J=re+(z^le&(B^z))+Q[2]+606105819&4294967295,re=le+(J<<17&4294967295|J>>>15),J=z+(B^re&(le^B))+Q[3]+3250441966&4294967295,z=re+(J<<22&4294967295|J>>>10),J=B+(le^z&(re^le))+Q[4]+4118548399&4294967295,B=z+(J<<7&4294967295|J>>>25),J=le+(re^B&(z^re))+Q[5]+1200080426&4294967295,le=B+(J<<12&4294967295|J>>>20),J=re+(z^le&(B^z))+Q[6]+2821735955&4294967295,re=le+(J<<17&4294967295|J>>>15),J=z+(B^re&(le^B))+Q[7]+4249261313&4294967295,z=re+(J<<22&4294967295|J>>>10),J=B+(le^z&(re^le))+Q[8]+1770035416&4294967295,B=z+(J<<7&4294967295|J>>>25),J=le+(re^B&(z^re))+Q[9]+2336552879&4294967295,le=B+(J<<12&4294967295|J>>>20),J=re+(z^le&(B^z))+Q[10]+4294925233&4294967295,re=le+(J<<17&4294967295|J>>>15),J=z+(B^re&(le^B))+Q[11]+2304563134&4294967295,z=re+(J<<22&4294967295|J>>>10),J=B+(le^z&(re^le))+Q[12]+1804603682&4294967295,B=z+(J<<7&4294967295|J>>>25),J=le+(re^B&(z^re))+Q[13]+4254626195&4294967295,le=B+(J<<12&4294967295|J>>>20),J=re+(z^le&(B^z))+Q[14]+2792965006&4294967295,re=le+(J<<17&4294967295|J>>>15),J=z+(B^re&(le^B))+Q[15]+1236535329&4294967295,z=re+(J<<22&4294967295|J>>>10),J=B+(re^le&(z^re))+Q[1]+4129170786&4294967295,B=z+(J<<5&4294967295|J>>>27),J=le+(z^re&(B^z))+Q[6]+3225465664&4294967295,le=B+(J<<9&4294967295|J>>>23),J=re+(B^z&(le^B))+Q[11]+643717713&4294967295,re=le+(J<<14&4294967295|J>>>18),J=z+(le^B&(re^le))+Q[0]+3921069994&4294967295,z=re+(J<<20&4294967295|J>>>12),J=B+(re^le&(z^re))+Q[5]+3593408605&4294967295,B=z+(J<<5&4294967295|J>>>27),J=le+(z^re&(B^z))+Q[10]+38016083&4294967295,le=B+(J<<9&4294967295|J>>>23),J=re+(B^z&(le^B))+Q[15]+3634488961&4294967295,re=le+(J<<14&4294967295|J>>>18),J=z+(le^B&(re^le))+Q[4]+3889429448&4294967295,z=re+(J<<20&4294967295|J>>>12),J=B+(re^le&(z^re))+Q[9]+568446438&4294967295,B=z+(J<<5&4294967295|J>>>27),J=le+(z^re&(B^z))+Q[14]+3275163606&4294967295,le=B+(J<<9&4294967295|J>>>23),J=re+(B^z&(le^B))+Q[3]+4107603335&4294967295,re=le+(J<<14&4294967295|J>>>18),J=z+(le^B&(re^le))+Q[8]+1163531501&4294967295,z=re+(J<<20&4294967295|J>>>12),J=B+(re^le&(z^re))+Q[13]+2850285829&4294967295,B=z+(J<<5&4294967295|J>>>27),J=le+(z^re&(B^z))+Q[2]+4243563512&4294967295,le=B+(J<<9&4294967295|J>>>23),J=re+(B^z&(le^B))+Q[7]+1735328473&4294967295,re=le+(J<<14&4294967295|J>>>18),J=z+(le^B&(re^le))+Q[12]+2368359562&4294967295,z=re+(J<<20&4294967295|J>>>12),J=B+(z^re^le)+Q[5]+4294588738&4294967295,B=z+(J<<4&4294967295|J>>>28),J=le+(B^z^re)+Q[8]+2272392833&4294967295,le=B+(J<<11&4294967295|J>>>21),J=re+(le^B^z)+Q[11]+1839030562&4294967295,re=le+(J<<16&4294967295|J>>>16),J=z+(re^le^B)+Q[14]+4259657740&4294967295,z=re+(J<<23&4294967295|J>>>9),J=B+(z^re^le)+Q[1]+2763975236&4294967295,B=z+(J<<4&4294967295|J>>>28),J=le+(B^z^re)+Q[4]+1272893353&4294967295,le=B+(J<<11&4294967295|J>>>21),J=re+(le^B^z)+Q[7]+4139469664&4294967295,re=le+(J<<16&4294967295|J>>>16),J=z+(re^le^B)+Q[10]+3200236656&4294967295,z=re+(J<<23&4294967295|J>>>9),J=B+(z^re^le)+Q[13]+681279174&4294967295,B=z+(J<<4&4294967295|J>>>28),J=le+(B^z^re)+Q[0]+3936430074&4294967295,le=B+(J<<11&4294967295|J>>>21),J=re+(le^B^z)+Q[3]+3572445317&4294967295,re=le+(J<<16&4294967295|J>>>16),J=z+(re^le^B)+Q[6]+76029189&4294967295,z=re+(J<<23&4294967295|J>>>9),J=B+(z^re^le)+Q[9]+3654602809&4294967295,B=z+(J<<4&4294967295|J>>>28),J=le+(B^z^re)+Q[12]+3873151461&4294967295,le=B+(J<<11&4294967295|J>>>21),J=re+(le^B^z)+Q[15]+530742520&4294967295,re=le+(J<<16&4294967295|J>>>16),J=z+(re^le^B)+Q[2]+3299628645&4294967295,z=re+(J<<23&4294967295|J>>>9),J=B+(re^(z|~le))+Q[0]+4096336452&4294967295,B=z+(J<<6&4294967295|J>>>26),J=le+(z^(B|~re))+Q[7]+1126891415&4294967295,le=B+(J<<10&4294967295|J>>>22),J=re+(B^(le|~z))+Q[14]+2878612391&4294967295,re=le+(J<<15&4294967295|J>>>17),J=z+(le^(re|~B))+Q[5]+4237533241&4294967295,z=re+(J<<21&4294967295|J>>>11),J=B+(re^(z|~le))+Q[12]+1700485571&4294967295,B=z+(J<<6&4294967295|J>>>26),J=le+(z^(B|~re))+Q[3]+2399980690&4294967295,le=B+(J<<10&4294967295|J>>>22),J=re+(B^(le|~z))+Q[10]+4293915773&4294967295,re=le+(J<<15&4294967295|J>>>17),J=z+(le^(re|~B))+Q[1]+2240044497&4294967295,z=re+(J<<21&4294967295|J>>>11),J=B+(re^(z|~le))+Q[8]+1873313359&4294967295,B=z+(J<<6&4294967295|J>>>26),J=le+(z^(B|~re))+Q[15]+4264355552&4294967295,le=B+(J<<10&4294967295|J>>>22),J=re+(B^(le|~z))+Q[6]+2734768916&4294967295,re=le+(J<<15&4294967295|J>>>17),J=z+(le^(re|~B))+Q[13]+1309151649&4294967295,z=re+(J<<21&4294967295|J>>>11),J=B+(re^(z|~le))+Q[4]+4149444226&4294967295,B=z+(J<<6&4294967295|J>>>26),J=le+(z^(B|~re))+Q[11]+3174756917&4294967295,le=B+(J<<10&4294967295|J>>>22),J=re+(B^(le|~z))+Q[2]+718787259&4294967295,re=le+(J<<15&4294967295|J>>>17),J=z+(le^(re|~B))+Q[9]+3951481745&4294967295,H.g[0]=H.g[0]+B&4294967295,H.g[1]=H.g[1]+(re+(J<<21&4294967295|J>>>11))&4294967295,H.g[2]=H.g[2]+re&4294967295,H.g[3]=H.g[3]+le&4294967295}i.prototype.u=function(H,B){B===void 0&&(B=H.length);for(var z=B-this.blockSize,Q=this.B,re=this.h,le=0;le<B;){if(re==0)for(;le<=z;)o(this,H,le),le+=this.blockSize;if(typeof H=="string"){for(;le<B;)if(Q[re++]=H.charCodeAt(le++),re==this.blockSize){o(this,Q),re=0;break}}else for(;le<B;)if(Q[re++]=H[le++],re==this.blockSize){o(this,Q),re=0;break}}this.h=re,this.o+=B},i.prototype.v=function(){var H=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);H[0]=128;for(var B=1;B<H.length-8;++B)H[B]=0;var z=8*this.o;for(B=H.length-8;B<H.length;++B)H[B]=z&255,z/=256;for(this.u(H),H=Array(16),B=z=0;4>B;++B)for(var Q=0;32>Q;Q+=8)H[z++]=this.g[B]>>>Q&255;return H};function u(H,B){var z=g;return Object.prototype.hasOwnProperty.call(z,H)?z[H]:z[H]=B(H)}function h(H,B){this.h=B;for(var z=[],Q=!0,re=H.length-1;0<=re;re--){var le=H[re]|0;Q&&le==B||(z[re]=le,Q=!1)}this.g=z}var g={};function T(H){return-128<=H&&128>H?u(H,function(B){return new h([B|0],0>B?-1:0)}):new h([H|0],0>H?-1:0)}function m(H){if(isNaN(H)||!isFinite(H))return L;if(0>H)return U(m(-H));for(var B=[],z=1,Q=0;H>=z;Q++)B[Q]=H/z|0,z*=4294967296;return new h(B,0)}function _(H,B){if(H.length==0)throw Error("number format error: empty string");if(B=B||10,2>B||36<B)throw Error("radix out of range: "+B);if(H.charAt(0)=="-")return U(_(H.substring(1),B));if(0<=H.indexOf("-"))throw Error('number format error: interior "-" character');for(var z=m(Math.pow(B,8)),Q=L,re=0;re<H.length;re+=8){var le=Math.min(8,H.length-re),J=parseInt(H.substring(re,re+le),B);8>le?(le=m(Math.pow(B,le)),Q=Q.j(le).add(m(J))):(Q=Q.j(z),Q=Q.add(m(J)))}return Q}var L=T(0),I=T(1),D=T(16777216);r=h.prototype,r.m=function(){if(N(this))return-U(this).m();for(var H=0,B=1,z=0;z<this.g.length;z++){var Q=this.i(z);H+=(0<=Q?Q:4294967296+Q)*B,B*=4294967296}return H},r.toString=function(H){if(H=H||10,2>H||36<H)throw Error("radix out of range: "+H);if(F(this))return"0";if(N(this))return"-"+U(this).toString(H);for(var B=m(Math.pow(H,6)),z=this,Q="";;){var re=fe(z,B).g;z=Y(z,re.j(B));var le=((0<z.g.length?z.g[0]:z.h)>>>0).toString(H);if(z=re,F(z))return le+Q;for(;6>le.length;)le="0"+le;Q=le+Q}},r.i=function(H){return 0>H?0:H<this.g.length?this.g[H]:this.h};function F(H){if(H.h!=0)return!1;for(var B=0;B<H.g.length;B++)if(H.g[B]!=0)return!1;return!0}function N(H){return H.h==-1}r.l=function(H){return H=Y(this,H),N(H)?-1:F(H)?0:1};function U(H){for(var B=H.g.length,z=[],Q=0;Q<B;Q++)z[Q]=~H.g[Q];return new h(z,~H.h).add(I)}r.abs=function(){return N(this)?U(this):this},r.add=function(H){for(var B=Math.max(this.g.length,H.g.length),z=[],Q=0,re=0;re<=B;re++){var le=Q+(this.i(re)&65535)+(H.i(re)&65535),J=(le>>>16)+(this.i(re)>>>16)+(H.i(re)>>>16);Q=J>>>16,le&=65535,J&=65535,z[re]=J<<16|le}return new h(z,z[z.length-1]&-2147483648?-1:0)};function Y(H,B){return H.add(U(B))}r.j=function(H){if(F(this)||F(H))return L;if(N(this))return N(H)?U(this).j(U(H)):U(U(this).j(H));if(N(H))return U(this.j(U(H)));if(0>this.l(D)&&0>H.l(D))return m(this.m()*H.m());for(var B=this.g.length+H.g.length,z=[],Q=0;Q<2*B;Q++)z[Q]=0;for(Q=0;Q<this.g.length;Q++)for(var re=0;re<H.g.length;re++){var le=this.i(Q)>>>16,J=this.i(Q)&65535,pt=H.i(re)>>>16,Jt=H.i(re)&65535;z[2*Q+2*re]+=J*Jt,X(z,2*Q+2*re),z[2*Q+2*re+1]+=le*Jt,X(z,2*Q+2*re+1),z[2*Q+2*re+1]+=J*pt,X(z,2*Q+2*re+1),z[2*Q+2*re+2]+=le*pt,X(z,2*Q+2*re+2)}for(Q=0;Q<B;Q++)z[Q]=z[2*Q+1]<<16|z[2*Q];for(Q=B;Q<2*B;Q++)z[Q]=0;return new h(z,0)};function X(H,B){for(;(H[B]&65535)!=H[B];)H[B+1]+=H[B]>>>16,H[B]&=65535,B++}function ce(H,B){this.g=H,this.h=B}function fe(H,B){if(F(B))throw Error("division by zero");if(F(H))return new ce(L,L);if(N(H))return B=fe(U(H),B),new ce(U(B.g),U(B.h));if(N(B))return B=fe(H,U(B)),new ce(U(B.g),B.h);if(30<H.g.length){if(N(H)||N(B))throw Error("slowDivide_ only works with positive integers.");for(var z=I,Q=B;0>=Q.l(H);)z=me(z),Q=me(Q);var re=we(z,1),le=we(Q,1);for(Q=we(Q,2),z=we(z,2);!F(Q);){var J=le.add(Q);0>=J.l(H)&&(re=re.add(z),le=J),Q=we(Q,1),z=we(z,1)}return B=Y(H,re.j(B)),new ce(re,B)}for(re=L;0<=H.l(B);){for(z=Math.max(1,Math.floor(H.m()/B.m())),Q=Math.ceil(Math.log(z)/Math.LN2),Q=48>=Q?1:Math.pow(2,Q-48),le=m(z),J=le.j(B);N(J)||0<J.l(H);)z-=Q,le=m(z),J=le.j(B);F(le)&&(le=I),re=re.add(le),H=Y(H,J)}return new ce(re,H)}r.A=function(H){return fe(this,H).h},r.and=function(H){for(var B=Math.max(this.g.length,H.g.length),z=[],Q=0;Q<B;Q++)z[Q]=this.i(Q)&H.i(Q);return new h(z,this.h&H.h)},r.or=function(H){for(var B=Math.max(this.g.length,H.g.length),z=[],Q=0;Q<B;Q++)z[Q]=this.i(Q)|H.i(Q);return new h(z,this.h|H.h)},r.xor=function(H){for(var B=Math.max(this.g.length,H.g.length),z=[],Q=0;Q<B;Q++)z[Q]=this.i(Q)^H.i(Q);return new h(z,this.h^H.h)};function me(H){for(var B=H.g.length+1,z=[],Q=0;Q<B;Q++)z[Q]=H.i(Q)<<1|H.i(Q-1)>>>31;return new h(z,H.h)}function we(H,B){var z=B>>5;B%=32;for(var Q=H.g.length-z,re=[],le=0;le<Q;le++)re[le]=0<B?H.i(le+z)>>>B|H.i(le+z+1)<<32-B:H.i(le+z);return new h(re,H.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,xy=i,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.A,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=m,h.fromString=_,wo=h}).apply(typeof x0<"u"?x0:typeof self<"u"?self:typeof window<"u"?window:{});var Sc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wy,$l,Sy,Uc,Bd,Ay,Ry,Iy;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,S,b){return c==Array.prototype||c==Object.prototype||(c[S]=b.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sc=="object"&&Sc];for(var S=0;S<c.length;++S){var b=c[S];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var i=t(this);function o(c,S){if(S)e:{var b=i;c=c.split(".");for(var V=0;V<c.length-1;V++){var de=c[V];if(!(de in b))break e;b=b[de]}c=c[c.length-1],V=b[c],S=S(V),S!=V&&S!=null&&e(b,c,{configurable:!0,writable:!0,value:S})}}function u(c,S){c instanceof String&&(c+="");var b=0,V=!1,de={next:function(){if(!V&&b<c.length){var xe=b++;return{value:S(xe,c[xe]),done:!1}}return V=!0,{done:!0,value:void 0}}};return de[Symbol.iterator]=function(){return de},de}o("Array.prototype.values",function(c){return c||function(){return u(this,function(S,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var h=h||{},g=this||self;function T(c){var S=typeof c;return S=S!="object"?S:c?Array.isArray(c)?"array":S:"null",S=="array"||S=="object"&&typeof c.length=="number"}function m(c){var S=typeof c;return S=="object"&&c!=null||S=="function"}function _(c,S,b){return c.call.apply(c.bind,arguments)}function L(c,S,b){if(!c)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var de=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(de,V),c.apply(S,de)}}return function(){return c.apply(S,arguments)}}function I(c,S,b){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:L,I.apply(null,arguments)}function D(c,S){var b=Array.prototype.slice.call(arguments,1);return function(){var V=b.slice();return V.push.apply(V,arguments),c.apply(this,V)}}function F(c,S){function b(){}b.prototype=S.prototype,c.aa=S.prototype,c.prototype=new b,c.prototype.constructor=c,c.Qb=function(V,de,xe){for(var Ge=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)Ge[jt-2]=arguments[jt];return S.prototype[de].apply(V,Ge)}}function N(c){const S=c.length;if(0<S){const b=Array(S);for(let V=0;V<S;V++)b[V]=c[V];return b}return[]}function U(c,S){for(let b=1;b<arguments.length;b++){const V=arguments[b];if(T(V)){const de=c.length||0,xe=V.length||0;c.length=de+xe;for(let Ge=0;Ge<xe;Ge++)c[de+Ge]=V[Ge]}else c.push(V)}}class Y{constructor(S,b){this.i=S,this.j=b,this.h=0,this.g=null}get(){let S;return 0<this.h?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function X(c){return/^[\s\xa0]*$/.test(c)}function ce(){var c=g.navigator;return c&&(c=c.userAgent)?c:""}function fe(c){return fe[" "](c),c}fe[" "]=function(){};var me=ce().indexOf("Gecko")!=-1&&!(ce().toLowerCase().indexOf("webkit")!=-1&&ce().indexOf("Edge")==-1)&&!(ce().indexOf("Trident")!=-1||ce().indexOf("MSIE")!=-1)&&ce().indexOf("Edge")==-1;function we(c,S,b){for(const V in c)S.call(b,c[V],V,c)}function H(c,S){for(const b in c)S.call(void 0,c[b],b,c)}function B(c){const S={};for(const b in c)S[b]=c[b];return S}const z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(c,S){let b,V;for(let de=1;de<arguments.length;de++){V=arguments[de];for(b in V)c[b]=V[b];for(let xe=0;xe<z.length;xe++)b=z[xe],Object.prototype.hasOwnProperty.call(V,b)&&(c[b]=V[b])}}function re(c){var S=1;c=c.split(":");const b=[];for(;0<S&&c.length;)b.push(c.shift()),S--;return c.length&&b.push(c.join(":")),b}function le(c){g.setTimeout(()=>{throw c},0)}function J(){var c=Ke;let S=null;return c.g&&(S=c.g,c.g=c.g.next,c.g||(c.h=null),S.next=null),S}class pt{constructor(){this.h=this.g=null}add(S,b){const V=Jt.get();V.set(S,b),this.h?this.h.next=V:this.g=V,this.h=V}}var Jt=new Y(()=>new At,c=>c.reset());class At{constructor(){this.next=this.g=this.h=null}set(S,b){this.h=S,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let dt,Ue=!1,Ke=new pt,Be=()=>{const c=g.Promise.resolve(void 0);dt=()=>{c.then(se)}};var se=()=>{for(var c;c=J();){try{c.h.call(c.g)}catch(b){le(b)}var S=Jt;S.j(c),100>S.h&&(S.h++,c.next=S.g,S.g=c)}Ue=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function He(c,S){this.type=c,this.g=this.target=S,this.defaultPrevented=!1}He.prototype.h=function(){this.defaultPrevented=!0};var Ye=function(){if(!g.addEventListener||!Object.defineProperty)return!1;var c=!1,S=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const b=()=>{};g.addEventListener("test",b,S),g.removeEventListener("test",b,S)}catch{}return c}();function mt(c,S){if(He.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var b=this.type=c.type,V=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=S,S=c.relatedTarget){if(me){e:{try{fe(S.nodeName);var de=!0;break e}catch{}de=!1}de||(S=null)}}else b=="mouseover"?S=c.fromElement:b=="mouseout"&&(S=c.toElement);this.relatedTarget=S,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:wt[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&mt.aa.h.call(this)}}F(mt,He);var wt={2:"touch",3:"pen",4:"mouse"};mt.prototype.h=function(){mt.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var et="closure_listenable_"+(1e6*Math.random()|0),vt=0;function Rt(c,S,b,V,de){this.listener=c,this.proxy=null,this.src=S,this.type=b,this.capture=!!V,this.ha=de,this.key=++vt,this.da=this.fa=!1}function Kt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function br(c){this.src=c,this.g={},this.h=0}br.prototype.add=function(c,S,b,V,de){var xe=c.toString();c=this.g[xe],c||(c=this.g[xe]=[],this.h++);var Ge=or(c,S,V,de);return-1<Ge?(S=c[Ge],b||(S.fa=!1)):(S=new Rt(S,this.src,xe,!!V,de),S.fa=b,c.push(S)),S};function bn(c,S){var b=S.type;if(b in c.g){var V=c.g[b],de=Array.prototype.indexOf.call(V,S,void 0),xe;(xe=0<=de)&&Array.prototype.splice.call(V,de,1),xe&&(Kt(S),c.g[b].length==0&&(delete c.g[b],c.h--))}}function or(c,S,b,V){for(var de=0;de<c.length;++de){var xe=c[de];if(!xe.da&&xe.listener==S&&xe.capture==!!b&&xe.ha==V)return de}return-1}var tn="closure_lm_"+(1e6*Math.random()|0),lr={};function Gn(c,S,b,V,de){if(Array.isArray(S)){for(var xe=0;xe<S.length;xe++)Gn(c,S[xe],b,V,de);return null}return b=$(b),c&&c[et]?c.K(S,b,m(V)?!!V.capture:!!V,de):kr(c,S,b,!1,V,de)}function kr(c,S,b,V,de,xe){if(!S)throw Error("Invalid event type");var Ge=m(de)?!!de.capture:!!de,jt=k(c);if(jt||(c[tn]=jt=new br(c)),b=jt.add(S,b,V,Ge,xe),b.proxy)return b;if(V=dr(),b.proxy=V,V.src=c,V.listener=b,c.addEventListener)Ye||(de=Ge),de===void 0&&(de=!1),c.addEventListener(S.toString(),V,de);else if(c.attachEvent)c.attachEvent(ue(S.toString()),V);else if(c.addListener&&c.removeListener)c.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return b}function dr(){function c(b){return S.call(c.src,c.listener,b)}const S=W;return c}function Vi(c,S,b,V,de){if(Array.isArray(S))for(var xe=0;xe<S.length;xe++)Vi(c,S[xe],b,V,de);else V=m(V)?!!V.capture:!!V,b=$(b),c&&c[et]?(c=c.i,S=String(S).toString(),S in c.g&&(xe=c.g[S],b=or(xe,b,V,de),-1<b&&(Kt(xe[b]),Array.prototype.splice.call(xe,b,1),xe.length==0&&(delete c.g[S],c.h--)))):c&&(c=k(c))&&(S=c.g[S.toString()],c=-1,S&&(c=or(S,b,V,de)),(b=-1<c?S[c]:null)&&q(b))}function q(c){if(typeof c!="number"&&c&&!c.da){var S=c.src;if(S&&S[et])bn(S.i,c);else{var b=c.type,V=c.proxy;S.removeEventListener?S.removeEventListener(b,V,c.capture):S.detachEvent?S.detachEvent(ue(b),V):S.addListener&&S.removeListener&&S.removeListener(V),(b=k(S))?(bn(b,c),b.h==0&&(b.src=null,S[tn]=null)):Kt(c)}}}function ue(c){return c in lr?lr[c]:lr[c]="on"+c}function W(c,S){if(c.da)c=!0;else{S=new mt(S,this);var b=c.listener,V=c.ha||c.src;c.fa&&q(c),c=b.call(V,S)}return c}function k(c){return c=c[tn],c instanceof br?c:null}var j="__closure_events_fn_"+(1e9*Math.random()>>>0);function $(c){return typeof c=="function"?c:(c[j]||(c[j]=function(S){return c.handleEvent(S)}),c[j])}function ee(){ye.call(this),this.i=new br(this),this.M=this,this.F=null}F(ee,ye),ee.prototype[et]=!0,ee.prototype.removeEventListener=function(c,S,b,V){Vi(this,c,S,b,V)};function te(c,S){var b,V=c.F;if(V)for(b=[];V;V=V.F)b.push(V);if(c=c.M,V=S.type||S,typeof S=="string")S=new He(S,c);else if(S instanceof He)S.target=S.target||c;else{var de=S;S=new He(V,c),Q(S,de)}if(de=!0,b)for(var xe=b.length-1;0<=xe;xe--){var Ge=S.g=b[xe];de=ae(Ge,V,!0,S)&&de}if(Ge=S.g=c,de=ae(Ge,V,!0,S)&&de,de=ae(Ge,V,!1,S)&&de,b)for(xe=0;xe<b.length;xe++)Ge=S.g=b[xe],de=ae(Ge,V,!1,S)&&de}ee.prototype.N=function(){if(ee.aa.N.call(this),this.i){var c=this.i,S;for(S in c.g){for(var b=c.g[S],V=0;V<b.length;V++)Kt(b[V]);delete c.g[S],c.h--}}this.F=null},ee.prototype.K=function(c,S,b,V){return this.i.add(String(c),S,!1,b,V)},ee.prototype.L=function(c,S,b,V){return this.i.add(String(c),S,!0,b,V)};function ae(c,S,b,V){if(S=c.i.g[String(S)],!S)return!0;S=S.concat();for(var de=!0,xe=0;xe<S.length;++xe){var Ge=S[xe];if(Ge&&!Ge.da&&Ge.capture==b){var jt=Ge.listener,Rr=Ge.ha||Ge.src;Ge.fa&&bn(c.i,Ge),de=jt.call(Rr,V)!==!1&&de}}return de&&!V.defaultPrevented}function _e(c,S,b){if(typeof c=="function")b&&(c=I(c,b));else if(c&&typeof c.handleEvent=="function")c=I(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(S)?-1:g.setTimeout(c,S||0)}function Ie(c){c.g=_e(()=>{c.g=null,c.i&&(c.i=!1,Ie(c))},c.l);const S=c.h;c.h=null,c.m.apply(null,S)}class Ce extends ye{constructor(S,b){super(),this.m=S,this.l=b,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Ie(this)}N(){super.N(),this.g&&(g.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Re(c){ye.call(this),this.h=c,this.g={}}F(Re,ye);var Ne=[];function ke(c){we(c.g,function(S,b){this.g.hasOwnProperty(b)&&q(S)},c),c.g={}}Re.prototype.N=function(){Re.aa.N.call(this),ke(this)},Re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ze=g.JSON.stringify,De=g.JSON.parse,Qe=class{stringify(c){return g.JSON.stringify(c,void 0)}parse(c){return g.JSON.parse(c,void 0)}};function $e(){}$e.prototype.h=null;function lt(c){return c.h||(c.h=c.i())}function bt(){}var st={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Nt(){He.call(this,"d")}F(Nt,He);function Pt(){He.call(this,"c")}F(Pt,He);var gt={},kt=null;function Ft(){return kt=kt||new ee}gt.La="serverreachability";function pr(c){He.call(this,gt.La,c)}F(pr,He);function Zt(c){const S=Ft();te(S,new pr(S))}gt.STAT_EVENT="statevent";function qt(c,S){He.call(this,gt.STAT_EVENT,c),this.stat=S}F(qt,He);function Dt(c){const S=Ft();te(S,new qt(S,c))}gt.Ma="timingevent";function nr(c,S){He.call(this,gt.Ma,c),this.size=S}F(nr,He);function rr(c,S){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return g.setTimeout(function(){c()},S)}function tr(){this.g=!0}tr.prototype.xa=function(){this.g=!1};function Ht(c,S,b,V,de,xe){c.info(function(){if(c.g)if(xe)for(var Ge="",jt=xe.split("&"),Rr=0;Rr<jt.length;Rr++){var Mt=jt[Rr].split("=");if(1<Mt.length){var Fr=Mt[0];Mt=Mt[1];var wr=Fr.split("_");Ge=2<=wr.length&&wr[1]=="type"?Ge+(Fr+"="+Mt+"&"):Ge+(Fr+"=redacted&")}}else Ge=null;else Ge=xe;return"XMLHTTP REQ ("+V+") [attempt "+de+"]: "+S+`
`+b+`
`+Ge})}function Yr(c,S,b,V,de,xe,Ge){c.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+de+"]: "+S+`
`+b+`
`+xe+" "+Ge})}function gr(c,S,b,V){c.info(function(){return"XMLHTTP TEXT ("+S+"): "+Ar(c,b)+(V?" "+V:"")})}function Dr(c,S){c.info(function(){return"TIMEOUT: "+S})}tr.prototype.info=function(){};function Ar(c,S){if(!c.g)return S;if(!S)return null;try{var b=JSON.parse(S);if(b){for(c=0;c<b.length;c++)if(Array.isArray(b[c])){var V=b[c];if(!(2>V.length)){var de=V[1];if(Array.isArray(de)&&!(1>de.length)){var xe=de[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var Ge=1;Ge<de.length;Ge++)de[Ge]=""}}}}return ze(b)}catch{return S}}var jr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},cn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_r;function wn(){}F(wn,$e),wn.prototype.g=function(){return new XMLHttpRequest},wn.prototype.i=function(){return{}},_r=new wn;function Er(c,S,b,V){this.j=c,this.i=S,this.l=b,this.R=V||1,this.U=new Re(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oi}function oi(){this.i=null,this.g="",this.h=!1}var Se={},Tr={};function kn(c,S,b){c.L=1,c.v=qi(Sn(S)),c.m=b,c.P=!0,Kn(c,null)}function Kn(c,S){c.F=Date.now(),Yt(c),c.A=Sn(c.v);var b=c.A,V=c.R;Array.isArray(V)||(V=[String(V)]),Qi(b.i,"t",V),c.C=0,b=c.j.J,c.h=new oi,c.g=qs(c.j,b?S:null,!c.m),0<c.O&&(c.M=new Ce(I(c.Y,c,c.g),c.O)),S=c.U,b=c.g,V=c.ca;var de="readystatechange";Array.isArray(de)||(de&&(Ne[0]=de.toString()),de=Ne);for(var xe=0;xe<de.length;xe++){var Ge=Gn(b,de[xe],V||S.handleEvent,!1,S.h||S);if(!Ge)break;S.g[Ge.key]=Ge}S=c.H?B(c.H):{},c.m?(c.u||(c.u="POST"),S["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,S)):(c.u="GET",c.g.ea(c.A,c.u,null,S)),Zt(),Ht(c.i,c.u,c.A,c.l,c.R,c.m)}Er.prototype.ca=function(c){c=c.target;const S=this.M;S&&nn(c)==3?S.j():this.Y(c)},Er.prototype.Y=function(c){try{if(c==this.g)e:{const wr=nn(this.g);var S=this.g.Ba();const Rn=this.g.Z();if(!(3>wr)&&(wr!=3||this.g&&(this.h.h||this.g.oa()||Ks(this.g)))){this.J||wr!=4||S==7||(S==8||0>=Rn?Zt(3):Zt(2)),wi(this);var b=this.g.Z();this.X=b;t:if(fn(this)){var V=Ks(this.g);c="";var de=V.length,xe=nn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){rn(this),Dn(this);var Ge="";break t}this.h.i=new g.TextDecoder}for(S=0;S<de;S++)this.h.h=!0,c+=this.h.i.decode(V[S],{stream:!(xe&&S==de-1)});V.length=0,this.h.g+=c,this.C=0,Ge=this.h.g}else Ge=this.g.oa();if(this.o=b==200,Yr(this.i,this.u,this.A,this.l,this.R,wr,b),this.o){if(this.T&&!this.K){t:{if(this.g){var jt,Rr=this.g;if((jt=Rr.g?Rr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(jt)){var Mt=jt;break t}}Mt=null}if(b=Mt)gr(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hn(this,b);else{this.o=!1,this.s=3,Dt(12),rn(this),Dn(this);break e}}if(this.P){b=!0;let In;for(;!this.J&&this.C<Ge.length;)if(In=hs(this,Ge),In==Tr){wr==4&&(this.s=4,Dt(14),b=!1),gr(this.i,this.l,null,"[Incomplete Response]");break}else if(In==Se){this.s=4,Dt(15),gr(this.i,this.l,Ge,"[Invalid Chunk]"),b=!1;break}else gr(this.i,this.l,In,null),Hn(this,In);if(fn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wr!=4||Ge.length!=0||this.h.h||(this.s=1,Dt(16),b=!1),this.o=this.o&&b,!b)gr(this.i,this.l,Ge,"[Invalid Chunked Response]"),rn(this),Dn(this);else if(0<Ge.length&&!this.W){this.W=!0;var Fr=this.j;Fr.g==this&&Fr.ba&&!Fr.M&&(Fr.j.info("Great, no buffering proxy detected. Bytes received: "+Ge.length),Vo(Fr),Fr.M=!0,Dt(11))}}else gr(this.i,this.l,Ge,null),Hn(this,Ge);wr==4&&rn(this),this.o&&!this.J&&(wr==4?Ws(this.j,this):(this.o=!1,Yt(this)))}else Ji(this.g),b==400&&0<Ge.indexOf("Unknown SID")?(this.s=3,Dt(12)):(this.s=0,Dt(13)),rn(this),Dn(this)}}}catch{}finally{}};function fn(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function hs(c,S){var b=c.C,V=S.indexOf(`
`,b);return V==-1?Tr:(b=Number(S.substring(b,V)),isNaN(b)?Se:(V+=1,V+b>S.length?Tr:(S=S.slice(V,V+b),c.C=V+b,S)))}Er.prototype.cancel=function(){this.J=!0,rn(this)};function Yt(c){c.S=Date.now()+c.I,ds(c,c.I)}function ds(c,S){if(c.B!=null)throw Error("WatchDog timer not null");c.B=rr(I(c.ba,c),S)}function wi(c){c.B&&(g.clearTimeout(c.B),c.B=null)}Er.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(Dr(this.i,this.A),this.L!=2&&(Zt(),Dt(17)),rn(this),this.s=2,Dn(this)):ds(this,this.S-c)};function Dn(c){c.j.G==0||c.J||Ws(c.j,c)}function rn(c){wi(c);var S=c.M;S&&typeof S.ma=="function"&&S.ma(),c.M=null,ke(c.U),c.g&&(S=c.g,c.g=null,S.abort(),S.ma())}function Hn(c,S){try{var b=c.j;if(b.G!=0&&(b.g==c||Or(b.h,c))){if(!c.K&&Or(b.h,c)&&b.G==3){try{var V=b.Da.g.parse(S)}catch{V=null}if(Array.isArray(V)&&V.length==3){var de=V;if(de[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<c.F)Et(b),Xn(b);else break e;$s(b),Dt(18)}}else b.za=de[1],0<b.za-b.T&&37500>de[2]&&b.F&&b.v==0&&!b.C&&(b.C=rr(I(b.Za,b),6e3));if(1>=ai(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else fi(b,11)}else if((c.K||b.g==c)&&Et(b),!X(S))for(de=b.Da.g.parse(S),S=0;S<de.length;S++){let Mt=de[S];if(b.T=Mt[0],Mt=Mt[1],b.G==2)if(Mt[0]=="c"){b.K=Mt[1],b.ia=Mt[2];const Fr=Mt[3];Fr!=null&&(b.la=Fr,b.j.info("VER="+b.la));const wr=Mt[4];wr!=null&&(b.Aa=wr,b.j.info("SVER="+b.Aa));const Rn=Mt[5];Rn!=null&&typeof Rn=="number"&&0<Rn&&(V=1.5*Rn,b.L=V,b.j.info("backChannelRequestTimeoutMs_="+V)),V=b;const In=c.g;if(In){const Es=In.g?In.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Es){var xe=V.h;xe.g||Es.indexOf("spdy")==-1&&Es.indexOf("quic")==-1&&Es.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(Bi(xe,xe.h),xe.h=null))}if(V.D){const Xs=In.g?In.g.getResponseHeader("X-HTTP-Session-Id"):null;Xs&&(V.ya=Xs,er(V.I,V.D,Xs))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-c.F,b.j.info("Handshake RTT: "+b.R+"ms")),V=b;var Ge=c;if(V.qa=Ra(V,V.J?V.ia:null,V.W),Ge.K){Si(V.h,Ge);var jt=Ge,Rr=V.L;Rr&&(jt.I=Rr),jt.B&&(wi(jt),Yt(jt)),V.g=Ge}else _s(V);0<b.i.length&&Jn(b)}else Mt[0]!="stop"&&Mt[0]!="close"||fi(b,7);else b.G==3&&(Mt[0]=="stop"||Mt[0]=="close"?Mt[0]=="stop"?fi(b,7):Nr(b):Mt[0]!="noop"&&b.l&&b.l.ta(Mt),b.v=0)}}Zt(4)}catch{}}var zs=class{constructor(c,S){this.g=c,this.map=S}};function $n(c){this.l=c||10,g.PerformanceNavigationTiming?(c=g.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(g.chrome&&g.chrome.loadTimes&&g.chrome.loadTimes()&&g.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Lr(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function ai(c){return c.h?1:c.g?c.g.size:0}function Or(c,S){return c.h?c.h==S:c.g?c.g.has(S):!1}function Bi(c,S){c.g?c.g.add(S):c.h=S}function Si(c,S){c.h&&c.h==S?c.h=null:c.g&&c.g.has(S)&&c.g.delete(S)}$n.prototype.cancel=function(){if(this.i=ji(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function ji(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let S=c.i;for(const b of c.g.values())S=S.concat(b.D);return S}return N(c.i)}function zi(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(T(c)){for(var S=[],b=c.length,V=0;V<b;V++)S.push(c[V]);return S}S=[],b=0;for(V in c)S[b++]=c[V];return S}function Gi(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(T(c)||typeof c=="string"){var S=[];c=c.length;for(var b=0;b<c;b++)S.push(b);return S}S=[],b=0;for(const V in c)S[b++]=V;return S}}}function Ki(c,S){if(c.forEach&&typeof c.forEach=="function")c.forEach(S,void 0);else if(T(c)||typeof c=="string")Array.prototype.forEach.call(c,S,void 0);else for(var b=Gi(c),V=zi(c),de=V.length,xe=0;xe<de;xe++)S.call(void 0,V[xe],b&&b[xe],c)}var Hi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yl(c,S){if(c){c=c.split("&");for(var b=0;b<c.length;b++){var V=c[b].indexOf("="),de=null;if(0<=V){var xe=c[b].substring(0,V);de=c[b].substring(V+1)}else xe=c[b];S(xe,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function Ai(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Ai){this.h=c.h,ps(this,c.j),this.o=c.o,this.g=c.g,$i(this,c.s),this.l=c.l;var S=c.i,b=new li;b.i=S.i,S.g&&(b.g=new Map(S.g),b.h=S.h),Wi(this,b),this.m=c.m}else c&&(S=String(c).match(Hi))?(this.h=!1,ps(this,S[1]||"",!0),this.o=Ot(S[2]||""),this.g=Ot(S[3]||"",!0),$i(this,S[4]),this.l=Ot(S[5]||"",!0),Wi(this,S[6]||"",!0),this.m=Ot(S[7]||"")):(this.h=!1,this.i=new li(null,this.h))}Ai.prototype.toString=function(){var c=[],S=this.j;S&&c.push(Yi(S,gs,!0),":");var b=this.g;return(b||S=="file")&&(c.push("//"),(S=this.o)&&c.push(Yi(S,gs,!0),"@"),c.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&c.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&c.push("/"),c.push(Yi(b,b.charAt(0)=="/"?ya:va,!0))),(b=this.i.toString())&&c.push("?",b),(b=this.m)&&c.push("#",Yi(b,No)),c.join("")};function Sn(c){return new Ai(c)}function ps(c,S,b){c.j=b?Ot(S,!0):S,c.j&&(c.j=c.j.replace(/:$/,""))}function $i(c,S){if(S){if(S=Number(S),isNaN(S)||0>S)throw Error("Bad port number "+S);c.s=S}else c.s=null}function Wi(c,S,b){S instanceof li?(c.i=S,ui(c.i,c.h)):(b||(S=Yi(S,Oo)),c.i=new li(S,c.h))}function er(c,S,b){c.i.set(S,b)}function qi(c){return er(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ot(c,S){return c?S?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Yi(c,S,b){return typeof c=="string"?(c=encodeURI(c).replace(S,ma),b&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function ma(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var gs=/[#\/\?@]/g,va=/[#\?:]/g,ya=/[#\?]/g,Oo=/[#\?@]/g,No=/#/g;function li(c,S){this.h=this.g=null,this.i=c||null,this.j=!!S}function zr(c){c.g||(c.g=new Map,c.h=0,c.i&&yl(c.i,function(S,b){c.add(decodeURIComponent(S.replace(/\+/g," ")),b)}))}r=li.prototype,r.add=function(c,S){zr(this),this.i=null,c=Ln(this,c);var b=this.g.get(c);return b||this.g.set(c,b=[]),b.push(S),this.h+=1,this};function Wn(c,S){zr(c),S=Ln(c,S),c.g.has(S)&&(c.i=null,c.h-=c.g.get(S).length,c.g.delete(S))}function qn(c,S){return zr(c),S=Ln(c,S),c.g.has(S)}r.forEach=function(c,S){zr(this),this.g.forEach(function(b,V){b.forEach(function(de){c.call(S,de,V,this)},this)},this)},r.na=function(){zr(this);const c=Array.from(this.g.values()),S=Array.from(this.g.keys()),b=[];for(let V=0;V<S.length;V++){const de=c[V];for(let xe=0;xe<de.length;xe++)b.push(S[V])}return b},r.V=function(c){zr(this);let S=[];if(typeof c=="string")qn(this,c)&&(S=S.concat(this.g.get(Ln(this,c))));else{c=Array.from(this.g.values());for(let b=0;b<c.length;b++)S=S.concat(c[b])}return S},r.set=function(c,S){return zr(this),this.i=null,c=Ln(this,c),qn(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[S]),this.h+=1,this},r.get=function(c,S){return c?(c=this.V(c),0<c.length?String(c[0]):S):S};function Qi(c,S,b){Wn(c,S),0<b.length&&(c.i=null,c.g.set(Ln(c,S),N(b)),c.h+=b.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],S=Array.from(this.g.keys());for(var b=0;b<S.length;b++){var V=S[b];const xe=encodeURIComponent(String(V)),Ge=this.V(V);for(V=0;V<Ge.length;V++){var de=xe;Ge[V]!==""&&(de+="="+encodeURIComponent(String(Ge[V]))),c.push(de)}}return this.i=c.join("&")};function Ln(c,S){return S=String(S),c.j&&(S=S.toLowerCase()),S}function ui(c,S){S&&!c.j&&(zr(c),c.i=null,c.g.forEach(function(b,V){var de=V.toLowerCase();V!=de&&(Wn(this,V),Qi(this,de,b))},c)),c.j=S}function _l(c,S){const b=new tr;if(g.Image){const V=new Image;V.onload=D(hn,b,"TestLoadImage: loaded",!0,S,V),V.onerror=D(hn,b,"TestLoadImage: error",!1,S,V),V.onabort=D(hn,b,"TestLoadImage: abort",!1,S,V),V.ontimeout=D(hn,b,"TestLoadImage: timeout",!1,S,V),g.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=c}else S(!1)}function _a(c,S){const b=new tr,V=new AbortController,de=setTimeout(()=>{V.abort(),hn(b,"TestPingServer: timeout",!1,S)},1e4);fetch(c,{signal:V.signal}).then(xe=>{clearTimeout(de),xe.ok?hn(b,"TestPingServer: ok",!0,S):hn(b,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(de),hn(b,"TestPingServer: error",!1,S)})}function hn(c,S,b,V,de){try{de&&(de.onload=null,de.onerror=null,de.onabort=null,de.ontimeout=null),V(b)}catch{}}function El(){this.g=new Qe}function Ea(c,S,b){const V=b||"";try{Ki(c,function(de,xe){let Ge=de;m(de)&&(Ge=ze(de)),S.push(V+xe+"="+encodeURIComponent(Ge))})}catch(de){throw S.push(V+"type="+encodeURIComponent("_badmap")),de}}function Ri(c){this.l=c.Ub||null,this.j=c.eb||!1}F(Ri,$e),Ri.prototype.g=function(){return new ms(this.l,this.j)},Ri.prototype.i=function(c){return function(){return c}}({});function ms(c,S){ee.call(this),this.D=c,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}F(ms,ee),r=ms.prototype,r.open=function(c,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=S,this.readyState=1,Qn(this)},r.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const S={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(S.body=c),(this.D||g).fetch(new Request(this.A,S)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Yn(this)),this.readyState=0},r.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Qn(this)),this.g&&(this.readyState=3,Qn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof g.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ta(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ta(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}r.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var S=c.value?c.value:new Uint8Array(0);(S=this.v.decode(S,{stream:!c.done}))&&(this.response=this.responseText+=S)}c.done?Yn(this):Qn(this),this.readyState==3&&Ta(this)}},r.Ra=function(c){this.g&&(this.response=this.responseText=c,Yn(this))},r.Qa=function(c){this.g&&(this.response=c,Yn(this))},r.ga=function(){this.g&&Yn(this)};function Yn(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Qn(c)}r.setRequestHeader=function(c,S){this.u.append(c,S)},r.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],S=this.h.entries();for(var b=S.next();!b.done;)b=b.value,c.push(b[0]+": "+b[1]),b=S.next();return c.join(`\r
`)};function Qn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ms.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Ii(c){let S="";return we(c,function(b,V){S+=V,S+=":",S+=b,S+=`\r
`}),S}function Xi(c,S,b){e:{for(V in b){var V=!1;break e}V=!0}V||(b=Ii(b),typeof c=="string"?b!=null&&encodeURIComponent(String(b)):er(c,S,b))}function Qt(c){ee.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}F(Qt,ee);var xa=/^https?$/i,Fo=["POST","PUT"];r=Qt.prototype,r.Ha=function(c){this.J=c},r.ea=function(c,S,b,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);S=S?S.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_r.g(),this.v=this.o?lt(this.o):lt(_r),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(S,String(c),!0),this.B=!1}catch(xe){vs(this,xe);return}if(c=b||"",b=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var de in V)b.set(de,V[de]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const xe of V.keys())b.set(xe,V.get(xe));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(b.keys()).find(xe=>xe.toLowerCase()=="content-type"),de=g.FormData&&c instanceof g.FormData,!(0<=Array.prototype.indexOf.call(Fo,S,void 0))||V||de||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,Ge]of b)this.g.setRequestHeader(xe,Ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Gs(this),this.u=!0,this.g.send(c),this.u=!1}catch(xe){vs(this,xe)}};function vs(c,S){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=S,c.m=5,ys(c),dn(c)}function ys(c){c.A||(c.A=!0,te(c,"complete"),te(c,"error"))}r.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,te(this,"complete"),te(this,"abort"),dn(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),dn(this,!0)),Qt.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Mo(this):this.bb())},r.bb=function(){Mo(this)};function Mo(c){if(c.h&&typeof h<"u"&&(!c.v[1]||nn(c)!=4||c.Z()!=2)){if(c.u&&nn(c)==4)_e(c.Ea,0,c);else if(te(c,"readystatechange"),nn(c)==4){c.h=!1;try{const Ge=c.Z();e:switch(Ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var b;if(!(b=S)){var V;if(V=Ge===0){var de=String(c.D).match(Hi)[1]||null;!de&&g.self&&g.self.location&&(de=g.self.location.protocol.slice(0,-1)),V=!xa.test(de?de.toLowerCase():"")}b=V}if(b)te(c,"complete"),te(c,"success");else{c.m=6;try{var xe=2<nn(c)?c.g.statusText:""}catch{xe=""}c.l=xe+" ["+c.Z()+"]",ys(c)}}finally{dn(c)}}}}function dn(c,S){if(c.g){Gs(c);const b=c.g,V=c.v[0]?()=>{}:null;c.g=null,c.v=null,S||te(c,"ready");try{b.onreadystatechange=V}catch{}}}function Gs(c){c.I&&(g.clearTimeout(c.I),c.I=null)}r.isActive=function(){return!!this.g};function nn(c){return c.g?c.g.readyState:0}r.Z=function(){try{return 2<nn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(c){if(this.g){var S=this.g.responseText;return c&&S.indexOf(c)==0&&(S=S.substring(c.length)),De(S)}};function Ks(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Ji(c){const S={};c=(c.g&&2<=nn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<c.length;V++){if(X(c[V]))continue;var b=re(c[V]);const de=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const xe=S[de]||[];S[de]=xe,xe.push(b)}H(S,function(V){return V.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function An(c,S,b){return b&&b.internalChannelParams&&b.internalChannelParams[c]||S}function Uo(c){this.Aa=0,this.i=[],this.j=new tr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=An("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=An("baseRetryDelayMs",5e3,c),this.cb=An("retryDelaySeedMs",1e4,c),this.Wa=An("forwardChannelMaxRetries",2,c),this.wa=An("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new $n(c&&c.concurrentRequestLimit),this.Da=new El,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Uo.prototype,r.la=8,r.G=1,r.connect=function(c,S,b,V){Dt(0),this.W=c,this.H=S||{},b&&V!==void 0&&(this.H.OSID=b,this.H.OAID=V),this.F=this.X,this.I=Ra(this,null,this.W),Jn(this)};function Nr(c){if(Hs(c),c.G==3){var S=c.U++,b=Sn(c.I);if(er(b,"SID",c.K),er(b,"RID",S),er(b,"TYPE","terminate"),Gr(c,b),S=new Er(c,c.j,S),S.L=2,S.v=qi(Sn(b)),b=!1,g.navigator&&g.navigator.sendBeacon)try{b=g.navigator.sendBeacon(S.v.toString(),"")}catch{}!b&&g.Image&&(new Image().src=S.v,b=!0),b||(S.g=qs(S.j,null),S.g.ea(S.v)),S.F=Date.now(),Yt(S)}Aa(c)}function Xn(c){c.g&&(Vo(c),c.g.cancel(),c.g=null)}function Hs(c){Xn(c),c.u&&(g.clearTimeout(c.u),c.u=null),Et(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&g.clearTimeout(c.s),c.s=null)}function Jn(c){if(!Lr(c.h)&&!c.s){c.s=!0;var S=c.Ga;dt||Be(),Ue||(dt(),Ue=!0),Ke.add(S,c),c.B=0}}function wa(c,S){return ai(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=S.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=rr(I(c.Ga,c,S),ci(c,c.B)),c.B++,!0)}r.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const de=new Er(this,this.j,c);let xe=this.o;if(this.S&&(xe?(xe=B(xe),Q(xe,this.S)):xe=this.S),this.m!==null||this.O||(de.H=xe,xe=null),this.P)e:{for(var S=0,b=0;b<this.i.length;b++){t:{var V=this.i[b];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(S+=V,4096<S){S=b;break e}if(S===4096||b===this.i.length-1){S=b+1;break e}}S=1e3}else S=1e3;S=Zi(this,de,S),b=Sn(this.I),er(b,"RID",c),er(b,"CVER",22),this.D&&er(b,"X-HTTP-Session-Id",this.D),Gr(this,b),xe&&(this.O?S="headers="+encodeURIComponent(String(Ii(xe)))+"&"+S:this.m&&Xi(b,this.m,xe)),Bi(this.h,de),this.Ua&&er(b,"TYPE","init"),this.P?(er(b,"$req",S),er(b,"SID","null"),de.T=!0,kn(de,b,null)):kn(de,b,S),this.G=2}}else this.G==3&&(c?Qr(this,c):this.i.length==0||Lr(this.h)||Qr(this))};function Qr(c,S){var b;S?b=S.l:b=c.U++;const V=Sn(c.I);er(V,"SID",c.K),er(V,"RID",b),er(V,"AID",c.T),Gr(c,V),c.m&&c.o&&Xi(V,c.m,c.o),b=new Er(c,c.j,b,c.B+1),c.m===null&&(b.H=c.o),S&&(c.i=S.D.concat(c.i)),S=Zi(c,b,1e3),b.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Bi(c.h,b),kn(b,V,S)}function Gr(c,S){c.H&&we(c.H,function(b,V){er(S,V,b)}),c.l&&Ki({},function(b,V){er(S,V,b)})}function Zi(c,S,b){b=Math.min(c.i.length,b);var V=c.l?I(c.l.Na,c.l,c):null;e:{var de=c.i;let xe=-1;for(;;){const Ge=["count="+b];xe==-1?0<b?(xe=de[0].g,Ge.push("ofs="+xe)):xe=0:Ge.push("ofs="+xe);let jt=!0;for(let Rr=0;Rr<b;Rr++){let Mt=de[Rr].g;const Fr=de[Rr].map;if(Mt-=xe,0>Mt)xe=Math.max(0,de[Rr].g-100),jt=!1;else try{Ea(Fr,Ge,"req"+Mt+"_")}catch{V&&V(Fr)}}if(jt){V=Ge.join("&");break e}}}return c=c.i.splice(0,b),S.D=c,V}function _s(c){if(!c.g&&!c.u){c.Y=1;var S=c.Fa;dt||Be(),Ue||(dt(),Ue=!0),Ke.add(S,c),c.v=0}}function $s(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=rr(I(c.Fa,c),ci(c,c.v)),c.v++,!0)}r.Fa=function(){if(this.u=null,Sa(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=rr(I(this.ab,this),c)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Dt(10),Xn(this),Sa(this))};function Vo(c){c.A!=null&&(g.clearTimeout(c.A),c.A=null)}function Sa(c){c.g=new Er(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var S=Sn(c.qa);er(S,"RID","rpc"),er(S,"SID",c.K),er(S,"AID",c.T),er(S,"CI",c.F?"0":"1"),!c.F&&c.ja&&er(S,"TO",c.ja),er(S,"TYPE","xmlhttp"),Gr(c,S),c.m&&c.o&&Xi(S,c.m,c.o),c.L&&(c.g.I=c.L);var b=c.g;c=c.ia,b.L=1,b.v=qi(Sn(S)),b.m=null,b.P=!0,Kn(b,c)}r.Za=function(){this.C!=null&&(this.C=null,Xn(this),$s(this),Dt(19))};function Et(c){c.C!=null&&(g.clearTimeout(c.C),c.C=null)}function Ws(c,S){var b=null;if(c.g==S){Et(c),Vo(c),c.g=null;var V=2}else if(Or(c.h,S))b=S.D,Si(c.h,S),V=1;else return;if(c.G!=0){if(S.o)if(V==1){b=S.m?S.m.length:0,S=Date.now()-S.F;var de=c.B;V=Ft(),te(V,new nr(V,b)),Jn(c)}else _s(c);else if(de=S.s,de==3||de==0&&0<S.X||!(V==1&&wa(c,S)||V==2&&$s(c)))switch(b&&0<b.length&&(S=c.h,S.i=S.i.concat(b)),de){case 1:fi(c,5);break;case 4:fi(c,10);break;case 3:fi(c,6);break;default:fi(c,2)}}}function ci(c,S){let b=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(b*=2),b*S}function fi(c,S){if(c.j.info("Error code "+S),S==2){var b=I(c.fb,c),V=c.Xa;const de=!V;V=new Ai(V||"//www.google.com/images/cleardot.gif"),g.location&&g.location.protocol=="http"||ps(V,"https"),qi(V),de?_l(V.toString(),b):_a(V.toString(),b)}else Dt(2);c.G=0,c.l&&c.l.sa(S),Aa(c),Hs(c)}r.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function Aa(c){if(c.G=0,c.ka=[],c.l){const S=ji(c.h);(S.length!=0||c.i.length!=0)&&(U(c.ka,S),U(c.ka,c.i),c.h.i.length=0,N(c.i),c.i.length=0),c.l.ra()}}function Ra(c,S,b){var V=b instanceof Ai?Sn(b):new Ai(b);if(V.g!="")S&&(V.g=S+"."+V.g),$i(V,V.s);else{var de=g.location;V=de.protocol,S=S?S+"."+de.hostname:de.hostname,de=+de.port;var xe=new Ai(null);V&&ps(xe,V),S&&(xe.g=S),de&&$i(xe,de),b&&(xe.l=b),V=xe}return b=c.D,S=c.ya,b&&S&&er(V,b,S),er(V,"VER",c.la),Gr(c,V),V}function qs(c,S,b){if(S&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return S=c.Ca&&!c.pa?new Qt(new Ri({eb:b})):new Qt(c.pa),S.Ha(c.J),S}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ys(){}r=Ys.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Qs(){}Qs.prototype.g=function(c,S){return new xr(c,S)};function xr(c,S){ee.call(this),this.g=new Uo(S),this.l=c,this.h=S&&S.messageUrlParams||null,c=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(c?c["X-WebChannel-Content-Type"]=S.messageContentType:c={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.va&&(c?c["X-WebChannel-Client-Profile"]=S.va:c={"X-WebChannel-Client-Profile":S.va}),this.g.S=c,(c=S&&S.Sb)&&!X(c)&&(this.g.m=c),this.v=S&&S.supportsCrossDomainXhr||!1,this.u=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!X(S)&&(this.g.D=S,c=this.h,c!==null&&S in c&&(c=this.h,S in c&&delete c[S])),this.j=new Zn(this)}F(xr,ee),xr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xr.prototype.close=function(){Nr(this.g)},xr.prototype.o=function(c){var S=this.g;if(typeof c=="string"){var b={};b.__data__=c,c=b}else this.u&&(b={},b.__data__=ze(c),c=b);S.i.push(new zs(S.Ya++,c)),S.G==3&&Jn(S)},xr.prototype.N=function(){this.g.l=null,delete this.j,Nr(this.g),delete this.g,xr.aa.N.call(this)};function Bo(c){Nt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var S=c.__sm__;if(S){e:{for(const b in S){c=b;break e}c=void 0}(this.i=c)&&(c=this.i,S=S!==null&&c in S?S[c]:void 0),this.data=S}else this.data=c}F(Bo,Nt);function jo(){Pt.call(this),this.status=1}F(jo,Pt);function Zn(c){this.g=c}F(Zn,Ys),Zn.prototype.ua=function(){te(this.g,"a")},Zn.prototype.ta=function(c){te(this.g,new Bo(c))},Zn.prototype.sa=function(c){te(this.g,new jo)},Zn.prototype.ra=function(){te(this.g,"b")},Qs.prototype.createWebChannel=Qs.prototype.g,xr.prototype.send=xr.prototype.o,xr.prototype.open=xr.prototype.m,xr.prototype.close=xr.prototype.close,Iy=function(){return new Qs},Ry=function(){return Ft()},Ay=gt,Bd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},jr.NO_ERROR=0,jr.TIMEOUT=8,jr.HTTP_ERROR=6,Uc=jr,cn.COMPLETE="complete",Sy=cn,bt.EventType=st,st.OPEN="a",st.CLOSE="b",st.ERROR="c",st.MESSAGE="d",ee.prototype.listen=ee.prototype.K,$l=bt,Qt.prototype.listenOnce=Qt.prototype.L,Qt.prototype.getLastError=Qt.prototype.Ka,Qt.prototype.getLastErrorCode=Qt.prototype.Ba,Qt.prototype.getStatus=Qt.prototype.Z,Qt.prototype.getResponseJson=Qt.prototype.Oa,Qt.prototype.getResponseText=Qt.prototype.oa,Qt.prototype.send=Qt.prototype.ea,Qt.prototype.setWithCredentials=Qt.prototype.Ha,wy=Qt}).apply(typeof Sc<"u"?Sc:typeof self<"u"?self:typeof window<"u"?window:{});const w0="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}En.UNAUTHENTICATED=new En(null),En.GOOGLE_CREDENTIALS=new En("google-credentials-uid"),En.FIRST_PARTY=new En("first-party-uid"),En.MOCK_USER=new En("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pl="11.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=new mp("@firebase/firestore");function Ya(){return la.logLevel}function Je(r,...e){if(la.logLevel<=Gt.DEBUG){const t=e.map(_p);la.debug(`Firestore (${pl}): ${r}`,...t)}}function Vs(r,...e){if(la.logLevel<=Gt.ERROR){const t=e.map(_p);la.error(`Firestore (${pl}): ${r}`,...t)}}function tl(r,...e){if(la.logLevel<=Gt.WARN){const t=e.map(_p);la.warn(`Firestore (${pl}): ${r}`,...t)}}function _p(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(r="Unexpected state"){const e=`FIRESTORE (${pl}) INTERNAL ASSERTION FAILED: `+r;throw Vs(e),new Error(e)}function Xt(r,e){r||_t()}function St(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends Lo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(En.UNAUTHENTICATED))}shutdown(){}}class XA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class JA{constructor(e){this.t=e,this.currentUser=En.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Xt(this.o===void 0);let i=this.i;const o=T=>this.i!==i?(i=this.i,t(T)):Promise.resolve();let u=new Os;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new Os,e.enqueueRetryable(()=>o(this.currentUser))};const h=()=>{const T=u;e.enqueueRetryable(async()=>{await T.promise,await o(this.currentUser)})},g=T=>{Je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=T,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit(T=>g(T)),setTimeout(()=>{if(!this.auth){const T=this.t.getImmediate({optional:!0});T?g(T):(Je("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new Os)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(Je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Xt(typeof i.accessToken=="string"),new Cy(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(e===null||typeof e=="string"),new En(e)}}class ZA{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=En.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class eR{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new ZA(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(En.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rR{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Xt(this.o===void 0);const i=u=>{u.error!=null&&Je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.R;return this.R=u.token,Je("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable(()=>i(u))};const o=u=>{Je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(u=>o(u)),setTimeout(()=>{if(!this.appCheck){const u=this.A.getImmediate({optional:!0});u?o(u):Je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Xt(typeof t.token=="string"),this.R=t.token,new tR(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<r;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const o=nR(40);for(let u=0;u<o.length;++u)i.length<20&&o[u]<t&&(i+=e.charAt(o[u]%e.length))}return i}}function Bt(r,e){return r<e?-1:r>e?1:0}function rl(r,e,t){return r.length===e.length&&r.every((i,o)=>t(i,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{static now(){return Wr.fromMillis(Date.now())}static fromDate(e){return Wr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Wr(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new at(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new at(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new at(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Bt(this.nanoseconds,e.nanoseconds):Bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{static fromTimestamp(e){return new xt(e)}static min(){return new xt(new Wr(0,0))}static max(){return new xt(new Wr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,t,i){t===void 0?t=0:t>e.length&&_t(),i===void 0?i=e.length-t:i>e.length-t&&_t(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return os.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof os?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const u=os.compareSegments(e.get(o),t.get(o));if(u!==0)return u}return Math.sign(e.length-t.length)}static compareSegments(e,t){const i=os.isNumericId(e),o=os.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?os.extractNumericId(e).compare(os.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return wo.fromString(e.substring(4,e.length-2))}}class fr extends os{construct(e,t,i){return new fr(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new at(Me.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(o=>o.length>0))}return new fr(t)}static emptyPath(){return new fr([])}}const iR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ln extends os{construct(e,t,i){return new ln(e,t,i)}static isValidIdentifier(e){return iR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ln.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ln(["__name__"])}static fromServerFormat(e){const t=[];let i="",o=0;const u=()=>{if(i.length===0)throw new at(Me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let h=!1;for(;o<e.length;){const g=e[o];if(g==="\\"){if(o+1===e.length)throw new at(Me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const T=e[o+1];if(T!=="\\"&&T!=="."&&T!=="`")throw new at(Me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=T,o+=2}else g==="`"?(h=!h,o++):g!=="."||h?(i+=g,o++):(u(),o++)}if(u(),h)throw new at(Me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ln(t)}static emptyPath(){return new ln([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.path=e}static fromPath(e){return new ht(fr.fromString(e))}static fromName(e){return new ht(fr.fromString(e).popFirst(5))}static empty(){return new ht(fr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return fr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ht(new fr(e.slice()))}}function sR(r,e){const t=r.toTimestamp().seconds,i=r.toTimestamp().nanoseconds+1,o=xt.fromTimestamp(i===1e9?new Wr(t+1,0):new Wr(t,i));return new Io(o,ht.empty(),e)}function oR(r){return new Io(r.readTime,r.key,-1)}class Io{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Io(xt.min(),ht.empty(),-1)}static max(){return new Io(xt.max(),ht.empty(),-1)}}function aR(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=ht.comparator(r.documentKey,e.documentKey),t!==0?t:Bt(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gl(r){if(r.code!==Me.FAILED_PRECONDITION||r.message!==lR)throw r;Je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_t(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Pe((i,o)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,o)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Pe?t:Pe.resolve(t)}catch(t){return Pe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Pe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Pe.reject(t)}static resolve(e){return new Pe((t,i)=>{t(e)})}static reject(e){return new Pe((t,i)=>{i(e)})}static waitFor(e){return new Pe((t,i)=>{let o=0,u=0,h=!1;e.forEach(g=>{++o,g.next(()=>{++u,h&&u===o&&t()},T=>i(T))}),h=!0,u===o&&t()})}static or(e){let t=Pe.resolve(!1);for(const i of e)t=t.next(o=>o?Pe.resolve(o):i());return t}static forEach(e,t){const i=[];return e.forEach((o,u)=>{i.push(t.call(this,o,u))}),this.waitFor(i)}static mapArray(e,t){return new Pe((i,o)=>{const u=e.length,h=new Array(u);let g=0;for(let T=0;T<u;T++){const m=T;t(e[m]).next(_=>{h[m]=_,++g,g===u&&i(h)},_=>o(_))}})}static doWhile(e,t){return new Pe((i,o)=>{const u=()=>{e()===!0?t().next(()=>{u()},o):i()};u()})}}function cR(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ml(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ef.oe=-1;function Tf(r){return r==null}function Xc(r){return r===0&&1/r==-1/0}function fR(r){return typeof r=="number"&&Number.isInteger(r)&&!Xc(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=S0(e)),e=dR(r.get(t),e);return S0(e)}function dR(r,e){let t=e;const i=r.length;for(let o=0;o<i;o++){const u=r.charAt(o);switch(u){case"\0":t+="";break;case"":t+="";break;default:t+=u}}return t}function S0(r){return r+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ha(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function by(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,t){this.comparator=e,this.root=t||an.EMPTY}insert(e,t){return new yr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,an.BLACK,null,null))}remove(e){return new yr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,an.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ac(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ac(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ac(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ac(this.root,e,this.comparator,!0)}}class Ac{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&o&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class an{constructor(e,t,i,o,u){this.key=e,this.value=t,this.color=i??an.RED,this.left=o??an.EMPTY,this.right=u??an.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,u){return new an(e??this.key,t??this.value,i??this.color,o??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const u=i(e,o.key);return o=u<0?o.copy(null,null,null,o.left.insert(e,t,i),null):u===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return an.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return an.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,an.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,an.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw _t();const e=this.left.check();if(e!==this.right.check())throw _t();return e+(this.isRed()?0:1)}}an.EMPTY=null,an.RED=!0,an.BLACK=!1;an.EMPTY=new class{constructor(){this.size=0}get key(){throw _t()}get value(){throw _t()}get color(){throw _t()}get left(){throw _t()}get right(){throw _t()}copy(e,t,i,o,u){return this}insert(e,t,i){return new an(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this.comparator=e,this.data=new yr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new R0(this.data.getIterator())}getIteratorFrom(e){return new R0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof qr)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,u=i.getNext().key;if(this.comparator(o,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new qr(this.comparator);return t.data=e,t}}class R0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.fields=e,e.sort(ln.comparator)}static empty(){return new Ni([])}unionWith(e){let t=new qr(ln.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ni(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rl(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new ky("Invalid base64 string: "+u):u}}(e);return new un(t)}static fromUint8Array(e){const t=function(o){let u="";for(let h=0;h<o.length;++h)u+=String.fromCharCode(o[h]);return u}(e);return new un(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}un.EMPTY_BYTE_STRING=new un("");const pR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Co(r){if(Xt(!!r),typeof r=="string"){let e=0;const t=pR.exec(r);if(Xt(!!t),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(r);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Pr(r.seconds),nanos:Pr(r.nanos)}}function Pr(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Po(r){return typeof r=="string"?un.fromBase64String(r):un.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ep(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function xf(r){const e=r.mapValue.fields.__previous_value__;return Ep(e)?xf(e):e}function ou(r){const e=Co(r.mapValue.fields.__local_write_time__.timestampValue);return new Wr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,t,i,o,u,h,g,T,m){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=g,this.longPollingOptions=T,this.useFetchStreams=m}}class au{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new au("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof au&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function bo(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Ep(r)?4:vR(r)?9007199254740991:mR(r)?10:11:_t()}function cs(r,e){if(r===e)return!0;const t=bo(r);if(t!==bo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return ou(r).isEqual(ou(e));case 3:return function(o,u){if(typeof o.timestampValue=="string"&&typeof u.timestampValue=="string"&&o.timestampValue.length===u.timestampValue.length)return o.timestampValue===u.timestampValue;const h=Co(o.timestampValue),g=Co(u.timestampValue);return h.seconds===g.seconds&&h.nanos===g.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(o,u){return Po(o.bytesValue).isEqual(Po(u.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(o,u){return Pr(o.geoPointValue.latitude)===Pr(u.geoPointValue.latitude)&&Pr(o.geoPointValue.longitude)===Pr(u.geoPointValue.longitude)}(r,e);case 2:return function(o,u){if("integerValue"in o&&"integerValue"in u)return Pr(o.integerValue)===Pr(u.integerValue);if("doubleValue"in o&&"doubleValue"in u){const h=Pr(o.doubleValue),g=Pr(u.doubleValue);return h===g?Xc(h)===Xc(g):isNaN(h)&&isNaN(g)}return!1}(r,e);case 9:return rl(r.arrayValue.values||[],e.arrayValue.values||[],cs);case 10:case 11:return function(o,u){const h=o.mapValue.fields||{},g=u.mapValue.fields||{};if(A0(h)!==A0(g))return!1;for(const T in h)if(h.hasOwnProperty(T)&&(g[T]===void 0||!cs(h[T],g[T])))return!1;return!0}(r,e);default:return _t()}}function lu(r,e){return(r.values||[]).find(t=>cs(t,e))!==void 0}function nl(r,e){if(r===e)return 0;const t=bo(r),i=bo(e);if(t!==i)return Bt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Bt(r.booleanValue,e.booleanValue);case 2:return function(u,h){const g=Pr(u.integerValue||u.doubleValue),T=Pr(h.integerValue||h.doubleValue);return g<T?-1:g>T?1:g===T?0:isNaN(g)?isNaN(T)?0:-1:1}(r,e);case 3:return I0(r.timestampValue,e.timestampValue);case 4:return I0(ou(r),ou(e));case 5:return Bt(r.stringValue,e.stringValue);case 6:return function(u,h){const g=Po(u),T=Po(h);return g.compareTo(T)}(r.bytesValue,e.bytesValue);case 7:return function(u,h){const g=u.split("/"),T=h.split("/");for(let m=0;m<g.length&&m<T.length;m++){const _=Bt(g[m],T[m]);if(_!==0)return _}return Bt(g.length,T.length)}(r.referenceValue,e.referenceValue);case 8:return function(u,h){const g=Bt(Pr(u.latitude),Pr(h.latitude));return g!==0?g:Bt(Pr(u.longitude),Pr(h.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return C0(r.arrayValue,e.arrayValue);case 10:return function(u,h){var g,T,m,_;const L=u.fields||{},I=h.fields||{},D=(g=L.value)===null||g===void 0?void 0:g.arrayValue,F=(T=I.value)===null||T===void 0?void 0:T.arrayValue,N=Bt(((m=D==null?void 0:D.values)===null||m===void 0?void 0:m.length)||0,((_=F==null?void 0:F.values)===null||_===void 0?void 0:_.length)||0);return N!==0?N:C0(D,F)}(r.mapValue,e.mapValue);case 11:return function(u,h){if(u===Rc.mapValue&&h===Rc.mapValue)return 0;if(u===Rc.mapValue)return 1;if(h===Rc.mapValue)return-1;const g=u.fields||{},T=Object.keys(g),m=h.fields||{},_=Object.keys(m);T.sort(),_.sort();for(let L=0;L<T.length&&L<_.length;++L){const I=Bt(T[L],_[L]);if(I!==0)return I;const D=nl(g[T[L]],m[_[L]]);if(D!==0)return D}return Bt(T.length,_.length)}(r.mapValue,e.mapValue);default:throw _t()}}function I0(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Bt(r,e);const t=Co(r),i=Co(e),o=Bt(t.seconds,i.seconds);return o!==0?o:Bt(t.nanos,i.nanos)}function C0(r,e){const t=r.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const u=nl(t[o],i[o]);if(u)return u}return Bt(t.length,i.length)}function il(r){return jd(r)}function jd(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const i=Co(t);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Po(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return ht.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let i="[",o=!0;for(const u of t.values||[])o?o=!1:i+=",",i+=jd(u);return i+"]"}(r.arrayValue):"mapValue"in r?function(t){const i=Object.keys(t.fields||{}).sort();let o="{",u=!0;for(const h of i)u?u=!1:o+=",",o+=`${h}:${jd(t.fields[h])}`;return o+"}"}(r.mapValue):_t()}function Vc(r){switch(bo(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=xf(r);return e?16+Vc(e):16;case 5:return 2*r.stringValue.length;case 6:return Po(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((o,u)=>o+Vc(u),0)}(r.arrayValue);case 10:case 11:return function(i){let o=0;return ha(i.fields,(u,h)=>{o+=u.length+Vc(h)}),o}(r.mapValue);default:throw _t()}}function zd(r){return!!r&&"integerValue"in r}function Tp(r){return!!r&&"arrayValue"in r}function P0(r){return!!r&&"nullValue"in r}function b0(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Bc(r){return!!r&&"mapValue"in r}function mR(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Xl(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return ha(r.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Xl(i)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Xl(r.arrayValue.values[t]);return e}return Object.assign({},r)}function vR(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this.value=e}static empty(){return new yi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Bc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xl(t)}setAll(e){let t=ln.emptyPath(),i={},o=[];e.forEach((h,g)=>{if(!t.isImmediateParentOf(g)){const T=this.getFieldsMap(t);this.applyChanges(T,i,o),i={},o=[],t=g.popLast()}h?i[g.lastSegment()]=Xl(h):o.push(g.lastSegment())});const u=this.getFieldsMap(t);this.applyChanges(u,i,o)}delete(e){const t=this.field(e.popLast());Bc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Bc(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){ha(t,(o,u)=>e[o]=u);for(const o of i)delete e[o]}clone(){return new yi(Xl(this.value))}}function Dy(r){const e=[];return ha(r.fields,(t,i)=>{const o=new ln([t]);if(Bc(i)){const u=Dy(i.mapValue).fields;if(u.length===0)e.push(o);else for(const h of u)e.push(o.child(h))}else e.push(o)}),new Ni(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e,t,i,o,u,h,g){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=u,this.data=h,this.documentState=g}static newInvalidDocument(e){return new Tn(e,0,xt.min(),xt.min(),xt.min(),yi.empty(),0)}static newFoundDocument(e,t,i,o){return new Tn(e,1,t,xt.min(),i,o,0)}static newNoDocument(e,t){return new Tn(e,2,t,xt.min(),xt.min(),yi.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,xt.min(),xt.min(),yi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(xt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t){this.position=e,this.inclusive=t}}function k0(r,e,t){let i=0;for(let o=0;o<r.position.length;o++){const u=e[o],h=r.position[o];if(u.field.isKeyField()?i=ht.comparator(ht.fromName(h.referenceValue),t.key):i=nl(h,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function D0(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!cs(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,t="asc"){this.field=e,this.dir=t}}function yR(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{}class $r extends Ly{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new ER(e,t,i):t==="array-contains"?new wR(e,i):t==="in"?new SR(e,i):t==="not-in"?new AR(e,i):t==="array-contains-any"?new RR(e,i):new $r(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new TR(e,i):new xR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(nl(t,this.value)):t!==null&&bo(this.value)===bo(t)&&this.matchesComparison(nl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _t()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fs extends Ly{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new fs(e,t)}matches(e){return Oy(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Oy(r){return r.op==="and"}function Ny(r){return _R(r)&&Oy(r)}function _R(r){for(const e of r.filters)if(e instanceof fs)return!1;return!0}function Gd(r){if(r instanceof $r)return r.field.canonicalString()+r.op.toString()+il(r.value);if(Ny(r))return r.filters.map(e=>Gd(e)).join(",");{const e=r.filters.map(t=>Gd(t)).join(",");return`${r.op}(${e})`}}function Fy(r,e){return r instanceof $r?function(i,o){return o instanceof $r&&i.op===o.op&&i.field.isEqual(o.field)&&cs(i.value,o.value)}(r,e):r instanceof fs?function(i,o){return o instanceof fs&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((u,h,g)=>u&&Fy(h,o.filters[g]),!0):!1}(r,e):void _t()}function My(r){return r instanceof $r?function(t){return`${t.field.canonicalString()} ${t.op} ${il(t.value)}`}(r):r instanceof fs?function(t){return t.op.toString()+" {"+t.getFilters().map(My).join(" ,")+"}"}(r):"Filter"}class ER extends $r{constructor(e,t,i){super(e,t,i),this.key=ht.fromName(i.referenceValue)}matches(e){const t=ht.comparator(e.key,this.key);return this.matchesComparison(t)}}class TR extends $r{constructor(e,t){super(e,"in",t),this.keys=Uy("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class xR extends $r{constructor(e,t){super(e,"not-in",t),this.keys=Uy("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Uy(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>ht.fromName(i.referenceValue))}class wR extends $r{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Tp(t)&&lu(t.arrayValue,this.value)}}class SR extends $r{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&lu(this.value.arrayValue,t)}}class AR extends $r{constructor(e,t){super(e,"not-in",t)}matches(e){if(lu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!lu(this.value.arrayValue,t)}}class RR extends $r{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Tp(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>lu(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e,t=null,i=[],o=[],u=null,h=null,g=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=u,this.startAt=h,this.endAt=g,this.ue=null}}function L0(r,e=null,t=[],i=[],o=null,u=null,h=null){return new IR(r,e,t,i,o,u,h)}function xp(r){const e=St(r);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Gd(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(u){return u.field.canonicalString()+u.dir}(i)).join(","),Tf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>il(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>il(i)).join(",")),e.ue=t}return e.ue}function wp(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!yR(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Fy(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!D0(r.startAt,e.startAt)&&D0(r.endAt,e.endAt)}function Kd(r){return ht.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e,t=null,i=[],o=[],u=null,h="F",g=null,T=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=u,this.limitType=h,this.startAt=g,this.endAt=T,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function CR(r,e,t,i,o,u,h,g){return new wf(r,e,t,i,o,u,h,g)}function Sp(r){return new wf(r)}function O0(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function PR(r){return r.collectionGroup!==null}function Jl(r){const e=St(r);if(e.ce===null){e.ce=[];const t=new Set;for(const u of e.explicitOrderBy)e.ce.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let g=new qr(ln.comparator);return h.filters.forEach(T=>{T.getFlattenedFilters().forEach(m=>{m.isInequality()&&(g=g.add(m.field))})}),g})(e).forEach(u=>{t.has(u.canonicalString())||u.isKeyField()||e.ce.push(new Zc(u,i))}),t.has(ln.keyField().canonicalString())||e.ce.push(new Zc(ln.keyField(),i))}return e.ce}function ls(r){const e=St(r);return e.le||(e.le=bR(e,Jl(r))),e.le}function bR(r,e){if(r.limitType==="F")return L0(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(o=>{const u=o.dir==="desc"?"asc":"desc";return new Zc(o.field,u)});const t=r.endAt?new Jc(r.endAt.position,r.endAt.inclusive):null,i=r.startAt?new Jc(r.startAt.position,r.startAt.inclusive):null;return L0(r.path,r.collectionGroup,e,r.filters,r.limit,t,i)}}function Hd(r,e,t){return new wf(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Sf(r,e){return wp(ls(r),ls(e))&&r.limitType===e.limitType}function Vy(r){return`${xp(ls(r))}|lt:${r.limitType}`}function Qa(r){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(o=>My(o)).join(", ")}]`),Tf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(o=>function(h){return`${h.field.canonicalString()} (${h.dir})`}(o)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(o=>il(o)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(o=>il(o)).join(",")),`Target(${i})`}(ls(r))}; limitType=${r.limitType})`}function Af(r,e){return e.isFoundDocument()&&function(i,o){const u=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):ht.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)}(r,e)&&function(i,o){for(const u of Jl(i))if(!u.field.isKeyField()&&o.data.field(u.field)===null)return!1;return!0}(r,e)&&function(i,o){for(const u of i.filters)if(!u.matches(o))return!1;return!0}(r,e)&&function(i,o){return!(i.startAt&&!function(h,g,T){const m=k0(h,g,T);return h.inclusive?m<=0:m<0}(i.startAt,Jl(i),o)||i.endAt&&!function(h,g,T){const m=k0(h,g,T);return h.inclusive?m>=0:m>0}(i.endAt,Jl(i),o))}(r,e)}function kR(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function By(r){return(e,t)=>{let i=!1;for(const o of Jl(r)){const u=DR(o,e,t);if(u!==0)return u;i=i||o.field.isKeyField()}return 0}}function DR(r,e,t){const i=r.field.isKeyField()?ht.comparator(e.key,t.key):function(u,h,g){const T=h.data.field(u),m=g.data.field(u);return T!==null&&m!==null?nl(T,m):_t()}(r.field,e,t);switch(r.dir){case"asc":return i;case"desc":return-1*i;default:return _t()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,u]of i)if(this.equalsFn(o,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],e))return void(o[u]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){ha(this.inner,(t,i)=>{for(const[o,u]of i)e(o,u)})}isEmpty(){return by(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR=new yr(ht.comparator);function Bs(){return LR}const jy=new yr(ht.comparator);function Wl(...r){let e=jy;for(const t of r)e=e.insert(t.key,t);return e}function zy(r){let e=jy;return r.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function na(){return Zl()}function Gy(){return Zl()}function Zl(){return new da(r=>r.toString(),(r,e)=>r.isEqual(e))}const OR=new yr(ht.comparator),NR=new qr(ht.comparator);function Ut(...r){let e=NR;for(const t of r)e=e.add(t);return e}const FR=new qr(Bt);function MR(){return FR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ap(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xc(e)?"-0":e}}function Ky(r){return{integerValue:""+r}}function UR(r,e){return fR(e)?Ky(e):Ap(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(){this._=void 0}}function VR(r,e,t){return r instanceof ef?function(o,u){const h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return u&&Ep(u)&&(u=xf(u)),u&&(h.fields.__previous_value__=u),{mapValue:h}}(t,e):r instanceof uu?$y(r,e):r instanceof cu?Wy(r,e):function(o,u){const h=Hy(o,u),g=N0(h)+N0(o.Pe);return zd(h)&&zd(o.Pe)?Ky(g):Ap(o.serializer,g)}(r,e)}function BR(r,e,t){return r instanceof uu?$y(r,e):r instanceof cu?Wy(r,e):t}function Hy(r,e){return r instanceof tf?function(i){return zd(i)||function(u){return!!u&&"doubleValue"in u}(i)}(e)?e:{integerValue:0}:null}class ef extends Rf{}class uu extends Rf{constructor(e){super(),this.elements=e}}function $y(r,e){const t=qy(e);for(const i of r.elements)t.some(o=>cs(o,i))||t.push(i);return{arrayValue:{values:t}}}class cu extends Rf{constructor(e){super(),this.elements=e}}function Wy(r,e){let t=qy(e);for(const i of r.elements)t=t.filter(o=>!cs(o,i));return{arrayValue:{values:t}}}class tf extends Rf{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function N0(r){return Pr(r.integerValue||r.doubleValue)}function qy(r){return Tp(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function jR(r,e){return r.field.isEqual(e.field)&&function(i,o){return i instanceof uu&&o instanceof uu||i instanceof cu&&o instanceof cu?rl(i.elements,o.elements,cs):i instanceof tf&&o instanceof tf?cs(i.Pe,o.Pe):i instanceof ef&&o instanceof ef}(r.transform,e.transform)}class zR{constructor(e,t){this.version=e,this.transformResults=t}}class Ns{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ns}static exists(e){return new Ns(void 0,e)}static updateTime(e){return new Ns(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jc(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class If{}function Yy(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new Xy(r.key,Ns.none()):new vu(r.key,r.data,Ns.none());{const t=r.data,i=yi.empty();let o=new qr(ln.comparator);for(let u of e.fields)if(!o.has(u)){let h=t.field(u);h===null&&u.length>1&&(u=u.popLast(),h=t.field(u)),h===null?i.delete(u):i.set(u,h),o=o.add(u)}return new pa(r.key,i,new Ni(o.toArray()),Ns.none())}}function GR(r,e,t){r instanceof vu?function(o,u,h){const g=o.value.clone(),T=M0(o.fieldTransforms,u,h.transformResults);g.setAll(T),u.convertToFoundDocument(h.version,g).setHasCommittedMutations()}(r,e,t):r instanceof pa?function(o,u,h){if(!jc(o.precondition,u))return void u.convertToUnknownDocument(h.version);const g=M0(o.fieldTransforms,u,h.transformResults),T=u.data;T.setAll(Qy(o)),T.setAll(g),u.convertToFoundDocument(h.version,T).setHasCommittedMutations()}(r,e,t):function(o,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()}(0,e,t)}function eu(r,e,t,i){return r instanceof vu?function(u,h,g,T){if(!jc(u.precondition,h))return g;const m=u.value.clone(),_=U0(u.fieldTransforms,T,h);return m.setAll(_),h.convertToFoundDocument(h.version,m).setHasLocalMutations(),null}(r,e,t,i):r instanceof pa?function(u,h,g,T){if(!jc(u.precondition,h))return g;const m=U0(u.fieldTransforms,T,h),_=h.data;return _.setAll(Qy(u)),_.setAll(m),h.convertToFoundDocument(h.version,_).setHasLocalMutations(),g===null?null:g.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map(L=>L.field))}(r,e,t,i):function(u,h,g){return jc(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):g}(r,e,t)}function KR(r,e){let t=null;for(const i of r.fieldTransforms){const o=e.data.field(i.field),u=Hy(i.transform,o||null);u!=null&&(t===null&&(t=yi.empty()),t.set(i.field,u))}return t||null}function F0(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&rl(i,o,(u,h)=>jR(u,h))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class vu extends If{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class pa extends If{constructor(e,t,i,o,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function Qy(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=r.data.field(t);e.set(t,i)}}),e}function M0(r,e,t){const i=new Map;Xt(r.length===t.length);for(let o=0;o<t.length;o++){const u=r[o],h=u.transform,g=e.data.field(u.field);i.set(u.field,BR(h,g,t[o]))}return i}function U0(r,e,t){const i=new Map;for(const o of r){const u=o.transform,h=t.data.field(o.field);i.set(o.field,VR(u,h,e))}return i}class Xy extends If{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class HR extends If{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const u=this.mutations[o];u.key.isEqual(e.key)&&GR(u,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=eu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=eu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Gy();return this.mutations.forEach(o=>{const u=e.get(o.key),h=u.overlayedDocument;let g=this.applyToLocalView(h,u.mutatedFields);g=t.has(o.key)?null:g;const T=Yy(h,g);T!==null&&i.set(o.key,T),h.isValidDocument()||h.convertToNoDocument(xt.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ut())}isEqual(e){return this.batchId===e.batchId&&rl(this.mutations,e.mutations,(t,i)=>F0(t,i))&&rl(this.baseMutations,e.baseMutations,(t,i)=>F0(t,i))}}class Rp{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Xt(e.mutations.length===i.length);let o=function(){return OR}();const u=e.mutations;for(let h=0;h<u.length;h++)o=o.insert(u[h].key,i[h].version);return new Rp(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vr,zt;function YR(r){switch(r){default:return _t();case Me.CANCELLED:case Me.UNKNOWN:case Me.DEADLINE_EXCEEDED:case Me.RESOURCE_EXHAUSTED:case Me.INTERNAL:case Me.UNAVAILABLE:case Me.UNAUTHENTICATED:return!1;case Me.INVALID_ARGUMENT:case Me.NOT_FOUND:case Me.ALREADY_EXISTS:case Me.PERMISSION_DENIED:case Me.FAILED_PRECONDITION:case Me.ABORTED:case Me.OUT_OF_RANGE:case Me.UNIMPLEMENTED:case Me.DATA_LOSS:return!0}}function Jy(r){if(r===void 0)return Vs("GRPC error has no .code"),Me.UNKNOWN;switch(r){case Vr.OK:return Me.OK;case Vr.CANCELLED:return Me.CANCELLED;case Vr.UNKNOWN:return Me.UNKNOWN;case Vr.DEADLINE_EXCEEDED:return Me.DEADLINE_EXCEEDED;case Vr.RESOURCE_EXHAUSTED:return Me.RESOURCE_EXHAUSTED;case Vr.INTERNAL:return Me.INTERNAL;case Vr.UNAVAILABLE:return Me.UNAVAILABLE;case Vr.UNAUTHENTICATED:return Me.UNAUTHENTICATED;case Vr.INVALID_ARGUMENT:return Me.INVALID_ARGUMENT;case Vr.NOT_FOUND:return Me.NOT_FOUND;case Vr.ALREADY_EXISTS:return Me.ALREADY_EXISTS;case Vr.PERMISSION_DENIED:return Me.PERMISSION_DENIED;case Vr.FAILED_PRECONDITION:return Me.FAILED_PRECONDITION;case Vr.ABORTED:return Me.ABORTED;case Vr.OUT_OF_RANGE:return Me.OUT_OF_RANGE;case Vr.UNIMPLEMENTED:return Me.UNIMPLEMENTED;case Vr.DATA_LOSS:return Me.DATA_LOSS;default:return _t()}}(zt=Vr||(Vr={}))[zt.OK=0]="OK",zt[zt.CANCELLED=1]="CANCELLED",zt[zt.UNKNOWN=2]="UNKNOWN",zt[zt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zt[zt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zt[zt.NOT_FOUND=5]="NOT_FOUND",zt[zt.ALREADY_EXISTS=6]="ALREADY_EXISTS",zt[zt.PERMISSION_DENIED=7]="PERMISSION_DENIED",zt[zt.UNAUTHENTICATED=16]="UNAUTHENTICATED",zt[zt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zt[zt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zt[zt.ABORTED=10]="ABORTED",zt[zt.OUT_OF_RANGE=11]="OUT_OF_RANGE",zt[zt.UNIMPLEMENTED=12]="UNIMPLEMENTED",zt[zt.INTERNAL=13]="INTERNAL",zt[zt.UNAVAILABLE=14]="UNAVAILABLE",zt[zt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=new wo([4294967295,4294967295],0);function V0(r){const e=QR().encode(r),t=new xy;return t.update(e),new Uint8Array(t.digest())}function B0(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new wo([t,i],0),new wo([o,u],0)]}class Ip{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ql(`Invalid padding: ${t}`);if(i<0)throw new ql(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ql(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ql(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=wo.fromNumber(this.Te)}de(e,t,i){let o=e.add(t.multiply(wo.fromNumber(i)));return o.compare(XR)===1&&(o=new wo([o.getBits(0),o.getBits(1)],0)),o.modulo(this.Ie).toNumber()}Ee(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=V0(e),[i,o]=B0(t);for(let u=0;u<this.hashCount;u++){const h=this.de(i,o,u);if(!this.Ee(h))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new Ip(u,o,t);return i.forEach(g=>h.insert(g)),h}insert(e){if(this.Te===0)return;const t=V0(e),[i,o]=B0(t);for(let u=0;u<this.hashCount;u++){const h=this.de(i,o,u);this.Ae(h)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ql extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,t,i,o,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,yu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Cf(xt.min(),o,new yr(Bt),Bs(),Ut())}}class yu{constructor(e,t,i,o,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new yu(i,t,Ut(),Ut(),Ut())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e,t,i,o){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=o}}class Zy{constructor(e,t){this.targetId=e,this.me=t}}class e_{constructor(e,t,i=un.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class j0{constructor(){this.fe=0,this.ge=z0(),this.pe=un.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ut(),t=Ut(),i=Ut();return this.ge.forEach((o,u)=>{switch(u){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:_t()}}),new yu(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=z0()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Xt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class JR{constructor(e){this.Be=e,this.Le=new Map,this.ke=Bs(),this.qe=Ic(),this.Qe=Ic(),this.Ke=new yr(Bt)}$e(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{const i=this.ze(t);switch(e.state){case 0:this.je(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.je(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),i.De(e.resumeToken));break;default:_t()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Le.forEach((i,o)=>{this.je(o)&&t(o)})}Je(e){const t=e.targetId,i=e.me.count,o=this.Ye(t);if(o){const u=o.target;if(Kd(u))if(i===0){const h=new ht(u.path);this.We(t,h,Tn.newNoDocument(h,xt.min()))}else Xt(i===1);else{const h=this.Ze(t);if(h!==i){const g=this.Xe(e),T=g?this.et(g,e,h):1;if(T!==0){this.He(t);const m=T===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,m)}}}}}Xe(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:u=0}=t;let h,g;try{h=Po(i).toUint8Array()}catch(T){if(T instanceof ky)return tl("Decoding the base64 bloom filter in existence filter failed ("+T.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw T}try{g=new Ip(h,o,u)}catch(T){return tl(T instanceof ql?"BloomFilter error: ":"Applying bloom filter failed: ",T),null}return g.Te===0?null:g}et(e,t,i){return t.me.count===i-this.rt(e,t.targetId)?0:2}rt(e,t){const i=this.Be.getRemoteKeysForTarget(t);let o=0;return i.forEach(u=>{const h=this.Be.nt(),g=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(g)||(this.We(t,u,null),o++)}),o}it(e){const t=new Map;this.Le.forEach((u,h)=>{const g=this.Ye(h);if(g){if(u.current&&Kd(g.target)){const T=new ht(g.target.path);this.st(T).has(h)||this.ot(h,T)||this.We(h,T,Tn.newNoDocument(T,e))}u.be&&(t.set(h,u.ve()),u.Ce())}});let i=Ut();this.Qe.forEach((u,h)=>{let g=!0;h.forEachWhile(T=>{const m=this.Ye(T);return!m||m.purpose==="TargetPurposeLimboResolution"||(g=!1,!1)}),g&&(i=i.add(u))}),this.ke.forEach((u,h)=>h.setReadTime(e));const o=new Cf(e,t,this.Ke,this.ke,i);return this.ke=Bs(),this.qe=Ic(),this.Qe=Ic(),this.Ke=new yr(Bt),o}Ue(e,t){if(!this.je(e))return;const i=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,i){if(!this.je(e))return;const o=this.ze(e);this.ot(e,t)?o.Fe(t,1):o.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Le.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Le.get(e);return t||(t=new j0,this.Le.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new qr(Bt),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new qr(Bt),this.qe=this.qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||Je("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.Le.get(e);return t&&t.Se?null:this.Be.ut(e)}He(e){this.Le.set(e,new j0),this.Be.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}}function Ic(){return new yr(ht.comparator)}function z0(){return new yr(ht.comparator)}const ZR={asc:"ASCENDING",desc:"DESCENDING"},eI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tI={and:"AND",or:"OR"};class rI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $d(r,e){return r.useProto3Json||Tf(e)?e:{value:e}}function rf(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function t_(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function nI(r,e){return rf(r,e.toTimestamp())}function us(r){return Xt(!!r),xt.fromTimestamp(function(t){const i=Co(t);return new Wr(i.seconds,i.nanos)}(r))}function Cp(r,e){return Wd(r,e).canonicalString()}function Wd(r,e){const t=function(o){return new fr(["projects",o.projectId,"databases",o.database])}(r).child("documents");return e===void 0?t:t.child(e)}function r_(r){const e=fr.fromString(r);return Xt(a_(e)),e}function qd(r,e){return Cp(r.databaseId,e.path)}function gd(r,e){const t=r_(e);if(t.get(1)!==r.databaseId.projectId)throw new at(Me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new at(Me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new ht(i_(t))}function n_(r,e){return Cp(r.databaseId,e)}function iI(r){const e=r_(r);return e.length===4?fr.emptyPath():i_(e)}function Yd(r){return new fr(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function i_(r){return Xt(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function G0(r,e,t){return{name:qd(r,e),fields:t.value.mapValue.fields}}function sI(r,e){let t;if("targetChange"in e){e.targetChange;const i=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:_t()}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],u=function(m,_){return m.useProto3Json?(Xt(_===void 0||typeof _=="string"),un.fromBase64String(_||"")):(Xt(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),un.fromUint8Array(_||new Uint8Array))}(r,e.targetChange.resumeToken),h=e.targetChange.cause,g=h&&function(m){const _=m.code===void 0?Me.UNKNOWN:Jy(m.code);return new at(_,m.message||"")}(h);t=new e_(i,o,u,g||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=gd(r,i.document.name),u=us(i.document.updateTime),h=i.document.createTime?us(i.document.createTime):xt.min(),g=new yi({mapValue:{fields:i.document.fields}}),T=Tn.newFoundDocument(o,u,h,g),m=i.targetIds||[],_=i.removedTargetIds||[];t=new zc(m,_,T.key,T)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=gd(r,i.document),u=i.readTime?us(i.readTime):xt.min(),h=Tn.newNoDocument(o,u),g=i.removedTargetIds||[];t=new zc([],g,h.key,h)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=gd(r,i.document),u=i.removedTargetIds||[];t=new zc([],u,o,null)}else{if(!("filter"in e))return _t();{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:u}=i,h=new qR(o,u),g=i.targetId;t=new Zy(g,h)}}return t}function oI(r,e){let t;if(e instanceof vu)t={update:G0(r,e.key,e.value)};else if(e instanceof Xy)t={delete:qd(r,e.key)};else if(e instanceof pa)t={update:G0(r,e.key,e.data),updateMask:gI(e.fieldMask)};else{if(!(e instanceof HR))return _t();t={verify:qd(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(u,h){const g=h.transform;if(g instanceof ef)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof uu)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof cu)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof tf)return{fieldPath:h.field.canonicalString(),increment:g.Pe};throw _t()}(0,i))),e.precondition.isNone||(t.currentDocument=function(o,u){return u.updateTime!==void 0?{updateTime:nI(o,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:_t()}(r,e.precondition)),t}function aI(r,e){return r&&r.length>0?(Xt(e!==void 0),r.map(t=>function(o,u){let h=o.updateTime?us(o.updateTime):us(u);return h.isEqual(xt.min())&&(h=us(u)),new zR(h,o.transformResults||[])}(t,e))):[]}function lI(r,e){return{documents:[n_(r,e.path)]}}function uI(r,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=n_(r,o);const u=function(m){if(m.length!==0)return o_(fs.create(m,"and"))}(e.filters);u&&(t.structuredQuery.where=u);const h=function(m){if(m.length!==0)return m.map(_=>function(I){return{field:Xa(I.field),direction:hI(I.dir)}}(_))}(e.orderBy);h&&(t.structuredQuery.orderBy=h);const g=$d(r,e.limit);return g!==null&&(t.structuredQuery.limit=g),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ct:t,parent:o}}function cI(r){let e=iI(r.parent);const t=r.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Xt(i===1);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let u=[];t.where&&(u=function(L){const I=s_(L);return I instanceof fs&&Ny(I)?I.getFilters():[I]}(t.where));let h=[];t.orderBy&&(h=function(L){return L.map(I=>function(F){return new Zc(Ja(F.field),function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(F.direction))}(I))}(t.orderBy));let g=null;t.limit&&(g=function(L){let I;return I=typeof L=="object"?L.value:L,Tf(I)?null:I}(t.limit));let T=null;t.startAt&&(T=function(L){const I=!!L.before,D=L.values||[];return new Jc(D,I)}(t.startAt));let m=null;return t.endAt&&(m=function(L){const I=!L.before,D=L.values||[];return new Jc(D,I)}(t.endAt)),CR(e,o,h,u,g,"F",T,m)}function fI(r,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _t()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function s_(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ja(t.unaryFilter.field);return $r.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=Ja(t.unaryFilter.field);return $r.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ja(t.unaryFilter.field);return $r.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=Ja(t.unaryFilter.field);return $r.create(h,"!=",{nullValue:"NULL_VALUE"});default:return _t()}}(r):r.fieldFilter!==void 0?function(t){return $r.create(Ja(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _t()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return fs.create(t.compositeFilter.filters.map(i=>s_(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return _t()}}(t.compositeFilter.op))}(r):_t()}function hI(r){return ZR[r]}function dI(r){return eI[r]}function pI(r){return tI[r]}function Xa(r){return{fieldPath:r.canonicalString()}}function Ja(r){return ln.fromServerFormat(r.fieldPath)}function o_(r){return r instanceof $r?function(t){if(t.op==="=="){if(b0(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NAN"}};if(P0(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(b0(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NOT_NAN"}};if(P0(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xa(t.field),op:dI(t.op),value:t.value}}}(r):r instanceof fs?function(t){const i=t.getFilters().map(o=>o_(o));return i.length===1?i[0]:{compositeFilter:{op:pI(t.op),filters:i}}}(r):_t()}function gI(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function a_(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,t,i,o,u=xt.min(),h=xt.min(),g=un.EMPTY_BYTE_STRING,T=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=g,this.expectedCount=T}withSequenceNumber(e){return new Eo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Eo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e){this.ht=e}}function vI(r){const e=cI({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Hd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(){this.ln=new _I}addToCollectionParentIndex(e,t){return this.ln.add(t),Pe.resolve()}getCollectionParents(e,t){return Pe.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return Pe.resolve()}deleteFieldIndex(e,t){return Pe.resolve()}deleteAllFieldIndexes(e){return Pe.resolve()}createTargetIndexes(e,t){return Pe.resolve()}getDocumentsMatchingTarget(e,t){return Pe.resolve(null)}getIndexType(e,t){return Pe.resolve(0)}getFieldIndexes(e,t){return Pe.resolve([])}getNextCollectionGroupToUpdate(e){return Pe.resolve(null)}getMinOffset(e,t){return Pe.resolve(Io.min())}getMinOffsetFromCollectionGroup(e,t){return Pe.resolve(Io.min())}updateCollectionGroup(e,t,i){return Pe.resolve()}updateIndexEntries(e,t){return Pe.resolve()}}class _I{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new qr(fr.comparator),u=!o.has(i);return this.index[t]=o.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new qr(fr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Bn{static withCacheSize(e){return new Bn(e,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bn.DEFAULT_COLLECTION_PERCENTILE=10,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bn.DEFAULT=new Bn(41943040,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bn.DISABLED=new Bn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new sl(0)}static Qn(){return new sl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0([r,e],[t,i]){const o=Bt(r,t);return o===0?Bt(e,i):o}class EI{constructor(e){this.Gn=e,this.buffer=new qr(H0),this.zn=0}jn(){return++this.zn}Hn(e){const t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();H0(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class TI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){Je("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ml(t)?Je("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await gl(t)}await this.Yn(3e5)})}}class xI{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return Pe.resolve(Ef.oe);const i=new EI(t);return this.Zn.forEachTarget(e,o=>i.Hn(o.sequenceNumber)).next(()=>this.Zn.er(e,o=>i.Hn(o))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Zn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Je("LruGarbageCollector","Garbage collection skipped; disabled"),Pe.resolve(K0)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(Je("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),K0):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let i,o,u,h,g,T,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(L=>(L>this.params.maximumSequenceNumbersToCollect?(Je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${L}`),o=this.params.maximumSequenceNumbersToCollect):o=L,h=Date.now(),this.nthSequenceNumber(e,o))).next(L=>(i=L,g=Date.now(),this.removeTargets(e,i,t))).next(L=>(u=L,T=Date.now(),this.removeOrphanedDocuments(e,i))).next(L=>(m=Date.now(),Ya()<=Gt.DEBUG&&Je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-_}ms
	Determined least recently used ${o} in `+(g-h)+`ms
	Removed ${u} targets in `+(T-g)+`ms
	Removed ${L} documents in `+(m-T)+`ms
Total Duration: ${m-_}ms`),Pe.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:u,documentsRemoved:L})))}}function wI(r,e){return new xI(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(){this.changes=new da(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Pe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(i!==null&&eu(i.mutation,o,Ni.empty(),Wr.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Ut()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Ut()){const o=na();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,i).next(u=>{let h=Wl();return u.forEach((g,T)=>{h=h.insert(g,T.overlayedDocument)}),h}))}getOverlayedDocuments(e,t){const i=na();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Ut()))}populateOverlays(e,t,i){const o=[];return i.forEach(u=>{t.has(u)||o.push(u)}),this.documentOverlayCache.getOverlays(e,o).next(u=>{u.forEach((h,g)=>{t.set(h,g)})})}computeViews(e,t,i,o){let u=Bs();const h=Zl(),g=function(){return Zl()}();return t.forEach((T,m)=>{const _=i.get(m.key);o.has(m.key)&&(_===void 0||_.mutation instanceof pa)?u=u.insert(m.key,m):_!==void 0?(h.set(m.key,_.mutation.getFieldMask()),eu(_.mutation,m,_.mutation.getFieldMask(),Wr.now())):h.set(m.key,Ni.empty())}),this.recalculateAndSaveOverlays(e,u).next(T=>(T.forEach((m,_)=>h.set(m,_)),t.forEach((m,_)=>{var L;return g.set(m,new AI(_,(L=h.get(m))!==null&&L!==void 0?L:null))}),g))}recalculateAndSaveOverlays(e,t){const i=Zl();let o=new yr((h,g)=>h-g),u=Ut();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(h=>{for(const g of h)g.keys().forEach(T=>{const m=t.get(T);if(m===null)return;let _=i.get(T)||Ni.empty();_=g.applyToLocalView(m,_),i.set(T,_);const L=(o.get(g.batchId)||Ut()).add(T);o=o.insert(g.batchId,L)})}).next(()=>{const h=[],g=o.getReverseIterator();for(;g.hasNext();){const T=g.getNext(),m=T.key,_=T.value,L=Gy();_.forEach(I=>{if(!u.has(I)){const D=Yy(t.get(I),i.get(I));D!==null&&L.set(I,D),u=u.add(I)}}),h.push(this.documentOverlayCache.saveOverlays(e,m,L))}return Pe.waitFor(h)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,o){return function(h){return ht.isDocumentKey(h.path)&&h.collectionGroup===null&&h.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):PR(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next(u=>{const h=o-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-u.size):Pe.resolve(na());let g=-1,T=u;return h.next(m=>Pe.forEach(m,(_,L)=>(g<L.largestBatchId&&(g=L.largestBatchId),u.get(_)?Pe.resolve():this.remoteDocumentCache.getEntry(e,_).next(I=>{T=T.insert(_,I)}))).next(()=>this.populateOverlays(e,m,u)).next(()=>this.computeViews(e,T,m,Ut())).next(_=>({batchId:g,changes:zy(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ht(t)).next(i=>{let o=Wl();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const u=t.collectionGroup;let h=Wl();return this.indexManager.getCollectionParents(e,u).next(g=>Pe.forEach(g,T=>{const m=function(L,I){return new wf(I,null,L.explicitOrderBy.slice(),L.filters.slice(),L.limit,L.limitType,L.startAt,L.endAt)}(t,T.child(u));return this.getDocumentsMatchingCollectionQuery(e,m,i,o).next(_=>{_.forEach((L,I)=>{h=h.insert(L,I)})})}).next(()=>h))}getDocumentsMatchingCollectionQuery(e,t,i,o){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,o))).next(h=>{u.forEach((T,m)=>{const _=m.getKey();h.get(_)===null&&(h=h.insert(_,Tn.newInvalidDocument(_)))});let g=Wl();return h.forEach((T,m)=>{const _=u.get(T);_!==void 0&&eu(_.mutation,m,Ni.empty(),Wr.now()),Af(t,m)&&(g=g.insert(T,m))}),g})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return Pe.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:us(o.createTime)}}(t)),Pe.resolve()}getNamedQuery(e,t){return Pe.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(o){return{name:o.name,query:vI(o.bundledQuery),readTime:us(o.readTime)}}(t)),Pe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(){this.overlays=new yr(ht.comparator),this.dr=new Map}getOverlay(e,t){return Pe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=na();return Pe.forEach(t,o=>this.getOverlay(e,o).next(u=>{u!==null&&i.set(o,u)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((o,u)=>{this.Tt(e,t,u)}),Pe.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.dr.get(i);return o!==void 0&&(o.forEach(u=>this.overlays=this.overlays.remove(u)),this.dr.delete(i)),Pe.resolve()}getOverlaysForCollection(e,t,i){const o=na(),u=t.length+1,h=new ht(t.child("")),g=this.overlays.getIteratorFrom(h);for(;g.hasNext();){const T=g.getNext().value,m=T.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===u&&T.largestBatchId>i&&o.set(T.getKey(),T)}return Pe.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let u=new yr((m,_)=>m-_);const h=this.overlays.getIterator();for(;h.hasNext();){const m=h.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let _=u.get(m.largestBatchId);_===null&&(_=na(),u=u.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const g=na(),T=u.getIterator();for(;T.hasNext()&&(T.getNext().value.forEach((m,_)=>g.set(m,_)),!(g.size()>=o)););return Pe.resolve(g)}Tt(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const h=this.dr.get(o.largestBatchId).delete(i.key);this.dr.set(o.largestBatchId,h)}this.overlays=this.overlays.insert(i.key,new WR(t,i));let u=this.dr.get(t);u===void 0&&(u=Ut(),this.dr.set(t,u)),this.dr.set(t,u.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(){this.sessionToken=un.EMPTY_BYTE_STRING}getSessionToken(e){return Pe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Pe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(){this.Er=new qr(en.Ar),this.Rr=new qr(en.Vr)}isEmpty(){return this.Er.isEmpty()}addReference(e,t){const i=new en(e,t);this.Er=this.Er.add(i),this.Rr=this.Rr.add(i)}mr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.gr(new en(e,t))}pr(e,t){e.forEach(i=>this.removeReference(i,t))}yr(e){const t=new ht(new fr([])),i=new en(t,e),o=new en(t,e+1),u=[];return this.Rr.forEachInRange([i,o],h=>{this.gr(h),u.push(h.key)}),u}wr(){this.Er.forEach(e=>this.gr(e))}gr(e){this.Er=this.Er.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const t=new ht(new fr([])),i=new en(t,e),o=new en(t,e+1);let u=Ut();return this.Rr.forEachInRange([i,o],h=>{u=u.add(h.key)}),u}containsKey(e){const t=new en(e,0),i=this.Er.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class en{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return ht.comparator(e.key,t.key)||Bt(e.br,t.br)}static Vr(e,t){return Bt(e.br,t.br)||ht.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new qr(en.Ar)}checkEmpty(e){return Pe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const u=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new $R(u,t,i,o);this.mutationQueue.push(h);for(const g of o)this.vr=this.vr.add(new en(g.key,u)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return Pe.resolve(h)}lookupMutationBatch(e,t){return Pe.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.Fr(i),u=o<0?0:o;return Pe.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Pe.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return Pe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new en(t,0),o=new en(t,Number.POSITIVE_INFINITY),u=[];return this.vr.forEachInRange([i,o],h=>{const g=this.Cr(h.br);u.push(g)}),Pe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new qr(Bt);return t.forEach(o=>{const u=new en(o,0),h=new en(o,Number.POSITIVE_INFINITY);this.vr.forEachInRange([u,h],g=>{i=i.add(g.br)})}),Pe.resolve(this.Mr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let u=i;ht.isDocumentKey(u)||(u=u.child(""));const h=new en(new ht(u),0);let g=new qr(Bt);return this.vr.forEachWhile(T=>{const m=T.key.path;return!!i.isPrefixOf(m)&&(m.length===o&&(g=g.add(T.br)),!0)},h),Pe.resolve(this.Mr(g))}Mr(e){const t=[];return e.forEach(i=>{const o=this.Cr(i);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Xt(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.vr;return Pe.forEach(t.mutations,o=>{const u=new en(o.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.vr=i})}Bn(e){}containsKey(e,t){const i=new en(t,0),o=this.vr.firstAfterOrEqual(i);return Pe.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pe.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e){this.Nr=e,this.docs=function(){return new yr(ht.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),u=o?o.size:0,h=this.Nr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Pe.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=Bs();return t.forEach(o=>{const u=this.docs.get(o);i=i.insert(o,u?u.document.mutableCopy():Tn.newInvalidDocument(o))}),Pe.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let u=Bs();const h=t.path,g=new ht(h.child("__id-9223372036854775808__")),T=this.docs.getIteratorFrom(g);for(;T.hasNext();){const{key:m,value:{document:_}}=T.getNext();if(!h.isPrefixOf(m.path))break;m.path.length>h.length+1||aR(oR(_),i)<=0||(o.has(_.key)||Af(t,_))&&(u=u.insert(_.key,_.mutableCopy()))}return Pe.resolve(u)}getAllFromCollectionGroup(e,t,i,o){_t()}Br(e,t){return Pe.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new DI(this)}getSize(e){return Pe.resolve(this.size)}}class DI extends SI{constructor(e){super(),this.hr=e}applyChanges(e){const t=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?t.push(this.hr.addEntry(e,o)):this.hr.removeEntry(i)}),Pe.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e){this.persistence=e,this.Lr=new da(t=>xp(t),wp),this.lastRemoteSnapshotVersion=xt.min(),this.highestTargetId=0,this.kr=0,this.qr=new Pp,this.targetCount=0,this.Qr=sl.qn()}forEachTarget(e,t){return this.Lr.forEach((i,o)=>t(o)),Pe.resolve()}getLastRemoteSnapshotVersion(e){return Pe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pe.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),Pe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.kr&&(this.kr=t),Pe.resolve()}Un(e){this.Lr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Qr=new sl(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,Pe.resolve()}updateTargetData(e,t){return this.Un(t),Pe.resolve()}removeTargetData(e,t){return this.Lr.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,Pe.resolve()}removeTargets(e,t,i){let o=0;const u=[];return this.Lr.forEach((h,g)=>{g.sequenceNumber<=t&&i.get(g.targetId)===null&&(this.Lr.delete(h),u.push(this.removeMatchingKeysForTargetId(e,g.targetId)),o++)}),Pe.waitFor(u).next(()=>o)}getTargetCount(e){return Pe.resolve(this.targetCount)}getTargetData(e,t){const i=this.Lr.get(t)||null;return Pe.resolve(i)}addMatchingKeys(e,t,i){return this.qr.mr(t,i),Pe.resolve()}removeMatchingKeys(e,t,i){this.qr.pr(t,i);const o=this.persistence.referenceDelegate,u=[];return o&&t.forEach(h=>{u.push(o.markPotentiallyOrphaned(e,h))}),Pe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),Pe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.qr.Sr(t);return Pe.resolve(i)}containsKey(e,t){return Pe.resolve(this.qr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,t){this.Kr={},this.overlays={},this.$r=new Ef(0),this.Ur=!1,this.Ur=!0,this.Wr=new PI,this.referenceDelegate=e(this),this.Gr=new LI(this),this.indexManager=new yI,this.remoteDocumentCache=function(o){return new kI(o)}(i=>this.referenceDelegate.zr(i)),this.serializer=new mI(t),this.jr=new II(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new CI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Kr[e.toKey()];return i||(i=new bI(t,this.referenceDelegate),this.Kr[e.toKey()]=i),i}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,i){Je("MemoryPersistence","Starting transaction:",e);const o=new OI(this.$r.next());return this.referenceDelegate.Hr(),i(o).next(u=>this.referenceDelegate.Jr(o).next(()=>u)).toPromise().then(u=>(o.raiseOnCommittedEvent(),u))}Yr(e,t){return Pe.or(Object.values(this.Kr).map(i=>()=>i.containsKey(e,t)))}}class OI extends uR{constructor(e){super(),this.currentSequenceNumber=e}}class bp{constructor(e){this.persistence=e,this.Zr=new Pp,this.Xr=null}static ei(e){return new bp(e)}get ti(){if(this.Xr)return this.Xr;throw _t()}addReference(e,t,i){return this.Zr.addReference(i,t),this.ti.delete(i.toString()),Pe.resolve()}removeReference(e,t,i){return this.Zr.removeReference(i,t),this.ti.add(i.toString()),Pe.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),Pe.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(o=>this.ti.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(u=>this.ti.add(u.toString()))}).next(()=>i.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pe.forEach(this.ti,i=>{const o=ht.fromPath(i);return this.ni(e,o).next(u=>{u||t.removeEntry(o,xt.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(i=>{i?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return Pe.or([()=>Pe.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}}class nf{constructor(e,t){this.persistence=e,this.ri=new da(i=>hR(i.path),(i,o)=>i.isEqual(o)),this.garbageCollector=wI(this,t)}static ei(e,t){return new nf(e,t)}Hr(){}Jr(e){return Pe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){const t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(o=>i+o))}nr(e){let t=0;return this.er(e,i=>{t++}).next(()=>t)}er(e,t){return Pe.forEach(this.ri,(i,o)=>this.ir(e,i,o).next(u=>u?Pe.resolve():t(o)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),u=o.newChangeBuffer();return o.Br(e,h=>this.ir(e,h,t).next(g=>{g||(i++,u.removeEntry(h,xt.min()))})).next(()=>u.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),Pe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),Pe.resolve()}removeReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),Pe.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),Pe.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Vc(e.data.value)),t}ir(e,t,i){return Pe.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.ri.get(t);return Pe.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Wi=i,this.Gi=o}static zi(e,t){let i=Ut(),o=Ut();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}return new kp(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return k1()?8:cR(C1())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,i,o){const u={result:null};return this.Xi(e,t).next(h=>{u.result=h}).next(()=>{if(!u.result)return this.es(e,t,o,i).next(h=>{u.result=h})}).next(()=>{if(u.result)return;const h=new NI;return this.ts(e,t,h).next(g=>{if(u.result=g,this.Hi)return this.ns(e,t,h,g.size)})}).next(()=>u.result)}ns(e,t,i,o){return i.documentReadCount<this.Ji?(Ya()<=Gt.DEBUG&&Je("QueryEngine","SDK will not create cache indexes for query:",Qa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),Pe.resolve()):(Ya()<=Gt.DEBUG&&Je("QueryEngine","Query:",Qa(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.Yi*o?(Ya()<=Gt.DEBUG&&Je("QueryEngine","The SDK decides to create cache indexes for query:",Qa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ls(t))):Pe.resolve())}Xi(e,t){if(O0(t))return Pe.resolve(null);let i=ls(t);return this.indexManager.getIndexType(e,i).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Hd(t,null,"F"),i=ls(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(u=>{const h=Ut(...u);return this.Zi.getDocuments(e,h).next(g=>this.indexManager.getMinOffset(e,i).next(T=>{const m=this.rs(t,g);return this.ss(t,m,h,T.readTime)?this.Xi(e,Hd(t,null,"F")):this.os(e,m,t,T)}))})))}es(e,t,i,o){return O0(t)||o.isEqual(xt.min())?Pe.resolve(null):this.Zi.getDocuments(e,i).next(u=>{const h=this.rs(t,u);return this.ss(t,h,i,o)?Pe.resolve(null):(Ya()<=Gt.DEBUG&&Je("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Qa(t)),this.os(e,h,t,sR(o,-1)).next(g=>g))})}rs(e,t){let i=new qr(By(e));return t.forEach((o,u)=>{Af(e,u)&&(i=i.add(u))}),i}ss(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(o)>0)}ts(e,t,i){return Ya()<=Gt.DEBUG&&Je("QueryEngine","Using full collection scan to execute query:",Qa(t)),this.Zi.getDocumentsMatchingQuery(e,t,Io.min(),i)}os(e,t,i,o){return this.Zi.getDocumentsMatchingQuery(e,i,o).next(u=>(t.forEach(h=>{u=u.insert(h.key,h)}),u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,t,i,o){this.persistence=e,this._s=t,this.serializer=o,this.us=new yr(Bt),this.cs=new da(u=>xp(u),wp),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(i)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RI(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}}function UI(r,e,t,i){return new MI(r,e,t,i)}async function u_(r,e){const t=St(r);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next(u=>(o=u,t.Ps(e),t.mutationQueue.getAllMutationBatches(i))).next(u=>{const h=[],g=[];let T=Ut();for(const m of o){h.push(m.batchId);for(const _ of m.mutations)T=T.add(_.key)}for(const m of u){g.push(m.batchId);for(const _ of m.mutations)T=T.add(_.key)}return t.localDocuments.getDocuments(i,T).next(m=>({Ts:m,removedBatchIds:h,addedBatchIds:g}))})})}function VI(r,e){const t=St(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=e.batch.keys(),u=t.hs.newChangeBuffer({trackRemovals:!0});return function(g,T,m,_){const L=m.batch,I=L.keys();let D=Pe.resolve();return I.forEach(F=>{D=D.next(()=>_.getEntry(T,F)).next(N=>{const U=m.docVersions.get(F);Xt(U!==null),N.version.compareTo(U)<0&&(L.applyToRemoteDocument(N,m),N.isValidDocument()&&(N.setReadTime(m.commitVersion),_.addEntry(N)))})}),D.next(()=>g.mutationQueue.removeMutationBatch(T,L))}(t,i,e,u).next(()=>u.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(g){let T=Ut();for(let m=0;m<g.mutationResults.length;++m)g.mutationResults[m].transformResults.length>0&&(T=T.add(g.batch.mutations[m].key));return T}(e))).next(()=>t.localDocuments.getDocuments(i,o))})}function c_(r){const e=St(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function BI(r,e){const t=St(r),i=e.snapshotVersion;let o=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",u=>{const h=t.hs.newChangeBuffer({trackRemovals:!0});o=t.us;const g=[];e.targetChanges.forEach((_,L)=>{const I=o.get(L);if(!I)return;g.push(t.Gr.removeMatchingKeys(u,_.removedDocuments,L).next(()=>t.Gr.addMatchingKeys(u,_.addedDocuments,L)));let D=I.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(L)!==null?D=D.withResumeToken(un.EMPTY_BYTE_STRING,xt.min()).withLastLimboFreeSnapshotVersion(xt.min()):_.resumeToken.approximateByteSize()>0&&(D=D.withResumeToken(_.resumeToken,i)),o=o.insert(L,D),function(N,U,Y){return N.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0}(I,D,_)&&g.push(t.Gr.updateTargetData(u,D))});let T=Bs(),m=Ut();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&g.push(t.persistence.referenceDelegate.updateLimboDocument(u,_))}),g.push(jI(u,h,e.documentUpdates).next(_=>{T=_.Is,m=_.ds})),!i.isEqual(xt.min())){const _=t.Gr.getLastRemoteSnapshotVersion(u).next(L=>t.Gr.setTargetsMetadata(u,u.currentSequenceNumber,i));g.push(_)}return Pe.waitFor(g).next(()=>h.apply(u)).next(()=>t.localDocuments.getLocalViewOfDocuments(u,T,m)).next(()=>T)}).then(u=>(t.us=o,u))}function jI(r,e,t){let i=Ut(),o=Ut();return t.forEach(u=>i=i.add(u)),e.getEntries(r,i).next(u=>{let h=Bs();return t.forEach((g,T)=>{const m=u.get(g);T.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(g)),T.isNoDocument()&&T.version.isEqual(xt.min())?(e.removeEntry(g,T.readTime),h=h.insert(g,T)):!m.isValidDocument()||T.version.compareTo(m.version)>0||T.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(T),h=h.insert(g,T)):Je("LocalStore","Ignoring outdated watch update for ",g,". Current version:",m.version," Watch version:",T.version)}),{Is:h,ds:o}})}function zI(r,e){const t=St(r);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function GI(r,e){const t=St(r);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return t.Gr.getTargetData(i,e).next(u=>u?(o=u,Pe.resolve(o)):t.Gr.allocateTargetId(i).next(h=>(o=new Eo(e,h,"TargetPurposeListen",i.currentSequenceNumber),t.Gr.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=t.us.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.us=t.us.insert(i.targetId,i),t.cs.set(e,i.targetId)),i})}async function Qd(r,e,t){const i=St(r),o=i.us.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,h=>i.persistence.referenceDelegate.removeTarget(h,o))}catch(h){if(!ml(h))throw h;Je("LocalStore",`Failed to update sequence numbers for target ${e}: ${h}`)}i.us=i.us.remove(e),i.cs.delete(o.target)}function $0(r,e,t){const i=St(r);let o=xt.min(),u=Ut();return i.persistence.runTransaction("Execute query","readwrite",h=>function(T,m,_){const L=St(T),I=L.cs.get(_);return I!==void 0?Pe.resolve(L.us.get(I)):L.Gr.getTargetData(m,_)}(i,h,ls(e)).next(g=>{if(g)return o=g.lastLimboFreeSnapshotVersion,i.Gr.getMatchingKeysForTargetId(h,g.targetId).next(T=>{u=T})}).next(()=>i._s.getDocumentsMatchingQuery(h,e,t?o:xt.min(),t?u:Ut())).next(g=>(KI(i,kR(e),g),{documents:g,Es:u})))}function KI(r,e,t){let i=r.ls.get(e)||xt.min();t.forEach((o,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)}),r.ls.set(e,i)}class W0{constructor(){this.activeTargetIds=MR()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class HI{constructor(){this._o=new W0,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,i){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new W0,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){Je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){Je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cc=null;function md(){return Cc===null?Cc=function(){return 268435456+Math.round(2147483648*Math.random())}():Cc++,"0x"+Cc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n="WebChannelConnection";class YI extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),u=encodeURIComponent(this.databaseId.database);this.Fo=i+"://"+t.host,this.Mo=`projects/${o}/databases/${u}`,this.xo=this.databaseId.database==="(default)"?`project_id=${o}`:`project_id=${o}&database_id=${u}`}Oo(t,i,o,u,h){const g=md(),T=this.No(t,i.toUriEncodedString());Je("RestConnection",`Sending RPC '${t}' ${g}:`,T,o);const m={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Bo(m,u,h),this.Lo(t,T,m,o).then(_=>(Je("RestConnection",`Received RPC '${t}' ${g}: `,_),_),_=>{throw tl("RestConnection",`RPC '${t}' ${g} failed with error: `,_,"url: ",T,"request:",o),_})}ko(t,i,o,u,h,g){return this.Oo(t,i,o,u,h)}Bo(t,i,o){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+pl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((u,h)=>t[h]=u),o&&o.headers.forEach((u,h)=>t[h]=u)}No(t,i){const o=WI[t];return`${this.Fo}/v1/${i}:${o}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Lo(e,t,i,o){const u=md();return new Promise((h,g)=>{const T=new wy;T.setWithCredentials(!0),T.listenOnce(Sy.COMPLETE,()=>{try{switch(T.getLastErrorCode()){case Uc.NO_ERROR:const _=T.getResponseJson();Je(_n,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(_)),h(_);break;case Uc.TIMEOUT:Je(_n,`RPC '${e}' ${u} timed out`),g(new at(Me.DEADLINE_EXCEEDED,"Request time out"));break;case Uc.HTTP_ERROR:const L=T.getStatus();if(Je(_n,`RPC '${e}' ${u} failed with status:`,L,"response text:",T.getResponseText()),L>0){let I=T.getResponseJson();Array.isArray(I)&&(I=I[0]);const D=I==null?void 0:I.error;if(D&&D.status&&D.message){const F=function(U){const Y=U.toLowerCase().replace(/_/g,"-");return Object.values(Me).indexOf(Y)>=0?Y:Me.UNKNOWN}(D.status);g(new at(F,D.message))}else g(new at(Me.UNKNOWN,"Server responded with status "+T.getStatus()))}else g(new at(Me.UNAVAILABLE,"Connection failed."));break;default:_t()}}finally{Je(_n,`RPC '${e}' ${u} completed.`)}});const m=JSON.stringify(o);Je(_n,`RPC '${e}' ${u} sending request:`,o),T.send(t,"POST",m,i,15)})}qo(e,t,i){const o=md(),u=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=Iy(),g=Ry(),T={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(T.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(T.useFetchStreams=!0),this.Bo(T.initMessageHeaders,t,i),T.encodeInitMessageHeaders=!0;const _=u.join("");Je(_n,`Creating RPC '${e}' stream ${o}: ${_}`,T);const L=h.createWebChannel(_,T);let I=!1,D=!1;const F=new qI({Eo:U=>{D?Je(_n,`Not sending because RPC '${e}' stream ${o} is closed:`,U):(I||(Je(_n,`Opening RPC '${e}' stream ${o} transport.`),L.open(),I=!0),Je(_n,`RPC '${e}' stream ${o} sending:`,U),L.send(U))},Ao:()=>L.close()}),N=(U,Y,X)=>{U.listen(Y,ce=>{try{X(ce)}catch(fe){setTimeout(()=>{throw fe},0)}})};return N(L,$l.EventType.OPEN,()=>{D||(Je(_n,`RPC '${e}' stream ${o} transport opened.`),F.So())}),N(L,$l.EventType.CLOSE,()=>{D||(D=!0,Je(_n,`RPC '${e}' stream ${o} transport closed`),F.Do())}),N(L,$l.EventType.ERROR,U=>{D||(D=!0,tl(_n,`RPC '${e}' stream ${o} transport errored:`,U),F.Do(new at(Me.UNAVAILABLE,"The operation could not be completed")))}),N(L,$l.EventType.MESSAGE,U=>{var Y;if(!D){const X=U.data[0];Xt(!!X);const ce=X,fe=(ce==null?void 0:ce.error)||((Y=ce[0])===null||Y===void 0?void 0:Y.error);if(fe){Je(_n,`RPC '${e}' stream ${o} received error:`,fe);const me=fe.status;let we=function(z){const Q=Vr[z];if(Q!==void 0)return Jy(Q)}(me),H=fe.message;we===void 0&&(we=Me.INTERNAL,H="Unknown error status: "+me+" with message "+fe.message),D=!0,F.Do(new at(we,H)),L.close()}else Je(_n,`RPC '${e}' stream ${o} received:`,X),F.vo(X)}}),N(g,Ay.STAT_EVENT,U=>{U.stat===Bd.PROXY?Je(_n,`RPC '${e}' stream ${o} detected buffering proxy`):U.stat===Bd.NOPROXY&&Je(_n,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{F.bo()},0),F}}function vd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pf(r){return new rI(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,t,i=1e3,o=1.5,u=6e4){this.li=e,this.timerId=t,this.Qo=i,this.Ko=o,this.$o=u,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const t=Math.floor(this.Uo+this.Ho()),i=Math.max(0,Date.now()-this.Go),o=Math.max(0,t-i);o>0&&Je("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,o,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,t,i,o,u,h,g,T){this.li=e,this.Yo=i,this.Zo=o,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=g,this.listener=T,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new f_(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,t){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===Me.RESOURCE_EXHAUSTED?(Vs(t.toString()),Vs("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===Me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(t)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.Xo===t&&this.I_(i,o)},i=>{e(()=>{const o=new at(Me.UNKNOWN,"Fetching auth token failed: "+i.message);return this.d_(o)})})}I_(e,t){const i=this.T_(this.Xo);this.stream=this.E_(e,t),this.stream.Ro(()=>{i(()=>this.listener.Ro())}),this.stream.mo(()=>{i(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(o=>{i(()=>this.d_(o))}),this.stream.onMessage(o=>{i(()=>++this.n_==1?this.A_(o):this.onNext(o))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}d_(e){return Je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(Je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QI extends h_{constructor(e,t,i,o,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,h),this.serializer=u}E_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const t=sI(this.serializer,e),i=function(u){if(!("targetChange"in u))return xt.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?xt.min():h.readTime?us(h.readTime):xt.min()}(e);return this.listener.R_(t,i)}V_(e){const t={};t.database=Yd(this.serializer),t.addTarget=function(u,h){let g;const T=h.target;if(g=Kd(T)?{documents:lI(u,T)}:{query:uI(u,T).ct},g.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){g.resumeToken=t_(u,h.resumeToken);const m=$d(u,h.expectedCount);m!==null&&(g.expectedCount=m)}else if(h.snapshotVersion.compareTo(xt.min())>0){g.readTime=rf(u,h.snapshotVersion.toTimestamp());const m=$d(u,h.expectedCount);m!==null&&(g.expectedCount=m)}return g}(this.serializer,e);const i=fI(this.serializer,e);i&&(t.labels=i),this.c_(t)}m_(e){const t={};t.database=Yd(this.serializer),t.removeTarget=e,this.c_(t)}}class XI extends h_{constructor(e,t,i,o,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,h),this.serializer=u}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}E_(e,t){return this.connection.qo("Write",e,t)}A_(e){return Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const t=aI(e.writeResults,e.commitTime),i=us(e.commitTime);return this.listener.y_(i,t)}w_(){const e={};e.database=Yd(this.serializer),this.c_(e)}g_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>oI(this.serializer,i))};this.c_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI extends class{}{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.S_=!1}b_(){if(this.S_)throw new at(Me.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,i,o){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,h])=>this.connection.Oo(e,Wd(t,i),o,u,h)).catch(u=>{throw u.name==="FirebaseError"?(u.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new at(Me.UNKNOWN,u.toString())})}ko(e,t,i,o,u){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([h,g])=>this.connection.ko(e,Wd(t,i),o,h,g,u)).catch(h=>{throw h.name==="FirebaseError"?(h.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new at(Me.UNKNOWN,h.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class ZI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(Vs(t),this.C_=!1):Je("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,t,i,o,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.B_=[],this.L_=new Map,this.k_=new Set,this.q_=[],this.Q_=u,this.Q_.uo(h=>{i.enqueueAndForget(async()=>{ga(this)&&(Je("RemoteStore","Restarting streams for network reachability change."),await async function(T){const m=St(T);m.k_.add(4),await _u(m),m.K_.set("Unknown"),m.k_.delete(4),await bf(m)}(this))})}),this.K_=new ZI(i,o)}}async function bf(r){if(ga(r))for(const e of r.q_)await e(!0)}async function _u(r){for(const e of r.q_)await e(!1)}function d_(r,e){const t=St(r);t.L_.has(e.targetId)||(t.L_.set(e.targetId,e),Np(t)?Op(t):vl(t).s_()&&Lp(t,e))}function Dp(r,e){const t=St(r),i=vl(t);t.L_.delete(e),i.s_()&&p_(t,e),t.L_.size===0&&(i.s_()?i.a_():ga(t)&&t.K_.set("Unknown"))}function Lp(r,e){if(r.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}vl(r).V_(e)}function p_(r,e){r.U_.xe(e),vl(r).m_(e)}function Op(r){r.U_=new JR({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>r.L_.get(e)||null,nt:()=>r.datastore.serializer.databaseId}),vl(r).start(),r.K_.F_()}function Np(r){return ga(r)&&!vl(r).i_()&&r.L_.size>0}function ga(r){return St(r).k_.size===0}function g_(r){r.U_=void 0}async function tC(r){r.K_.set("Online")}async function rC(r){r.L_.forEach((e,t)=>{Lp(r,e)})}async function nC(r,e){g_(r),Np(r)?(r.K_.O_(e),Op(r)):r.K_.set("Unknown")}async function iC(r,e,t){if(r.K_.set("Online"),e instanceof e_&&e.state===2&&e.cause)try{await async function(o,u){const h=u.cause;for(const g of u.targetIds)o.L_.has(g)&&(await o.remoteSyncer.rejectListen(g,h),o.L_.delete(g),o.U_.removeTarget(g))}(r,e)}catch(i){Je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await sf(r,i)}else if(e instanceof zc?r.U_.$e(e):e instanceof Zy?r.U_.Je(e):r.U_.Ge(e),!t.isEqual(xt.min()))try{const i=await c_(r.localStore);t.compareTo(i)>=0&&await function(u,h){const g=u.U_.it(h);return g.targetChanges.forEach((T,m)=>{if(T.resumeToken.approximateByteSize()>0){const _=u.L_.get(m);_&&u.L_.set(m,_.withResumeToken(T.resumeToken,h))}}),g.targetMismatches.forEach((T,m)=>{const _=u.L_.get(T);if(!_)return;u.L_.set(T,_.withResumeToken(un.EMPTY_BYTE_STRING,_.snapshotVersion)),p_(u,T);const L=new Eo(_.target,T,m,_.sequenceNumber);Lp(u,L)}),u.remoteSyncer.applyRemoteEvent(g)}(r,t)}catch(i){Je("RemoteStore","Failed to raise snapshot:",i),await sf(r,i)}}async function sf(r,e,t){if(!ml(e))throw e;r.k_.add(1),await _u(r),r.K_.set("Offline"),t||(t=()=>c_(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{Je("RemoteStore","Retrying IndexedDB access"),await t(),r.k_.delete(1),await bf(r)})}function m_(r,e){return e().catch(t=>sf(r,t,e))}async function kf(r){const e=St(r),t=ko(e);let i=e.B_.length>0?e.B_[e.B_.length-1].batchId:-1;for(;sC(e);)try{const o=await zI(e.localStore,i);if(o===null){e.B_.length===0&&t.a_();break}i=o.batchId,oC(e,o)}catch(o){await sf(e,o)}v_(e)&&y_(e)}function sC(r){return ga(r)&&r.B_.length<10}function oC(r,e){r.B_.push(e);const t=ko(r);t.s_()&&t.f_&&t.g_(e.mutations)}function v_(r){return ga(r)&&!ko(r).i_()&&r.B_.length>0}function y_(r){ko(r).start()}async function aC(r){ko(r).w_()}async function lC(r){const e=ko(r);for(const t of r.B_)e.g_(t.mutations)}async function uC(r,e,t){const i=r.B_.shift(),o=Rp.from(i,e,t);await m_(r,()=>r.remoteSyncer.applySuccessfulWrite(o)),await kf(r)}async function cC(r,e){e&&ko(r).f_&&await async function(i,o){if(function(h){return YR(h)&&h!==Me.ABORTED}(o.code)){const u=i.B_.shift();ko(i).__(),await m_(i,()=>i.remoteSyncer.rejectFailedWrite(u.batchId,o)),await kf(i)}}(r,e),v_(r)&&y_(r)}async function Y0(r,e){const t=St(r);t.asyncQueue.verifyOperationInProgress(),Je("RemoteStore","RemoteStore received new credentials");const i=ga(t);t.k_.add(3),await _u(t),i&&t.K_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),await bf(t)}async function fC(r,e){const t=St(r);e?(t.k_.delete(2),await bf(t)):e||(t.k_.add(2),await _u(t),t.K_.set("Unknown"))}function vl(r){return r.W_||(r.W_=function(t,i,o){const u=St(t);return u.b_(),new QI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)}(r.datastore,r.asyncQueue,{Ro:tC.bind(null,r),mo:rC.bind(null,r),po:nC.bind(null,r),R_:iC.bind(null,r)}),r.q_.push(async e=>{e?(r.W_.__(),Np(r)?Op(r):r.K_.set("Unknown")):(await r.W_.stop(),g_(r))})),r.W_}function ko(r){return r.G_||(r.G_=function(t,i,o){const u=St(t);return u.b_(),new XI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)}(r.datastore,r.asyncQueue,{Ro:()=>Promise.resolve(),mo:aC.bind(null,r),po:cC.bind(null,r),p_:lC.bind(null,r),y_:uC.bind(null,r)}),r.q_.push(async e=>{e?(r.G_.__(),await kf(r)):(await r.G_.stop(),r.B_.length>0&&(Je("RemoteStore",`Stopping write stream with ${r.B_.length} pending writes`),r.B_=[]))})),r.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e,t,i,o,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=u,this.deferred=new Os,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(h=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,u){const h=Date.now()+i,g=new Fp(e,t,h,o,u);return g.start(i),g}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(Me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mp(r,e){if(Vs("AsyncQueue",`${e}: ${r}`),ml(r))return new at(Me.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{static emptySet(e){return new Za(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ht.comparator(t.key,i.key):(t,i)=>ht.comparator(t.key,i.key),this.keyedMap=Wl(),this.sortedSet=new yr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Za)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,u=i.getNext().key;if(!o.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Za;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(){this.z_=new yr(ht.comparator)}track(e){const t=e.doc.key,i=this.z_.get(t);i?e.type!==0&&i.type===3?this.z_=this.z_.insert(t,e):e.type===3&&i.type!==1?this.z_=this.z_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.z_=this.z_.remove(t):e.type===1&&i.type===2?this.z_=this.z_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):_t():this.z_=this.z_.insert(t,e)}j_(){const e=[];return this.z_.inorderTraversal((t,i)=>{e.push(i)}),e}}class ol{constructor(e,t,i,o,u,h,g,T,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=g,this.excludesMetadataChanges=T,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,o,u){const h=[];return t.forEach(g=>{h.push({type:0,doc:g})}),new ol(e,t,Za.emptySet(t),h,i,o,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class dC{constructor(){this.queries=X0(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,i){const o=St(t),u=o.queries;o.queries=X0(),u.forEach((h,g)=>{for(const T of g.J_)T.onError(i)})})(this,new at(Me.ABORTED,"Firestore shutting down"))}}function X0(){return new da(r=>Vy(r),Sf)}async function __(r,e){const t=St(r);let i=3;const o=e.query;let u=t.queries.get(o);u?!u.Y_()&&e.Z_()&&(i=2):(u=new hC,i=e.Z_()?0:1);try{switch(i){case 0:u.H_=await t.onListen(o,!0);break;case 1:u.H_=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(h){const g=Mp(h,`Initialization of query '${Qa(e.query)}' failed`);return void e.onError(g)}t.queries.set(o,u),u.J_.push(e),e.ea(t.onlineState),u.H_&&e.ta(u.H_)&&Up(t)}async function E_(r,e){const t=St(r),i=e.query;let o=3;const u=t.queries.get(i);if(u){const h=u.J_.indexOf(e);h>=0&&(u.J_.splice(h,1),u.J_.length===0?o=e.Z_()?0:1:!u.Y_()&&e.Z_()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function pC(r,e){const t=St(r);let i=!1;for(const o of e){const u=o.query,h=t.queries.get(u);if(h){for(const g of h.J_)g.ta(o)&&(i=!0);h.H_=o}}i&&Up(t)}function gC(r,e,t){const i=St(r),o=i.queries.get(e);if(o)for(const u of o.J_)u.onError(t);i.queries.delete(e)}function Up(r){r.X_.forEach(e=>{e.next()})}var Xd,J0;(J0=Xd||(Xd={})).na="default",J0.Cache="cache";class T_{constructor(e,t,i){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=i||{}}ta(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new ol(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;const i=t!=="Offline";return(!this.options.ua||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=ol.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==Xd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e){this.key=e}}class w_{constructor(e){this.key=e}}class mC{constructor(e,t){this.query=e,this.Ea=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Ut(),this.mutatedKeys=Ut(),this.Va=By(e),this.ma=new Za(this.Va)}get fa(){return this.Ea}ga(e,t){const i=t?t.pa:new Q0,o=t?t.ma:this.ma;let u=t?t.mutatedKeys:this.mutatedKeys,h=o,g=!1;const T=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,L)=>{const I=o.get(_),D=Af(this.query,L)?L:null,F=!!I&&this.mutatedKeys.has(I.key),N=!!D&&(D.hasLocalMutations||this.mutatedKeys.has(D.key)&&D.hasCommittedMutations);let U=!1;I&&D?I.data.isEqual(D.data)?F!==N&&(i.track({type:3,doc:D}),U=!0):this.ya(I,D)||(i.track({type:2,doc:D}),U=!0,(T&&this.Va(D,T)>0||m&&this.Va(D,m)<0)&&(g=!0)):!I&&D?(i.track({type:0,doc:D}),U=!0):I&&!D&&(i.track({type:1,doc:I}),U=!0,(T||m)&&(g=!0)),U&&(D?(h=h.add(D),u=N?u.add(_):u.delete(_)):(h=h.delete(_),u=u.delete(_)))}),this.query.limit!==null)for(;h.size>this.query.limit;){const _=this.query.limitType==="F"?h.last():h.first();h=h.delete(_.key),u=u.delete(_.key),i.track({type:1,doc:_})}return{ma:h,pa:i,ss:g,mutatedKeys:u}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const u=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const h=e.pa.j_();h.sort((_,L)=>function(D,F){const N=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _t()}};return N(D)-N(F)}(_.type,L.type)||this.Va(_.doc,L.doc)),this.wa(i),o=o!=null&&o;const g=t&&!o?this.Sa():[],T=this.Ra.size===0&&this.current&&!o?1:0,m=T!==this.Aa;return this.Aa=T,h.length!==0||m?{snapshot:new ol(this.query,e.ma,u,h,e.mutatedKeys,T===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),ba:g}:{ba:g}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new Q0,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.Ea.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.Ea=this.Ea.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ea=this.Ea.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=Ut(),this.ma.forEach(i=>{this.Da(i.key)&&(this.Ra=this.Ra.add(i.key))});const t=[];return e.forEach(i=>{this.Ra.has(i)||t.push(new w_(i))}),this.Ra.forEach(i=>{e.has(i)||t.push(new x_(i))}),t}va(e){this.Ea=e.Es,this.Ra=Ut();const t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return ol.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class vC{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class yC{constructor(e){this.key=e,this.Fa=!1}}class _C{constructor(e,t,i,o,u,h){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Ma={},this.xa=new da(g=>Vy(g),Sf),this.Oa=new Map,this.Na=new Set,this.Ba=new yr(ht.comparator),this.La=new Map,this.ka=new Pp,this.qa={},this.Qa=new Map,this.Ka=sl.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function EC(r,e,t=!0){const i=P_(r);let o;const u=i.xa.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),o=u.view.Ca()):o=await S_(i,e,t,!0),o}async function TC(r,e){const t=P_(r);await S_(t,e,!0,!1)}async function S_(r,e,t,i){const o=await GI(r.localStore,ls(e)),u=o.targetId,h=r.sharedClientState.addLocalQueryTarget(u,t);let g;return i&&(g=await xC(r,e,u,h==="current",o.resumeToken)),r.isPrimaryClient&&t&&d_(r.remoteStore,o),g}async function xC(r,e,t,i,o){r.Ua=(L,I,D)=>async function(N,U,Y,X){let ce=U.view.ga(Y);ce.ss&&(ce=await $0(N.localStore,U.query,!1).then(({documents:H})=>U.view.ga(H,ce)));const fe=X&&X.targetChanges.get(U.targetId),me=X&&X.targetMismatches.get(U.targetId)!=null,we=U.view.applyChanges(ce,N.isPrimaryClient,fe,me);return ev(N,U.targetId,we.ba),we.snapshot}(r,L,I,D);const u=await $0(r.localStore,e,!0),h=new mC(e,u.Es),g=h.ga(u.documents),T=yu.createSynthesizedTargetChangeForCurrentChange(t,i&&r.onlineState!=="Offline",o),m=h.applyChanges(g,r.isPrimaryClient,T);ev(r,t,m.ba);const _=new vC(e,t,h);return r.xa.set(e,_),r.Oa.has(t)?r.Oa.get(t).push(e):r.Oa.set(t,[e]),m.snapshot}async function wC(r,e,t){const i=St(r),o=i.xa.get(e),u=i.Oa.get(o.targetId);if(u.length>1)return i.Oa.set(o.targetId,u.filter(h=>!Sf(h,e))),void i.xa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await Qd(i.localStore,o.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(o.targetId),t&&Dp(i.remoteStore,o.targetId),Jd(i,o.targetId)}).catch(gl)):(Jd(i,o.targetId),await Qd(i.localStore,o.targetId,!0))}async function SC(r,e){const t=St(r),i=t.xa.get(e),o=t.Oa.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Dp(t.remoteStore,i.targetId))}async function AC(r,e,t){const i=DC(r);try{const o=await function(h,g){const T=St(h),m=Wr.now(),_=g.reduce((D,F)=>D.add(F.key),Ut());let L,I;return T.persistence.runTransaction("Locally write mutations","readwrite",D=>{let F=Bs(),N=Ut();return T.hs.getEntries(D,_).next(U=>{F=U,F.forEach((Y,X)=>{X.isValidDocument()||(N=N.add(Y))})}).next(()=>T.localDocuments.getOverlayedDocuments(D,F)).next(U=>{L=U;const Y=[];for(const X of g){const ce=KR(X,L.get(X.key).overlayedDocument);ce!=null&&Y.push(new pa(X.key,ce,Dy(ce.value.mapValue),Ns.exists(!0)))}return T.mutationQueue.addMutationBatch(D,m,Y,g)}).next(U=>{I=U;const Y=U.applyToLocalDocumentSet(L,N);return T.documentOverlayCache.saveOverlays(D,U.batchId,Y)})}).then(()=>({batchId:I.batchId,changes:zy(L)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),function(h,g,T){let m=h.qa[h.currentUser.toKey()];m||(m=new yr(Bt)),m=m.insert(g,T),h.qa[h.currentUser.toKey()]=m}(i,o.batchId,t),await Eu(i,o.changes),await kf(i.remoteStore)}catch(o){const u=Mp(o,"Failed to persist write");t.reject(u)}}async function A_(r,e){const t=St(r);try{const i=await BI(t.localStore,e);e.targetChanges.forEach((o,u)=>{const h=t.La.get(u);h&&(Xt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?h.Fa=!0:o.modifiedDocuments.size>0?Xt(h.Fa):o.removedDocuments.size>0&&(Xt(h.Fa),h.Fa=!1))}),await Eu(t,i,e)}catch(i){await gl(i)}}function Z0(r,e,t){const i=St(r);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.xa.forEach((u,h)=>{const g=h.view.ea(e);g.snapshot&&o.push(g.snapshot)}),function(h,g){const T=St(h);T.onlineState=g;let m=!1;T.queries.forEach((_,L)=>{for(const I of L.J_)I.ea(g)&&(m=!0)}),m&&Up(T)}(i.eventManager,e),o.length&&i.Ma.R_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function RC(r,e,t){const i=St(r);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.La.get(e),u=o&&o.key;if(u){let h=new yr(ht.comparator);h=h.insert(u,Tn.newNoDocument(u,xt.min()));const g=Ut().add(u),T=new Cf(xt.min(),new Map,new yr(Bt),h,g);await A_(i,T),i.Ba=i.Ba.remove(u),i.La.delete(e),Vp(i)}else await Qd(i.localStore,e,!1).then(()=>Jd(i,e,t)).catch(gl)}async function IC(r,e){const t=St(r),i=e.batch.batchId;try{const o=await VI(t.localStore,e);I_(t,i,null),R_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Eu(t,o)}catch(o){await gl(o)}}async function CC(r,e,t){const i=St(r);try{const o=await function(h,g){const T=St(h);return T.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let _;return T.mutationQueue.lookupMutationBatch(m,g).next(L=>(Xt(L!==null),_=L.keys(),T.mutationQueue.removeMutationBatch(m,L))).next(()=>T.mutationQueue.performConsistencyCheck(m)).next(()=>T.documentOverlayCache.removeOverlaysForBatchId(m,_,g)).next(()=>T.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_)).next(()=>T.localDocuments.getDocuments(m,_))})}(i.localStore,e);I_(i,e,t),R_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Eu(i,o)}catch(o){await gl(o)}}function R_(r,e){(r.Qa.get(e)||[]).forEach(t=>{t.resolve()}),r.Qa.delete(e)}function I_(r,e,t){const i=St(r);let o=i.qa[i.currentUser.toKey()];if(o){const u=o.get(e);u&&(t?u.reject(t):u.resolve(),o=o.remove(e)),i.qa[i.currentUser.toKey()]=o}}function Jd(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const i of r.Oa.get(e))r.xa.delete(i),t&&r.Ma.Wa(i,t);r.Oa.delete(e),r.isPrimaryClient&&r.ka.yr(e).forEach(i=>{r.ka.containsKey(i)||C_(r,i)})}function C_(r,e){r.Na.delete(e.path.canonicalString());const t=r.Ba.get(e);t!==null&&(Dp(r.remoteStore,t),r.Ba=r.Ba.remove(e),r.La.delete(t),Vp(r))}function ev(r,e,t){for(const i of t)i instanceof x_?(r.ka.addReference(i.key,e),PC(r,i)):i instanceof w_?(Je("SyncEngine","Document no longer in limbo: "+i.key),r.ka.removeReference(i.key,e),r.ka.containsKey(i.key)||C_(r,i.key)):_t()}function PC(r,e){const t=e.key,i=t.path.canonicalString();r.Ba.get(t)||r.Na.has(i)||(Je("SyncEngine","New document in limbo: "+t),r.Na.add(i),Vp(r))}function Vp(r){for(;r.Na.size>0&&r.Ba.size<r.maxConcurrentLimboResolutions;){const e=r.Na.values().next().value;r.Na.delete(e);const t=new ht(fr.fromString(e)),i=r.Ka.next();r.La.set(i,new yC(t)),r.Ba=r.Ba.insert(t,i),d_(r.remoteStore,new Eo(ls(Sp(t.path)),i,"TargetPurposeLimboResolution",Ef.oe))}}async function Eu(r,e,t){const i=St(r),o=[],u=[],h=[];i.xa.isEmpty()||(i.xa.forEach((g,T)=>{h.push(i.Ua(T,e,t).then(m=>{var _;if((m||t)&&i.isPrimaryClient){const L=m?!m.fromCache:(_=t==null?void 0:t.targetChanges.get(T.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(T.targetId,L?"current":"not-current")}if(m){o.push(m);const L=kp.zi(T.targetId,m);u.push(L)}}))}),await Promise.all(h),i.Ma.R_(o),await async function(T,m){const _=St(T);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",L=>Pe.forEach(m,I=>Pe.forEach(I.Wi,D=>_.persistence.referenceDelegate.addReference(L,I.targetId,D)).next(()=>Pe.forEach(I.Gi,D=>_.persistence.referenceDelegate.removeReference(L,I.targetId,D)))))}catch(L){if(!ml(L))throw L;Je("LocalStore","Failed to update sequence numbers: "+L)}for(const L of m){const I=L.targetId;if(!L.fromCache){const D=_.us.get(I),F=D.snapshotVersion,N=D.withLastLimboFreeSnapshotVersion(F);_.us=_.us.insert(I,N)}}}(i.localStore,u))}async function bC(r,e){const t=St(r);if(!t.currentUser.isEqual(e)){Je("SyncEngine","User change. New user:",e.toKey());const i=await u_(t.localStore,e);t.currentUser=e,function(u,h){u.Qa.forEach(g=>{g.forEach(T=>{T.reject(new at(Me.CANCELLED,h))})}),u.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Eu(t,i.Ts)}}function kC(r,e){const t=St(r),i=t.La.get(e);if(i&&i.Fa)return Ut().add(i.key);{let o=Ut();const u=t.Oa.get(e);if(!u)return o;for(const h of u){const g=t.xa.get(h);o=o.unionWith(g.view.fa)}return o}}function P_(r){const e=St(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=A_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RC.bind(null,e),e.Ma.R_=pC.bind(null,e.eventManager),e.Ma.Wa=gC.bind(null,e.eventManager),e}function DC(r){const e=St(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=CC.bind(null,e),e}class of{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pf(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,t){return null}Ya(e,t){return null}Ha(e){return UI(this.persistence,new FI,e.initialUser,this.serializer)}ja(e){return new l_(bp.ei,this.serializer)}za(e){return new HI}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}of.provider={build:()=>new of};class LC extends of{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){Xt(this.persistence.referenceDelegate instanceof nf);const i=this.persistence.referenceDelegate.garbageCollector;return new TI(i,e.asyncQueue,t)}ja(e){const t=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new l_(i=>nf.ei(i,t),this.serializer)}}class Zd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Z0(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bC.bind(null,this.syncEngine),await fC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dC}()}createDatastore(e){const t=Pf(e.databaseInfo.databaseId),i=function(u){return new YI(u)}(e.databaseInfo);return function(u,h,g,T){return new JI(u,h,g,T)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,o,u,h,g){return new eC(i,o,u,h,g)}(this.localStore,this.datastore,e.asyncQueue,t=>Z0(this.syncEngine,t,0),function(){return q0.p()?new q0:new $I}())}createSyncEngine(e,t){return function(o,u,h,g,T,m,_){const L=new _C(o,u,h,g,T,m);return _&&(L.$a=!0),L}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const u=St(o);Je("RemoteStore","RemoteStore shutting down."),u.k_.add(5),await _u(u),u.Q_.shutdown(),u.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Zd.provider={build:()=>new Zd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):Vs("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,t,i,o,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=En.UNAUTHENTICATED,this.clientId=Py.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,async h=>{Je("FirestoreClient","Received user=",h.uid),await this.authCredentialListener(h),this.user=h}),this.appCheckCredentials.start(i,h=>(Je("FirestoreClient","Received new app check token=",h),this.appCheckCredentialListener(h,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Os;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Mp(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function yd(r,e){r.asyncQueue.verifyOperationInProgress(),Je("FirestoreClient","Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let i=t.initialUser;r.setCredentialChangeListener(async o=>{i.isEqual(o)||(await u_(e.localStore,o),i=o)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function tv(r,e){r.asyncQueue.verifyOperationInProgress();const t=await NC(r);Je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(i=>Y0(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,o)=>Y0(e.remoteStore,o)),r._onlineComponents=e}async function NC(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Je("FirestoreClient","Using user provided OfflineComponentProvider");try{await yd(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===Me.FAILED_PRECONDITION||o.code===Me.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;tl("Error using user provided cache. Falling back to memory cache: "+t),await yd(r,new of)}}else Je("FirestoreClient","Using default OfflineComponentProvider"),await yd(r,new LC(void 0));return r._offlineComponents}async function k_(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Je("FirestoreClient","Using user provided OnlineComponentProvider"),await tv(r,r._uninitializedComponentsProvider._online)):(Je("FirestoreClient","Using default OnlineComponentProvider"),await tv(r,new Zd))),r._onlineComponents}function FC(r){return k_(r).then(e=>e.syncEngine)}async function D_(r){const e=await k_(r),t=e.eventManager;return t.onListen=EC.bind(null,e.syncEngine),t.onUnlisten=wC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=TC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=SC.bind(null,e.syncEngine),t}function MC(r,e,t={}){const i=new Os;return r.asyncQueue.enqueueAndForget(async()=>function(u,h,g,T,m){const _=new b_({next:I=>{_.eu(),h.enqueueAndForget(()=>E_(u,L));const D=I.docs.has(g);!D&&I.fromCache?m.reject(new at(Me.UNAVAILABLE,"Failed to get document because the client is offline.")):D&&I.fromCache&&T&&T.source==="server"?m.reject(new at(Me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(I)},error:I=>m.reject(I)}),L=new T_(Sp(g.path),_,{includeMetadataChanges:!0,ua:!0});return __(u,L)}(await D_(r),r.asyncQueue,e,t,i)),i.promise}function UC(r,e,t={}){const i=new Os;return r.asyncQueue.enqueueAndForget(async()=>function(u,h,g,T,m){const _=new b_({next:I=>{_.eu(),h.enqueueAndForget(()=>E_(u,L)),I.fromCache&&T.source==="server"?m.reject(new at(Me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(I)},error:I=>m.reject(I)}),L=new T_(g,_,{includeMetadataChanges:!0,ua:!0});return __(u,L)}(await D_(r),r.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O_(r,e,t){if(!t)throw new at(Me.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function VC(r,e,t,i){if(e===!0&&i===!0)throw new at(Me.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function nv(r){if(!ht.isDocumentKey(r))throw new at(Me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function iv(r){if(ht.isDocumentKey(r))throw new at(Me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Bp(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":_t()}function al(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new at(Me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bp(r);throw new at(Me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new at(Me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new at(Me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=L_((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(u){if(u.timeoutSeconds!==void 0){if(isNaN(u.timeoutSeconds))throw new at(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${u.timeoutSeconds} (must not be NaN)`);if(u.timeoutSeconds<5)throw new at(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${u.timeoutSeconds} (minimum allowed value is 5)`);if(u.timeoutSeconds>30)throw new at(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${u.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Df{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(Me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(Me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sv(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new QA;switch(i.type){case"firstParty":return new eR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new at(Me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=rv.get(t);i&&(Je("ComponentProvider","Removing Datastore"),rv.delete(t),i.terminate())}(this),Promise.resolve()}}function BC(r,e,t,i={}){var o;const u=(r=al(r,Df))._getSettings(),h=`${e}:${t}`;if(u.host!=="firestore.googleapis.com"&&u.host!==h&&tl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},u),{host:h,ssl:!1})),i.mockUserToken){let g,T;if(typeof i.mockUserToken=="string")g=i.mockUserToken,T=En.MOCK_USER;else{g=I1(i.mockUserToken,(o=r._app)===null||o===void 0?void 0:o.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new at(Me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new En(m)}r._authCredentials=new XA(new Cy(g,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Lf(this.firestore,e,this._query)}}class _i{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new So(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _i(this.firestore,e,this._key)}}class So extends Lf{constructor(e,t,i){super(e,t,Sp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _i(this.firestore,null,new ht(e))}withConverter(e){return new So(this.firestore,e,this._path)}}function N_(r,e,...t){if(r=el(r),O_("collection","path",e),r instanceof Df){const i=fr.fromString(e,...t);return iv(i),new So(r,null,i)}{if(!(r instanceof _i||r instanceof So))throw new at(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=r._path.child(fr.fromString(e,...t));return iv(i),new So(r.firestore,null,i)}}function F_(r,e,...t){if(r=el(r),arguments.length===1&&(e=Py.newId()),O_("doc","path",e),r instanceof Df){const i=fr.fromString(e,...t);return nv(i),new _i(r,null,new ht(i))}{if(!(r instanceof _i||r instanceof So))throw new at(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=r._path.child(fr.fromString(e,...t));return nv(i),new _i(r.firestore,r instanceof So?r.converter:null,new ht(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e=Promise.resolve()){this.Iu=[],this.du=!1,this.Eu=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new f_(this,"async_queue_retry"),this.fu=()=>{const i=vd();i&&Je("AsyncQueue","Visibility state changed to "+i.visibilityState),this.r_.Jo()},this.gu=e;const t=vd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.du}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.du){this.du=!0,this.Vu=e||!1;const t=vd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.du)return new Promise(()=>{});const t=new Os;return this.yu(()=>this.du&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!ml(e))throw e;Je("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const t=this.gu.then(()=>(this.Ru=!0,e().catch(i=>{this.Au=i,this.Ru=!1;const o=function(h){let g=h.message||"";return h.stack&&(g=h.stack.includes(h.message)?h.stack:h.message+`
`+h.stack),g}(i);throw Vs("INTERNAL UNHANDLED ERROR: ",o),i}).then(i=>(this.Ru=!1,i))));return this.gu=t,t}enqueueAfterDelay(e,t,i){this.pu(),this.mu.indexOf(e)>-1&&(t=0);const o=Fp.createAndSchedule(this,e,t,i,u=>this.Su(u));return this.Eu.push(o),o}pu(){this.Au&&_t()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const t of this.Eu)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.Eu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Eu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const t=this.Eu.indexOf(e);this.Eu.splice(t,1)}}class Of extends Df{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new ov,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ov(e),this._firestoreClient=void 0,await e}}}function jC(r,e){const t=typeof r=="object"?r:UA(),i=typeof r=="string"?r:"(default)",o=yp(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const u=A1("firestore");u&&BC(o,...u)}return o}function jp(r){if(r._terminated)throw new at(Me.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||zC(r),r._firestoreClient}function zC(r){var e,t,i;const o=r._freezeSettings(),u=function(g,T,m,_){return new gR(g,T,m,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,L_(_.experimentalLongPollingOptions),_.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,o);r._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(r._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),r._firestoreClient=new OC(r._authCredentials,r._appCheckCredentials,r._queue,u,r._componentsProvider&&function(g){const T=g==null?void 0:g._online.build();return{_offline:g==null?void 0:g._offline.build(T),_online:T}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ll(un.fromBase64String(e))}catch(t){throw new at(Me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ll(un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new at(Me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ln(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new at(Me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new at(Me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Bt(this._lat,e._lat)||Bt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,o){if(i.length!==o.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==o[u])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC=/^__.*__$/;class KC{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new pa(e,this.data,this.fieldMask,t,this.fieldTransforms):new vu(e,this.data,t,this.fieldTransforms)}}function U_(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _t()}}class Hp{constructor(e,t,i,o,u,h){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,u===void 0&&this.Fu(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new Hp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.xu({path:i,Nu:!1});return o.Bu(e),o}Lu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.xu({path:i,Nu:!1});return o.Fu(),o}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return af(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Bu(this.path.get(e))}Bu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(U_(this.Mu)&&GC.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class HC{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Pf(e)}$u(e,t,i,o=!1){return new Hp({Mu:e,methodName:t,Ku:i,path:ln.emptyPath(),Nu:!1,Qu:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $C(r){const e=r._freezeSettings(),t=Pf(r._databaseId);return new HC(r._databaseId,!!e.ignoreUndefinedProperties,t)}function WC(r,e,t,i,o,u={}){const h=r.$u(u.merge||u.mergeFields?2:0,e,t,o);z_("Data must be an object, but it was:",h,i);const g=B_(i,h);let T,m;if(u.merge)T=new Ni(h.fieldMask),m=h.fieldTransforms;else if(u.mergeFields){const _=[];for(const L of u.mergeFields){const I=qC(e,L,t);if(!h.contains(I))throw new at(Me.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);QC(_,I)||_.push(I)}T=new Ni(_),m=h.fieldTransforms.filter(L=>T.covers(L.field))}else T=null,m=h.fieldTransforms;return new KC(new yi(g),T,m)}function V_(r,e){if(j_(r=el(r)))return z_("Unsupported field value:",e,r),B_(r,e);if(r instanceof M_)return function(i,o){if(!U_(o.Mu))throw o.qu(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.qu(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(o);u&&o.fieldTransforms.push(u)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(i,o){const u=[];let h=0;for(const g of i){let T=V_(g,o.ku(h));T==null&&(T={nullValue:"NULL_VALUE"}),u.push(T),h++}return{arrayValue:{values:u}}}(r,e)}return function(i,o){if((i=el(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return UR(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Wr.fromDate(i);return{timestampValue:rf(o.serializer,u)}}if(i instanceof Wr){const u=new Wr(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:rf(o.serializer,u)}}if(i instanceof Gp)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ll)return{bytesValue:t_(o.serializer,i._byteString)};if(i instanceof _i){const u=o.databaseId,h=i.firestore._databaseId;if(!h.isEqual(u))throw o.qu(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Cp(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Kp)return function(h,g){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:h.toArray().map(T=>{if(typeof T!="number")throw g.qu("VectorValues must only contain numeric values.");return Ap(g.serializer,T)})}}}}}}(i,o);throw o.qu(`Unsupported field value: ${Bp(i)}`)}(r,e)}function B_(r,e){const t={};return by(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ha(r,(i,o)=>{const u=V_(o,e.Ou(i));u!=null&&(t[i]=u)}),{mapValue:{fields:t}}}function j_(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Wr||r instanceof Gp||r instanceof ll||r instanceof _i||r instanceof M_||r instanceof Kp)}function z_(r,e,t){if(!j_(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const i=Bp(t);throw i==="an object"?e.qu(r+" a custom object"):e.qu(r+" "+i)}}function qC(r,e,t){if((e=el(e))instanceof zp)return e._internalPath;if(typeof e=="string")return G_(r,e);throw af("Field path arguments must be of type string or ",r,!1,void 0,t)}const YC=new RegExp("[~\\*/\\[\\]]");function G_(r,e,t){if(e.search(YC)>=0)throw af(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new zp(...e.split("."))._internalPath}catch{throw af(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function af(r,e,t,i,o){const u=i&&!i.isEmpty(),h=o!==void 0;let g=`Function ${e}() called with invalid data`;t&&(g+=" (via `toFirestore()`)"),g+=". ";let T="";return(u||h)&&(T+=" (found",u&&(T+=` in field ${i}`),h&&(T+=` in document ${o}`),T+=")"),new at(Me.INVALID_ARGUMENT,g+r+T)}function QC(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,t,i,o,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new _i(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(H_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class XC extends K_{data(){return super.data()}}function H_(r,e){return typeof e=="string"?G_(r,e):e instanceof zp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new at(Me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ZC{convertValue(e,t="none"){switch(bo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Po(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _t()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ha(e,(o,u)=>{i[o]=this.convertValue(u,t)}),i}convertVectorValue(e){var t,i,o;const u=(o=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.map(h=>Pr(h.doubleValue));return new Kp(u)}convertGeoPoint(e){return new Gp(Pr(e.latitude),Pr(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=xf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(ou(e));default:return null}}convertTimestamp(e){const t=Co(e);return new Wr(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=fr.fromString(e);Xt(a_(i));const o=new au(i.get(1),i.get(3)),u=new ht(i.popFirst(5));return o.isEqual(t)||Vs(`Document ${u} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(r,e,t){let i;return i=r?r.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $_ extends K_{constructor(e,t,i,o,u,h){super(e,t,i,o,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Gc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(H_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class Gc extends $_{data(e={}){return super.data(e)}}class tP{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Yl(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Gc(this._firestore,this._userDataWriter,i.key,i,new Yl(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new at(Me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,u){if(o._snapshot.oldDocs.isEmpty()){let h=0;return o._snapshot.docChanges.map(g=>{const T=new Gc(o._firestore,o._userDataWriter,g.doc.key,g.doc,new Yl(o._snapshot.mutatedKeys.has(g.doc.key),o._snapshot.fromCache),o.query.converter);return g.doc,{type:"added",doc:T,oldIndex:-1,newIndex:h++}})}{let h=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(g=>u||g.type!==3).map(g=>{const T=new Gc(o._firestore,o._userDataWriter,g.doc.key,g.doc,new Yl(o._snapshot.mutatedKeys.has(g.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,_=-1;return g.type!==0&&(m=h.indexOf(g.doc.key),h=h.delete(g.doc.key)),g.type!==1&&(h=h.add(g.doc),_=h.indexOf(g.doc.key)),{type:rP(g.type),doc:T,oldIndex:m,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function rP(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _t()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(r){r=al(r,_i);const e=al(r.firestore,Of);return MC(jp(e),r._key).then(t=>aP(e,r,t))}class W_ extends ZC{constructor(e){super(),this.firestore=e}convertBytes(e){return new ll(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _i(this.firestore,null,t)}}function iP(r){r=al(r,Lf);const e=al(r.firestore,Of),t=jp(e),i=new W_(e);return JC(r._query),UC(t,r._query).then(o=>new tP(e,i,r,o))}function sP(r,e){const t=al(r.firestore,Of),i=F_(r),o=eP(r.converter,e);return oP(t,[WC($C(r.firestore),"addDoc",i._key,o,r.converter!==null,{}).toMutation(i._key,Ns.exists(!1))]).then(()=>i)}function oP(r,e){return function(i,o){const u=new Os;return i.asyncQueue.enqueueAndForget(async()=>AC(await FC(i),o,u)),u.promise}(jp(r),e)}function aP(r,e,t){const i=t.docs.get(e._key),o=new W_(r);return new $_(r,o,e._key,i,new Yl(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){pl=o})(MA),Ro(new Ms("firestore",(i,{instanceIdentifier:o,options:u})=>{const h=i.getProvider("app").getImmediate(),g=new Of(new JA(i.getProvider("auth-internal")),new rR(i.getProvider("app-check-internal")),function(m,_){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new at(Me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new au(m.options.projectId,_)}(h,o),h);return u=Object.assign({useFetchStreams:t},u),g._setSettings(u),g},"PUBLIC").setMultipleInstances(!0)),as(w0,"4.7.6",e),as(w0,"4.7.6","esm2017")})();const q_="@firebase/installations",$p="0.6.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=1e4,Q_=`w:${$p}`,X_="FIS_v2",lP="https://firebaseinstallations.googleapis.com/v1",uP=60*60*1e3,cP="installations",fP="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ua=new _f(cP,fP,hP);function J_(r){return r instanceof Lo&&r.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_({projectId:r}){return`${lP}/projects/${r}/installations`}function eE(r){return{token:r.token,requestStatus:2,expiresIn:pP(r.expiresIn),creationTime:Date.now()}}async function tE(r,e){const i=(await e.json()).error;return ua.create("request-failed",{requestName:r,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function rE({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function dP(r,{refreshToken:e}){const t=rE(r);return t.append("Authorization",gP(e)),t}async function nE(r){const e=await r();return e.status>=500&&e.status<600?r():e}function pP(r){return Number(r.replace("s","000"))}function gP(r){return`${X_} ${r}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mP({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const i=Z_(r),o=rE(r),u=e.getImmediate({optional:!0});if(u){const m=await u.getHeartbeatsHeader();m&&o.append("x-firebase-client",m)}const h={fid:t,authVersion:X_,appId:r.appId,sdkVersion:Q_},g={method:"POST",headers:o,body:JSON.stringify(h)},T=await nE(()=>fetch(i,g));if(T.ok){const m=await T.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:eE(m.authToken)}}else throw await tE("Create Installation",T)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(r){return new Promise(e=>{setTimeout(e,r)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vP(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP=/^[cdef][\w-]{21}$/,ep="";function _P(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=EP(r);return yP.test(t)?t:ep}catch{return ep}}function EP(r){return vP(r).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(r){return`${r.appName}!${r.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE=new Map;function oE(r,e){const t=Nf(r);aE(t,e),TP(t,e)}function aE(r,e){const t=sE.get(r);if(t)for(const i of t)i(e)}function TP(r,e){const t=xP();t&&t.postMessage({key:r,fid:e}),wP()}let ia=null;function xP(){return!ia&&"BroadcastChannel"in self&&(ia=new BroadcastChannel("[Firebase] FID Change"),ia.onmessage=r=>{aE(r.data.key,r.data.fid)}),ia}function wP(){sE.size===0&&ia&&(ia.close(),ia=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP="firebase-installations-database",AP=1,ca="firebase-installations-store";let _d=null;function Wp(){return _d||(_d=yy(SP,AP,{upgrade:(r,e)=>{switch(e){case 0:r.createObjectStore(ca)}}})),_d}async function lf(r,e){const t=Nf(r),o=(await Wp()).transaction(ca,"readwrite"),u=o.objectStore(ca),h=await u.get(t);return await u.put(e,t),await o.done,(!h||h.fid!==e.fid)&&oE(r,e.fid),e}async function lE(r){const e=Nf(r),i=(await Wp()).transaction(ca,"readwrite");await i.objectStore(ca).delete(e),await i.done}async function Ff(r,e){const t=Nf(r),o=(await Wp()).transaction(ca,"readwrite"),u=o.objectStore(ca),h=await u.get(t),g=e(h);return g===void 0?await u.delete(t):await u.put(g,t),await o.done,g&&(!h||h.fid!==g.fid)&&oE(r,g.fid),g}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qp(r){let e;const t=await Ff(r.appConfig,i=>{const o=RP(i),u=IP(r,o);return e=u.registrationPromise,u.installationEntry});return t.fid===ep?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function RP(r){const e=r||{fid:_P(),registrationStatus:0};return uE(e)}function IP(r,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(ua.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=CP(r,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:PP(r)}:{installationEntry:e}}async function CP(r,e){try{const t=await mP(r,e);return lf(r.appConfig,t)}catch(t){throw J_(t)&&t.customData.serverCode===409?await lE(r.appConfig):await lf(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function PP(r){let e=await av(r.appConfig);for(;e.registrationStatus===1;)await iE(100),e=await av(r.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await qp(r);return i||t}return e}function av(r){return Ff(r,e=>{if(!e)throw ua.create("installation-not-found");return uE(e)})}function uE(r){return bP(r)?{fid:r.fid,registrationStatus:0}:r}function bP(r){return r.registrationStatus===1&&r.registrationTime+Y_<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kP({appConfig:r,heartbeatServiceProvider:e},t){const i=DP(r,t),o=dP(r,t),u=e.getImmediate({optional:!0});if(u){const m=await u.getHeartbeatsHeader();m&&o.append("x-firebase-client",m)}const h={installation:{sdkVersion:Q_,appId:r.appId}},g={method:"POST",headers:o,body:JSON.stringify(h)},T=await nE(()=>fetch(i,g));if(T.ok){const m=await T.json();return eE(m)}else throw await tE("Generate Auth Token",T)}function DP(r,{fid:e}){return`${Z_(r)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yp(r,e=!1){let t;const i=await Ff(r.appConfig,u=>{if(!cE(u))throw ua.create("not-registered");const h=u.authToken;if(!e&&NP(h))return u;if(h.requestStatus===1)return t=LP(r,e),u;{if(!navigator.onLine)throw ua.create("app-offline");const g=MP(u);return t=OP(r,g),g}});return t?await t:i.authToken}async function LP(r,e){let t=await lv(r.appConfig);for(;t.authToken.requestStatus===1;)await iE(100),t=await lv(r.appConfig);const i=t.authToken;return i.requestStatus===0?Yp(r,e):i}function lv(r){return Ff(r,e=>{if(!cE(e))throw ua.create("not-registered");const t=e.authToken;return UP(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function OP(r,e){try{const t=await kP(r,e),i=Object.assign(Object.assign({},e),{authToken:t});return await lf(r.appConfig,i),t}catch(t){if(J_(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await lE(r.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await lf(r.appConfig,i)}throw t}}function cE(r){return r!==void 0&&r.registrationStatus===2}function NP(r){return r.requestStatus===2&&!FP(r)}function FP(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+uP}function MP(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}function UP(r){return r.requestStatus===1&&r.requestTime+Y_<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VP(r){const e=r,{installationEntry:t,registrationPromise:i}=await qp(e);return i?i.catch(console.error):Yp(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BP(r,e=!1){const t=r;return await jP(t),(await Yp(t,e)).token}async function jP(r){const{registrationPromise:e}=await qp(r);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zP(r){if(!r||!r.options)throw Ed("App Configuration");if(!r.name)throw Ed("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw Ed(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function Ed(r){return ua.create("missing-app-config-values",{valueName:r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE="installations",GP="installations-internal",KP=r=>{const e=r.getProvider("app").getImmediate(),t=zP(e),i=yp(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},HP=r=>{const e=r.getProvider("app").getImmediate(),t=yp(e,fE).getImmediate();return{getId:()=>VP(t),getToken:o=>BP(t,o)}};function $P(){Ro(new Ms(fE,KP,"PUBLIC")),Ro(new Ms(GP,HP,"PRIVATE"))}$P();as(q_,$p);as(q_,$p,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="analytics",WP="firebase_id",qP="origin",YP=60*1e3,QP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Qp="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn=new mp("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Ei=new _f("analytics","Analytics",XP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(r){if(!r.startsWith(Qp)){const e=Ei.create("invalid-gtag-resource",{gtagURL:r});return zn.warn(e.message),""}return r}function hE(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function ZP(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}function eb(r,e){const t=ZP("firebase-js-sdk-policy",{createScriptURL:JP}),i=document.createElement("script"),o=`${Qp}?l=${r}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(o):o,i.async=!0,document.head.appendChild(i)}function tb(r){let e=[];return Array.isArray(window[r])?e=window[r]:window[r]=e,e}async function rb(r,e,t,i,o,u){const h=i[o];try{if(h)await e[h];else{const T=(await hE(t)).find(m=>m.measurementId===o);T&&await e[T.appId]}}catch(g){zn.error(g)}r("config",o,u)}async function nb(r,e,t,i,o){try{let u=[];if(o&&o.send_to){let h=o.send_to;Array.isArray(h)||(h=[h]);const g=await hE(t);for(const T of h){const m=g.find(L=>L.measurementId===T),_=m&&e[m.appId];if(_)u.push(_);else{u=[];break}}}u.length===0&&(u=Object.values(e)),await Promise.all(u),r("event",i,o||{})}catch(u){zn.error(u)}}function ib(r,e,t,i){async function o(u,...h){try{if(u==="event"){const[g,T]=h;await nb(r,e,t,g,T)}else if(u==="config"){const[g,T]=h;await rb(r,e,t,i,g,T)}else if(u==="consent"){const[g,T]=h;r("consent",g,T)}else if(u==="get"){const[g,T,m]=h;r("get",g,T,m)}else if(u==="set"){const[g]=h;r("set",g)}else r(u,...h)}catch(g){zn.error(g)}}return o}function sb(r,e,t,i,o){let u=function(...h){window[i].push(arguments)};return window[o]&&typeof window[o]=="function"&&(u=window[o]),window[o]=ib(u,r,e,t),{gtagCore:u,wrappedGtag:window[o]}}function ob(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Qp)&&t.src.includes(r))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab=30,lb=1e3;class ub{constructor(e={},t=lb){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const dE=new ub;function cb(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}async function fb(r){var e;const{appId:t,apiKey:i}=r,o={method:"GET",headers:cb(i)},u=QP.replace("{app-id}",t),h=await fetch(u,o);if(h.status!==200&&h.status!==304){let g="";try{const T=await h.json();!((e=T.error)===null||e===void 0)&&e.message&&(g=T.error.message)}catch{}throw Ei.create("config-fetch-failed",{httpStatus:h.status,responseMessage:g})}return h.json()}async function hb(r,e=dE,t){const{appId:i,apiKey:o,measurementId:u}=r.options;if(!i)throw Ei.create("no-app-id");if(!o){if(u)return{measurementId:u,appId:i};throw Ei.create("no-api-key")}const h=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},g=new gb;return setTimeout(async()=>{g.abort()},YP),pE({appId:i,apiKey:o,measurementId:u},h,g,e)}async function pE(r,{throttleEndTimeMillis:e,backoffCount:t},i,o=dE){var u;const{appId:h,measurementId:g}=r;try{await db(i,e)}catch(T){if(g)return zn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${g} provided in the "measurementId" field in the local Firebase config. [${T==null?void 0:T.message}]`),{appId:h,measurementId:g};throw T}try{const T=await fb(r);return o.deleteThrottleMetadata(h),T}catch(T){const m=T;if(!pb(m)){if(o.deleteThrottleMetadata(h),g)return zn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${g} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:h,measurementId:g};throw T}const _=Number((u=m==null?void 0:m.customData)===null||u===void 0?void 0:u.httpStatus)===503?d0(t,o.intervalMillis,ab):d0(t,o.intervalMillis),L={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return o.setThrottleMetadata(h,L),zn.debug(`Calling attemptFetch again in ${_} millis`),pE(r,L,i,o)}}function db(r,e){return new Promise((t,i)=>{const o=Math.max(e-Date.now(),0),u=setTimeout(t,o);r.addEventListener(()=>{clearTimeout(u),i(Ei.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function pb(r){if(!(r instanceof Lo)||!r.customData)return!1;const e=Number(r.customData.httpStatus);return e===429||e===500||e===503||e===504}class gb{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function mb(r,e,t,i,o){if(o&&o.global){r("event",t,i);return}else{const u=await e,h=Object.assign(Object.assign({},i),{send_to:u});r("event",t,h)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vb(){if(py())try{await gy()}catch(r){return zn.warn(Ei.create("indexeddb-unavailable",{errorInfo:r==null?void 0:r.toString()}).message),!1}else return zn.warn(Ei.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function yb(r,e,t,i,o,u,h){var g;const T=hb(r);T.then(D=>{t[D.measurementId]=D.appId,r.options.measurementId&&D.measurementId!==r.options.measurementId&&zn.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${D.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(D=>zn.error(D)),e.push(T);const m=vb().then(D=>{if(D)return i.getId()}),[_,L]=await Promise.all([T,m]);ob(u)||eb(u,_.measurementId),o("js",new Date);const I=(g=h==null?void 0:h.config)!==null&&g!==void 0?g:{};return I[qP]="firebase",I.update=!0,L!=null&&(I[WP]=L),o("config",_.measurementId,I),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e){this.app=e}_delete(){return delete tu[this.app.options.appId],Promise.resolve()}}let tu={},cv=[];const fv={};let Td="dataLayer",Eb="gtag",hv,gE,dv=!1;function Tb(){const r=[];if(b1()&&r.push("This is a browser extension environment."),D1()||r.push("Cookies are not available."),r.length>0){const e=r.map((i,o)=>`(${o+1}) ${i}`).join(" "),t=Ei.create("invalid-analytics-context",{errorInfo:e});zn.warn(t.message)}}function xb(r,e,t){Tb();const i=r.options.appId;if(!i)throw Ei.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)zn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Ei.create("no-api-key");if(tu[i]!=null)throw Ei.create("already-exists",{id:i});if(!dv){tb(Td);const{wrappedGtag:u,gtagCore:h}=sb(tu,cv,fv,Td,Eb);gE=u,hv=h,dv=!0}return tu[i]=yb(r,cv,fv,e,hv,Td,t),new _b(r)}function wb(r,e,t,i){r=el(r),mb(gE,tu[r.app.options.appId],e,t,i).catch(o=>zn.error(o))}const pv="@firebase/analytics",gv="0.10.11";function Sb(){Ro(new Ms(uv,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return xb(i,o,t)},"PUBLIC")),Ro(new Ms("analytics-internal",r,"PRIVATE")),as(pv,gv),as(pv,gv,"esm2017");function r(e){try{const t=e.getProvider(uv).getImmediate();return{logEvent:(i,o,u)=>wb(t,i,o,u)}}catch(t){throw Ei.create("interop-component-reg-failed",{reason:t})}}}Sb();const Ab={apiKey:"AIzaSyCjqjCxZiLAZRTNFg6f8_pnI7dslpm4p44",authDomain:"nitc-stream.firebaseapp.com",projectId:"nitc-stream",storageBucket:"nitc-stream.firebasestorage.app",messagingSenderId:"757958234907",appId:"1:757958234907:web:5ecaf876cddbe3ac0039be",measurementId:"G-J4E8D4MKPF"},Rb=_y(Ab),Xp=jC(Rb);function Ib({title:r,thumbnail:e,streamer_id:t,views:i,streamId:o}){return he.jsx("a",{href:`/streams/${o}`,children:he.jsxs("div",{className:"card bg-base-100 w-96 shadow-xl",children:[he.jsx("figure",{children:he.jsx("img",{src:e||"https://img.daisyui.com/images/stock/photo-1606107557195-0e29a4b5b4aa.webp",alt:"Shoes"})}),he.jsxs("div",{className:"card-body",children:[he.jsxs("h2",{className:"card-title",children:[r,he.jsx("div",{className:"badge badge-secondary",children:"Live"})]}),he.jsxs("p",{children:[he.jsx(ap,{className:"size-5"})," ",i]}),he.jsx("div",{className:"card-actions justify-end",children:he.jsx("div",{className:"badge badge-outline",children:t})})]})]})})}const Cb=()=>{const r=vf(),e=pe.useRef(null),[t,i]=pe.useState([]),o=t.map(h=>he.jsx("li",{children:he.jsx(Ib,{title:h.title,thumbnail:h==null?void 0:h.thumbnail,views:h.views,streamer_id:h.userId,streamId:h.id})},h.id));async function u(){console.log("running");const h=await iP(N_(Xp,"streams"));let g=[];h.forEach(T=>{console.log(T.id," => ",T.data()),g.push({id:T.id,...T.data()})}),i(g)}return pe.useEffect(()=>(u(),()=>{}),[]),he.jsxs("div",{children:[he.jsx("dialog",{id:"my_modal_3",className:"modal",children:he.jsx("div",{className:"modal-box",children:he.jsxs("form",{method:"dialog",children:[he.jsx("input",{type:"text",placeholder:"Enter stream title...",className:"input input-bordered w-full max-w-xs",ref:e}),he.jsx("button",{className:"btn btn-primary mx-2",onClick:()=>r(`/start-stream?streamTitle=${e.current.value}`),children:"Start"}),he.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:""})]})})}),he.jsx("div",{children:he.jsx("ul",{className:"grid grid-cols-4",children:o})}),he.jsx("button",{className:"btn btn-primary fixed bottom-2 right-2",onClick:()=>document.getElementById("my_modal_3").showModal(),children:"Start Stream"})]})},mE=({title:r,subtitle:e})=>he.jsx("div",{className:"hidden lg:flex items-center justify-center bg-base-200 p-12",children:he.jsxs("div",{className:"max-w-md text-center",children:[he.jsx("div",{className:"grid grid-cols-3 gap-3 mb-8",children:[...Array(9)].map((t,i)=>he.jsx("div",{className:`aspect-square rounded-2xl bg-primary/10 ${i%2===0?"animate-pulse":""}`},i))}),he.jsx("h2",{className:"text-2xl font-bold mb-4",children:r}),he.jsx("p",{className:"text-base-content/60",children:e})]})}),Pb=()=>{const[r,e]=pe.useState(!1),[t,i]=pe.useState({fullName:"",email:"",password:""}),{signup:o,isSigningUp:u}=pu(),h=()=>t.fullName.trim()?t.email.trim()?/\S+@\S+\.\S+/.test(t.email)?t.password?t.password.length<8?Oi.error("Password must be at least 8 characters"):!0:Oi.error("Password is required"):Oi.error("Invalid email format"):Oi.error("Email is required"):Oi.error("Full name is required"),g=T=>{T.preventDefault(),h()===!0&&o(t)};return he.jsxs("div",{className:"min-h-screen grid lg:grid-cols-2",children:[he.jsx("div",{className:"flex flex-col justify-center items-center p- sm:p-12",children:he.jsxs("div",{className:"w-full max-w-md space-y-8",children:[he.jsx("div",{className:"text-center mb-8",children:he.jsxs("div",{className:"flex flex-col items-center gap-2 group",children:[he.jsx("div",{className:`size-12 rounded-xl bg-primary/10 flex items-center justify-center \r
              group-hover:bg-primary/20 transition-colors`,children:he.jsx(Qv,{className:"size-6 text-primary"})}),he.jsx("h1",{className:"text-2xl font-bold mt-2",children:"Create Account"}),he.jsx("p",{className:"text-base-content/60",children:"Get started with your free account"})]})}),he.jsxs("form",{onSubmit:g,className:"space-y-6",children:[he.jsxs("div",{className:"form-control",children:[he.jsx("label",{className:"label",children:he.jsx("span",{className:"label-text font-medium",children:"Full Name"})}),he.jsxs("div",{className:"relative",children:[he.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:he.jsx(Xv,{className:"size-5 text-base-content/40"})}),he.jsx("input",{type:"text",className:"input input-bordered w-full pl-10",placeholder:"John Doe",value:t.fullName,onChange:T=>i({...t,fullName:T.target.value})})]})]}),he.jsxs("div",{className:"form-control",children:[he.jsx("label",{className:"label",children:he.jsx("span",{className:"label-text font-medium",children:"Email"})}),he.jsxs("div",{className:"relative",children:[he.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:he.jsx(Yv,{className:"size-5 text-base-content/40"})}),he.jsx("input",{type:"email",className:"input input-bordered w-full pl-10",placeholder:"you@example.com",value:t.email,onChange:T=>i({...t,email:T.target.value})})]})]}),he.jsxs("div",{className:"form-control",children:[he.jsx("label",{className:"label",children:he.jsx("span",{className:"label-text font-medium",children:"Password"})}),he.jsxs("div",{className:"relative",children:[he.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:he.jsx(qv,{className:"size-5 text-base-content/40"})}),he.jsx("input",{type:r?"text":"password",className:"input input-bordered w-full pl-10",placeholder:"",value:t.password,onChange:T=>i({...t,password:T.target.value})}),he.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>e(!r),children:r?he.jsx($v,{className:"size-5 text-base-content/40"}):he.jsx(ap,{className:"size-5 text-base-content/40"})})]})]}),he.jsx("button",{type:"submit",className:"btn btn-primary w-full",disabled:u,children:u?he.jsxs(he.Fragment,{children:[he.jsx(Wv,{className:"size-5 animate-spin"}),"Loading..."]}):"Create Account"})]}),he.jsx("div",{className:"text-center",children:he.jsxs("p",{className:"text-base-content/60",children:["Already have an account?"," ",he.jsx(oa,{to:"/login",className:"link link-primary",children:"Sign in"})]})})]})}),he.jsx(mE,{title:"Join our community",subtitle:"Connect with frineds, share moments, and stay in touch with your loved ones."})," "]})},bb=()=>{const[r,e]=pe.useState(!1),[t,i]=pe.useState({email:"",password:""}),{login:o,isLoggingIn:u}=pu(),h=async g=>{g.preventDefault(),o(t)};return he.jsxs("div",{className:"h-screen grid lg:grid-cols-2",children:[he.jsx("div",{className:"flex flex-col justify-center items-center p-6 sm:p-12",children:he.jsxs("div",{className:"w-full max-w-md space-y-8",children:[he.jsx("div",{className:"text-center mb-8",children:he.jsxs("div",{className:"flex flex-col items-center gap-2 group",children:[he.jsx("div",{className:`w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center group-hover:bg-primary/20\r
              transition-colors`,children:he.jsx(Qv,{className:"w-6 h-6 text-primary"})}),he.jsx("h1",{className:"text-2xl font-bold mt-2",children:"Welcome Back"}),he.jsx("p",{className:"text-base-content/60",children:"Sign in to your account"})]})}),he.jsxs("form",{onSubmit:h,className:"space-y-6",children:[he.jsxs("div",{className:"form-control",children:[he.jsx("label",{className:"label",children:he.jsx("span",{className:"label-text font-medium",children:"Email"})}),he.jsxs("div",{className:"relative",children:[he.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:he.jsx(Yv,{className:"h-5 w-5 text-base-content/40"})}),he.jsx("input",{type:"email",className:"input input-bordered w-full pl-10",placeholder:"you@example.com",value:t.email,onChange:g=>i({...t,email:g.target.value})})]})]}),he.jsxs("div",{className:"form-control",children:[he.jsx("label",{className:"label",children:he.jsx("span",{className:"label-text font-medium",children:"Password"})}),he.jsxs("div",{className:"relative",children:[he.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:he.jsx(qv,{className:"h-5 w-5 text-base-content/40"})}),he.jsx("input",{type:r?"text":"password",className:"input input-bordered w-full pl-10",placeholder:"",value:t.password,onChange:g=>i({...t,password:g.target.value})}),he.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>e(!r),children:r?he.jsx($v,{className:"h-5 w-5 text-base-content/40"}):he.jsx(ap,{className:"h-5 w-5 text-base-content/40"})})]})]}),he.jsx("button",{type:"submit",className:"btn btn-primary w-full",disabled:u,children:u?he.jsxs(he.Fragment,{children:[he.jsx(Wv,{className:"h-5 w-5 animate-spin"}),"Loading..."]}):"Sign in"})]}),he.jsx("div",{className:"text-center",children:he.jsxs("p",{className:"text-base-content/60",children:["Don't have an account?"," ",he.jsx(oa,{to:"/signup",className:"link link-primary",children:"Create account"})]})})]})}),he.jsx(mE,{title:"Welcome back!",subtitle:"Sign in to continue your conversations and catch up with your messages."})]})},kb=()=>he.jsx("div",{children:"SettingsPage"}),Db=()=>he.jsx("div",{children:"ProfilePage"});/*! js-cookie v3.0.5 | MIT */function Pc(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)r[i]=t[i]}return r}var Lb={read:function(r){return r[0]==='"'&&(r=r.slice(1,-1)),r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(r){return encodeURIComponent(r).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function tp(r,e){function t(o,u,h){if(!(typeof document>"u")){h=Pc({},e,h),typeof h.expires=="number"&&(h.expires=new Date(Date.now()+h.expires*864e5)),h.expires&&(h.expires=h.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var g="";for(var T in h)h[T]&&(g+="; "+T,h[T]!==!0&&(g+="="+h[T].split(";")[0]));return document.cookie=o+"="+r.write(u,o)+g}}function i(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var u=document.cookie?document.cookie.split("; "):[],h={},g=0;g<u.length;g++){var T=u[g].split("="),m=T.slice(1).join("=");try{var _=decodeURIComponent(T[0]);if(h[_]=r.read(m,_),o===_)break}catch{}}return o?h[o]:h}}return Object.create({set:t,get:i,remove:function(o,u){t(o,"",Pc({},u,{expires:-1}))},withAttributes:function(o){return tp(this.converter,Pc({},this.attributes,o))},withConverter:function(o){return tp(Pc({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(r)}})}var Ob=tp(Lb,{path:"/"});const Nb=()=>{const[r,e]=pe.useState(null);pe.useState(null);const[t,i]=pe.useState(null),[o,u]=u1(),h=o.get("streamTitle"),{authUser:g}=pu(),T=pe.useRef(null);pe.useEffect(()=>{const I=new WebSocket(`ws://127.0.0.1:3200/?token=${Ob.get("jwt")}`);return I.onopen=()=>{console.log("WebSocket is connected")},I.onclose=()=>{console.log("WebSocket is closed")},i(I),()=>{I.close()}},[]);async function m(){try{const I=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});T.current&&(T.current.srcObject=I),e(I)}catch(I){console.error("Error accessing webcam",I)}}const _=()=>{r&&(r.getTracks().forEach(I=>{I.stop()}),e(null))};async function L(){if(r){console.log("Stream started");const I=new MediaRecorder(r,{mimeType:"video/webm"}),D=await sP(N_(Xp,"streams"),{title:h,views:0,userId:g._id});console.log(D),console.log("stream written"),I.ondataavailable=F=>{F.data.size>0&&t.readyState===WebSocket.OPEN&&t.send(F.data)},I.start(500)}}return he.jsxs("div",{className:"p-4 flex flex-col gap-2",children:[he.jsx("h1",{className:"text-xl",children:h}),he.jsxs("div",{className:"flex",children:[he.jsx("button",{className:"btn btn-ghost p-2",onClick:()=>{r?_():m()},children:r?"Cancel":he.jsx(Uw,{className:"h-5 w-5 text-base-content/40"})}),he.jsx("button",{className:"btn btn-primary",onClick:L,children:"Start"}),he.jsx("video",{ref:T,autoPlay:!0,className:"rounded"})]})]})};var Kc={exports:{}},Fb=Kc.exports,mv;function Mb(){return mv||(mv=1,function(r,e){typeof window<"u"&&function(i,o){r.exports=o()}(Fb,function(){return function(t){var i={};function o(u){if(i[u])return i[u].exports;var h=i[u]={i:u,l:!1,exports:{}};return t[u].call(h.exports,h,h.exports,o),h.l=!0,h.exports}return o.m=t,o.c=i,o.d=function(u,h,g){o.o(u,h)||Object.defineProperty(u,h,{enumerable:!0,get:g})},o.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},o.t=function(u,h){if(h&1&&(u=o(u)),h&8||h&4&&typeof u=="object"&&u&&u.__esModule)return u;var g=Object.create(null);if(o.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:u}),h&2&&typeof u!="string")for(var T in u)o.d(g,T,(function(m){return u[m]}).bind(null,T));return g},o.n=function(u){var h=u&&u.__esModule?function(){return u.default}:function(){return u};return o.d(h,"a",h),h},o.o=function(u,h){return Object.prototype.hasOwnProperty.call(u,h)},o.p="/dist/",o(o.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(t,i,o){var u=Object.prototype.hasOwnProperty,h="~";function g(){}Object.create&&(g.prototype=Object.create(null),new g().__proto__||(h=!1));function T(I,D,F){this.fn=I,this.context=D,this.once=F||!1}function m(I,D,F,N,U){if(typeof F!="function")throw new TypeError("The listener must be a function");var Y=new T(F,N||I,U),X=h?h+D:D;return I._events[X]?I._events[X].fn?I._events[X]=[I._events[X],Y]:I._events[X].push(Y):(I._events[X]=Y,I._eventsCount++),I}function _(I,D){--I._eventsCount===0?I._events=new g:delete I._events[D]}function L(){this._events=new g,this._eventsCount=0}L.prototype.eventNames=function(){var D=[],F,N;if(this._eventsCount===0)return D;for(N in F=this._events)u.call(F,N)&&D.push(h?N.slice(1):N);return Object.getOwnPropertySymbols?D.concat(Object.getOwnPropertySymbols(F)):D},L.prototype.listeners=function(D){var F=h?h+D:D,N=this._events[F];if(!N)return[];if(N.fn)return[N.fn];for(var U=0,Y=N.length,X=new Array(Y);U<Y;U++)X[U]=N[U].fn;return X},L.prototype.listenerCount=function(D){var F=h?h+D:D,N=this._events[F];return N?N.fn?1:N.length:0},L.prototype.emit=function(D,F,N,U,Y,X){var ce=h?h+D:D;if(!this._events[ce])return!1;var fe=this._events[ce],me=arguments.length,we,H;if(fe.fn){switch(fe.once&&this.removeListener(D,fe.fn,void 0,!0),me){case 1:return fe.fn.call(fe.context),!0;case 2:return fe.fn.call(fe.context,F),!0;case 3:return fe.fn.call(fe.context,F,N),!0;case 4:return fe.fn.call(fe.context,F,N,U),!0;case 5:return fe.fn.call(fe.context,F,N,U,Y),!0;case 6:return fe.fn.call(fe.context,F,N,U,Y,X),!0}for(H=1,we=new Array(me-1);H<me;H++)we[H-1]=arguments[H];fe.fn.apply(fe.context,we)}else{var B=fe.length,z;for(H=0;H<B;H++)switch(fe[H].once&&this.removeListener(D,fe[H].fn,void 0,!0),me){case 1:fe[H].fn.call(fe[H].context);break;case 2:fe[H].fn.call(fe[H].context,F);break;case 3:fe[H].fn.call(fe[H].context,F,N);break;case 4:fe[H].fn.call(fe[H].context,F,N,U);break;default:if(!we)for(z=1,we=new Array(me-1);z<me;z++)we[z-1]=arguments[z];fe[H].fn.apply(fe[H].context,we)}}return!0},L.prototype.on=function(D,F,N){return m(this,D,F,N,!1)},L.prototype.once=function(D,F,N){return m(this,D,F,N,!0)},L.prototype.removeListener=function(D,F,N,U){var Y=h?h+D:D;if(!this._events[Y])return this;if(!F)return _(this,Y),this;var X=this._events[Y];if(X.fn)X.fn===F&&(!U||X.once)&&(!N||X.context===N)&&_(this,Y);else{for(var ce=0,fe=[],me=X.length;ce<me;ce++)(X[ce].fn!==F||U&&!X[ce].once||N&&X[ce].context!==N)&&fe.push(X[ce]);fe.length?this._events[Y]=fe.length===1?fe[0]:fe:_(this,Y)}return this},L.prototype.removeAllListeners=function(D){var F;return D?(F=h?h+D:D,this._events[F]&&_(this,F)):(this._events=new g,this._eventsCount=0),this},L.prototype.off=L.prototype.removeListener,L.prototype.addListener=L.prototype.on,L.prefixed=h,L.EventEmitter=L,t.exports=L},"./node_modules/url-toolkit/src/url-toolkit.js":function(t,i,o){(function(u){var h=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,g=/^([^\/?#]*)(.*)$/,T=/(?:\/|^)\.(?=\/)/g,m=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,_={buildAbsoluteURL:function(L,I,D){if(D=D||{},L=L.trim(),I=I.trim(),!I){if(!D.alwaysNormalize)return L;var F=_.parseURL(L);if(!F)throw new Error("Error trying to parse base URL.");return F.path=_.normalizePath(F.path),_.buildURLFromParts(F)}var N=_.parseURL(I);if(!N)throw new Error("Error trying to parse relative URL.");if(N.scheme)return D.alwaysNormalize?(N.path=_.normalizePath(N.path),_.buildURLFromParts(N)):I;var U=_.parseURL(L);if(!U)throw new Error("Error trying to parse base URL.");if(!U.netLoc&&U.path&&U.path[0]!=="/"){var Y=g.exec(U.path);U.netLoc=Y[1],U.path=Y[2]}U.netLoc&&!U.path&&(U.path="/");var X={scheme:U.scheme,netLoc:N.netLoc,path:null,params:N.params,query:N.query,fragment:N.fragment};if(!N.netLoc&&(X.netLoc=U.netLoc,N.path[0]!=="/"))if(!N.path)X.path=U.path,N.params||(X.params=U.params,N.query||(X.query=U.query));else{var ce=U.path,fe=ce.substring(0,ce.lastIndexOf("/")+1)+N.path;X.path=_.normalizePath(fe)}return X.path===null&&(X.path=D.alwaysNormalize?_.normalizePath(N.path):N.path),_.buildURLFromParts(X)},parseURL:function(L){var I=h.exec(L);return I?{scheme:I[1]||"",netLoc:I[2]||"",path:I[3]||"",params:I[4]||"",query:I[5]||"",fragment:I[6]||""}:null},normalizePath:function(L){for(L=L.split("").reverse().join("").replace(T,"");L.length!==(L=L.replace(m,"")).length;);return L.split("").reverse().join("")},buildURLFromParts:function(L){return L.scheme+L.netLoc+L.path+L.params+L.query+L.fragment}};t.exports=_})()},"./node_modules/webworkify-webpack/index.js":function(t,i,o){function u(D){var F={};function N(Y){if(F[Y])return F[Y].exports;var X=F[Y]={i:Y,l:!1,exports:{}};return D[Y].call(X.exports,X,X.exports,N),X.l=!0,X.exports}N.m=D,N.c=F,N.i=function(Y){return Y},N.d=function(Y,X,ce){N.o(Y,X)||Object.defineProperty(Y,X,{configurable:!1,enumerable:!0,get:ce})},N.r=function(Y){Object.defineProperty(Y,"__esModule",{value:!0})},N.n=function(Y){var X=Y&&Y.__esModule?function(){return Y.default}:function(){return Y};return N.d(X,"a",X),X},N.o=function(Y,X){return Object.prototype.hasOwnProperty.call(Y,X)},N.p="/",N.oe=function(Y){throw console.error(Y),Y};var U=N(N.s=ENTRY_MODULE);return U.default||U}var h="[\\.|\\-|\\+|\\w|/|@]+",g="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+h+").*?\\)";function T(D){return(D+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function m(D){return!isNaN(1*D)}function _(D,F,N){var U={};U[N]=[];var Y=F.toString(),X=Y.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!X)return U;for(var ce=X[1],fe=new RegExp("(\\\\n|\\W)"+T(ce)+g,"g"),me;me=fe.exec(Y);)me[3]!=="dll-reference"&&U[N].push(me[3]);for(fe=new RegExp("\\("+T(ce)+'\\("(dll-reference\\s('+h+'))"\\)\\)'+g,"g");me=fe.exec(Y);)D[me[2]]||(U[N].push(me[1]),D[me[2]]=o(me[1]).m),U[me[2]]=U[me[2]]||[],U[me[2]].push(me[4]);for(var we=Object.keys(U),H=0;H<we.length;H++)for(var B=0;B<U[we[H]].length;B++)m(U[we[H]][B])&&(U[we[H]][B]=1*U[we[H]][B]);return U}function L(D){var F=Object.keys(D);return F.reduce(function(N,U){return N||D[U].length>0},!1)}function I(D,F){for(var N={main:[F]},U={main:[]},Y={main:{}};L(N);)for(var X=Object.keys(N),ce=0;ce<X.length;ce++){var fe=X[ce],me=N[fe],we=me.pop();if(Y[fe]=Y[fe]||{},!(Y[fe][we]||!D[fe][we])){Y[fe][we]=!0,U[fe]=U[fe]||[],U[fe].push(we);for(var H=_(D,D[fe][we],fe),B=Object.keys(H),z=0;z<B.length;z++)N[B[z]]=N[B[z]]||[],N[B[z]]=N[B[z]].concat(H[B[z]])}}return U}t.exports=function(D,F){F=F||{};var N={main:o.m},U=F.all?{main:Object.keys(N.main)}:I(N,D),Y="";Object.keys(U).filter(function(we){return we!=="main"}).forEach(function(we){for(var H=0;U[we][H];)H++;U[we].push(H),N[we][H]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",Y=Y+"var "+we+" = ("+u.toString().replace("ENTRY_MODULE",JSON.stringify(H))+")({"+U[we].map(function(B){return""+JSON.stringify(B)+": "+N[we][B].toString()}).join(",")+`});
`}),Y=Y+"new (("+u.toString().replace("ENTRY_MODULE",JSON.stringify(D))+")({"+U.main.map(function(we){return""+JSON.stringify(we)+": "+N.main[we].toString()}).join(",")+"}))(self);";var X=new window.Blob([Y],{type:"text/javascript"});if(F.bare)return X;var ce=window.URL||window.webkitURL||window.mozURL||window.msURL,fe=ce.createObjectURL(X),me=new window.Worker(fe);return me.objectURL=fe,me}},"./src/crypt/decrypter.js":function(t,i,o){o.r(i);var u=function(){function Y(ce,fe){this.subtle=ce,this.aesIV=fe}var X=Y.prototype;return X.decrypt=function(fe,me){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},me,fe)},Y}(),h=function(){function Y(ce,fe){this.subtle=ce,this.key=fe}var X=Y.prototype;return X.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},Y}(),g=h;function T(Y){var X=Y.byteLength,ce=X&&new DataView(Y).getUint8(X-1);return ce?Y.slice(0,X-ce):Y}var m=function(){function Y(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var X=Y.prototype;return X.uint8ArrayToUint32Array_=function(fe){for(var me=new DataView(fe),we=new Uint32Array(4),H=0;H<4;H++)we[H]=me.getUint32(H*4);return we},X.initTable=function(){var fe=this.sBox,me=this.invSBox,we=this.subMix,H=we[0],B=we[1],z=we[2],Q=we[3],re=this.invSubMix,le=re[0],J=re[1],pt=re[2],Jt=re[3],At=new Uint32Array(256),dt=0,Ue=0,Ke=0;for(Ke=0;Ke<256;Ke++)Ke<128?At[Ke]=Ke<<1:At[Ke]=Ke<<1^283;for(Ke=0;Ke<256;Ke++){var Be=Ue^Ue<<1^Ue<<2^Ue<<3^Ue<<4;Be=Be>>>8^Be&255^99,fe[dt]=Be,me[Be]=dt;var se=At[dt],ye=At[se],He=At[ye],Ye=At[Be]*257^Be*16843008;H[dt]=Ye<<24|Ye>>>8,B[dt]=Ye<<16|Ye>>>16,z[dt]=Ye<<8|Ye>>>24,Q[dt]=Ye,Ye=He*16843009^ye*65537^se*257^dt*16843008,le[Be]=Ye<<24|Ye>>>8,J[Be]=Ye<<16|Ye>>>16,pt[Be]=Ye<<8|Ye>>>24,Jt[Be]=Ye,dt?(dt=se^At[At[At[He^se]]],Ue^=At[At[Ue]]):dt=Ue=1}},X.expandKey=function(fe){for(var me=this.uint8ArrayToUint32Array_(fe),we=!0,H=0;H<me.length&&we;)we=me[H]===this.key[H],H++;if(!we){this.key=me;var B=this.keySize=me.length;if(B!==4&&B!==6&&B!==8)throw new Error("Invalid aes key size="+B);var z=this.ksRows=(B+6+1)*4,Q,re,le=this.keySchedule=new Uint32Array(z),J=this.invKeySchedule=new Uint32Array(z),pt=this.sBox,Jt=this.rcon,At=this.invSubMix,dt=At[0],Ue=At[1],Ke=At[2],Be=At[3],se,ye;for(Q=0;Q<z;Q++){if(Q<B){se=le[Q]=me[Q];continue}ye=se,Q%B===0?(ye=ye<<8|ye>>>24,ye=pt[ye>>>24]<<24|pt[ye>>>16&255]<<16|pt[ye>>>8&255]<<8|pt[ye&255],ye^=Jt[Q/B|0]<<24):B>6&&Q%B===4&&(ye=pt[ye>>>24]<<24|pt[ye>>>16&255]<<16|pt[ye>>>8&255]<<8|pt[ye&255]),le[Q]=se=(le[Q-B]^ye)>>>0}for(re=0;re<z;re++)Q=z-re,re&3?ye=le[Q]:ye=le[Q-4],re<4||Q<=4?J[re]=ye:J[re]=dt[pt[ye>>>24]]^Ue[pt[ye>>>16&255]]^Ke[pt[ye>>>8&255]]^Be[pt[ye&255]],J[re]=J[re]>>>0}},X.networkToHostOrderSwap=function(fe){return fe<<24|(fe&65280)<<8|(fe&16711680)>>8|fe>>>24},X.decrypt=function(fe,me,we,H){for(var B=this.keySize+6,z=this.invKeySchedule,Q=this.invSBox,re=this.invSubMix,le=re[0],J=re[1],pt=re[2],Jt=re[3],At=this.uint8ArrayToUint32Array_(we),dt=At[0],Ue=At[1],Ke=At[2],Be=At[3],se=new Int32Array(fe),ye=new Int32Array(se.length),He,Ye,mt,wt,et,vt,Rt,Kt,br,bn,or,tn,lr,Gn,kr=this.networkToHostOrderSwap;me<se.length;){for(br=kr(se[me]),bn=kr(se[me+1]),or=kr(se[me+2]),tn=kr(se[me+3]),et=br^z[0],vt=tn^z[1],Rt=or^z[2],Kt=bn^z[3],lr=4,Gn=1;Gn<B;Gn++)He=le[et>>>24]^J[vt>>16&255]^pt[Rt>>8&255]^Jt[Kt&255]^z[lr],Ye=le[vt>>>24]^J[Rt>>16&255]^pt[Kt>>8&255]^Jt[et&255]^z[lr+1],mt=le[Rt>>>24]^J[Kt>>16&255]^pt[et>>8&255]^Jt[vt&255]^z[lr+2],wt=le[Kt>>>24]^J[et>>16&255]^pt[vt>>8&255]^Jt[Rt&255]^z[lr+3],et=He,vt=Ye,Rt=mt,Kt=wt,lr=lr+4;He=Q[et>>>24]<<24^Q[vt>>16&255]<<16^Q[Rt>>8&255]<<8^Q[Kt&255]^z[lr],Ye=Q[vt>>>24]<<24^Q[Rt>>16&255]<<16^Q[Kt>>8&255]<<8^Q[et&255]^z[lr+1],mt=Q[Rt>>>24]<<24^Q[Kt>>16&255]<<16^Q[et>>8&255]<<8^Q[vt&255]^z[lr+2],wt=Q[Kt>>>24]<<24^Q[et>>16&255]<<16^Q[vt>>8&255]<<8^Q[Rt&255]^z[lr+3],lr=lr+3,ye[me]=kr(He^dt),ye[me+1]=kr(wt^Ue),ye[me+2]=kr(mt^Ke),ye[me+3]=kr(Ye^Be),dt=br,Ue=bn,Ke=or,Be=tn,me=me+4}return H?T(ye.buffer):ye.buffer},X.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},Y}(),_=m,L=o("./src/errors.ts"),I=o("./src/utils/logger.js"),D=o("./src/events.js"),F=o("./src/utils/get-self-scope.js"),N=Object(F.getSelfScope)(),U=function(){function Y(ce,fe,me){var we=me===void 0?{}:me,H=we.removePKCS7Padding,B=H===void 0?!0:H;if(this.logEnabled=!0,this.observer=ce,this.config=fe,this.removePKCS7Padding=B,B)try{var z=N.crypto;z&&(this.subtle=z.subtle||z.webkitSubtle)}catch{}this.disableWebCrypto=!this.subtle}var X=Y.prototype;return X.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},X.decrypt=function(fe,me,we,H){var B=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(I.logger.log("JS AES decrypt"),this.logEnabled=!1);var z=this.decryptor;z||(this.decryptor=z=new _),z.expandKey(me),H(z.decrypt(fe,0,we,this.removePKCS7Padding))}else{this.logEnabled&&(I.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var Q=this.subtle;this.key!==me&&(this.key=me,this.fastAesKey=new g(Q,me)),this.fastAesKey.expandKey().then(function(re){var le=new u(Q,we);le.decrypt(fe,re).catch(function(J){B.onWebCryptoError(J,fe,me,we,H)}).then(function(J){H(J)})}).catch(function(re){B.onWebCryptoError(re,fe,me,we,H)})}},X.onWebCryptoError=function(fe,me,we,H,B){this.config.enableSoftwareAES?(I.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(me,we,H,B)):(I.logger.error("decrypting error : "+fe.message),this.observer.trigger(D.default.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:fe.message}))},X.destroy=function(){var fe=this.decryptor;fe&&(fe.destroy(),this.decryptor=void 0)},Y}();i.default=U},"./src/demux/demuxer-inline.js":function(t,i,o){o.r(i);var u=o("./src/events.js"),h=o("./src/errors.ts"),g=o("./src/crypt/decrypter.js"),T=o("./src/polyfills/number.js"),m=o("./src/utils/logger.js"),_=o("./src/utils/get-self-scope.js");function L(q,ue,W,k){var j,$,ee,te,ae,_e=navigator.userAgent.toLowerCase(),Ie=k,Ce=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(j=((ue[W+2]&192)>>>6)+1,$=(ue[W+2]&60)>>>2,$>Ce.length-1){q.trigger(u.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+$});return}return te=(ue[W+2]&1)<<2,te|=(ue[W+3]&192)>>>6,m.logger.log("manifest codec:"+k+",ADTS data:type:"+j+",sampleingIndex:"+$+"["+Ce[$]+"Hz],channelConfig:"+te),/firefox/i.test(_e)?$>=6?(j=5,ae=new Array(4),ee=$-3):(j=2,ae=new Array(2),ee=$):_e.indexOf("android")!==-1?(j=2,ae=new Array(2),ee=$):(j=5,ae=new Array(4),k&&(k.indexOf("mp4a.40.29")!==-1||k.indexOf("mp4a.40.5")!==-1)||!k&&$>=6?ee=$-3:((k&&k.indexOf("mp4a.40.2")!==-1&&($>=6&&te===1||/vivaldi/i.test(_e))||!k&&te===1)&&(j=2,ae=new Array(2)),ee=$)),ae[0]=j<<3,ae[0]|=($&14)>>1,ae[1]|=($&1)<<7,ae[1]|=te<<3,j===5&&(ae[1]|=(ee&14)>>1,ae[2]=(ee&1)<<7,ae[2]|=8,ae[3]=0),{config:ae,samplerate:Ce[$],channelCount:te,codec:"mp4a.40."+j,manifestCodec:Ie}}function I(q,ue){return q[ue]===255&&(q[ue+1]&246)===240}function D(q,ue){return q[ue+1]&1?7:9}function F(q,ue){return(q[ue+3]&3)<<11|q[ue+4]<<3|(q[ue+5]&224)>>>5}function N(q,ue){return!!(ue+1<q.length&&I(q,ue))}function U(q,ue){if(N(q,ue)){var W=D(q,ue);if(ue+W>=q.length)return!1;var k=F(q,ue);if(k<=W)return!1;var j=ue+k;if(j===q.length||j+1<q.length&&I(q,j))return!0}return!1}function Y(q,ue,W,k,j){if(!q.samplerate){var $=L(ue,W,k,j);q.config=$.config,q.samplerate=$.samplerate,q.channelCount=$.channelCount,q.codec=$.codec,q.manifestCodec=$.manifestCodec,m.logger.log("parsed codec:"+q.codec+",rate:"+$.samplerate+",nb channel:"+$.channelCount)}}function X(q){return 1024*9e4/q}function ce(q,ue,W,k,j){var $,ee,te,ae=q.length;if($=D(q,ue),ee=F(q,ue),ee-=$,ee>0&&ue+$+ee<=ae)return te=W+k*j,{headerLength:$,frameLength:ee,stamp:te}}function fe(q,ue,W,k,j){var $=X(q.samplerate),ee=ce(ue,W,k,j,$);if(ee){var te=ee.stamp,ae=ee.headerLength,_e=ee.frameLength,Ie={unit:ue.subarray(W+ae,W+ae+_e),pts:te,dts:te};return q.samples.push(Ie),{sample:Ie,length:_e+ae}}}var me=o("./src/demux/id3.js"),we=function(){function q(W,k,j){this.observer=W,this.config=j,this.remuxer=k}var ue=q.prototype;return ue.resetInitSegment=function(k,j,$,ee){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:j,duration:ee,inputTimeScale:9e4}},ue.resetTimeStamp=function(){},q.probe=function(k){if(!k)return!1;for(var j=me.default.getID3Data(k,0)||[],$=j.length,ee=k.length;$<ee;$++)if(U(k,$))return m.logger.log("ADTS sync word found !"),!0;return!1},ue.append=function(k,j,$,ee){for(var te=this._audioTrack,ae=me.default.getID3Data(k,0)||[],_e=me.default.getTimeStamp(ae),Ie=Object(T.isFiniteNumber)(_e)?_e*90:j*9e4,Ce=0,Re=Ie,Ne=k.length,ke=ae.length,ze=[{pts:Re,dts:Re,data:ae}];ke<Ne-1;)if(N(k,ke)&&ke+5<Ne){Y(te,this.observer,k,ke,te.manifestCodec);var De=fe(te,k,ke,Ie,Ce);if(De)ke+=De.length,Re=De.sample.pts,Ce++;else{m.logger.log("Unable to parse AAC frame");break}}else me.default.isHeader(k,ke)?(ae=me.default.getID3Data(k,ke),ze.push({pts:Re,dts:Re,data:ae}),ke+=ae.length):ke++;this.remuxer.remux(te,{samples:[]},{samples:ze,inputTimeScale:9e4},{samples:[]},j,$,ee)},ue.destroy=function(){},q}(),H=we,B=o("./src/demux/mp4demuxer.js"),z={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(ue,W,k,j,$){if(!(k+24>W.length)){var ee=this.parseHeader(W,k);if(ee&&k+ee.frameLength<=W.length){var te=ee.samplesPerFrame*9e4/ee.sampleRate,ae=j+$*te,_e={unit:W.subarray(k,k+ee.frameLength),pts:ae,dts:ae};return ue.config=[],ue.channelCount=ee.channelCount,ue.samplerate=ee.sampleRate,ue.samples.push(_e),{sample:_e,length:ee.frameLength}}}},parseHeader:function(ue,W){var k=ue[W+1]>>3&3,j=ue[W+1]>>1&3,$=ue[W+2]>>4&15,ee=ue[W+2]>>2&3,te=ue[W+2]>>1&1;if(k!==1&&$!==0&&$!==15&&ee!==3){var ae=k===3?3-j:j===3?3:4,_e=z.BitratesMap[ae*14+$-1]*1e3,Ie=k===3?0:k===2?1:2,Ce=z.SamplingRateMap[Ie*3+ee],Re=ue[W+3]>>6===3?1:2,Ne=z.SamplesCoefficients[k][j],ke=z.BytesInSlot[j],ze=Ne*8*ke,De=parseInt(Ne*_e/Ce+te,10)*ke;return{sampleRate:Ce,channelCount:Re,frameLength:De,samplesPerFrame:ze}}},isHeaderPattern:function(ue,W){return ue[W]===255&&(ue[W+1]&224)===224&&(ue[W+1]&6)!==0},isHeader:function(ue,W){return!!(W+1<ue.length&&this.isHeaderPattern(ue,W))},probe:function(ue,W){if(W+1<ue.length&&this.isHeaderPattern(ue,W)){var k=4,j=this.parseHeader(ue,W),$=k;j&&j.frameLength&&($=j.frameLength);var ee=W+$;if(ee===ue.length||ee+1<ue.length&&this.isHeaderPattern(ue,ee))return!0}return!1}},Q=z,re=function(){function q(W){this.data=W,this.bytesAvailable=W.byteLength,this.word=0,this.bitsAvailable=0}var ue=q.prototype;return ue.loadWord=function(){var k=this.data,j=this.bytesAvailable,$=k.byteLength-j,ee=new Uint8Array(4),te=Math.min(4,j);if(te===0)throw new Error("no bytes available");ee.set(k.subarray($,$+te)),this.word=new DataView(ee.buffer).getUint32(0),this.bitsAvailable=te*8,this.bytesAvailable-=te},ue.skipBits=function(k){var j;this.bitsAvailable>k?(this.word<<=k,this.bitsAvailable-=k):(k-=this.bitsAvailable,j=k>>3,k-=j>>3,this.bytesAvailable-=j,this.loadWord(),this.word<<=k,this.bitsAvailable-=k)},ue.readBits=function(k){var j=Math.min(this.bitsAvailable,k),$=this.word>>>32-j;return k>32&&m.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=j,this.bitsAvailable>0?this.word<<=j:this.bytesAvailable>0&&this.loadWord(),j=k-j,j>0&&this.bitsAvailable?$<<j|this.readBits(j):$},ue.skipLZ=function(){var k;for(k=0;k<this.bitsAvailable;++k)if(this.word&2147483648>>>k)return this.word<<=k,this.bitsAvailable-=k,k;return this.loadWord(),k+this.skipLZ()},ue.skipUEG=function(){this.skipBits(1+this.skipLZ())},ue.skipEG=function(){this.skipBits(1+this.skipLZ())},ue.readUEG=function(){var k=this.skipLZ();return this.readBits(k+1)-1},ue.readEG=function(){var k=this.readUEG();return 1&k?1+k>>>1:-1*(k>>>1)},ue.readBoolean=function(){return this.readBits(1)===1},ue.readUByte=function(){return this.readBits(8)},ue.readUShort=function(){return this.readBits(16)},ue.readUInt=function(){return this.readBits(32)},ue.skipScalingList=function(k){var j=8,$=8,ee,te;for(ee=0;ee<k;ee++)$!==0&&(te=this.readEG(),$=(j+te+256)%256),j=$===0?j:$},ue.readSPS=function(){var k=0,j=0,$=0,ee=0,te,ae,_e,Ie,Ce,Re,Ne,ke=this.readUByte.bind(this),ze=this.readBits.bind(this),De=this.readUEG.bind(this),Qe=this.readBoolean.bind(this),$e=this.skipBits.bind(this),lt=this.skipEG.bind(this),bt=this.skipUEG.bind(this),st=this.skipScalingList.bind(this);if(ke(),te=ke(),ze(5),$e(3),ke(),bt(),te===100||te===110||te===122||te===244||te===44||te===83||te===86||te===118||te===128){var Nt=De();if(Nt===3&&$e(1),bt(),bt(),$e(1),Qe())for(Re=Nt!==3?8:12,Ne=0;Ne<Re;Ne++)Qe()&&(Ne<6?st(16):st(64))}bt();var Pt=De();if(Pt===0)De();else if(Pt===1)for($e(1),lt(),lt(),ae=De(),Ne=0;Ne<ae;Ne++)lt();bt(),$e(1),_e=De(),Ie=De(),Ce=ze(1),Ce===0&&$e(1),$e(1),Qe()&&(k=De(),j=De(),$=De(),ee=De());var gt=[1,1];if(Qe()&&Qe()){var kt=ke();switch(kt){case 1:gt=[1,1];break;case 2:gt=[12,11];break;case 3:gt=[10,11];break;case 4:gt=[16,11];break;case 5:gt=[40,33];break;case 6:gt=[24,11];break;case 7:gt=[20,11];break;case 8:gt=[32,11];break;case 9:gt=[80,33];break;case 10:gt=[18,11];break;case 11:gt=[15,11];break;case 12:gt=[64,33];break;case 13:gt=[160,99];break;case 14:gt=[4,3];break;case 15:gt=[3,2];break;case 16:gt=[2,1];break;case 255:{gt=[ke()<<8|ke(),ke()<<8|ke()];break}}}return{width:Math.ceil((_e+1)*16-k*2-j*2),height:(2-Ce)*(Ie+1)*16-(Ce?2:4)*($+ee),pixelRatio:gt}},ue.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},q}(),le=re,J=function(){function q(W,k,j,$){this.decryptdata=j,this.discardEPB=$,this.decrypter=new g.default(W,k,{removePKCS7Padding:!1})}var ue=q.prototype;return ue.decryptBuffer=function(k,j){this.decrypter.decrypt(k,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,j)},ue.decryptAacSample=function(k,j,$,ee){var te=k[j].unit,ae=te.subarray(16,te.length-te.length%16),_e=ae.buffer.slice(ae.byteOffset,ae.byteOffset+ae.length),Ie=this;this.decryptBuffer(_e,function(Ce){Ce=new Uint8Array(Ce),te.set(Ce,16),ee||Ie.decryptAacSamples(k,j+1,$)})},ue.decryptAacSamples=function(k,j,$){for(;;j++){if(j>=k.length){$();return}if(!(k[j].unit.length<32)){var ee=this.decrypter.isSync();if(this.decryptAacSample(k,j,$,ee),!ee)return}}},ue.getAvcEncryptedData=function(k){for(var j=Math.floor((k.length-48)/160)*16+16,$=new Int8Array(j),ee=0,te=32;te<=k.length-16;te+=160,ee+=16)$.set(k.subarray(te,te+16),ee);return $},ue.getAvcDecryptedUnit=function(k,j){j=new Uint8Array(j);for(var $=0,ee=32;ee<=k.length-16;ee+=160,$+=16)k.set(j.subarray($,$+16),ee);return k},ue.decryptAvcSample=function(k,j,$,ee,te,ae){var _e=this.discardEPB(te.data),Ie=this.getAvcEncryptedData(_e),Ce=this;this.decryptBuffer(Ie.buffer,function(Re){te.data=Ce.getAvcDecryptedUnit(_e,Re),ae||Ce.decryptAvcSamples(k,j,$+1,ee)})},ue.decryptAvcSamples=function(k,j,$,ee){for(;;j++,$=0){if(j>=k.length){ee();return}for(var te=k[j].units;!($>=te.length);$++){var ae=te[$];if(!(ae.data.length<=48||ae.type!==1&&ae.type!==5)){var _e=this.decrypter.isSync();if(this.decryptAvcSample(k,j,$,ee,ae,_e),!_e)return}}}},q}(),pt=J,Jt={video:1,audio:2,id3:3,text:4},At=function(){function q(W,k,j,$){this.observer=W,this.config=j,this.typeSupported=$,this.remuxer=k,this.sampleAes=null,this.pmtUnknownTypes={}}var ue=q.prototype;return ue.setDecryptData=function(k){k!=null&&k.key!=null&&k.method==="SAMPLE-AES"?this.sampleAes=new pt(this.observer,this.config,k,this.discardEPB):this.sampleAes=null},q.probe=function(k){var j=q._syncOffset(k);return j<0?!1:(j&&m.logger.warn("MPEG2-TS detected but first sync word found @ offset "+j+", junk ahead ?"),!0)},q._syncOffset=function(k){for(var j=Math.min(1e3,k.length-564),$=0;$<j;){if(k[$]===71&&k[$+188]===71&&k[$+2*188]===71)return $;$++}return-1},q.createTrack=function(k,j){return{container:k==="video"||k==="audio"?"video/mp2t":void 0,type:k,id:Jt[k],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:k==="video"?0:void 0,isAAC:k==="audio"?!0:void 0,duration:k==="audio"?j:void 0}},ue.resetInitSegment=function(k,j,$,ee){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=q.createTrack("video",ee),this._audioTrack=q.createTrack("audio",ee),this._id3Track=q.createTrack("id3",ee),this._txtTrack=q.createTrack("text",ee),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=j,this.videoCodec=$,this._duration=ee},ue.resetTimeStamp=function(){},ue.append=function(k,j,$,ee){var te,ae=k.length,_e,Ie,Ce,Re,Ne,ke=!1;this.pmtUnknownTypes={},this.contiguous=$;var ze=this.pmtParsed,De=this._avcTrack,Qe=this._audioTrack,$e=this._id3Track,lt=De.pid,bt=Qe.pid,st=$e.pid,Nt=this._pmtId,Pt=De.pesData,gt=Qe.pesData,kt=$e.pesData,Ft=this._parsePAT,pr=this._parsePMT.bind(this),Zt=this._parsePES,qt=this._parseAVCPES.bind(this),Dt=this._parseAACPES.bind(this),nr=this._parseMPEGPES.bind(this),rr=this._parseID3PES.bind(this),tr=q._syncOffset(k);for(ae-=(ae+tr)%188,te=tr;te<ae;te+=188)if(k[te]===71){if(_e=!!(k[te+1]&64),Ie=((k[te+1]&31)<<8)+k[te+2],Ce=(k[te+3]&48)>>4,Ce>1){if(Re=te+5+k[te+4],Re===te+188)continue}else Re=te+4;switch(Ie){case lt:_e&&(Pt&&(Ne=Zt(Pt))&&qt(Ne,!1),Pt={data:[],size:0}),Pt&&(Pt.data.push(k.subarray(Re,te+188)),Pt.size+=te+188-Re);break;case bt:_e&&(gt&&(Ne=Zt(gt))&&(Qe.isAAC?Dt(Ne):nr(Ne)),gt={data:[],size:0}),gt&&(gt.data.push(k.subarray(Re,te+188)),gt.size+=te+188-Re);break;case st:_e&&(kt&&(Ne=Zt(kt))&&rr(Ne),kt={data:[],size:0}),kt&&(kt.data.push(k.subarray(Re,te+188)),kt.size+=te+188-Re);break;case 0:_e&&(Re+=k[Re]+1),Nt=this._pmtId=Ft(k,Re);break;case Nt:_e&&(Re+=k[Re]+1);var Ht=pr(k,Re,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,this.sampleAes!=null);lt=Ht.avc,lt>0&&(De.pid=lt),bt=Ht.audio,bt>0&&(Qe.pid=bt,Qe.isAAC=Ht.isAAC),st=Ht.id3,st>0&&($e.pid=st),ke&&!ze&&(m.logger.log("reparse from beginning"),ke=!1,te=tr-188),ze=this.pmtParsed=!0;break;case 17:case 8191:break;default:ke=!0;break}}else this.observer.trigger(u.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});Pt&&(Ne=Zt(Pt))?(qt(Ne,!0),De.pesData=null):De.pesData=Pt,gt&&(Ne=Zt(gt))?(Qe.isAAC?Dt(Ne):nr(Ne),Qe.pesData=null):(gt&&gt.size&&m.logger.log("last AAC PES packet truncated,might overlap between fragments"),Qe.pesData=gt),kt&&(Ne=Zt(kt))?(rr(Ne),$e.pesData=null):$e.pesData=kt,this.sampleAes==null?this.remuxer.remux(Qe,De,$e,this._txtTrack,j,$,ee):this.decryptAndRemux(Qe,De,$e,this._txtTrack,j,$,ee)},ue.decryptAndRemux=function(k,j,$,ee,te,ae,_e){if(k.samples&&k.isAAC){var Ie=this;this.sampleAes.decryptAacSamples(k.samples,0,function(){Ie.decryptAndRemuxAvc(k,j,$,ee,te,ae,_e)})}else this.decryptAndRemuxAvc(k,j,$,ee,te,ae,_e)},ue.decryptAndRemuxAvc=function(k,j,$,ee,te,ae,_e){if(j.samples){var Ie=this;this.sampleAes.decryptAvcSamples(j.samples,0,0,function(){Ie.remuxer.remux(k,j,$,ee,te,ae,_e)})}else this.remuxer.remux(k,j,$,ee,te,ae,_e)},ue.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},ue._parsePAT=function(k,j){return(k[j+10]&31)<<8|k[j+11]},ue._trackUnknownPmt=function(k,j,$){var ee=this.pmtUnknownTypes[k]||0;return ee===0&&(this.pmtUnknownTypes[k]=0,j.call(m.logger,$)),this.pmtUnknownTypes[k]++,ee},ue._parsePMT=function(k,j,$,ee){var te,ae,_e,Ie,Ce={audio:-1,avc:-1,id3:-1,isAAC:!0};for(te=(k[j+1]&15)<<8|k[j+2],ae=j+3+te-4,_e=(k[j+10]&15)<<8|k[j+11],j+=12+_e;j<ae;){switch(Ie=(k[j+1]&31)<<8|k[j+2],k[j]){case 207:if(!ee){this._trackUnknownPmt(k[j],m.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:Ce.audio===-1&&(Ce.audio=Ie);break;case 21:Ce.id3===-1&&(Ce.id3=Ie);break;case 219:if(!ee){this._trackUnknownPmt(k[j],m.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:Ce.avc===-1&&(Ce.avc=Ie);break;case 3:case 4:$?Ce.audio===-1&&(Ce.audio=Ie,Ce.isAAC=!1):this._trackUnknownPmt(k[j],m.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(k[j],m.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(k[j],m.logger.log,"Unknown stream type:"+k[j]);break}j+=((k[j+3]&15)<<8|k[j+4])+5}return Ce},ue._parsePES=function(k){var j=0,$,ee,te,ae,_e,Ie,Ce,Re,Ne,ke=k.data;if(!k||k.size===0)return null;for(;ke[0].length<19&&ke.length>1;){var ze=new Uint8Array(ke[0].length+ke[1].length);ze.set(ke[0]),ze.set(ke[1],ke[0].length),ke[0]=ze,ke.splice(1,1)}if($=ke[0],te=($[0]<<16)+($[1]<<8)+$[2],te===1){if(ae=($[4]<<8)+$[5],ae&&ae>k.size-6||(ee=$[7],ee&192&&(Ce=($[9]&14)*536870912+($[10]&255)*4194304+($[11]&254)*16384+($[12]&255)*128+($[13]&254)/2,ee&64?(Re=($[14]&14)*536870912+($[15]&255)*4194304+($[16]&254)*16384+($[17]&255)*128+($[18]&254)/2,Ce-Re>60*9e4&&(m.logger.warn(Math.round((Ce-Re)/9e4)+"s delta between PTS and DTS, align them"),Ce=Re)):Re=Ce),_e=$[8],Ne=_e+9,k.size<=Ne))return null;k.size-=Ne,Ie=new Uint8Array(k.size);for(var De=0,Qe=ke.length;De<Qe;De++){$=ke[De];var $e=$.byteLength;if(Ne)if(Ne>$e){Ne-=$e;continue}else $=$.subarray(Ne),$e-=Ne,Ne=0;Ie.set($,j),j+=$e}return ae&&(ae-=_e+3),{data:Ie,pts:Ce,dts:Re,len:ae}}else return null},ue.pushAccesUnit=function(k,j){if(k.units.length&&k.frame){var $=j.samples,ee=$.length;if(isNaN(k.pts))if(ee){var te=$[ee-1];k.pts=te.pts,k.dts=te.dts}else{j.dropped++;return}!this.config.forceKeyFrameOnDiscontinuity||k.key===!0||j.sps&&(ee||this.contiguous)?(k.id=ee,$.push(k)):j.dropped++}k.debug.length&&m.logger.log(k.pts+"/"+k.dts+":"+k.debug)},ue._parseAVCPES=function(k,j){var $=this,ee=this._avcTrack,te=this._parseAVCNALu(k.data),ae,_e=this.avcSample,Ie,Ce=!1,Re,Ne=this.pushAccesUnit.bind(this),ke=function(De,Qe,$e,lt){return{key:De,pts:Qe,dts:$e,units:[],debug:lt}};k.data=null,_e&&te.length&&!ee.audFound&&(Ne(_e,ee),_e=this.avcSample=ke(!1,k.pts,k.dts,"")),te.forEach(function(ze){switch(ze.type){case 1:Ie=!0,_e||(_e=$.avcSample=ke(!0,k.pts,k.dts,"")),_e.frame=!0;var De=ze.data;if(Ce&&De.length>4){var Qe=new le(De).readSliceType();(Qe===2||Qe===4||Qe===7||Qe===9)&&(_e.key=!0)}break;case 5:Ie=!0,_e||(_e=$.avcSample=ke(!0,k.pts,k.dts,"")),_e.key=!0,_e.frame=!0;break;case 6:Ie=!0,ae=new le($.discardEPB(ze.data)),ae.readUByte();for(var $e=0,lt=0,bt=!1,st=0;!bt&&ae.bytesAvailable>1;){$e=0;do st=ae.readUByte(),$e+=st;while(st===255);lt=0;do st=ae.readUByte(),lt+=st;while(st===255);if($e===4&&ae.bytesAvailable!==0){bt=!0;var Nt=ae.readUByte();if(Nt===181){var Pt=ae.readUShort();if(Pt===49){var gt=ae.readUInt();if(gt===1195456820){var kt=ae.readUByte();if(kt===3){var Ft=ae.readUByte(),pr=ae.readUByte(),Zt=31&Ft,qt=[Ft,pr];for(Re=0;Re<Zt;Re++)qt.push(ae.readUByte()),qt.push(ae.readUByte()),qt.push(ae.readUByte());$._insertSampleInOrder($._txtTrack.samples,{type:3,pts:k.pts,bytes:qt})}}}}}else if($e===5&&ae.bytesAvailable!==0){if(bt=!0,lt>16){var Dt=[];for(Re=0;Re<16;Re++)Dt.push(ae.readUByte().toString(16)),(Re===3||Re===5||Re===7||Re===9)&&Dt.push("-");var nr=lt-16,rr=new Uint8Array(nr);for(Re=0;Re<nr;Re++)rr[Re]=ae.readUByte();$._insertSampleInOrder($._txtTrack.samples,{pts:k.pts,payloadType:$e,uuid:Dt.join(""),userDataBytes:rr,userData:Object(me.utf8ArrayToStr)(rr.buffer)})}}else if(lt<ae.bytesAvailable)for(Re=0;Re<lt;Re++)ae.readUByte()}break;case 7:if(Ie=!0,Ce=!0,!ee.sps){ae=new le(ze.data);var tr=ae.readSPS();ee.width=tr.width,ee.height=tr.height,ee.pixelRatio=tr.pixelRatio,ee.sps=[ze.data],ee.duration=$._duration;var Ht=ze.data.subarray(1,4),Yr="avc1.";for(Re=0;Re<3;Re++){var gr=Ht[Re].toString(16);gr.length<2&&(gr="0"+gr),Yr+=gr}ee.codec=Yr}break;case 8:Ie=!0,ee.pps||(ee.pps=[ze.data]);break;case 9:Ie=!1,ee.audFound=!0,_e&&Ne(_e,ee),_e=$.avcSample=ke(!1,k.pts,k.dts,"");break;case 12:Ie=!1;break;default:Ie=!1,_e&&(_e.debug+="unknown NAL "+ze.type+" ");break}if(_e&&Ie){var Dr=_e.units;Dr.push(ze)}}),j&&_e&&(Ne(_e,ee),this.avcSample=null)},ue._insertSampleInOrder=function(k,j){var $=k.length;if($>0){if(j.pts>=k[$-1].pts)k.push(j);else for(var ee=$-1;ee>=0;ee--)if(j.pts<k[ee].pts){k.splice(ee,0,j);break}}else k.push(j)},ue._getLastNalUnit=function(){var k=this.avcSample,j;if(!k||k.units.length===0){var $=this._avcTrack,ee=$.samples;k=ee[ee.length-1]}if(k){var te=k.units;j=te[te.length-1]}return j},ue._parseAVCNALu=function(k){var j=0,$=k.byteLength,ee,te,ae=this._avcTrack,_e=ae.naluState||0,Ie=_e,Ce=[],Re,Ne,ke=-1,ze;for(_e===-1&&(ke=0,ze=k[0]&31,_e=0,j=1);j<$;){if(ee=k[j++],!_e){_e=ee?0:1;continue}if(_e===1){_e=ee?0:2;continue}if(!ee)_e=3;else if(ee===1){if(ke>=0)Re={data:k.subarray(ke,j-_e-1),type:ze},Ce.push(Re);else{var De=this._getLastNalUnit();if(De&&(Ie&&j<=4-Ie&&De.state&&(De.data=De.data.subarray(0,De.data.byteLength-Ie)),te=j-_e-1,te>0)){var Qe=new Uint8Array(De.data.byteLength+te);Qe.set(De.data,0),Qe.set(k.subarray(0,te),De.data.byteLength),De.data=Qe}}j<$?(Ne=k[j]&31,ke=j,ze=Ne,_e=0):_e=-1}else _e=0}if(ke>=0&&_e>=0&&(Re={data:k.subarray(ke,$),type:ze,state:_e},Ce.push(Re)),Ce.length===0){var $e=this._getLastNalUnit();if($e){var lt=new Uint8Array($e.data.byteLength+k.byteLength);lt.set($e.data,0),lt.set(k,$e.data.byteLength),$e.data=lt}}return ae.naluState=_e,Ce},ue.discardEPB=function(k){for(var j=k.byteLength,$=[],ee=1,te,ae;ee<j-2;)k[ee]===0&&k[ee+1]===0&&k[ee+2]===3?($.push(ee+2),ee+=2):ee++;if($.length===0)return k;te=j-$.length,ae=new Uint8Array(te);var _e=0;for(ee=0;ee<te;_e++,ee++)_e===$[0]&&(_e++,$.shift()),ae[ee]=k[_e];return ae},ue._parseAACPES=function(k){var j=this._audioTrack,$=k.data,ee=k.pts,te=0,ae=this.aacOverFlow,_e=this.aacLastPTS,Ie,Ce,Re,Ne,ke;if(ae){var ze=new Uint8Array(ae.byteLength+$.byteLength);ze.set(ae,0),ze.set($,ae.byteLength),$=ze}for(Re=te,ke=$.length;Re<ke-1&&!N($,Re);Re++);if(Re){var De,Qe;if(Re<ke-1?(De="AAC PES did not start with ADTS header,offset:"+Re,Qe=!1):(De="no ADTS header found in AAC PES",Qe=!0),m.logger.warn("parsing error:"+De),this.observer.trigger(u.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:Qe,reason:De}),Qe)return}if(Y(j,this.observer,$,Re,this.audioCodec),Ce=0,Ie=X(j.samplerate),ae&&_e){var $e=_e+Ie;Math.abs($e-ee)>1&&(m.logger.log("AAC: align PTS for overlapping frames by "+Math.round(($e-ee)/90)),ee=$e)}for(;Re<ke;)if(N($,Re)){if(Re+5<ke){var lt=fe(j,$,Re,ee,Ce);if(lt){Re+=lt.length,Ne=lt.sample.pts,Ce++;continue}}break}else Re++;Re<ke?ae=$.subarray(Re,ke):ae=null,this.aacOverFlow=ae,this.aacLastPTS=Ne},ue._parseMPEGPES=function(k){for(var j=k.data,$=j.length,ee=0,te=0,ae=k.pts;te<$;)if(Q.isHeader(j,te)){var _e=Q.appendFrame(this._audioTrack,j,te,ae,ee);if(_e)te+=_e.length,ee++;else break}else te++},ue._parseID3PES=function(k){this._id3Track.samples.push(k)},q}(),dt=At,Ue=function(){function q(W,k,j){this.observer=W,this.config=j,this.remuxer=k}var ue=q.prototype;return ue.resetInitSegment=function(k,j,$,ee){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:j,duration:ee,inputTimeScale:9e4}},ue.resetTimeStamp=function(){},q.probe=function(k){var j,$,ee=me.default.getID3Data(k,0);if(ee&&me.default.getTimeStamp(ee)!==void 0){for(j=ee.length,$=Math.min(k.length-1,j+100);j<$;j++)if(Q.probe(k,j))return m.logger.log("MPEG Audio sync word found !"),!0}return!1},ue.append=function(k,j,$,ee){for(var te=me.default.getID3Data(k,0)||[],ae=me.default.getTimeStamp(te),_e=ae!==void 0?90*ae:j*9e4,Ie=te.length,Ce=k.length,Re=0,Ne=0,ke=this._audioTrack,ze=[{pts:_e,dts:_e,data:te}];Ie<Ce;)if(Q.isHeader(k,Ie)){var De=Q.appendFrame(ke,k,Ie,_e,Re);if(De)Ie+=De.length,Ne=De.sample.pts,Re++;else break}else me.default.isHeader(k,Ie)?(te=me.default.getID3Data(k,Ie),ze.push({pts:Ne,dts:Ne,data:te}),Ie+=te.length):Ie++;this.remuxer.remux(ke,{samples:[]},{samples:ze,inputTimeScale:9e4},{samples:[]},j,$,ee)},ue.destroy=function(){},q}(),Ke=Ue,Be=function(){function q(){}return q.getSilentFrame=function(W,k){switch(W){case"mp4a.40.2":if(k===1)return new Uint8Array([0,200,0,128,35,128]);if(k===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(k===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(k===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(k===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(k===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(k===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(k===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(k===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}return null},q}(),se=Be,ye=Math.pow(2,32)-1,He=function(){function q(){}return q.init=function(){q.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var W;for(W in q.types)q.types.hasOwnProperty(W)&&(q.types[W]=[W.charCodeAt(0),W.charCodeAt(1),W.charCodeAt(2),W.charCodeAt(3)]);var k=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),j=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);q.HDLR_TYPES={video:k,audio:j};var $=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ee=new Uint8Array([0,0,0,0,0,0,0,0]);q.STTS=q.STSC=q.STCO=ee,q.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),q.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),q.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),q.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var te=new Uint8Array([105,115,111,109]),ae=new Uint8Array([97,118,99,49]),_e=new Uint8Array([0,0,0,1]);q.FTYP=q.box(q.types.ftyp,te,_e,te,ae),q.DINF=q.box(q.types.dinf,q.box(q.types.dref,$))},q.box=function(W){for(var k=Array.prototype.slice.call(arguments,1),j=8,$=k.length,ee=$,te;$--;)j+=k[$].byteLength;for(te=new Uint8Array(j),te[0]=j>>24&255,te[1]=j>>16&255,te[2]=j>>8&255,te[3]=j&255,te.set(W,4),$=0,j=8;$<ee;$++)te.set(k[$],j),j+=k[$].byteLength;return te},q.hdlr=function(W){return q.box(q.types.hdlr,q.HDLR_TYPES[W])},q.mdat=function(W){return q.box(q.types.mdat,W)},q.mdhd=function(W,k){k*=W;var j=Math.floor(k/(ye+1)),$=Math.floor(k%(ye+1));return q.box(q.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,W>>24&255,W>>16&255,W>>8&255,W&255,j>>24,j>>16&255,j>>8&255,j&255,$>>24,$>>16&255,$>>8&255,$&255,85,196,0,0]))},q.mdia=function(W){return q.box(q.types.mdia,q.mdhd(W.timescale,W.duration),q.hdlr(W.type),q.minf(W))},q.mfhd=function(W){return q.box(q.types.mfhd,new Uint8Array([0,0,0,0,W>>24,W>>16&255,W>>8&255,W&255]))},q.minf=function(W){return W.type==="audio"?q.box(q.types.minf,q.box(q.types.smhd,q.SMHD),q.DINF,q.stbl(W)):q.box(q.types.minf,q.box(q.types.vmhd,q.VMHD),q.DINF,q.stbl(W))},q.moof=function(W,k,j){return q.box(q.types.moof,q.mfhd(W),q.traf(j,k))},q.moov=function(W){for(var k=W.length,j=[];k--;)j[k]=q.trak(W[k]);return q.box.apply(null,[q.types.moov,q.mvhd(W[0].timescale,W[0].duration)].concat(j).concat(q.mvex(W)))},q.mvex=function(W){for(var k=W.length,j=[];k--;)j[k]=q.trex(W[k]);return q.box.apply(null,[q.types.mvex].concat(j))},q.mvhd=function(W,k){k*=W;var j=Math.floor(k/(ye+1)),$=Math.floor(k%(ye+1)),ee=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,W>>24&255,W>>16&255,W>>8&255,W&255,j>>24,j>>16&255,j>>8&255,j&255,$>>24,$>>16&255,$>>8&255,$&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return q.box(q.types.mvhd,ee)},q.sdtp=function(W){var k=W.samples||[],j=new Uint8Array(4+k.length),$,ee;for(ee=0;ee<k.length;ee++)$=k[ee].flags,j[ee+4]=$.dependsOn<<4|$.isDependedOn<<2|$.hasRedundancy;return q.box(q.types.sdtp,j)},q.stbl=function(W){return q.box(q.types.stbl,q.stsd(W),q.box(q.types.stts,q.STTS),q.box(q.types.stsc,q.STSC),q.box(q.types.stsz,q.STSZ),q.box(q.types.stco,q.STCO))},q.avc1=function(W){var k=[],j=[],$,ee,te;for($=0;$<W.sps.length;$++)ee=W.sps[$],te=ee.byteLength,k.push(te>>>8&255),k.push(te&255),k=k.concat(Array.prototype.slice.call(ee));for($=0;$<W.pps.length;$++)ee=W.pps[$],te=ee.byteLength,j.push(te>>>8&255),j.push(te&255),j=j.concat(Array.prototype.slice.call(ee));var ae=q.box(q.types.avcC,new Uint8Array([1,k[3],k[4],k[5],255,224|W.sps.length].concat(k).concat([W.pps.length]).concat(j))),_e=W.width,Ie=W.height,Ce=W.pixelRatio[0],Re=W.pixelRatio[1];return q.box(q.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,_e>>8&255,_e&255,Ie>>8&255,Ie&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),ae,q.box(q.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),q.box(q.types.pasp,new Uint8Array([Ce>>24,Ce>>16&255,Ce>>8&255,Ce&255,Re>>24,Re>>16&255,Re>>8&255,Re&255])))},q.esds=function(W){var k=W.config.length;return new Uint8Array([0,0,0,0,3,23+k,0,1,0,4,15+k,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([k]).concat(W.config).concat([6,1,2]))},q.mp4a=function(W){var k=W.samplerate;return q.box(q.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,W.channelCount,0,16,0,0,0,0,k>>8&255,k&255,0,0]),q.box(q.types.esds,q.esds(W)))},q.mp3=function(W){var k=W.samplerate;return q.box(q.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,W.channelCount,0,16,0,0,0,0,k>>8&255,k&255,0,0]))},q.stsd=function(W){return W.type==="audio"?!W.isAAC&&W.codec==="mp3"?q.box(q.types.stsd,q.STSD,q.mp3(W)):q.box(q.types.stsd,q.STSD,q.mp4a(W)):q.box(q.types.stsd,q.STSD,q.avc1(W))},q.tkhd=function(W){var k=W.id,j=W.duration*W.timescale,$=W.width,ee=W.height,te=Math.floor(j/(ye+1)),ae=Math.floor(j%(ye+1));return q.box(q.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,k>>24&255,k>>16&255,k>>8&255,k&255,0,0,0,0,te>>24,te>>16&255,te>>8&255,te&255,ae>>24,ae>>16&255,ae>>8&255,ae&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,$>>8&255,$&255,0,0,ee>>8&255,ee&255,0,0]))},q.traf=function(W,k){var j=q.sdtp(W),$=W.id,ee=Math.floor(k/(ye+1)),te=Math.floor(k%(ye+1));return q.box(q.types.traf,q.box(q.types.tfhd,new Uint8Array([0,0,0,0,$>>24,$>>16&255,$>>8&255,$&255])),q.box(q.types.tfdt,new Uint8Array([1,0,0,0,ee>>24,ee>>16&255,ee>>8&255,ee&255,te>>24,te>>16&255,te>>8&255,te&255])),q.trun(W,j.length+16+20+8+16+8+8),j)},q.trak=function(W){return W.duration=W.duration||4294967295,q.box(q.types.trak,q.tkhd(W),q.mdia(W))},q.trex=function(W){var k=W.id;return q.box(q.types.trex,new Uint8Array([0,0,0,0,k>>24,k>>16&255,k>>8&255,k&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},q.trun=function(W,k){var j=W.samples||[],$=j.length,ee=12+16*$,te=new Uint8Array(ee),ae,_e,Ie,Ce,Re,Ne;for(k+=8+ee,te.set([0,0,15,1,$>>>24&255,$>>>16&255,$>>>8&255,$&255,k>>>24&255,k>>>16&255,k>>>8&255,k&255],0),ae=0;ae<$;ae++)_e=j[ae],Ie=_e.duration,Ce=_e.size,Re=_e.flags,Ne=_e.cts,te.set([Ie>>>24&255,Ie>>>16&255,Ie>>>8&255,Ie&255,Ce>>>24&255,Ce>>>16&255,Ce>>>8&255,Ce&255,Re.isLeading<<2|Re.dependsOn,Re.isDependedOn<<6|Re.hasRedundancy<<4|Re.paddingValue<<1|Re.isNonSync,Re.degradPrio&61440,Re.degradPrio&15,Ne>>>24&255,Ne>>>16&255,Ne>>>8&255,Ne&255],12+16*ae);return q.box(q.types.trun,te)},q.initSegment=function(W){q.types||q.init();var k=q.moov(W),j;return j=new Uint8Array(q.FTYP.byteLength+k.byteLength),j.set(q.FTYP),j.set(k,q.FTYP.byteLength),j},q}(),Ye=He,mt=9e4;function wt(q,ue,W,k){W===void 0&&(W=1),k===void 0&&(k=!1);var j=q*ue*W;return k?Math.round(j):j}function et(q,ue){return ue===void 0&&(ue=!1),wt(q,1e3,1/mt,ue)}function vt(q,ue){return ue===void 0&&(ue=1),wt(q,mt,1/ue)}var Rt=vt(10),Kt=vt(.2),br=null,bn=function(){function q(W,k,j,$){if(this.observer=W,this.config=k,this.typeSupported=j,this.ISGenerated=!1,br===null){var ee=navigator.userAgent.match(/Chrome\/(\d+)/i);br=ee?parseInt(ee[1]):0}}var ue=q.prototype;return ue.destroy=function(){},ue.resetTimeStamp=function(k){this._initPTS=this._initDTS=k},ue.resetInitSegment=function(){this.ISGenerated=!1},ue.getVideoStartPts=function(k){var j=!1,$=k.reduce(function(ee,te){var ae=te.pts-ee;return ae<-4294967296?(j=!0,or(ee,te.pts)):ae>0?ee:te.pts},k[0].pts);return j&&m.logger.debug("PTS rollover detected"),$},ue.remux=function(k,j,$,ee,te,ae,_e){if(this.ISGenerated||this.generateIS(k,j,te),this.ISGenerated){var Ie=k.samples.length,Ce=j.samples.length,Re=te,Ne=te;if(Ie&&Ce){var ke=this.getVideoStartPts(j.samples),ze=or(k.samples[0].pts,ke)-ke,De=ze/j.inputTimeScale;Re+=Math.max(0,De),Ne+=Math.max(0,-De)}if(Ie){k.timescale||(m.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(k,j,te));var Qe=this.remuxAudio(k,Re,ae,_e);if(Ce){var $e;Qe&&($e=Qe.endPTS-Qe.startPTS),j.timescale||(m.logger.warn("regenerate InitSegment as video detected"),this.generateIS(k,j,te)),this.remuxVideo(j,Ne,ae,$e)}}else if(Ce){var lt=this.remuxVideo(j,Ne,ae,0,_e);lt&&k.codec&&this.remuxEmptyAudio(k,Re,ae,lt)}}$.samples.length&&this.remuxID3($,te),ee.samples.length&&this.remuxText(ee,te),this.observer.trigger(u.default.FRAG_PARSED)},ue.generateIS=function(k,j,$){var ee=this.observer,te=k.samples,ae=j.samples,_e=this.typeSupported,Ie="audio/mp4",Ce={},Re={tracks:Ce},Ne=this._initPTS===void 0,ke,ze;if(Ne&&(ke=ze=1/0),k.config&&te.length&&(k.timescale=k.samplerate,m.logger.log("audio sampling rate : "+k.samplerate),k.isAAC||(_e.mpeg?(Ie="audio/mpeg",k.codec=""):_e.mp3&&(k.codec="mp3")),Ce.audio={container:Ie,codec:k.codec,initSegment:!k.isAAC&&_e.mpeg?new Uint8Array:Ye.initSegment([k]),metadata:{channelCount:k.channelCount}},Ne&&(ke=ze=te[0].pts-Math.round(k.inputTimeScale*$))),j.sps&&j.pps&&ae.length){var De=j.inputTimeScale;if(j.timescale=De,Ce.video={container:"video/mp4",codec:j.codec,initSegment:Ye.initSegment([j]),metadata:{width:j.width,height:j.height}},Ne){var Qe=this.getVideoStartPts(ae),$e=Math.round(De*$);ze=Math.min(ze,or(ae[0].dts,Qe)-$e),ke=Math.min(ke,Qe-$e),this.observer.trigger(u.default.INIT_PTS_FOUND,{initPTS:ke})}}else Ne&&Ce.audio&&this.observer.trigger(u.default.INIT_PTS_FOUND,{initPTS:ke});Object.keys(Ce).length?(ee.trigger(u.default.FRAG_PARSING_INIT_SEGMENT,Re),this.ISGenerated=!0,Ne&&(this._initPTS=ke,this._initDTS=ze)):ee.trigger(u.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},ue.remuxVideo=function(k,j,$,ee){var te=k.timescale,ae=k.samples,_e=[],Ie=ae.length,Ce=this._initPTS,Re=8,Ne,ke,ze,De,Qe,$e=Number.POSITIVE_INFINITY,lt=Number.NEGATIVE_INFINITY,bt=0,st=!1,Nt=this.nextAvcDts;if(Ie!==0){if(!$){var Pt=j*te,gt=ae[0].pts-or(ae[0].dts,ae[0].pts);Nt=Pt-gt}for(var kt=0;kt<Ie;kt++){var Ft=ae[kt];Ft.pts=or(Ft.pts-Ce,Nt),Ft.dts=or(Ft.dts-Ce,Nt),Ft.dts>Ft.pts&&(bt=Math.max(Math.min(bt,Ft.pts-Ft.dts),-1*Kt)),Ft.dts<ae[kt>0?kt-1:kt].dts&&(st=!0)}st&&ae.sort(function(Si,ji){var zi=Si.dts-ji.dts,Gi=Si.pts-ji.pts;return zi||Gi||Si.id-ji.id}),De=ae[0].dts,Qe=ae[Ie-1].dts;var pr=Math.round((Qe-De)/(Ie-1));if(bt<0){if(bt<pr*-2){m.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+et(-pr,!0)+" ms");for(var Zt=bt,qt=0;qt<Ie;qt++)ae[qt].dts=Zt=Math.max(Zt,ae[qt].pts-pr),ae[qt].pts=Math.max(Zt,ae[qt].pts)}else{m.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+et(bt,!0)+" ms to overcome this issue");for(var Dt=0;Dt<Ie;Dt++)ae[Dt].dts=ae[Dt].dts+bt}De=ae[0].dts,Qe=ae[Ie-1].dts}if($){var nr=De-Nt,rr=nr>pr,tr=nr<-1;if(rr||tr){rr?m.logger.warn("AVC: "+et(nr,!0)+" ms ("+nr+"dts) hole between fragments detected, filling it"):m.logger.warn("AVC: "+et(-nr,!0)+" ms ("+nr+"dts) overlapping between fragments detected"),De=Nt;var Ht=ae[0].pts-nr;ae[0].dts=De,ae[0].pts=Ht,m.logger.log("Video: First PTS/DTS adjusted: "+et(Ht,!0)+"/"+et(De,!0)+", delta: "+et(nr,!0)+" ms")}}br&&br<75&&(De=Math.max(0,De));for(var Yr=0,gr=0,Dr=0;Dr<Ie;Dr++){for(var Ar=ae[Dr],jr=Ar.units,cn=jr.length,_r=0,wn=0;wn<cn;wn++)_r+=jr[wn].data.length;gr+=_r,Yr+=cn,Ar.length=_r,Ar.dts=Math.max(Ar.dts,De),Ar.pts=Math.max(Ar.pts,Ar.dts,0),$e=Math.min(Ar.pts,$e),lt=Math.max(Ar.pts,lt)}Qe=ae[Ie-1].dts;var Er=gr+4*Yr+8;try{ke=new Uint8Array(Er)}catch{this.observer.trigger(u.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Er,reason:"fail allocating video mdat "+Er});return}var oi=new DataView(ke.buffer);oi.setUint32(0,Er),ke.set(Ye.types.mdat,4);for(var Se=0;Se<Ie;Se++){for(var Tr=ae[Se],kn=Tr.units,Kn=0,fn=void 0,hs=0,Yt=kn.length;hs<Yt;hs++){var ds=kn[hs],wi=ds.data,Dn=ds.data.byteLength;oi.setUint32(Re,Dn),Re+=4,ke.set(wi,Re),Re+=Dn,Kn+=4+Dn}if(Se<Ie-1)Ne=ae[Se+1].dts-Tr.dts;else{var rn=this.config,Hn=Tr.dts-ae[Se>0?Se-1:Se].dts;if(rn.stretchShortVideoTrack){var zs=rn.maxBufferHole,$n=Math.floor(zs*te),Lr=(ee?$e+ee*te:this.nextAudioPts)-Tr.pts;Lr>$n?(Ne=Lr-Hn,Ne<0&&(Ne=Hn),m.logger.log("It is approximately "+et(Lr,!1)+" ms to the next segment; using duration "+et(Ne,!1)+" ms for the last video frame.")):Ne=Hn}else Ne=Hn}fn=Math.round(Tr.pts-Tr.dts),_e.push({size:Kn,duration:Ne,cts:fn,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:Tr.key?2:1,isNonSync:Tr.key?0:1}})}this.nextAvcDts=Qe+Ne;var ai=k.dropped;if(k.nbNalu=0,k.dropped=0,_e.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var Or=_e[0].flags;Or.dependsOn=2,Or.isNonSync=0}k.samples=_e,ze=Ye.moof(k.sequenceNumber++,De,k),k.samples=[];var Bi={data1:ze,data2:ke,startPTS:$e/te,endPTS:(lt+Ne)/te,startDTS:De/te,endDTS:this.nextAvcDts/te,type:"video",hasAudio:!1,hasVideo:!0,nb:_e.length,dropped:ai};return this.observer.trigger(u.default.FRAG_PARSING_DATA,Bi),Bi}},ue.remuxAudio=function(k,j,$,ee){var te=k.inputTimeScale,ae=k.timescale,_e=te/ae,Ie=k.isAAC?1024:1152,Ce=Ie*_e,Re=this._initPTS,Ne=!k.isAAC&&this.typeSupported.mpeg,ke,ze,De,Qe,$e,lt,bt=Ne?0:8,st=k.samples,Nt=[],Pt=this.nextAudioPts;if($|=st.length&&Pt&&(ee&&Math.abs(j-Pt/te)<.1||Math.abs(st[0].pts-Pt-Re)<20*Ce),st.forEach(function(fn){fn.pts=fn.dts=or(fn.pts-Re,j*te)}),st=st.filter(function(fn){return fn.pts>=0}),st.length!==0){if($||(ee?Pt=Math.max(0,j*te):Pt=st[0].pts),k.isAAC)for(var gt=this.config.maxAudioFramesDrift,kt=0,Ft=Pt;kt<st.length;){var pr=st[kt],Zt=pr.pts,qt=Zt-Ft;if(qt<=-gt*Ce)$||kt>0?(m.logger.warn("Dropping 1 audio frame @ "+et(Ft,!0)/1e3+"s due to "+et(qt,!0)+" ms overlap."),st.splice(kt,1)):(m.logger.warn("Audio frame @ "+et(Zt,!0)/1e3+"s overlaps nextAudioPts by "+et(qt,!0)+" ms."),Ft=Zt+Ce,kt++);else if(qt>=gt*Ce&&qt<Rt&&Ft){var Dt=Math.round(qt/Ce);m.logger.warn("Injecting "+Dt+" audio frames @ "+et(Ft,!0)/1e3+"s due to "+et(qt,!0)+" ms gap.");for(var nr=0;nr<Dt;nr++){var rr=Math.max(Ft,0);ze=se.getSilentFrame(k.manifestCodec||k.codec,k.channelCount),ze||(m.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ze=pr.unit.subarray()),st.splice(kt,0,{unit:ze,pts:rr,dts:rr}),Ft+=Ce,kt++}pr.pts=pr.dts=Ft,Ft+=Ce,kt++}else pr.pts=pr.dts=Ft,Ft+=Ce,kt++}for(var tr=st.length,Ht=0;tr--;)Ht+=st[tr].unit.byteLength;for(var Yr=0,gr=st.length;Yr<gr;Yr++){var Dr=st[Yr],Ar=Dr.unit,jr=Dr.pts;if(lt!==void 0&&ke)ke.duration=Math.round((jr-lt)/_e);else{var cn=jr-Pt,_r=0;if($&&k.isAAC&&cn){if(cn>0&&cn<Rt)_r=Math.round((jr-Pt)/Ce),m.logger.log(et(cn,!0)+" ms hole between AAC samples detected,filling it"),_r>0&&(ze=se.getSilentFrame(k.manifestCodec||k.codec,k.channelCount),ze||(ze=Ar.subarray()),Ht+=_r*ze.length);else if(cn<-12){m.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+et(Pt,!0)+" ms / "+et(jr,!0)+" ms / "+et(-cn,!0)+" ms"),Ht-=Ar.byteLength;continue}jr=Pt}if($e=jr,Ht>0){Ht+=bt;try{De=new Uint8Array(Ht)}catch{this.observer.trigger(u.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Ht,reason:"fail allocating audio mdat "+Ht});return}if(!Ne){var wn=new DataView(De.buffer);wn.setUint32(0,Ht),De.set(Ye.types.mdat,4)}}else return;for(var Er=0;Er<_r;Er++)ze=se.getSilentFrame(k.manifestCodec||k.codec,k.channelCount),ze||(m.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),ze=Ar.subarray()),De.set(ze,bt),bt+=ze.byteLength,ke={size:ze.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},Nt.push(ke)}De.set(Ar,bt);var oi=Ar.byteLength;bt+=oi,ke={size:oi,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},Nt.push(ke),lt=jr}var Se=0;if(tr=Nt.length,tr>=2&&(Se=Nt[tr-2].duration,ke.duration=Se),tr){this.nextAudioPts=Pt=lt+_e*Se,k.samples=Nt,Ne?Qe=new Uint8Array:Qe=Ye.moof(k.sequenceNumber++,$e/_e,k),k.samples=[];var Tr=$e/te,kn=Pt/te,Kn={data1:Qe,data2:De,startPTS:Tr,endPTS:kn,startDTS:Tr,endDTS:kn,type:"audio",hasAudio:!0,hasVideo:!1,nb:tr};return this.observer.trigger(u.default.FRAG_PARSING_DATA,Kn),Kn}return null}},ue.remuxEmptyAudio=function(k,j,$,ee){var te=k.inputTimeScale,ae=k.samplerate?k.samplerate:te,_e=te/ae,Ie=this.nextAudioPts,Ce=(Ie!==void 0?Ie:ee.startDTS*te)+this._initDTS,Re=ee.endDTS*te+this._initDTS,Ne=1024,ke=_e*Ne,ze=Math.ceil((Re-Ce)/ke),De=se.getSilentFrame(k.manifestCodec||k.codec,k.channelCount);if(m.logger.warn("remux empty Audio"),!De){m.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}for(var Qe=[],$e=0;$e<ze;$e++){var lt=Ce+$e*ke;Qe.push({unit:De,pts:lt,dts:lt})}k.samples=Qe,this.remuxAudio(k,j,$)},ue.remuxID3=function(k,j){var $=k.samples.length;if($){for(var ee=k.inputTimeScale,te=this._initPTS,ae=this._initDTS,_e=0;_e<$;_e++){var Ie=k.samples[_e];Ie.pts=or(Ie.pts-te,j*ee)/ee,Ie.dts=or(Ie.dts-ae,j*ee)/ee}this.observer.trigger(u.default.FRAG_PARSING_METADATA,{samples:k.samples}),k.samples=[]}},ue.remuxText=function(k,j){var $=k.samples.length,ee=k.inputTimeScale,te=this._initPTS;if($){for(var ae=0;ae<$;ae++){var _e=k.samples[ae];_e.pts=or(_e.pts-te,j*ee)/ee}k.samples.sort(function(Ie,Ce){return Ie.pts-Ce.pts}),this.observer.trigger(u.default.FRAG_PARSING_USERDATA,{samples:k.samples})}k.samples=[]},q}();function or(q,ue){var W;if(ue===void 0)return q;for(ue<q?W=-8589934592:W=8589934592;Math.abs(q-ue)>4294967296;)q+=W;return q}var tn=bn,lr=function(){function q(W){this.observer=W}var ue=q.prototype;return ue.destroy=function(){},ue.resetTimeStamp=function(){},ue.resetInitSegment=function(){},ue.remux=function(k,j,$,ee,te,ae,_e,Ie){var Ce=this.observer,Re="";k&&(Re+="audio"),j&&(Re+="video"),Ce.trigger(u.default.FRAG_PARSING_DATA,{data1:Ie,startPTS:te,startDTS:te,type:Re,hasAudio:!!k,hasVideo:!!j,nb:1,dropped:0}),Ce.trigger(u.default.FRAG_PARSED)},q}(),Gn=lr,kr=Object(_.getSelfScope)(),dr;try{dr=kr.performance.now.bind(kr.performance)}catch{m.logger.debug("Unable to use Performance API on this environment"),dr=kr.Date.now}var Vi=function(){function q(W,k,j,$){this.observer=W,this.typeSupported=k,this.config=j,this.vendor=$}var ue=q.prototype;return ue.destroy=function(){var k=this.demuxer;k&&k.destroy()},ue.push=function(k,j,$,ee,te,ae,_e,Ie,Ce,Re,Ne,ke){var ze=this;if(k.byteLength>0&&j!=null&&j.key!=null&&j.method==="AES-128"){var De=this.decrypter;De==null&&(De=this.decrypter=new g.default(this.observer,this.config));var Qe=dr();De.decrypt(k,j.key.buffer,j.iv.buffer,function($e){var lt=dr();ze.observer.trigger(u.default.FRAG_DECRYPTED,{stats:{tstart:Qe,tdecrypt:lt}}),ze.pushDecrypted(new Uint8Array($e),j,new Uint8Array($),ee,te,ae,_e,Ie,Ce,Re,Ne,ke)})}else this.pushDecrypted(new Uint8Array(k),j,new Uint8Array($),ee,te,ae,_e,Ie,Ce,Re,Ne,ke)},ue.pushDecrypted=function(k,j,$,ee,te,ae,_e,Ie,Ce,Re,Ne,ke){var ze=this.demuxer,De=this.remuxer;if(!ze||_e||Ie){for(var Qe=this.observer,$e=this.typeSupported,lt=this.config,bt=[{demux:dt,remux:tn},{demux:B.default,remux:Gn},{demux:H,remux:tn},{demux:Ke,remux:tn}],st,Nt=0,Pt=bt.length;Nt<Pt&&(st=bt[Nt],!st.demux.probe(k));Nt++);if(!st){Qe.trigger(u.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});return}(!De||!(De instanceof st.remux))&&(De=new st.remux(Qe,lt,$e,this.vendor)),(!ze||!(ze instanceof st.demux))&&(ze=new st.demux(Qe,De,lt,$e),this.probe=st.demux.probe),this.demuxer=ze,this.remuxer=De}(_e||Ie)&&(ze.resetInitSegment($,ee,te,Re),De.resetInitSegment()),_e&&(ze.resetTimeStamp(ke),De.resetTimeStamp(ke)),typeof ze.setDecryptData=="function"&&ze.setDecryptData(j),ze.append(k,ae,Ce,Ne)},q}();i.default=Vi},"./src/demux/demuxer-worker.js":function(t,i,o){o.r(i);var u=o("./src/demux/demuxer-inline.js"),h=o("./src/events.js"),g=o("./src/utils/logger.js"),T=o("./node_modules/eventemitter3/index.js"),m=function(L){var I=new T.EventEmitter;I.trigger=function(N){for(var U=arguments.length,Y=new Array(U>1?U-1:0),X=1;X<U;X++)Y[X-1]=arguments[X];I.emit.apply(I,[N,N].concat(Y))},I.off=function(N){for(var U=arguments.length,Y=new Array(U>1?U-1:0),X=1;X<U;X++)Y[X-1]=arguments[X];I.removeListener.apply(I,[N].concat(Y))};var D=function(N,U){L.postMessage({event:N,data:U})};L.addEventListener("message",function(F){var N=F.data;switch(N.cmd){case"init":var U=JSON.parse(N.config);L.demuxer=new u.default(I,N.typeSupported,U,N.vendor),Object(g.enableLogs)(U.debug),D("init",null);break;case"demux":L.demuxer.push(N.data,N.decryptdata,N.initSegment,N.audioCodec,N.videoCodec,N.timeOffset,N.discontinuity,N.trackSwitch,N.contiguous,N.duration,N.accurateTimeOffset,N.defaultInitPTS);break}}),I.on(h.default.FRAG_DECRYPTED,D),I.on(h.default.FRAG_PARSING_INIT_SEGMENT,D),I.on(h.default.FRAG_PARSED,D),I.on(h.default.ERROR,D),I.on(h.default.FRAG_PARSING_METADATA,D),I.on(h.default.FRAG_PARSING_USERDATA,D),I.on(h.default.INIT_PTS_FOUND,D),I.on(h.default.FRAG_PARSING_DATA,function(F,N){var U=[],Y={event:F,data:N};N.data1&&(Y.data1=N.data1.buffer,U.push(N.data1.buffer),delete N.data1),N.data2&&(Y.data2=N.data2.buffer,U.push(N.data2.buffer),delete N.data2),L.postMessage(Y,U)})};i.default=m},"./src/demux/id3.js":function(t,i,o){o.r(i),o.d(i,"utf8ArrayToStr",function(){return m});var u=o("./src/utils/get-self-scope.js"),h=function(){function _(){}return _.isHeader=function(I,D){return D+10<=I.length&&I[D]===73&&I[D+1]===68&&I[D+2]===51&&I[D+3]<255&&I[D+4]<255&&I[D+6]<128&&I[D+7]<128&&I[D+8]<128&&I[D+9]<128},_.isFooter=function(I,D){return D+10<=I.length&&I[D]===51&&I[D+1]===68&&I[D+2]===73&&I[D+3]<255&&I[D+4]<255&&I[D+6]<128&&I[D+7]<128&&I[D+8]<128&&I[D+9]<128},_.getID3Data=function(I,D){for(var F=D,N=0;_.isHeader(I,D);){N+=10;var U=_._readSize(I,D+6);N+=U,_.isFooter(I,D+10)&&(N+=10),D+=N}if(N>0)return I.subarray(F,F+N)},_._readSize=function(I,D){var F=0;return F=(I[D]&127)<<21,F|=(I[D+1]&127)<<14,F|=(I[D+2]&127)<<7,F|=I[D+3]&127,F},_.getTimeStamp=function(I){for(var D=_.getID3Frames(I),F=0;F<D.length;F++){var N=D[F];if(_.isTimeStampFrame(N))return _._readTimeStamp(N)}},_.isTimeStampFrame=function(I){return I&&I.key==="PRIV"&&I.info==="com.apple.streaming.transportStreamTimestamp"},_._getFrameData=function(I){var D=String.fromCharCode(I[0],I[1],I[2],I[3]),F=_._readSize(I,4),N=10;return{type:D,size:F,data:I.subarray(N,N+F)}},_.getID3Frames=function(I){for(var D=0,F=[];_.isHeader(I,D);){var N=_._readSize(I,D+6);D+=10;for(var U=D+N;D+8<U;){var Y=_._getFrameData(I.subarray(D)),X=_._decodeFrame(Y);X&&F.push(X),D+=Y.size+10}_.isFooter(I,D)&&(D+=10)}return F},_._decodeFrame=function(I){return I.type==="PRIV"?_._decodePrivFrame(I):I.type[0]==="W"?_._decodeURLFrame(I):_._decodeTextFrame(I)},_._readTimeStamp=function(I){if(I.data.byteLength===8){var D=new Uint8Array(I.data),F=D[3]&1,N=(D[4]<<23)+(D[5]<<15)+(D[6]<<7)+D[7];return N/=45,F&&(N+=4772185884e-2),Math.round(N)}},_._decodePrivFrame=function(I){if(!(I.size<2)){var D=_._utf8ArrayToStr(I.data,!0),F=new Uint8Array(I.data.subarray(D.length+1));return{key:I.type,info:D,data:F.buffer}}},_._decodeTextFrame=function(I){if(!(I.size<2))if(I.type==="TXXX"){var D=1,F=_._utf8ArrayToStr(I.data.subarray(D),!0);D+=F.length+1;var N=_._utf8ArrayToStr(I.data.subarray(D));return{key:I.type,info:F,data:N}}else{var U=_._utf8ArrayToStr(I.data.subarray(1));return{key:I.type,data:U}}},_._decodeURLFrame=function(I){if(I.type==="WXXX"){if(I.size<2)return;var D=1,F=_._utf8ArrayToStr(I.data.subarray(D),!0);D+=F.length+1;var N=_._utf8ArrayToStr(I.data.subarray(D));return{key:I.type,info:F,data:N}}else{var U=_._utf8ArrayToStr(I.data);return{key:I.type,data:U}}},_._utf8ArrayToStr=function(I,D){D===void 0&&(D=!1);var F=T();if(F){var N=F.decode(I);if(D){var U=N.indexOf("\0");return U!==-1?N.substring(0,U):N}return N.replace(/\0/g,"")}for(var Y=I.length,X,ce,fe,me="",we=0;we<Y;){if(X=I[we++],X===0&&D)return me;if(X===0||X===3)continue;switch(X>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:me+=String.fromCharCode(X);break;case 12:case 13:ce=I[we++],me+=String.fromCharCode((X&31)<<6|ce&63);break;case 14:ce=I[we++],fe=I[we++],me+=String.fromCharCode((X&15)<<12|(ce&63)<<6|(fe&63)<<0);break}}return me},_}(),g;function T(){var _=Object(u.getSelfScope)();return!g&&typeof _.TextDecoder<"u"&&(g=new _.TextDecoder("utf-8")),g}var m=h._utf8ArrayToStr;i.default=h},"./src/demux/mp4demuxer.js":function(t,i,o){o.r(i);var u=o("./src/utils/logger.js"),h=o("./src/events.js"),g=Math.pow(2,32)-1,T=function(){function m(L,I){this.observer=L,this.remuxer=I}var _=m.prototype;return _.resetTimeStamp=function(I){this.initPTS=I},_.resetInitSegment=function(I,D,F,N){if(I&&I.byteLength){var U=this.initData=m.parseInitSegment(I);D==null&&(D="mp4a.40.5"),F==null&&(F="avc1.42e01e");var Y={};U.audio&&U.video?Y.audiovideo={container:"video/mp4",codec:D+","+F,initSegment:N?I:null}:(U.audio&&(Y.audio={container:"audio/mp4",codec:D,initSegment:N?I:null}),U.video&&(Y.video={container:"video/mp4",codec:F,initSegment:N?I:null})),this.observer.trigger(h.default.FRAG_PARSING_INIT_SEGMENT,{tracks:Y})}else D&&(this.audioCodec=D),F&&(this.videoCodec=F)},m.probe=function(I){return m.findBox({data:I,start:0,end:Math.min(I.length,16384)},["moof"]).length>0},m.bin2str=function(I){return String.fromCharCode.apply(null,I)},m.readUint16=function(I,D){I.data&&(D+=I.start,I=I.data);var F=I[D]<<8|I[D+1];return F<0?65536+F:F},m.readUint32=function(I,D){I.data&&(D+=I.start,I=I.data);var F=I[D]<<24|I[D+1]<<16|I[D+2]<<8|I[D+3];return F<0?4294967296+F:F},m.writeUint32=function(I,D,F){I.data&&(D+=I.start,I=I.data),I[D]=F>>24,I[D+1]=F>>16&255,I[D+2]=F>>8&255,I[D+3]=F&255},m.findBox=function(I,D){var F=[],N,U,Y,X,ce,fe,me;if(I.data?(fe=I.start,X=I.end,I=I.data):(fe=0,X=I.byteLength),!D.length)return null;for(N=fe;N<X;)U=m.readUint32(I,N),Y=m.bin2str(I.subarray(N+4,N+8)),me=U>1?N+U:X,Y===D[0]&&(D.length===1?F.push({data:I,start:N+8,end:me}):(ce=m.findBox({data:I,start:N+8,end:me},D.slice(1)),ce.length&&(F=F.concat(ce)))),N=me;return F},m.parseSegmentIndex=function(I){var D=m.findBox(I,["moov"])[0],F=D?D.end:null,N=0,U=m.findBox(I,["sidx"]),Y;if(!U||!U[0])return null;Y=[],U=U[0];var X=U.data[0];N=X===0?8:16;var ce=m.readUint32(U,N);N+=4;var fe=0,me=0;X===0?N+=8:N+=16,N+=2;var we=U.end+me,H=m.readUint16(U,N);N+=2;for(var B=0;B<H;B++){var z=N,Q=m.readUint32(U,z);z+=4;var re=Q&2147483647,le=(Q&2147483648)>>>31;if(le===1){console.warn("SIDX has hierarchical references (not supported)");return}var J=m.readUint32(U,z);z+=4,Y.push({referenceSize:re,subsegmentDuration:J,info:{duration:J/ce,start:we,end:we+re-1}}),we+=re,z+=4,N=z}return{earliestPresentationTime:fe,timescale:ce,version:X,referencesCount:H,references:Y,moovEndOffset:F}},m.parseInitSegment=function(I){var D=[],F=m.findBox(I,["moov","trak"]);return F.forEach(function(N){var U=m.findBox(N,["tkhd"])[0];if(U){var Y=U.data[U.start],X=Y===0?12:20,ce=m.readUint32(U,X),fe=m.findBox(N,["mdia","mdhd"])[0];if(fe){Y=fe.data[fe.start],X=Y===0?12:20;var me=m.readUint32(fe,X),we=m.findBox(N,["mdia","hdlr"])[0];if(we){var H=m.bin2str(we.data.subarray(we.start+8,we.start+12)),B={soun:"audio",vide:"video"}[H];if(B){var z=m.findBox(N,["mdia","minf","stbl","stsd"]);if(z.length){z=z[0];var Q=m.bin2str(z.data.subarray(z.start+12,z.start+16));u.logger.log("MP4Demuxer:"+B+":"+Q+" found")}D[ce]={timescale:me,type:B},D[B]={timescale:me,id:ce}}}}}}),D},m.getStartDTS=function(I,D){var F,N,U;return F=m.findBox(D,["moof","traf"]),N=[].concat.apply([],F.map(function(Y){return m.findBox(Y,["tfhd"]).map(function(X){var ce,fe,me;return ce=m.readUint32(X,4),fe=I[ce].timescale||9e4,me=m.findBox(Y,["tfdt"]).map(function(we){var H,B;return H=we.data[we.start],B=m.readUint32(we,4),H===1&&(B*=Math.pow(2,32),B+=m.readUint32(we,8)),B})[0],me/fe})})),U=Math.min.apply(null,N),isFinite(U)?U:0},m.offsetStartDTS=function(I,D,F){m.findBox(D,["moof","traf"]).map(function(N){return m.findBox(N,["tfhd"]).map(function(U){var Y=m.readUint32(U,4),X=I[Y].timescale||9e4;m.findBox(N,["tfdt"]).map(function(ce){var fe=ce.data[ce.start],me=m.readUint32(ce,4);if(fe===0)m.writeUint32(ce,4,me-F*X);else{me*=Math.pow(2,32),me+=m.readUint32(ce,8),me-=F*X,me=Math.max(me,0);var we=Math.floor(me/(g+1)),H=Math.floor(me%(g+1));m.writeUint32(ce,4,we),m.writeUint32(ce,8,H)}})})})},_.append=function(I,D,F,N){var U=this.initData;U||(this.resetInitSegment(I,this.audioCodec,this.videoCodec,!1),U=this.initData);var Y,X=this.initPTS;if(X===void 0){var ce=m.getStartDTS(U,I);this.initPTS=X=ce-D,this.observer.trigger(h.default.INIT_PTS_FOUND,{initPTS:X})}m.offsetStartDTS(U,I,X),Y=m.getStartDTS(U,I),this.remuxer.remux(U.audio,U.video,null,null,Y,F,N,I)},_.destroy=function(){},m}();i.default=T},"./src/errors.ts":function(t,i,o){o.r(i),o.d(i,"ErrorTypes",function(){return u}),o.d(i,"ErrorDetails",function(){return h});var u;(function(g){g.NETWORK_ERROR="networkError",g.MEDIA_ERROR="mediaError",g.KEY_SYSTEM_ERROR="keySystemError",g.MUX_ERROR="muxError",g.OTHER_ERROR="otherError"})(u||(u={}));var h;(function(g){g.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",g.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",g.KEY_SYSTEM_NO_SESSION="keySystemNoSession",g.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",g.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",g.MANIFEST_LOAD_ERROR="manifestLoadError",g.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",g.MANIFEST_PARSING_ERROR="manifestParsingError",g.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",g.LEVEL_EMPTY_ERROR="levelEmptyError",g.LEVEL_LOAD_ERROR="levelLoadError",g.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",g.LEVEL_SWITCH_ERROR="levelSwitchError",g.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",g.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",g.FRAG_LOAD_ERROR="fragLoadError",g.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",g.FRAG_DECRYPT_ERROR="fragDecryptError",g.FRAG_PARSING_ERROR="fragParsingError",g.REMUX_ALLOC_ERROR="remuxAllocError",g.KEY_LOAD_ERROR="keyLoadError",g.KEY_LOAD_TIMEOUT="keyLoadTimeOut",g.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",g.BUFFER_APPEND_ERROR="bufferAppendError",g.BUFFER_APPENDING_ERROR="bufferAppendingError",g.BUFFER_STALLED_ERROR="bufferStalledError",g.BUFFER_FULL_ERROR="bufferFullError",g.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",g.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",g.INTERNAL_EXCEPTION="internalException"})(h||(h={}))},"./src/events.js":function(t,i,o){o.r(i);var u={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"};i.default=u},"./src/hls.ts":function(t,i,o){o.r(i),o.d(i,"default",function(){return ku});var u={};o.r(u),o.d(u,"newCue",function(){return Hs});var h=o("./node_modules/url-toolkit/src/url-toolkit.js"),g=o("./src/errors.ts"),T=o("./src/polyfills/number.js"),m=o("./src/events.js"),_=o("./src/utils/logger.js"),L={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},I=function(){function R(v){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=v,this.onEvent=this.onEvent.bind(this);for(var d=arguments.length,a=new Array(d>1?d-1:0),f=1;f<d;f++)a[f-1]=arguments[f];this.handledEvents=a,this.useGenericHandler=!0,this.registerListeners()}var x=R.prototype;return x.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},x.onHandlerDestroying=function(){},x.onHandlerDestroyed=function(){},x.isEventHandler=function(){return typeof this.handledEvents=="object"&&this.handledEvents.length&&typeof this.onEvent=="function"},x.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(d){if(L[d])throw new Error("Forbidden event-name: "+d);this.hls.on(d,this.onEvent)},this)},x.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(d){this.hls.off(d,this.onEvent)},this)},x.onEvent=function(d,a){this.onEventGeneric(d,a)},x.onEventGeneric=function(d,a){var f=function(w,C){var P="on"+w.replace("hls","");if(typeof this[P]!="function")throw new Error("Event "+w+" has no generic handler in this "+this.constructor.name+" class (tried "+P+")");return this[P].bind(this,C)};try{f.call(this,d,a).call()}catch(y){_.logger.error("An internal error happened while handling event "+d+'. Error message: "'+y.message+'". Here is a stacktrace:',y),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:d,err:y})}},R}(),D=I,F;(function(R){R.MANIFEST="manifest",R.LEVEL="level",R.AUDIO_TRACK="audioTrack",R.SUBTITLE_TRACK="subtitleTrack"})(F||(F={}));var N;(function(R){R.MAIN="main",R.AUDIO="audio",R.SUBTITLE="subtitle"})(N||(N={}));var U=o("./src/demux/mp4demuxer.js");function Y(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function X(R,x,v){return x&&Y(R.prototype,x),R}var ce=function(){function R(x,v){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=x,this.reluri=v}return X(R,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(h.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),R}();function fe(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function me(R,x,v){return x&&fe(R.prototype,x),R}var we;(function(R){R.AUDIO="audio",R.VIDEO="video"})(we||(we={}));var H=function(){function R(){var v;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=(v={},v[we.AUDIO]=!1,v[we.VIDEO]=!1,v),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var x=R.prototype;return x.setByteRange=function(d,a){var f=d.split("@",2),y=[];f.length===1?y[0]=a?a.byteRangeEndOffset:0:y[0]=parseInt(f[1]),y[1]=parseInt(f[0])+y[0],this._byteRange=y},x.addElementaryStream=function(d){this._elementaryStreams[d]=!0},x.hasElementaryStream=function(d){return this._elementaryStreams[d]===!0},x.createInitializationVector=function(d){for(var a=new Uint8Array(16),f=12;f<16;f++)a[f]=d>>8*(15-f)&255;return a},x.setDecryptDataFromLevelKey=function(d,a){var f=d;return d!=null&&d.method&&d.uri&&!d.iv&&(f=new ce(d.baseuri,d.reluri),f.method=d.method,f.iv=this.createInitializationVector(a)),f},me(R,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(h.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(d){this._url=d}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var d=this.sn;typeof d!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&_.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),d=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,d)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(T.isFiniteNumber)(this.programDateTime))return null;var d=Object(T.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+d*1e3}},{key:"encrypted",get:function(){return!!(this.decryptdata&&this.decryptdata.uri!==null&&this.decryptdata.key===null)}}]),R}();function B(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function z(R,x,v){return x&&B(R.prototype,x),R}var Q=function(){function R(x){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=x,this.version=null}return z(R,[{key:"hasProgramDateTime",get:function(){return!!(this.fragments[0]&&Object(T.isFiniteNumber)(this.fragments[0].programDateTime))}}]),R}(),re=/^(\d+)x(\d+)$/,le=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,J=function(){function R(v){typeof v=="string"&&(v=R.parseAttrList(v));for(var d in v)v.hasOwnProperty(d)&&(this[d]=v[d])}var x=R.prototype;return x.decimalInteger=function(d){var a=parseInt(this[d],10);return a>Number.MAX_SAFE_INTEGER?1/0:a},x.hexadecimalInteger=function(d){if(this[d]){var a=(this[d]||"0x").slice(2);a=(a.length&1?"0":"")+a;for(var f=new Uint8Array(a.length/2),y=0;y<a.length/2;y++)f[y]=parseInt(a.slice(y*2,y*2+2),16);return f}else return null},x.hexadecimalIntegerAsNumber=function(d){var a=parseInt(this[d],16);return a>Number.MAX_SAFE_INTEGER?1/0:a},x.decimalFloatingPoint=function(d){return parseFloat(this[d])},x.enumeratedString=function(d){return this[d]},x.decimalResolution=function(d){var a=re.exec(this[d]);if(a!==null)return{width:parseInt(a[1],10),height:parseInt(a[2],10)}},R.parseAttrList=function(d){var a,f={};for(le.lastIndex=0;(a=le.exec(d))!==null;){var y=a[2],w='"';y.indexOf(w)===0&&y.lastIndexOf(w)===y.length-1&&(y=y.slice(1,-1)),f[a[1]]=y}return f},R}(),pt=J,Jt={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function At(R,x){var v=Jt[x];return!!v&&v[R.slice(0,4)]===!0}function dt(R,x){return MediaSource.isTypeSupported((x||"video")+'/mp4;codecs="'+R+'"')}var Ue=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,Ke=/#EXT-X-MEDIA:(.*)/g,Be=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),se=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,ye=/\.(mp4|m4s|m4v|m4a)$/i,He=function(){function R(){}return R.findGroup=function(v,d){for(var a=0;a<v.length;a++){var f=v[a];if(f.id===d)return f}},R.convertAVC1ToAVCOTI=function(v){var d=v.split("."),a;return d.length>2?(a=d.shift()+".",a+=parseInt(d.shift()).toString(16),a+=("000"+parseInt(d.shift()).toString(16)).substr(-4)):a=v,a},R.resolve=function(v,d){return h.buildAbsoluteURL(d,v,{alwaysNormalize:!0})},R.parseMasterPlaylist=function(v,d){var a=[],f={},y=!1;Ue.lastIndex=0;function w(ie,Ee){["video","audio"].forEach(function(be){var Fe=ie.filter(function(We){return At(We,be)});if(Fe.length){var Xe=Fe.filter(function(We){return We.lastIndexOf("avc1",0)===0||We.lastIndexOf("mp4a",0)===0});Ee[be+"Codec"]=Xe.length>0?Xe[0]:Fe[0],ie=ie.filter(function(We){return Fe.indexOf(We)===-1})}}),Ee.unknownCodecs=ie}for(var C;(C=Ue.exec(v))!=null;)if(C[1]){var P={},M=P.attrs=new pt(C[1]);P.url=R.resolve(C[2],d);var G=M.decimalResolution("RESOLUTION");G&&(P.width=G.width,P.height=G.height),P.bitrate=M.decimalInteger("AVERAGE-BANDWIDTH")||M.decimalInteger("BANDWIDTH"),P.name=M.NAME,w([].concat((M.CODECS||"").split(/[ ,]+/)),P),P.videoCodec&&P.videoCodec.indexOf("avc1")!==-1&&(P.videoCodec=R.convertAVC1ToAVCOTI(P.videoCodec)),a.push(P)}else if(C[3]){var K=new pt(C[3]);K["DATA-ID"]&&(y=!0,f[K["DATA-ID"]]=K)}return{levels:a,sessionData:y?f:null}},R.parseMasterPlaylistMedia=function(v,d,a,f){f===void 0&&(f=[]);var y,w=[],C=0;for(Ke.lastIndex=0;(y=Ke.exec(v))!==null;){var P=new pt(y[1]);if(P.TYPE===a){var M={attrs:P,id:C++,groupId:P["GROUP-ID"],instreamId:P["INSTREAM-ID"],name:P.NAME||P.LANGUAGE,type:a,default:P.DEFAULT==="YES",autoselect:P.AUTOSELECT==="YES",forced:P.FORCED==="YES",lang:P.LANGUAGE};if(P.URI&&(M.url=R.resolve(P.URI,d)),f.length){var G=R.findGroup(f,M.groupId);M.audioCodec=G?G.codec:f[0].codec}w.push(M)}}return w},R.parseLevelPlaylist=function(v,d,a,f,y){var w=0,C=0,P=new Q(d),M=0,G=null,K=new H,ie,Ee,be,Fe=null;for(Be.lastIndex=0;(ie=Be.exec(v))!==null;){var Xe=ie[1];if(Xe){K.duration=parseFloat(Xe);var We=(" "+ie[2]).slice(1);K.title=We||null,K.tagList.push(We?["INF",Xe,We]:["INF",Xe])}else if(ie[3]){if(Object(T.isFiniteNumber)(K.duration)){var ot=w++;K.type=f,K.start=C,be&&(K.levelkey=be),K.sn=ot,K.level=a,K.cc=M,K.urlId=y,K.baseurl=d,K.relurl=(" "+ie[3]).slice(1),mt(K,G),P.fragments.push(K),G=K,C+=K.duration,K=new H}}else if(ie[4]){var ut=(" "+ie[4]).slice(1);G?K.setByteRange(ut,G):K.setByteRange(ut)}else if(ie[5])K.rawProgramDateTime=(" "+ie[5]).slice(1),K.tagList.push(["PROGRAM-DATE-TIME",K.rawProgramDateTime]),Fe===null&&(Fe=P.fragments.length);else{if(ie=ie[0].match(se),!ie){_.logger.warn("No matches on slow regex match for level playlist!");continue}for(Ee=1;Ee<ie.length&&!(typeof ie[Ee]<"u");Ee++);var It=(" "+ie[Ee+1]).slice(1),ur=(" "+ie[Ee+2]).slice(1);switch(ie[Ee]){case"#":K.tagList.push(ur?[It,ur]:[It]);break;case"PLAYLIST-TYPE":P.type=It.toUpperCase();break;case"MEDIA-SEQUENCE":w=P.startSN=parseInt(It);break;case"TARGETDURATION":P.targetduration=parseFloat(It);break;case"VERSION":P.version=parseInt(It);break;case"EXTM3U":break;case"ENDLIST":P.live=!1;break;case"DIS":M++,K.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":M=parseInt(It);break;case"KEY":{var pn=It,Mr=new pt(pn),Vt=Mr.enumeratedString("METHOD"),rt=Mr.URI,Tt=Mr.hexadecimalInteger("IV"),ir=Mr.KEYFORMAT||"identity";if(ir==="com.apple.streamingkeydelivery"){_.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}Vt&&(be=new ce(d,rt),rt&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(Vt)>=0&&(be.method=Vt,be.key=null,be.iv=Tt));break}case"START":{var xs=new pt(It),es=xs.decimalFloatingPoint("TIME-OFFSET");Object(T.isFiniteNumber)(es)&&(P.startTimeOffset=es);break}case"MAP":{var Ci=new pt(It);K.relurl=Ci.URI,Ci.BYTERANGE&&K.setByteRange(Ci.BYTERANGE),K.baseurl=d,K.level=a,K.type=f,K.sn="initSegment",P.initSegment=K,K=new H,K.rawProgramDateTime=P.initSegment.rawProgramDateTime;break}default:_.logger.warn("line parsed but not handled: "+ie);break}}}return K=G,K&&!K.relurl&&(P.fragments.pop(),C-=K.duration),P.totalduration=C,P.averagetargetduration=C/P.fragments.length,P.endSN=w-1,P.startCC=P.fragments[0]?P.fragments[0].cc:0,P.endCC=M,!P.initSegment&&P.fragments.length&&P.fragments.every(function(ws){return ye.test(ws.relurl)})&&(_.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),K=new H,K.relurl=P.fragments[0].relurl,K.baseurl=d,K.level=a,K.type=f,K.sn="initSegment",P.initSegment=K,P.needSidxRanges=!0),Fe&&Ye(P.fragments,Fe),P},R}();function Ye(R,x){for(var v=R[x],d=x-1;d>=0;d--){var a=R[d];a.programDateTime=v.programDateTime-a.duration*1e3,v=a}}function mt(R,x){R.rawProgramDateTime?R.programDateTime=Date.parse(R.rawProgramDateTime):x!=null&&x.programDateTime&&(R.programDateTime=x.endProgramDateTime),Object(T.isFiniteNumber)(R.programDateTime)||(R.programDateTime=null,R.rawProgramDateTime=null)}function wt(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var et=window,vt=et.performance,Rt=function(R){wt(x,R);function x(d){var a;return a=R.call(this,d,m.default.MANIFEST_LOADING,m.default.LEVEL_LOADING,m.default.AUDIO_TRACK_LOADING,m.default.SUBTITLE_TRACK_LOADING)||this,a.loaders={},a}x.canHaveQualityLevels=function(a){return a!==F.AUDIO_TRACK&&a!==F.SUBTITLE_TRACK},x.mapContextToLevelType=function(a){var f=a.type;switch(f){case F.AUDIO_TRACK:return N.AUDIO;case F.SUBTITLE_TRACK:return N.SUBTITLE;default:return N.MAIN}},x.getResponseUrl=function(a,f){var y=a.url;return(y===void 0||y.indexOf("data:")===0)&&(y=f.url),y};var v=x.prototype;return v.createInternalLoader=function(a){var f=this.hls.config,y=f.pLoader,w=f.loader,C=y||w,P=new C(f);return a.loader=P,this.loaders[a.type]=P,P},v.getInternalLoader=function(a){return this.loaders[a.type]},v.resetInternalLoader=function(a){this.loaders[a]&&delete this.loaders[a]},v.destroyInternalLoaders=function(){for(var a in this.loaders){var f=this.loaders[a];f&&f.destroy(),this.resetInternalLoader(a)}},v.destroy=function(){this.destroyInternalLoaders(),R.prototype.destroy.call(this)},v.onManifestLoading=function(a){this.load({url:a.url,type:F.MANIFEST,level:0,id:null,responseType:"text"})},v.onLevelLoading=function(a){this.load({url:a.url,type:F.LEVEL,level:a.level,id:a.id,responseType:"text"})},v.onAudioTrackLoading=function(a){this.load({url:a.url,type:F.AUDIO_TRACK,level:null,id:a.id,responseType:"text"})},v.onSubtitleTrackLoading=function(a){this.load({url:a.url,type:F.SUBTITLE_TRACK,level:null,id:a.id,responseType:"text"})},v.load=function(a){var f=this.hls.config;_.logger.debug("Loading playlist of type "+a.type+", level: "+a.level+", id: "+a.id);var y=this.getInternalLoader(a);if(y){var w=y.context;if(w&&w.url===a.url)return _.logger.trace("playlist request ongoing"),!1;_.logger.warn("aborting previous loader for type: "+a.type),y.abort()}var C,P,M,G;switch(a.type){case F.MANIFEST:C=f.manifestLoadingMaxRetry,P=f.manifestLoadingTimeOut,M=f.manifestLoadingRetryDelay,G=f.manifestLoadingMaxRetryTimeout;break;case F.LEVEL:C=0,G=0,M=0,P=f.levelLoadingTimeOut;break;default:C=f.levelLoadingMaxRetry,P=f.levelLoadingTimeOut,M=f.levelLoadingRetryDelay,G=f.levelLoadingMaxRetryTimeout;break}y=this.createInternalLoader(a);var K={timeout:P,maxRetry:C,retryDelay:M,maxRetryDelay:G},ie={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return _.logger.debug("Calling internal loader delegate for URL: "+a.url),y.load(a,K,ie),!0},v.loadsuccess=function(a,f,y,w){if(w===void 0&&(w=null),y.isSidxRequest){this._handleSidxRequest(a,y),this._handlePlaylistLoaded(a,f,y,w);return}if(this.resetInternalLoader(y.type),typeof a.data!="string")throw new Error('expected responseType of "text" for PlaylistLoader');var C=a.data;if(f.tload=vt.now(),C.indexOf("#EXTM3U")!==0){this._handleManifestParsingError(a,y,"no EXTM3U delimiter",w);return}C.indexOf("#EXTINF:")>0||C.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(a,f,y,w):this._handleMasterPlaylist(a,f,y,w)},v.loaderror=function(a,f,y){y===void 0&&(y=null),this._handleNetworkError(f,y,!1,a)},v.loadtimeout=function(a,f,y){y===void 0&&(y=null),this._handleNetworkError(f,y,!0)},v._handleMasterPlaylist=function(a,f,y,w){var C=this.hls,P=a.data,M=x.getResponseUrl(a,y),G=He.parseMasterPlaylist(P,M),K=G.levels,ie=G.sessionData;if(!K.length){this._handleManifestParsingError(a,y,"no level found in manifest",w);return}var Ee=K.map(function(ot){return{id:ot.attrs.AUDIO,codec:ot.audioCodec}}),be=He.parseMasterPlaylistMedia(P,M,"AUDIO",Ee),Fe=He.parseMasterPlaylistMedia(P,M,"SUBTITLES"),Xe=He.parseMasterPlaylistMedia(P,M,"CLOSED-CAPTIONS");if(be.length){var We=!1;be.forEach(function(ot){ot.url||(We=!0)}),We===!1&&K[0].audioCodec&&!K[0].attrs.AUDIO&&(_.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),be.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}C.trigger(m.default.MANIFEST_LOADED,{levels:K,audioTracks:be,subtitles:Fe,captions:Xe,url:M,stats:f,networkDetails:w,sessionData:ie})},v._handleTrackOrLevelPlaylist=function(a,f,y,w){var C=this.hls,P=y.id,M=y.level,G=y.type,K=x.getResponseUrl(a,y),ie=Object(T.isFiniteNumber)(P)?P:0,Ee=Object(T.isFiniteNumber)(M)?M:ie,be=x.mapContextToLevelType(y),Fe=He.parseLevelPlaylist(a.data,K,Ee,be,ie);if(Fe.tload=f.tload,!Fe.fragments.length){C.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:K,reason:"no fragments found in level",level:typeof y.level=="number"?y.level:void 0});return}if(G===F.MANIFEST){var Xe={url:K,details:Fe};C.trigger(m.default.MANIFEST_LOADED,{levels:[Xe],audioTracks:[],url:K,stats:f,networkDetails:w,sessionData:null})}if(f.tparsed=vt.now(),Fe.needSidxRanges){var We=Fe.initSegment.url;this.load({url:We,isSidxRequest:!0,type:G,level:M,levelDetails:Fe,id:P,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});return}y.levelDetails=Fe,this._handlePlaylistLoaded(a,f,y,w)},v._handleSidxRequest=function(a,f){if(typeof a.data=="string")throw new Error("sidx request must be made with responseType of array buffer");var y=U.default.parseSegmentIndex(new Uint8Array(a.data));if(y){var w=y.references,C=f.levelDetails;w.forEach(function(P,M){var G=P.info;if(C){var K=C.fragments[M];K.byteRange.length===0&&K.setByteRange(String(1+G.end-G.start)+"@"+String(G.start))}}),C&&C.initSegment.setByteRange(String(y.moovEndOffset)+"@0")}},v._handleManifestParsingError=function(a,f,y,w){this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:a.url,reason:y,networkDetails:w})},v._handleNetworkError=function(a,f,y,w){y===void 0&&(y=!1),w===void 0&&(w=null),_.logger.info("A network error occured while loading a "+a.type+"-type playlist");var C,P,M=this.getInternalLoader(a);switch(a.type){case F.MANIFEST:C=y?g.ErrorDetails.MANIFEST_LOAD_TIMEOUT:g.ErrorDetails.MANIFEST_LOAD_ERROR,P=!0;break;case F.LEVEL:C=y?g.ErrorDetails.LEVEL_LOAD_TIMEOUT:g.ErrorDetails.LEVEL_LOAD_ERROR,P=!1;break;case F.AUDIO_TRACK:C=y?g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,P=!1;break;default:P=!1}M&&(M.abort(),this.resetInternalLoader(a.type));var G={type:g.ErrorTypes.NETWORK_ERROR,details:C,fatal:P,url:a.url,loader:M,context:a,networkDetails:f};w&&(G.response=w),this.hls.trigger(m.default.ERROR,G)},v._handlePlaylistLoaded=function(a,f,y,w){var C=y.type,P=y.level,M=y.id,G=y.levelDetails;if(!G||!G.targetduration){this._handleManifestParsingError(a,y,"invalid target duration",w);return}var K=x.canHaveQualityLevels(y.type);if(K)this.hls.trigger(m.default.LEVEL_LOADED,{details:G,level:P||0,id:M||0,stats:f,networkDetails:w});else switch(C){case F.AUDIO_TRACK:this.hls.trigger(m.default.AUDIO_TRACK_LOADED,{details:G,id:M,stats:f,networkDetails:w});break;case F.SUBTITLE_TRACK:this.hls.trigger(m.default.SUBTITLE_TRACK_LOADED,{details:G,id:M,stats:f,networkDetails:w});break}},x}(D),Kt=Rt;function br(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var bn=function(R){br(x,R);function x(d){var a;return a=R.call(this,d,m.default.FRAG_LOADING)||this,a.loaders={},a}var v=x.prototype;return v.destroy=function(){var a=this.loaders;for(var f in a){var y=a[f];y&&y.destroy()}this.loaders={},R.prototype.destroy.call(this)},v.onFragLoading=function(a){var f=a.frag,y=f.type,w=this.loaders,C=this.hls.config,P=C.fLoader,M=C.loader;f.loaded=0;var G=w[y];G&&(_.logger.warn("abort previous fragment loader for type: "+y),G.abort()),G=w[y]=f.loader=C.fLoader?new P(C):new M(C);var K,ie,Ee;K={url:f.url,frag:f,responseType:"arraybuffer",progressData:!1};var be=f.byteRangeStartOffset,Fe=f.byteRangeEndOffset;Object(T.isFiniteNumber)(be)&&Object(T.isFiniteNumber)(Fe)&&(K.rangeStart=be,K.rangeEnd=Fe),ie={timeout:C.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:C.fragLoadingMaxRetryTimeout},Ee={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},G.load(K,ie,Ee)},v.loadsuccess=function(a,f,y,w){w===void 0&&(w=null);var C=a.data,P=y.frag;P.loader=void 0,this.loaders[P.type]=void 0,this.hls.trigger(m.default.FRAG_LOADED,{payload:C,frag:P,stats:f,networkDetails:w})},v.loaderror=function(a,f,y){y===void 0&&(y=null);var w=f.frag,C=w.loader;C&&C.abort(),this.loaders[w.type]=void 0,this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:f.frag,response:a,networkDetails:y})},v.loadtimeout=function(a,f,y){y===void 0&&(y=null);var w=f.frag,C=w.loader;C&&C.abort(),this.loaders[w.type]=void 0,this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:f.frag,networkDetails:y})},v.loadprogress=function(a,f,y,w){w===void 0&&(w=null);var C=f.frag;C.loaded=a.loaded,this.hls.trigger(m.default.FRAG_LOAD_PROGRESS,{frag:C,stats:a,networkDetails:w})},x}(D),or=bn;function tn(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var lr=function(R){tn(x,R);function x(d){var a;return a=R.call(this,d,m.default.KEY_LOADING)||this,a.loaders={},a.decryptkey=null,a.decrypturl=null,a}var v=x.prototype;return v.destroy=function(){for(var a in this.loaders){var f=this.loaders[a];f&&f.destroy()}this.loaders={},R.prototype.destroy.call(this)},v.onKeyLoading=function(a){var f=a.frag,y=f.type,w=this.loaders[y];if(!f.decryptdata){_.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var C=f.decryptdata.uri;if(C!==this.decrypturl||this.decryptkey===null){var P=this.hls.config;if(w&&(_.logger.warn("abort previous key loader for type:"+y),w.abort()),!C){_.logger.warn("key uri is falsy");return}f.loader=this.loaders[y]=new P.loader(P),this.decrypturl=C,this.decryptkey=null;var M={url:C,frag:f,responseType:"arraybuffer"},G={timeout:P.fragLoadingTimeOut,maxRetry:0,retryDelay:P.fragLoadingRetryDelay,maxRetryDelay:P.fragLoadingMaxRetryTimeout},K={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};f.loader.load(M,G,K)}else this.decryptkey&&(f.decryptdata.key=this.decryptkey,this.hls.trigger(m.default.KEY_LOADED,{frag:f}))},v.loadsuccess=function(a,f,y){var w=y.frag;if(!w.decryptdata){_.logger.error("after key load, decryptdata unset");return}this.decryptkey=w.decryptdata.key=new Uint8Array(a.data),w.loader=void 0,delete this.loaders[w.type],this.hls.trigger(m.default.KEY_LOADED,{frag:w})},v.loaderror=function(a,f){var y=f.frag,w=y.loader;w&&w.abort(),delete this.loaders[y.type],this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:y,response:a})},v.loadtimeout=function(a,f){var y=f.frag,w=y.loader;w&&w.abort(),delete this.loaders[y.type],this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:y})},x}(D),Gn=lr;function kr(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var dr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},Vi=function(R){kr(x,R);function x(d){var a;return a=R.call(this,d,m.default.BUFFER_APPENDED,m.default.FRAG_BUFFERED,m.default.FRAG_LOADED)||this,a.bufferPadding=.2,a.fragments=Object.create(null),a.timeRanges=Object.create(null),a.config=d.config,a}var v=x.prototype;return v.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,D.prototype.destroy.call(this),R.prototype.destroy.call(this)},v.getBufferedFrag=function(a,f){var y=this.fragments,w=Object.keys(y).filter(function(P){var M=y[P];if(M.body.type!==f||!M.buffered)return!1;var G=M.body;return G.startPTS<=a&&a<=G.endPTS});if(w.length===0)return null;var C=w.pop();return y[C].body},v.detectEvictedFragments=function(a,f){var y=this;Object.keys(this.fragments).forEach(function(w){var C=y.fragments[w];if(!(!C||!C.buffered)){var P=C.range[a];if(P)for(var M=P.time,G=0;G<M.length;G++){var K=M[G];if(!y.isTimeBuffered(K.startPTS,K.endPTS,f)){y.removeFragment(C.body);break}}}})},v.detectPartialFragments=function(a){var f=this,y=this.getFragmentKey(a),w=this.fragments[y];w&&(w.buffered=!0,Object.keys(this.timeRanges).forEach(function(C){if(a.hasElementaryStream(C)){var P=f.timeRanges[C];w.range[C]=f.getBufferedTimes(a.startPTS,a.endPTS,P)}}))},v.getBufferedTimes=function(a,f,y){for(var w=[],C,P,M=!1,G=0;G<y.length;G++)if(C=y.start(G)-this.bufferPadding,P=y.end(G)+this.bufferPadding,a>=C&&f<=P){w.push({startPTS:Math.max(a,y.start(G)),endPTS:Math.min(f,y.end(G))});break}else if(a<P&&f>C)w.push({startPTS:Math.max(a,y.start(G)),endPTS:Math.min(f,y.end(G))}),M=!0;else if(f<=C)break;return{time:w,partial:M}},v.getFragmentKey=function(a){return a.type+"_"+a.level+"_"+a.urlId+"_"+a.sn},v.getPartialFragment=function(a){var f=this,y,w,C,P=null,M=0;return Object.keys(this.fragments).forEach(function(G){var K=f.fragments[G];f.isPartial(K)&&(w=K.body.startPTS-f.bufferPadding,C=K.body.endPTS+f.bufferPadding,a>=w&&a<=C&&(y=Math.min(a-w,C-a),M<=y&&(P=K.body,M=y)))}),P},v.getState=function(a){var f=this.getFragmentKey(a),y=this.fragments[f],w=dr.NOT_LOADED;return y!==void 0&&(y.buffered?this.isPartial(y)===!0?w=dr.PARTIAL:w=dr.OK:w=dr.APPENDING),w},v.isPartial=function(a){return a.buffered===!0&&(a.range.video!==void 0&&a.range.video.partial===!0||a.range.audio!==void 0&&a.range.audio.partial===!0)},v.isTimeBuffered=function(a,f,y){for(var w,C,P=0;P<y.length;P++){if(w=y.start(P)-this.bufferPadding,C=y.end(P)+this.bufferPadding,a>=w&&f<=C)return!0;if(f<=w)return!1}return!1},v.onFragLoaded=function(a){var f=a.frag;!Object(T.isFiniteNumber)(f.sn)||f.bitrateTest||(this.fragments[this.getFragmentKey(f)]={body:f,range:Object.create(null),buffered:!1})},v.onBufferAppended=function(a){var f=this;this.timeRanges=a.timeRanges,Object.keys(this.timeRanges).forEach(function(y){var w=f.timeRanges[y];f.detectEvictedFragments(y,w)})},v.onFragBuffered=function(a){this.detectPartialFragments(a.frag)},v.hasFragment=function(a){var f=this.getFragmentKey(a);return this.fragments[f]!==void 0},v.removeFragment=function(a){var f=this.getFragmentKey(a);delete this.fragments[f]},v.removeAllFragments=function(){this.fragments=Object.create(null)},x}(D),q={search:function(x,v){for(var d=0,a=x.length-1,f=null,y=null;d<=a;){f=(d+a)/2|0,y=x[f];var w=v(y);if(w>0)d=f+1;else if(w<0)a=f-1;else return y}return null}},ue=q,W=function(){function R(){}return R.isBuffered=function(v,d){try{if(v){for(var a=v.buffered,f=0;f<a.length;f++)if(d>=a.start(f)&&d<=a.end(f))return!0}}catch{}return!1},R.bufferInfo=function(v,d,a){try{if(v){var f=v.buffered,y=[],w;for(w=0;w<f.length;w++)y.push({start:f.start(w),end:f.end(w)});return this.bufferedInfo(y,d,a)}}catch{}return{len:0,start:d,end:d,nextStart:void 0}},R.bufferedInfo=function(v,d,a){v.sort(function(Fe,Xe){var We=Fe.start-Xe.start;return We||Xe.end-Fe.end});var f=[];if(a)for(var y=0;y<v.length;y++){var w=f.length;if(w){var C=f[w-1].end;v[y].start-C<a?v[y].end>C&&(f[w-1].end=v[y].end):f.push(v[y])}else f.push(v[y])}else f=v;for(var P=0,M,G=d,K=d,ie=0;ie<f.length;ie++){var Ee=f[ie].start,be=f[ie].end;if(d+a>=Ee&&d<be)G=Ee,K=be,P=K-d;else if(d+a<Ee){M=Ee;break}}return{len:P,start:G,end:K,nextStart:M}},R}(),k=o("./node_modules/eventemitter3/index.js"),j=o("./node_modules/webworkify-webpack/index.js"),$=o("./src/demux/demuxer-inline.js");function ee(){return window.MediaSource||window.WebKitMediaSource}var te=o("./src/utils/get-self-scope.js");function ae(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var _e=function(R){ae(x,R);function x(){return R.apply(this,arguments)||this}var v=x.prototype;return v.trigger=function(a){for(var f=arguments.length,y=new Array(f>1?f-1:0),w=1;w<f;w++)y[w-1]=arguments[w];this.emit.apply(this,[a,a].concat(y))},x}(k.EventEmitter),Ie=Object(te.getSelfScope)(),Ce=ee()||{isTypeSupported:function(){return!1}},Re=function(){function R(v,d){var a=this;this.hls=v,this.id=d;var f=this.observer=new _e,y=v.config,w=function(K,ie){ie=ie||{},ie.frag=a.frag,ie.id=a.id,v.trigger(K,ie)};f.on(m.default.FRAG_DECRYPTED,w),f.on(m.default.FRAG_PARSING_INIT_SEGMENT,w),f.on(m.default.FRAG_PARSING_DATA,w),f.on(m.default.FRAG_PARSED,w),f.on(m.default.ERROR,w),f.on(m.default.FRAG_PARSING_METADATA,w),f.on(m.default.FRAG_PARSING_USERDATA,w),f.on(m.default.INIT_PTS_FOUND,w);var C={mp4:Ce.isTypeSupported("video/mp4"),mpeg:Ce.isTypeSupported("audio/mpeg"),mp3:Ce.isTypeSupported('audio/mp4; codecs="mp3"')},P=navigator.vendor;if(y.enableWorker&&typeof Worker<"u"){_.logger.log("demuxing in webworker");var M;try{M=this.w=j("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),M.addEventListener("message",this.onwmsg),M.onerror=function(G){v.trigger(m.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:G.message+" ("+G.filename+":"+G.lineno+")"}})},M.postMessage({cmd:"init",typeSupported:C,vendor:P,id:d,config:JSON.stringify(y)})}catch(G){_.logger.warn("Error in worker:",G),_.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),M&&Ie.URL.revokeObjectURL(M.objectURL),this.demuxer=new $.default(f,C,y,P),this.w=void 0}}else this.demuxer=new $.default(f,C,y,P)}var x=R.prototype;return x.destroy=function(){var d=this.w;if(d)d.removeEventListener("message",this.onwmsg),d.terminate(),this.w=null;else{var a=this.demuxer;a&&(a.destroy(),this.demuxer=null)}var f=this.observer;f&&(f.removeAllListeners(),this.observer=null)},x.push=function(d,a,f,y,w,C,P,M){var G=this.w,K=Object(T.isFiniteNumber)(w.startPTS)?w.startPTS:w.start,ie=w.decryptdata,Ee=this.frag,be=!(Ee&&w.cc===Ee.cc),Fe=!(Ee&&w.level===Ee.level),Xe=Ee&&w.sn===Ee.sn+1,We=!Fe&&Xe;if(be&&_.logger.log(this.id+":discontinuity detected"),Fe&&_.logger.log(this.id+":switch detected"),this.frag=w,G)G.postMessage({cmd:"demux",data:d,decryptdata:ie,initSegment:a,audioCodec:f,videoCodec:y,timeOffset:K,discontinuity:be,trackSwitch:Fe,contiguous:We,duration:C,accurateTimeOffset:P,defaultInitPTS:M},d instanceof ArrayBuffer?[d]:[]);else{var ot=this.demuxer;ot&&ot.push(d,ie,a,f,y,K,be,Fe,We,C,P,M)}},x.onWorkerMessage=function(d){var a=d.data,f=this.hls;switch(a.event){case"init":Ie.URL.revokeObjectURL(this.w.objectURL);break;case m.default.FRAG_PARSING_DATA:a.data.data1=new Uint8Array(a.data1),a.data2&&(a.data.data2=new Uint8Array(a.data2));default:a.data=a.data||{},a.data.frag=this.frag,a.data.id=this.id,f.trigger(a.event,a.data);break}},R}(),Ne=Re;function ke(R,x,v){switch(x){case"audio":R.audioGroupIds||(R.audioGroupIds=[]),R.audioGroupIds.push(v);break;case"text":R.textGroupIds||(R.textGroupIds=[]),R.textGroupIds.push(v);break}}function ze(R,x,v){var d=R[x],a=R[v],f=a.startPTS;if(Object(T.isFiniteNumber)(f))v>x?(d.duration=f-d.start,d.duration<0&&_.logger.warn("negative duration computed for frag "+d.sn+",level "+d.level+", there should be some duration drift between playlist and fragment!")):(a.duration=d.start-f,a.duration<0&&_.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!"));else if(v>x){var y=d.cc===a.cc;a.start=d.start+(y&&d.minEndPTS?d.minEndPTS-d.start:d.duration)}else a.start=Math.max(d.start-a.duration,0)}function De(R,x,v,d,a,f){var y=v,w=d;if(Object(T.isFiniteNumber)(x.startPTS)){var C=Math.abs(x.startPTS-v);Object(T.isFiniteNumber)(x.deltaPTS)?x.deltaPTS=Math.max(C,x.deltaPTS):x.deltaPTS=C,y=Math.max(v,x.startPTS),v=Math.min(v,x.startPTS),w=Math.min(d,x.endPTS),d=Math.max(d,x.endPTS),a=Math.min(a,x.startDTS),f=Math.max(f,x.endDTS)}var P=v-x.start;x.start=x.startPTS=v,x.maxStartPTS=y,x.endPTS=d,x.minEndPTS=w,x.startDTS=a,x.endDTS=f,x.duration=d-v;var M=x.sn;if(!R||M<R.startSN||M>R.endSN)return 0;var G,K,ie;for(G=M-R.startSN,K=R.fragments,K[G]=x,ie=G;ie>0;ie--)ze(K,ie,ie-1);for(ie=G;ie<K.length-1;ie++)ze(K,ie,ie+1);return R.PTSKnown=!0,P}function Qe(R,x){x.initSegment&&R.initSegment&&(x.initSegment=R.initSegment);var v=0,d;if(lt(R,x,function(y,w){v=y.cc-w.cc,Object(T.isFiniteNumber)(y.startPTS)&&(w.start=w.startPTS=y.startPTS,w.endPTS=y.endPTS,w.duration=y.duration,w.backtracked=y.backtracked,w.dropped=y.dropped,d=w),x.PTSKnown=!0}),!!x.PTSKnown){if(v){_.logger.log("discontinuity sliding from playlist, take drift into account");for(var a=x.fragments,f=0;f<a.length;f++)a[f].cc+=v}d?De(x,d,d.startPTS,d.endPTS,d.startDTS,d.endDTS):bt(R,x),x.PTSKnown=R.PTSKnown}}function $e(R,x,v){v===void 0&&(v=0);var d=-1;lt(R,x,function(y,w,C){w.start=y.start,d=C});var a=x.fragments;if(d<0){a.forEach(function(y){y.start+=v});return}for(var f=d+1;f<a.length;f++)a[f].start=a[f-1].start+a[f-1].duration}function lt(R,x,v){if(!(!R||!x))for(var d=Math.max(R.startSN,x.startSN)-x.startSN,a=Math.min(R.endSN,x.endSN)-x.startSN,f=x.startSN-R.startSN,y=d;y<=a;y++){var w=R.fragments[f+y],C=x.fragments[y];if(!w||!C)break;v(w,C,y)}}function bt(R,x){var v=x.startSN-R.startSN,d=R.fragments,a=x.fragments;if(!(v<0||v>d.length))for(var f=0;f<a.length;f++)a[f].start+=d[v].start}function st(R,x,v){var d=1e3*(x.averagetargetduration?x.averagetargetduration:x.targetduration),a=d/2;return R&&x.endSN===R.endSN&&(d=a),v&&(d=Math.max(a,d-(window.performance.now()-v))),Math.round(d)}var Nt={toString:function(x){for(var v="",d=x.length,a=0;a<d;a++)v+="["+x.start(a).toFixed(3)+","+x.end(a).toFixed(3)+"]";return v}},Pt=Nt;function gt(R,x){for(var v=null,d=0;d<R.length;d+=1){var a=R[d];if(a&&a.cc===x){v=a;break}}return v}function kt(R,x){return ue.search(R,function(v){return v.cc<x?1:v.cc>x?-1:0})}function Ft(R,x,v){var d=!1;return x&&x.details&&v&&(v.endCC>v.startCC||R&&R.cc<v.startCC)&&(d=!0),d}function pr(R,x){var v=R.fragments,d=x.fragments;if(!d.length||!v.length){_.logger.log("No fragments to align");return}var a=gt(v,d[0].cc);if(!a||a&&!a.startPTS){_.logger.log("No frag in previous level to align on");return}return a}function Zt(R,x){x.fragments.forEach(function(v){if(v){var d=v.start+R;v.start=v.startPTS=d,v.endPTS=d+v.duration}}),x.PTSKnown=!0}function qt(R,x,v){Dt(R,v,x),!v.PTSKnown&&x&&nr(v,x.details)}function Dt(R,x,v){if(Ft(R,v,x)){var d=pr(v.details,x);d&&(_.logger.log("Adjusting PTS using last level due to CC increase within current level"),Zt(d.start,x))}}function nr(R,x){if(x&&x.fragments.length){if(!R.hasProgramDateTime||!x.hasProgramDateTime)return;var v=x.fragments[0].programDateTime,d=R.fragments[0].programDateTime,a=(d-v)/1e3+x.fragments[0].start;Object(T.isFiniteNumber)(a)&&(_.logger.log("adjusting PTS using programDateTime delta, sliding:"+a.toFixed(3)),Zt(a,R))}}function rr(R,x,v){if(x===null||!Array.isArray(R)||!R.length||!Object(T.isFiniteNumber)(x))return null;var d=R[0].programDateTime;if(x<(d||0))return null;var a=R[R.length-1].endProgramDateTime;if(x>=(a||0))return null;v=v||0;for(var f=0;f<R.length;++f){var y=R[f];if(Yr(x,v,y))return y}return null}function tr(R,x,v,d){v===void 0&&(v=0),d===void 0&&(d=0);var a=null;if(R?a=x[R.sn-x[0].sn+1]:v===0&&x[0].start===0&&(a=x[0]),a&&Ht(v,d,a)===0)return a;var f=ue.search(x,Ht.bind(null,v,d));return f||a}function Ht(R,x,v){R===void 0&&(R=0),x===void 0&&(x=0);var d=Math.min(x,v.duration+(v.deltaPTS?v.deltaPTS:0));return v.start+v.duration-d<=R?1:v.start-d>R&&v.start?-1:0}function Yr(R,x,v){var d=Math.min(x,v.duration+(v.deltaPTS?v.deltaPTS:0))*1e3,a=v.endProgramDateTime||0;return a-d>R}var gr=250,Dr=2,Ar=.1,jr=.05,cn=function(){function R(v,d,a,f){this.config=v,this.media=d,this.fragmentTracker=a,this.hls=f,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var x=R.prototype;return x.poll=function(d){var a=this.config,f=this.media,y=this.stalled,w=f.currentTime,C=f.seeking,P=this.seeking&&!C,M=!this.seeking&&C;if(this.seeking=C,w!==d){if(this.moved=!0,y!==null){if(this.stallReported){var G=self.performance.now()-y;_.logger.warn("playback not stuck anymore @"+w+", after "+Math.round(G)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((M||P)&&(this.stalled=null),!(f.paused||f.ended||f.playbackRate===0||!f.buffered.length)){var K=W.bufferInfo(f,w,0),ie=K.len>0,Ee=K.nextStart||0;if(!(!ie&&!Ee)){if(C){var be=K.len>Dr,Fe=!Ee||Ee-w>Dr&&!this.fragmentTracker.getPartialFragment(w);if(be||Fe)return;this.moved=!1}if(!this.moved&&this.stalled){var Xe=Math.max(Ee,K.start||0)-w;if(Xe>0&&Xe<=Dr){this._trySkipBufferHole(null);return}}var We=self.performance.now();if(y===null){this.stalled=We;return}var ot=We-y;!C&&ot>=gr&&this._reportStall(K.len);var ut=W.bufferInfo(f,w,a.maxBufferHole);this._tryFixBufferStall(ut,ot)}}},x._tryFixBufferStall=function(d,a){var f=this.config,y=this.fragmentTracker,w=this.media,C=w.currentTime,P=y.getPartialFragment(C);if(P){var M=this._trySkipBufferHole(P);if(M)return}d.len>f.maxBufferHole&&a>f.highBufferWatchdogPeriod*1e3&&(_.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},x._reportStall=function(d){var a=this.hls,f=this.media,y=this.stallReported;y||(this.stallReported=!0,_.logger.warn("Playback stalling at @"+f.currentTime+" due to low buffer (buffer="+d+")"),a.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:d}))},x._trySkipBufferHole=function(d){for(var a=this.config,f=this.hls,y=this.media,w=y.currentTime,C=0,P=0;P<y.buffered.length;P++){var M=y.buffered.start(P);if(w+a.maxBufferHole>=C&&w<M){var G=Math.max(M+jr,y.currentTime+Ar);return _.logger.warn("skipping hole, adjusting currentTime from "+w+" to "+G),this.moved=!0,this.stalled=null,y.currentTime=G,d&&f.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+w+" to "+G,frag:d}),G}C=y.buffered.end(P)}return 0},x._tryNudgeBuffer=function(){var d=this.config,a=this.hls,f=this.media,y=f.currentTime,w=(this.nudgeRetry||0)+1;if(this.nudgeRetry=w,w<d.nudgeMaxRetry){var C=y+w*d.nudgeOffset;_.logger.warn("Nudging 'currentTime' from "+y+" to "+C),f.currentTime=C,a.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else _.logger.error("Playhead still not moving while enough data buffered @"+y+" after "+d.nudgeMaxRetry+" nudges"),a.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},R}();function _r(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function wn(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var Er=function(R){wn(x,R);function x(d){for(var a,f=arguments.length,y=new Array(f>1?f-1:0),w=1;w<f;w++)y[w-1]=arguments[w];return a=R.call.apply(R,[this,d].concat(y))||this,a._boundTick=void 0,a._tickTimer=null,a._tickInterval=null,a._tickCallCount=0,a._boundTick=a.tick.bind(_r(a)),a}var v=x.prototype;return v.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},v.hasInterval=function(){return!!this._tickInterval},v.hasNextTick=function(){return!!this._tickTimer},v.setInterval=function(a){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,a),!0)},v.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},v.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},v.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},v.doTick=function(){},x}(D);function oi(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var Se={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},Tr=function(R){oi(x,R);function x(){return R.apply(this,arguments)||this}var v=x.prototype;return v.doTick=function(){},v.startLoad=function(){},v.stopLoad=function(){var a=this.fragCurrent;a&&(a.loader&&a.loader.abort(),this.fragmentTracker.removeFragment(a)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Se.STOPPED},v._streamEnded=function(a,f){var y=this.fragCurrent,w=this.fragmentTracker;if(!f.live&&y&&!y.backtracked&&y.sn===f.endSN&&!a.nextStart){var C=w.getState(y);return C===dr.PARTIAL||C===dr.OK}return!1},v.onMediaSeeking=function(){var a=this.config,f=this.media,y=this.mediaBuffer,w=this.state,C=f?f.currentTime:null,P=W.bufferInfo(y||f,C,this.config.maxBufferHole);if(_.logger.log("media seeking to "+(Object(T.isFiniteNumber)(C)?C.toFixed(3):C)),w===Se.FRAG_LOADING){var M=this.fragCurrent;if(P.len===0&&M){var G=a.maxFragLookUpTolerance,K=M.start-G,ie=M.start+M.duration+G;C<K||C>ie?(M.loader&&(_.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),M.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=Se.IDLE):_.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else w===Se.ENDED&&(P.len===0&&(this.fragPrevious=null,this.fragCurrent=null),this.state=Se.IDLE);f&&(this.lastCurrentTime=C),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=C),this.tick()},v.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},v.onHandlerDestroying=function(){this.stopLoad(),R.prototype.onHandlerDestroying.call(this)},v.onHandlerDestroyed=function(){this.state=Se.STOPPED,this.fragmentTracker=null},v.computeLivePosition=function(a,f){var y=this.config.liveSyncDuration!==void 0?this.config.liveSyncDuration:this.config.liveSyncDurationCount*f.targetduration;return a+Math.max(0,f.totalduration-y)},x}(Er);function kn(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function Kn(R,x,v){return x&&kn(R.prototype,x),R}function fn(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var hs=100,Yt=function(R){fn(x,R);function x(d,a){var f;return f=R.call(this,d,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.MANIFEST_LOADING,m.default.MANIFEST_PARSED,m.default.LEVEL_LOADED,m.default.LEVELS_UPDATED,m.default.KEY_LOADED,m.default.FRAG_LOADED,m.default.FRAG_LOAD_EMERGENCY_ABORTED,m.default.FRAG_PARSING_INIT_SEGMENT,m.default.FRAG_PARSING_DATA,m.default.FRAG_PARSED,m.default.ERROR,m.default.AUDIO_TRACK_SWITCHING,m.default.AUDIO_TRACK_SWITCHED,m.default.BUFFER_CREATED,m.default.BUFFER_APPENDED,m.default.BUFFER_FLUSHED)||this,f.fragmentTracker=a,f.config=d.config,f.audioCodecSwap=!1,f._state=Se.STOPPED,f.stallReported=!1,f.gapController=null,f.altAudio=!1,f.audioOnly=!1,f.bitrateTest=!1,f}var v=x.prototype;return v.startLoad=function(a){if(this.levels){var f=this.lastCurrentTime,y=this.hls;if(this.stopLoad(),this.setInterval(hs),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var w=y.startLevel;w===-1&&(y.config.testBandwidth?(w=0,this.bitrateTest=!0):w=y.nextAutoLevel),this.level=y.nextLoadLevel=w,this.loadedmetadata=!1}f>0&&a===-1&&(_.logger.log("override startPosition with lastCurrentTime @"+f.toFixed(3)),a=f),this.state=Se.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a,this.tick()}else this.forceStartLoad=!0,this.state=Se.STOPPED},v.stopLoad=function(){this.forceStartLoad=!1,R.prototype.stopLoad.call(this)},v.doTick=function(){switch(this.state){case Se.BUFFER_FLUSHING:this.fragLoadError=0;break;case Se.IDLE:this._doTickIdle();break;case Se.WAITING_LEVEL:var a=this.levels[this.level];a&&a.details&&(this.state=Se.IDLE);break;case Se.FRAG_LOADING_WAITING_RETRY:var f=window.performance.now(),y=this.retryDate;(!y||f>=y||this.media&&this.media.seeking)&&(_.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=Se.IDLE);break}this._checkBuffer(),this._checkFragmentChanged()},v._doTickIdle=function(){var a=this.hls,f=a.config,y=this.media;if(!(this.levelLastLoaded===void 0||!y&&(this.startFragRequested||!f.startFragPrefetch))){if(this.altAudio&&this.audioOnly){this.demuxer.frag=null;return}var w;this.loadedmetadata?w=y.currentTime:w=this.nextLoadPosition;var C=a.nextLoadLevel,P=this.levels[C];if(P){var M=P.bitrate,G;M?G=Math.max(8*f.maxBufferSize/M,f.maxBufferLength):G=f.maxBufferLength,G=Math.min(G,f.maxMaxBufferLength);var K=w<f.maxBufferHole?Math.max(Dr,f.maxBufferHole):f.maxBufferHole,ie=W.bufferInfo(this.mediaBuffer?this.mediaBuffer:y,w,K),Ee=ie.len;if(!(Ee>=G)){_.logger.trace("buffer length of "+Ee.toFixed(3)+" is below max of "+G.toFixed(3)+". checking for more payload ..."),this.level=a.nextLoadLevel=C;var be=P.details;if(!be||be.live&&this.levelLastLoaded!==C){this.state=Se.WAITING_LEVEL;return}if(this._streamEnded(ie,be)){var Fe={};this.altAudio&&(Fe.type="video"),this.hls.trigger(m.default.BUFFER_EOS,Fe),this.state=Se.ENDED;return}this._fetchPayloadOrEos(w,ie,be)}}}},v._fetchPayloadOrEos=function(a,f,y){var w=this.fragPrevious;this.level;var C=y.fragments,P=C.length;if(P!==0){var M=C[0].start,G=C[P-1].start+C[P-1].duration,K=f.end,ie;if(y.initSegment&&!y.initSegment.data)ie=y.initSegment;else if(y.live){var Ee=this.config.initialLiveManifestSize;if(P<Ee){_.logger.warn("Can not start playback of a level, reason: not enough fragments "+P+" < "+Ee);return}if(ie=this._ensureFragmentAtLivePoint(y,K,M,G,w,C),ie===null)return}else K<M&&(ie=C[0]);ie||(ie=this._findFragment(M,w,P,C,K,G,y)),ie&&(ie.encrypted?this._loadKey(ie,y):this._loadFragment(ie,y,a,K))}},v._ensureFragmentAtLivePoint=function(a,f,y,w,C,P){var M=this.hls.config,G=this.media,K,ie=1/0;if(M.liveMaxLatencyDuration!==void 0?ie=M.liveMaxLatencyDuration:Object(T.isFiniteNumber)(M.liveMaxLatencyDurationCount)&&(ie=M.liveMaxLatencyDurationCount*a.targetduration),f<Math.max(y-M.maxFragLookUpTolerance,w-ie)){var Ee=this.liveSyncPosition=this.computeLivePosition(y,a);f=Ee,G&&!G.paused&&G.readyState&&G.duration>Ee&&Ee>G.currentTime&&(_.logger.log("buffer end: "+f.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+Ee.toFixed(3)),G.currentTime=Ee),this.nextLoadPosition=Ee}if(a.PTSKnown&&f>w&&G&&G.readyState)return null;if(this.startFragRequested&&!a.PTSKnown&&C)if(a.hasProgramDateTime)_.logger.log("live playlist, switching playlist, load frag with same PDT: "+C.programDateTime),K=rr(P,C.endProgramDateTime,M.maxFragLookUpTolerance);else{var be=C.sn+1;if(be>=a.startSN&&be<=a.endSN){var Fe=P[be-a.startSN];C.cc===Fe.cc&&(K=Fe,_.logger.log("live playlist, switching playlist, load frag with next SN: "+K.sn))}K||(K=ue.search(P,function(Xe){return C.cc-Xe.cc}),K&&_.logger.log("live playlist, switching playlist, load frag with same CC: "+K.sn))}return K},v._findFragment=function(a,f,y,w,C,P,M){var G=this.hls.config,K;if(C<P){var ie=C>P-G.maxFragLookUpTolerance?0:G.maxFragLookUpTolerance;K=tr(f,w,C,ie)}else K=w[y-1];if(K){var Ee=K.sn-M.startSN,be=f&&K.level===f.level,Fe=w[Ee-1],Xe=w[Ee+1];if(f&&K.sn===f.sn)if(be&&!K.backtracked)if(K.sn<M.endSN){var We=f.deltaPTS;We&&We>G.maxBufferHole&&f.dropped&&Ee?(K=Fe,_.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(K=Xe,this.fragmentTracker.getState(K)!==dr.OK&&_.logger.log("Re-loading fragment with SN: "+K.sn))}else K=null;else K.backtracked&&(Xe&&Xe.backtracked?(_.logger.warn("Already backtracked from fragment "+Xe.sn+", will not backtrack to fragment "+K.sn+". Loading fragment "+Xe.sn),K=Xe):(_.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),K.dropped=0,Fe?(K=Fe,K.backtracked=!0):Ee&&(K=null)))}return K},v._loadKey=function(a,f){_.logger.log("Loading key for "+a.sn+" of ["+f.startSN+"-"+f.endSN+"], level "+this.level),this.state=Se.KEY_LOADING,this.hls.trigger(m.default.KEY_LOADING,{frag:a})},v._loadFragment=function(a,f,y,w){var C=this.fragmentTracker.getState(a);this.fragCurrent=a,a.sn!=="initSegment"&&(this.startFragRequested=!0),Object(T.isFiniteNumber)(a.sn)&&!a.bitrateTest&&(this.nextLoadPosition=a.start+a.duration),a.backtracked||C===dr.NOT_LOADED||C===dr.PARTIAL?(a.autoLevel=this.hls.autoLevelEnabled,a.bitrateTest=this.bitrateTest,_.logger.log("Loading "+a.sn+" of ["+f.startSN+"-"+f.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(y.toFixed(3))+", bufferEnd: "+parseFloat(w.toFixed(3))),this.hls.trigger(m.default.FRAG_LOADING,{frag:a}),this.demuxer||(this.demuxer=new Ne(this.hls,"main")),this.state=Se.FRAG_LOADING):C===dr.APPENDING&&this._reduceMaxBufferLength(a.duration)&&this.fragmentTracker.removeFragment(a)},v.getBufferedFrag=function(a){return this.fragmentTracker.getBufferedFrag(a,N.MAIN)},v.followingBufferedFrag=function(a){return a?this.getBufferedFrag(a.endPTS+.5):null},v._checkFragmentChanged=function(){var a,f,y=this.media;if(y&&y.readyState&&y.seeking===!1&&(f=y.currentTime,f>this.lastCurrentTime&&(this.lastCurrentTime=f),W.isBuffered(y,f)?a=this.getBufferedFrag(f):W.isBuffered(y,f+.1)&&(a=this.getBufferedFrag(f+.1)),a)){var w=a;if(w!==this.fragPlaying){this.hls.trigger(m.default.FRAG_CHANGED,{frag:w});var C=w.level;(!this.fragPlaying||this.fragPlaying.level!==C)&&this.hls.trigger(m.default.LEVEL_SWITCHED,{level:C}),this.fragPlaying=w}}},v.immediateLevelSwitch=function(){if(_.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var a=this.media,f;a?(f=a.paused,f||a.pause()):f=!0,this.previouslyPaused=f}var y=this.fragCurrent;y&&y.loader&&y.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},v.immediateLevelSwitchEnd=function(){var a=this.media;a&&a.buffered.length&&(this.immediateSwitch=!1,a.currentTime>0&&W.isBuffered(a,a.currentTime)&&(a.currentTime-=1e-4),this.previouslyPaused||a.play())},v.nextLevelSwitch=function(){var a=this.media;if(a&&a.readyState){var f,y=this.getBufferedFrag(a.currentTime);if(y&&y.startPTS>1&&this.flushMainBuffer(0,y.startPTS-1),a.paused)f=0;else{var w=this.hls.nextLoadLevel,C=this.levels[w],P=this.fragLastKbps;P&&this.fragCurrent?f=this.fragCurrent.duration*C.bitrate/(1e3*P)+1:f=0}var M=this.getBufferedFrag(a.currentTime+f);if(M){var G=this.followingBufferedFrag(M);if(G){var K=this.fragCurrent;K&&K.loader&&K.loader.abort(),this.fragCurrent=null;var ie=Math.max(M.endPTS,G.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,G.duration));this.flushMainBuffer(ie,Number.POSITIVE_INFINITY)}}}},v.flushMainBuffer=function(a,f){this.state=Se.BUFFER_FLUSHING;var y={startOffset:a,endOffset:f};this.altAudio&&(y.type="video"),this.hls.trigger(m.default.BUFFER_FLUSHING,y)},v.onMediaAttached=function(a){var f=this.media=this.mediaBuffer=a.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),f.addEventListener("seeking",this.onvseeking),f.addEventListener("seeked",this.onvseeked),f.addEventListener("ended",this.onvended);var y=this.config;this.levels&&y.autoStartLoad&&this.hls.startLoad(y.startPosition),this.gapController=new cn(y,f,this.fragmentTracker,this.hls)},v.onMediaDetaching=function(){var a=this.media;a&&a.ended&&(_.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var f=this.levels;f&&f.forEach(function(y){y.details&&y.details.fragments.forEach(function(w){w.backtracked=void 0})}),a&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("seeked",this.onvseeked),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},v.onMediaSeeked=function(){var a=this.media,f=a?a.currentTime:void 0;Object(T.isFiniteNumber)(f)&&_.logger.log("media seeked to "+f.toFixed(3)),this.tick()},v.onManifestLoading=function(){_.logger.log("trigger BUFFER_RESET"),this.hls.trigger(m.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},v.onManifestParsed=function(a){var f=!1,y=!1,w;a.levels.forEach(function(P){w=P.audioCodec,w&&(w.indexOf("mp4a.40.2")!==-1&&(f=!0),w.indexOf("mp4a.40.5")!==-1&&(y=!0))}),this.audioCodecSwitch=f&&y,this.audioCodecSwitch&&_.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=a.altAudio,this.levels=a.levels,this.startFragRequested=!1;var C=this.config;(C.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(C.startPosition)},v.onLevelLoaded=function(a){var f=a.details,y=a.level,w=this.levels[this.levelLastLoaded],C=this.levels[y],P=f.totalduration,M=0;if(_.logger.log("level "+y+" loaded ["+f.startSN+","+f.endSN+"],duration:"+P),f.live||C.details&&C.details.live){var G=C.details;G&&f.fragments.length>0?(Qe(G,f),M=f.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(M,G),f.PTSKnown&&Object(T.isFiniteNumber)(M)?_.logger.log("live playlist sliding:"+M.toFixed(3)):(_.logger.log("live playlist - outdated PTS, unknown sliding"),qt(this.fragPrevious,w,f))):(_.logger.log("live playlist - first load, unknown sliding"),f.PTSKnown=!1,qt(this.fragPrevious,w,f))}else f.PTSKnown=!1;if(C.details=f,this.levelLastLoaded=y,this.hls.trigger(m.default.LEVEL_UPDATED,{details:f,level:y}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var K=f.startTimeOffset;Object(T.isFiniteNumber)(K)?(K<0&&(_.logger.log("negative start time offset "+K+", count from end of last fragment"),K=M+P+K),_.logger.log("start time offset found in playlist, adjust startPosition to "+K),this.startPosition=K):f.live?(this.startPosition=this.computeLivePosition(M,f),_.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Se.WAITING_LEVEL&&(this.state=Se.IDLE),this.tick()},v.onKeyLoaded=function(){this.state===Se.KEY_LOADING&&(this.state=Se.IDLE,this.tick())},v.onFragLoaded=function(a){var f=this.fragCurrent,y=this.hls,w=this.levels,C=this.media,P=a.frag;if(this.state===Se.FRAG_LOADING&&f&&P.type==="main"&&P.level===f.level&&P.sn===f.sn){var M=a.stats,G=w[f.level],K=G.details;if(this.bitrateTest=!1,this.stats=M,_.logger.log("Loaded "+f.sn+" of ["+K.startSN+" ,"+K.endSN+"],level "+f.level),P.bitrateTest&&y.nextLoadLevel)this.state=Se.IDLE,this.startFragRequested=!1,M.tparsed=M.tbuffered=window.performance.now(),y.trigger(m.default.FRAG_BUFFERED,{stats:M,frag:f,id:"main"}),this.tick();else if(P.sn==="initSegment")this.state=Se.IDLE,M.tparsed=M.tbuffered=window.performance.now(),K.initSegment.data=a.payload,y.trigger(m.default.FRAG_BUFFERED,{stats:M,frag:f,id:"main"}),this.tick();else{_.logger.log("Parsing "+f.sn+" of ["+K.startSN+" ,"+K.endSN+"],level "+f.level+", cc "+f.cc),this.state=Se.PARSING,this.pendingBuffering=!0,this.appended=!1,P.bitrateTest&&(P.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:P}));var ie=!(C&&C.seeking)&&(K.PTSKnown||!K.live),Ee=K.initSegment?K.initSegment.data:[],be=this._getAudioCodec(G),Fe=this.demuxer=this.demuxer||new Ne(this.hls,"main");Fe.push(a.payload,Ee,be,G.videoCodec,f,K.totalduration,ie)}}this.fragLoadError=0},v.onFragParsingInitSegment=function(a){var f=this.fragCurrent,y=a.frag;if(f&&a.id==="main"&&y.sn===f.sn&&y.level===f.level&&this.state===Se.PARSING){var w=a.tracks,C,P;if(this.audioOnly=w.audio&&!w.video,this.altAudio&&!this.audioOnly&&delete w.audio,P=w.audio,P){var M=this.levels[this.level].audioCodec,G=navigator.userAgent.toLowerCase();M&&this.audioCodecSwap&&(_.logger.log("swapping playlist audio codec"),M.indexOf("mp4a.40.5")!==-1?M="mp4a.40.2":M="mp4a.40.5"),this.audioCodecSwitch&&P.metadata.channelCount!==1&&G.indexOf("firefox")===-1&&(M="mp4a.40.5"),G.indexOf("android")!==-1&&P.container!=="audio/mpeg"&&(M="mp4a.40.2",_.logger.log("Android: force audio codec to "+M)),P.levelCodec=M,P.id=a.id}P=w.video,P&&(P.levelCodec=this.levels[this.level].videoCodec,P.id=a.id),this.hls.trigger(m.default.BUFFER_CODECS,w);for(C in w){P=w[C],_.logger.log("main track:"+C+",container:"+P.container+",codecs[level/parsed]=["+P.levelCodec+"/"+P.codec+"]");var K=P.initSegment;K&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(m.default.BUFFER_APPENDING,{type:C,data:K,parent:"main",content:"initSegment"}))}this.tick()}},v.onFragParsingData=function(a){var f=this,y=this.fragCurrent,w=a.frag;if(y&&a.id==="main"&&w.sn===y.sn&&w.level===y.level&&!(a.type==="audio"&&this.altAudio)&&this.state===Se.PARSING){var C=this.levels[this.level],P=y;if(Object(T.isFiniteNumber)(a.endPTS)||(a.endPTS=a.startPTS+y.duration,a.endDTS=a.startDTS+y.duration),a.hasAudio===!0&&P.addElementaryStream(we.AUDIO),a.hasVideo===!0&&P.addElementaryStream(we.VIDEO),_.logger.log("Parsed "+a.type+",PTS:["+a.startPTS.toFixed(3)+","+a.endPTS.toFixed(3)+"],DTS:["+a.startDTS.toFixed(3)+"/"+a.endDTS.toFixed(3)+"],nb:"+a.nb+",dropped:"+(a.dropped||0)),a.type==="video")if(P.dropped=a.dropped,P.dropped)if(P.backtracked)_.logger.warn("Already backtracked on this fragment, appending with the gap",P.sn);else{var M=C.details;if(M&&P.sn===M.startSN)_.logger.warn("missing video frame(s) on first frag, appending with gap",P.sn);else{_.logger.warn("missing video frame(s), backtracking fragment",P.sn),this.fragmentTracker.removeFragment(P),P.backtracked=!0,this.nextLoadPosition=a.startPTS,this.state=Se.IDLE,this.fragPrevious=P,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.tick();return}}else P.backtracked=!1;var G=De(C.details,P,a.startPTS,a.endPTS,a.startDTS,a.endDTS),K=this.hls;K.trigger(m.default.LEVEL_PTS_UPDATED,{details:C.details,level:this.level,drift:G,type:a.type,start:a.startPTS,end:a.endPTS}),[a.data1,a.data2].forEach(function(ie){ie&&ie.length&&f.state===Se.PARSING&&(f.appended=!0,f.pendingBuffering=!0,K.trigger(m.default.BUFFER_APPENDING,{type:a.type,data:ie,parent:"main",content:"data"}))}),this.tick()}},v.onFragParsed=function(a){var f=this.fragCurrent,y=a.frag;f&&a.id==="main"&&y.sn===f.sn&&y.level===f.level&&this.state===Se.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=Se.PARSED,this._checkAppendedParsed())},v.onAudioTrackSwitching=function(a){var f=this.altAudio,y=!!a.url,w=a.id;if(!y){if(this.mediaBuffer!==this.media){_.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var C=this.fragCurrent;C.loader&&(_.logger.log("switching to main audio track, cancel main fragment load"),C.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=Se.IDLE}var P=this.hls;f&&P.trigger(m.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),P.trigger(m.default.AUDIO_TRACK_SWITCHED,{id:w})}},v.onAudioTrackSwitched=function(a){var f=a.id,y=!!this.hls.audioTracks[f].url;if(y){var w=this.videoBuffer;w&&this.mediaBuffer!==w&&(_.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=w)}this.altAudio=y,this.tick()},v.onBufferCreated=function(a){var f=a.tracks,y,w,C=!1;for(var P in f){var M=f[P];M.id==="main"?(w=P,y=M,P==="video"&&(this.videoBuffer=f[P].buffer)):C=!0}C&&y?(_.logger.log("alternate track found, use "+w+".buffered to schedule main fragment loading"),this.mediaBuffer=y.buffer):this.mediaBuffer=this.media},v.onBufferAppended=function(a){if(a.parent==="main"){var f=this.state;(f===Se.PARSING||f===Se.PARSED)&&(this.pendingBuffering=a.pending>0,this._checkAppendedParsed())}},v._checkAppendedParsed=function(){if(this.state===Se.PARSED&&(!this.appended||!this.pendingBuffering)){var a=this.fragCurrent;if(a){var f=this.mediaBuffer?this.mediaBuffer:this.media;_.logger.log("main buffered : "+Pt.toString(f.buffered)),this.fragPrevious=a;var y=this.stats;y.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*y.total/(y.tbuffered-y.tfirst)),this.hls.trigger(m.default.FRAG_BUFFERED,{stats:y,frag:a,id:"main"}),this.state=Se.IDLE}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},v.onError=function(a){var f=a.frag||this.fragCurrent;if(!(f&&f.type!=="main")){var y=!!this.media&&W.isBuffered(this.media,this.media.currentTime)&&W.isBuffered(this.media,this.media.currentTime+.5);switch(a.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:if(!a.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var w=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);_.logger.warn("mediaController: frag loading failed, retry in "+w+" ms"),this.retryDate=window.performance.now()+w,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=Se.FRAG_LOADING_WAITING_RETRY}else _.logger.error("mediaController: "+a.details+" reaches max retry, redispatch as fatal ..."),a.fatal=!0,this.state=Se.ERROR;break;case g.ErrorDetails.LEVEL_LOAD_ERROR:case g.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==Se.ERROR&&(a.fatal?(this.state=Se.ERROR,_.logger.warn("streamController: "+a.details+",switch to "+this.state+" state ...")):!a.levelRetry&&this.state===Se.WAITING_LEVEL&&(this.state=Se.IDLE));break;case g.ErrorDetails.BUFFER_FULL_ERROR:a.parent==="main"&&(this.state===Se.PARSING||this.state===Se.PARSED)&&(y?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=Se.IDLE):(_.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)));break}}},v._reduceMaxBufferLength=function(a){var f=this.config;return f.maxMaxBufferLength>=a?(f.maxMaxBufferLength/=2,_.logger.warn("main:reduce max buffer length to "+f.maxMaxBufferLength+"s"),!0):!1},v._checkBuffer=function(){var a=this.media;if(!(!a||a.readyState===0)){var f=this.mediaBuffer?this.mediaBuffer:a,y=f.buffered;!this.loadedmetadata&&y.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,y)}},v.onFragLoadEmergencyAborted=function(){this.state=Se.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},v.onBufferFlushed=function(){var a=this.mediaBuffer?this.mediaBuffer:this.media;if(a){var f=this.audioOnly?we.AUDIO:we.VIDEO;this.fragmentTracker.detectEvictedFragments(f,a.buffered)}this.state=Se.IDLE,this.fragPrevious=null},v.onLevelsUpdated=function(a){this.levels=a.levels},v.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},v._seekToStartPos=function(){var a=this.media,f=a.currentTime,y=this.startPosition;if(f!==y&&y>=0){if(a.seeking){_.logger.log("could not seek to "+y+", already seeking at "+f);return}var w=a.buffered.length?a.buffered.start(0):0,C=w-y;C>0&&C<this.config.maxBufferHole&&(_.logger.log("adjusting start position by "+C+" to match buffer start"),y+=C,this.startPosition=y),_.logger.log("seek to target start position "+y+" from current time "+f+". ready state "+a.readyState),a.currentTime=y}},v._getAudioCodec=function(a){var f=this.config.defaultAudioCodec||a.audioCodec;return this.audioCodecSwap&&(_.logger.log("swapping playlist audio codec"),f&&(f.indexOf("mp4a.40.5")!==-1?f="mp4a.40.2":f="mp4a.40.5")),f},Kn(x,[{key:"state",set:function(a){if(this.state!==a){var f=this.state;this._state=a,_.logger.log("main stream-controller: "+f+"->"+a),this.hls.trigger(m.default.STREAM_STATE_TRANSITION,{previousState:f,nextState:a})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var a=this.media;if(a){var f=this.getBufferedFrag(a.currentTime);if(f)return f.level}return-1}},{key:"nextBufferedFrag",get:function(){var a=this.media;return a?this.followingBufferedFrag(this.getBufferedFrag(a.currentTime)):null}},{key:"nextLevel",get:function(){var a=this.nextBufferedFrag;return a?a.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(a){this._liveSyncPosition=a}}]),x}(Tr),ds=Yt;function wi(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function Dn(R,x,v){return x&&wi(R.prototype,x),R}function rn(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var Hn,zs=function(R){rn(x,R);function x(d){var a;return a=R.call(this,d,m.default.MANIFEST_LOADED,m.default.LEVEL_LOADED,m.default.AUDIO_TRACK_SWITCHED,m.default.FRAG_LOADED,m.default.ERROR)||this,a.canload=!1,a.currentLevelIndex=null,a.manualLevelIndex=-1,a.timer=null,Hn=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),a}var v=x.prototype;return v.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},v.clearTimer=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},v.startLoad=function(){var a=this._levels;this.canload=!0,this.levelRetryCount=0,a&&a.forEach(function(f){f.loadError=0;var y=f.details;y&&y.live&&(f.details=void 0)}),this.timer!==null&&this.loadLevel()},v.stopLoad=function(){this.canload=!1},v.onManifestLoaded=function(a){var f=[],y=[],w,C={},P=null,M=!1,G=!1;if(a.levels.forEach(function(Ee){var be=Ee.attrs;Ee.loadError=0,Ee.fragmentError=!1,M=M||!!Ee.videoCodec,G=G||!!Ee.audioCodec,Hn&&Ee.audioCodec&&Ee.audioCodec.indexOf("mp4a.40.34")!==-1&&(Ee.audioCodec=void 0),P=C[Ee.bitrate],P?P.url.push(Ee.url):(Ee.url=[Ee.url],Ee.urlId=0,C[Ee.bitrate]=Ee,f.push(Ee)),be&&(be.AUDIO&&ke(P||Ee,"audio",be.AUDIO),be.SUBTITLES&&ke(P||Ee,"text",be.SUBTITLES))}),M&&G&&(f=f.filter(function(Ee){var be=Ee.videoCodec;return!!be})),f=f.filter(function(Ee){var be=Ee.audioCodec,Fe=Ee.videoCodec;return(!be||dt(be,"audio"))&&(!Fe||dt(Fe,"video"))}),a.audioTracks&&(y=a.audioTracks.filter(function(Ee){return!Ee.audioCodec||dt(Ee.audioCodec,"audio")}),y.forEach(function(Ee,be){Ee.id=be})),f.length>0){w=f[0].bitrate,f.sort(function(Ee,be){return Ee.bitrate-be.bitrate}),this._levels=f;for(var K=0;K<f.length;K++)if(f[K].bitrate===w){this._firstLevel=K,_.logger.log("manifest loaded,"+f.length+" level(s) found, first bitrate:"+w);break}var ie=G&&!M;this.hls.trigger(m.default.MANIFEST_PARSED,{levels:f,audioTracks:y,firstLevel:this._firstLevel,stats:a.stats,audio:G,video:M,altAudio:!ie&&y.some(function(Ee){return!!Ee.url})})}else this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},v.setLevelInternal=function(a){var f=this._levels,y=this.hls;if(a>=0&&a<f.length){if(this.clearTimer(),this.currentLevelIndex!==a){_.logger.log("switching to level "+a),this.currentLevelIndex=a;var w=f[a];w.level=a,y.trigger(m.default.LEVEL_SWITCHING,w)}var C=f[a],P=C.details;if(!P||P.live){var M=C.urlId;y.trigger(m.default.LEVEL_LOADING,{url:C.url[M],level:a,id:M})}}else y.trigger(m.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.LEVEL_SWITCH_ERROR,level:a,fatal:!1,reason:"invalid level idx"})},v.onError=function(a){if(a.fatal){a.type===g.ErrorTypes.NETWORK_ERROR&&this.clearTimer();return}var f=!1,y=!1,w;switch(a.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:w=a.frag.level,y=!0;break;case g.ErrorDetails.LEVEL_LOAD_ERROR:case g.ErrorDetails.LEVEL_LOAD_TIMEOUT:w=a.context.level,f=!0;break;case g.ErrorDetails.REMUX_ALLOC_ERROR:w=a.level,f=!0;break}w!==void 0&&this.recoverLevel(a,w,f,y)},v.recoverLevel=function(a,f,y,w){var C=this,P=this.hls.config,M=a.details,G=this._levels[f],K,ie,Ee;if(G.loadError++,G.fragmentError=w,y)if(this.levelRetryCount+1<=P.levelLoadingMaxRetry)ie=Math.min(Math.pow(2,this.levelRetryCount)*P.levelLoadingRetryDelay,P.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return C.loadLevel()},ie),a.levelRetry=!0,this.levelRetryCount++,_.logger.warn("level controller, "+M+", retry in "+ie+" ms, current retry count is "+this.levelRetryCount);else{_.logger.error("level controller, cannot recover from "+M+" error"),this.currentLevelIndex=null,this.clearTimer(),a.fatal=!0;return}(y||w)&&(K=G.url.length,K>1&&G.loadError<K?(G.urlId=(G.urlId+1)%K,G.details=void 0,_.logger.warn("level controller, "+M+" for level "+f+": switching to redundant URL-id "+G.urlId)):this.manualLevelIndex===-1?(Ee=f===0?this._levels.length-1:f-1,_.logger.warn("level controller, "+M+": switch to "+Ee),this.hls.nextAutoLevel=this.currentLevelIndex=Ee):w&&(_.logger.warn("level controller, "+M+": reload a fragment"),this.currentLevelIndex=null))},v.onFragLoaded=function(a){var f=a.frag;if(f!==void 0&&f.type==="main"){var y=this._levels[f.level];y!==void 0&&(y.fragmentError=!1,y.loadError=0,this.levelRetryCount=0)}},v.onLevelLoaded=function(a){var f=this,y=a.level,w=a.details;if(y===this.currentLevelIndex){var C=this._levels[y];if(C.fragmentError||(C.loadError=0,this.levelRetryCount=0),w.live){var P=st(C.details,w,a.stats.trequest);_.logger.log("live playlist, reload in "+Math.round(P)+" ms"),this.timer=setTimeout(function(){return f.loadLevel()},P)}else this.clearTimer()}},v.onAudioTrackSwitched=function(a){var f=this.hls.audioTracks[a.id].groupId,y=this.hls.levels[this.currentLevelIndex];if(y&&y.audioGroupIds){for(var w=-1,C=0;C<y.audioGroupIds.length;C++)if(y.audioGroupIds[C]===f){w=C;break}w!==y.urlId&&(y.urlId=w,this.startLoad())}},v.loadLevel=function(){if(_.logger.debug("call to loadLevel"),this.currentLevelIndex!==null&&this.canload){var a=this._levels[this.currentLevelIndex];if(typeof a=="object"&&a.url.length>0){var f=this.currentLevelIndex,y=a.urlId,w=a.url[y];_.logger.log("Attempt loading level index "+f+" with URL-id "+y),this.hls.trigger(m.default.LEVEL_LOADING,{url:w,level:f,id:y})}}},v.removeLevel=function(a,f){var y=this.levels.filter(function(w,C){return C!==a?!0:w.url.length>1&&f!==void 0?(w.url=w.url.filter(function(P,M){return M!==f}),w.urlId=0,!0):!1}).map(function(w,C){var P=w.details;return P&&P.fragments&&P.fragments.forEach(function(M){M.level=C}),w});this._levels=y,this.hls.trigger(m.default.LEVELS_UPDATED,{levels:y})},Dn(x,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(a){var f=this._levels;f&&(a=Math.min(a,f.length-1),(this.currentLevelIndex!==a||!f[a].details)&&this.setLevelInternal(a))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(a){this.manualLevelIndex=a,this._startLevel===void 0&&(this._startLevel=a),a!==-1&&(this.level=a)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(a){this._firstLevel=a}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var a=this.hls.config.startLevel;return a!==void 0?a:this._firstLevel}else return this._startLevel},set:function(a){this._startLevel=a}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(a){this.level=a,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=a)}}]),x}(D),$n=o("./src/demux/id3.js");function Lr(R,x){var v;try{v=new Event("addtrack")}catch{v=document.createEvent("Event"),v.initEvent("addtrack",!1,!1)}v.track=R,x.dispatchEvent(v)}function ai(R){if(R!=null&&R.cues)for(;R.cues.length>0;)R.removeCue(R.cues[0])}function Or(R,x){if(x<R[0].endTime)return R[0];if(x>R[R.length-1].endTime)return R[R.length-1];for(var v=0,d=R.length-1;v<=d;){var a=Math.floor((d+v)/2);if(x<R[a].endTime)d=a-1;else if(x>R[a].endTime)v=a+1;else return R[a]}return R[v].endTime-x<x-R[d].endTime?R[v]:R[d]}function Bi(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var Si=.25,ji=function(R){Bi(x,R);function x(d){var a;return a=R.call(this,d,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.FRAG_PARSING_METADATA,m.default.LIVE_BACK_BUFFER_REACHED)||this,a.id3Track=void 0,a.media=void 0,a}var v=x.prototype;return v.destroy=function(){D.prototype.destroy.call(this)},v.onMediaAttached=function(a){this.media=a.media,this.media},v.onMediaDetaching=function(){ai(this.id3Track),this.id3Track=void 0,this.media=void 0},v.getID3Track=function(a){for(var f=0;f<a.length;f++){var y=a[f];if(y.kind==="metadata"&&y.label==="id3")return Lr(y,this.media),y}return this.media.addTextTrack("metadata","id3")},v.onFragParsingMetadata=function(a){var f=a.frag,y=a.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var w=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,C=0;C<y.length;C++){var P=$n.default.getID3Frames(y[C].data);if(P){var M=Math.max(y[C].pts,0),G=C<y.length-1?y[C+1].pts:f.endPTS;G||(G=f.start+f.duration);var K=G-M;K<=0&&(G=M+Si);for(var ie=0;ie<P.length;ie++){var Ee=P[ie];if(!$n.default.isTimeStampFrame(Ee)){var be=new w(M,G,"");be.value=Ee,this.id3Track.addCue(be)}}}}},v.onLiveBackBufferReached=function(a){var f=a.bufferEnd,y=this.id3Track;if(!(!y||!y.cues||!y.cues.length)){var w=Or(y.cues,f);if(w)for(;y.cues[0]!==w;)y.removeCue(y.cues[0])}},x}(D),zi=ji;function Gi(){var R=ee();if(!R)return!1;var x=self.SourceBuffer||self.WebKitSourceBuffer,v=R&&typeof R.isTypeSupported=="function"&&R.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),d=!x||x.prototype&&typeof x.prototype.appendBuffer=="function"&&typeof x.prototype.remove=="function";return!!v&&!!d}var Ki=function(){function R(v){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=v?Math.exp(Math.log(.5)/v):0,this.estimate_=0,this.totalWeight_=0}var x=R.prototype;return x.sample=function(d,a){var f=Math.pow(this.alpha_,d);this.estimate_=a*(1-f)+f*this.estimate_,this.totalWeight_+=d},x.getTotalWeight=function(){return this.totalWeight_},x.getEstimate=function(){if(this.alpha_){var d=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/d}else return this.estimate_},R}(),Hi=Ki,yl=function(){function R(v,d,a,f){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=v,this.defaultEstimate_=f,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Hi(d),this.fast_=new Hi(a)}var x=R.prototype;return x.sample=function(d,a){d=Math.max(d,this.minDelayMs_);var f=8*a,y=d/1e3,w=f/y;this.fast_.sample(y,w),this.slow_.sample(y,w)},x.canEstimate=function(){var d=this.fast_;return d&&d.getTotalWeight()>=this.minWeight_},x.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},x.destroy=function(){},R}(),Ai=yl;function Sn(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function ps(R,x,v){return x&&Sn(R.prototype,x),R}function $i(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function Wi(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var er=window,qi=er.performance,Ot=function(R){Wi(x,R);function x(d){var a;return a=R.call(this,d,m.default.FRAG_LOADING,m.default.FRAG_LOADED,m.default.FRAG_BUFFERED,m.default.ERROR)||this,a.lastLoadedFragLevel=0,a._nextAutoLevel=-1,a.hls=d,a.timer=null,a._bwEstimator=null,a.onCheck=a._abandonRulesCheck.bind($i(a)),a}var v=x.prototype;return v.destroy=function(){this.clearTimer(),D.prototype.destroy.call(this)},v.onFragLoading=function(a){var f=a.frag;if(f.type==="main"&&(this.timer||(this.fragCurrent=f,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var y=this.hls,w=y.config,C=f.level,P=y.levels[C].details.live,M,G;P?(M=w.abrEwmaFastLive,G=w.abrEwmaSlowLive):(M=w.abrEwmaFastVoD,G=w.abrEwmaSlowVoD),this._bwEstimator=new Ai(y,G,M,w.abrEwmaDefaultEstimate)}},v._abandonRulesCheck=function(){var a=this.hls,f=a.media,y=this.fragCurrent;if(y){var w=y.loader;if(!w||w.stats&&w.stats.aborted){_.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}var C=w.stats;if(f&&C&&(!f.paused&&f.playbackRate!==0||!f.readyState)&&y.autoLevel&&y.level){var P=qi.now()-C.trequest,M=Math.abs(f.playbackRate);if(P>500*y.duration/M){var G=a.levels,K=Math.max(1,C.bw?C.bw/8:C.loaded*1e3/P),ie=G[y.level];if(!ie)return;var Ee=ie.realBitrate?Math.max(ie.realBitrate,ie.bitrate):ie.bitrate,be=C.total?C.total:Math.max(C.loaded,Math.round(y.duration*Ee/8)),Fe=f.currentTime,Xe=(be-C.loaded)/K,We=(W.bufferInfo(f,Fe,a.config.maxBufferHole).end-Fe)/M;if(We<2*y.duration/M&&Xe>We){var ot=a.minAutoLevel,ut,It;for(It=y.level-1;It>ot;It--){var ur=G[It].realBitrate?Math.max(G[It].realBitrate,G[It].bitrate):G[It].bitrate,pn=y.duration*ur/(8*.8*K);if(pn<We)break}ut<Xe&&(_.logger.warn("loading too slow, abort fragment loading and switch to level "+It+":fragLoadedDelay["+It+"]<fragLoadedDelay["+(y.level-1)+"];bufferStarvationDelay:"+ut.toFixed(1)+"<"+Xe.toFixed(1)+":"+We.toFixed(1)),a.nextLoadLevel=It,this._bwEstimator.sample(P,C.loaded),w.abort(),this.clearTimer(),a.trigger(m.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:y,stats:C}))}}}}},v.onFragLoaded=function(a){var f=a.frag;if(f.type==="main"&&Object(T.isFiniteNumber)(f.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=f.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var y=this.hls.levels[f.level],w=(y.loaded?y.loaded.bytes:0)+a.stats.loaded,C=(y.loaded?y.loaded.duration:0)+a.frag.duration;y.loaded={bytes:w,duration:C},y.realBitrate=Math.round(8*w/C)}if(a.frag.bitrateTest){var P=a.stats;P.tparsed=P.tbuffered=P.tload,this.onFragBuffered(a)}}},v.onFragBuffered=function(a){var f=a.stats,y=a.frag;if(f.aborted!==!0&&y.type==="main"&&Object(T.isFiniteNumber)(y.sn)&&(!y.bitrateTest||f.tload===f.tbuffered)){var w=f.tparsed-f.trequest;_.logger.log("latency/loading/parsing/append/kbps:"+Math.round(f.tfirst-f.trequest)+"/"+Math.round(f.tload-f.tfirst)+"/"+Math.round(f.tparsed-f.tload)+"/"+Math.round(f.tbuffered-f.tparsed)+"/"+Math.round(8*f.loaded/(f.tbuffered-f.trequest))),this._bwEstimator.sample(w,f.loaded),f.bwEstimate=this._bwEstimator.getEstimate(),y.bitrateTest?this.bitrateTestDelay=w/1e3:this.bitrateTestDelay=0}},v.onError=function(a){switch(a.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},v.clearTimer=function(){clearInterval(this.timer),this.timer=null},v._findBestLevel=function(a,f,y,w,C,P,M,G,K){for(var ie=C;ie>=w;ie--){var Ee=K[ie];if(Ee){var be=Ee.details,Fe=be?be.totalduration/be.fragments.length:f,Xe=be?be.live:!1,We=void 0;ie<=a?We=M*y:We=G*y;var ot=K[ie].realBitrate?Math.max(K[ie].realBitrate,K[ie].bitrate):K[ie].bitrate,ut=ot*Fe/We;if(_.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+ie+"/"+Math.round(We)+"/"+ot+"/"+Fe+"/"+P+"/"+ut),We>ot&&(!ut||Xe&&!this.bitrateTestDelay||ut<P))return ie}}return-1},ps(x,[{key:"nextAutoLevel",get:function(){var a=this._nextAutoLevel,f=this._bwEstimator;if(a!==-1&&(!f||!f.canEstimate()))return a;var y=this._nextABRAutoLevel;return a!==-1&&(y=Math.min(a,y)),y},set:function(a){this._nextAutoLevel=a}},{key:"_nextABRAutoLevel",get:function(){var a=this.hls,f=a.maxAutoLevel,y=a.levels,w=a.config,C=a.minAutoLevel,P=a.media,M=this.lastLoadedFragLevel,G=this.fragCurrent?this.fragCurrent.duration:0,K=P?P.currentTime:0,ie=P&&P.playbackRate!==0?Math.abs(P.playbackRate):1,Ee=this._bwEstimator?this._bwEstimator.getEstimate():w.abrEwmaDefaultEstimate,be=(W.bufferInfo(P,K,w.maxBufferHole).end-K)/ie,Fe=this._findBestLevel(M,G,Ee,C,f,be,w.abrBandWidthFactor,w.abrBandWidthUpFactor,y);if(Fe>=0)return Fe;_.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var Xe=G?Math.min(G,w.maxStarvationDelay):w.maxStarvationDelay,We=w.abrBandWidthFactor,ot=w.abrBandWidthUpFactor;if(be===0){var ut=this.bitrateTestDelay;if(ut){var It=G?Math.min(G,w.maxLoadingDelay):w.maxLoadingDelay;Xe=It-ut,_.logger.trace("bitrate test took "+Math.round(1e3*ut)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*Xe)+" ms"),We=ot=1}}return Fe=this._findBestLevel(M,G,Ee,C,f,be+Xe,We,ot,y),Math.max(Fe,0)}}]),x}(D),Yi=Ot;function ma(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var gs=ee(),va=function(R){ma(x,R);function x(d){var a;return a=R.call(this,d,m.default.MEDIA_ATTACHING,m.default.MEDIA_DETACHING,m.default.MANIFEST_PARSED,m.default.BUFFER_RESET,m.default.BUFFER_APPENDING,m.default.BUFFER_CODECS,m.default.BUFFER_EOS,m.default.BUFFER_FLUSHING,m.default.LEVEL_PTS_UPDATED,m.default.LEVEL_UPDATED)||this,a._msDuration=null,a._levelDuration=null,a._levelTargetDuration=10,a._live=null,a._objectUrl=null,a._needsFlush=!1,a._needsEos=!1,a.config=void 0,a.audioTimestampOffset=void 0,a.bufferCodecEventsExpected=0,a._bufferCodecEventsTotal=0,a.media=null,a.mediaSource=null,a.segments=[],a.parent=void 0,a.appending=!1,a.appended=0,a.appendError=0,a.flushBufferCounter=0,a.tracks={},a.pendingTracks={},a.sourceBuffer={},a.flushRange=[],a._onMediaSourceOpen=function(){_.logger.log("media source opened"),a.hls.trigger(m.default.MEDIA_ATTACHED,{media:a.media});var f=a.mediaSource;f&&f.removeEventListener("sourceopen",a._onMediaSourceOpen),a.checkPendingTracks()},a._onMediaSourceClose=function(){_.logger.log("media source closed")},a._onMediaSourceEnded=function(){_.logger.log("media source ended")},a._onSBUpdateEnd=function(){if(a.audioTimestampOffset&&a.sourceBuffer.audio){var f=a.sourceBuffer.audio;_.logger.warn("change mpeg audio timestamp offset from "+f.timestampOffset+" to "+a.audioTimestampOffset),f.timestampOffset=a.audioTimestampOffset,delete a.audioTimestampOffset}a._needsFlush&&a.doFlush(),a._needsEos&&a.checkEos(),a.appending=!1;var y=a.parent,w=a.segments.reduce(function(K,ie){return ie.parent===y?K+1:K},0),C={},P=a.sourceBuffer;for(var M in P){var G=P[M];if(!G)throw Error("handling source buffer update end error: source buffer for "+M+" uninitilized and unable to update buffered TimeRanges.");C[M]=G.buffered}a.hls.trigger(m.default.BUFFER_APPENDED,{parent:y,pending:w,timeRanges:C}),a._needsFlush||a.doAppending(),a.updateMediaElementDuration(),w===0&&a.flushLiveBackBuffer()},a._onSBUpdateError=function(f){_.logger.error("sourceBuffer error:",f),a.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},a.config=d.config,a}var v=x.prototype;return v.destroy=function(){D.prototype.destroy.call(this)},v.onLevelPtsUpdated=function(a){var f=a.type,y=this.tracks.audio;if(f==="audio"&&y&&y.container==="audio/mpeg"){var w=this.sourceBuffer.audio;if(!w)throw Error("Level PTS Updated and source buffer for audio uninitalized");var C=Math.abs(w.timestampOffset-a.start);if(C>.1){var P=w.updating;try{w.abort()}catch(M){_.logger.warn("can not abort audio buffer: "+M)}P?this.audioTimestampOffset=a.start:(_.logger.warn("change mpeg audio timestamp offset from "+w.timestampOffset+" to "+a.start),w.timestampOffset=a.start)}}},v.onManifestParsed=function(a){var f=2;(a.audio&&!a.video||!a.altAudio)&&(f=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=f,_.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},v.onMediaAttaching=function(a){var f=this.media=a.media;if(f&&gs){var y=this.mediaSource=new gs;y.addEventListener("sourceopen",this._onMediaSourceOpen),y.addEventListener("sourceended",this._onMediaSourceEnded),y.addEventListener("sourceclose",this._onMediaSourceClose),f.src=window.URL.createObjectURL(y),this._objectUrl=f.src}},v.onMediaDetaching=function(){_.logger.log("media source detaching");var a=this.mediaSource;if(a){if(a.readyState==="open")try{a.endOfStream()}catch(f){_.logger.warn("onMediaDetaching:"+f.message+" while calling endOfStream")}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):_.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(m.default.MEDIA_DETACHED)},v.checkPendingTracks=function(){var a=this.bufferCodecEventsExpected,f=this.pendingTracks,y=Object.keys(f).length;(y&&!a||y===2)&&(this.createSourceBuffers(f),this.pendingTracks={},this.doAppending())},v.onBufferReset=function(){var a=this.sourceBuffer;for(var f in a){var y=a[f];try{y&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(y),y.removeEventListener("updateend",this._onSBUpdateEnd),y.removeEventListener("error",this._onSBUpdateError))}catch{}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},v.onBufferCodecs=function(a){var f=this;Object.keys(this.sourceBuffer).length||(Object.keys(a).forEach(function(y){f.pendingTracks[y]=a[y]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},v.createSourceBuffers=function(a){var f=this.sourceBuffer,y=this.mediaSource;if(!y)throw Error("createSourceBuffers called when mediaSource was null");for(var w in a)if(!f[w]){var C=a[w];if(!C)throw Error("source buffer exists for track "+w+", however track does not");var P=C.levelCodec||C.codec,M=C.container+";codecs="+P;_.logger.log("creating sourceBuffer("+M+")");try{var G=f[w]=y.addSourceBuffer(M);G.addEventListener("updateend",this._onSBUpdateEnd),G.addEventListener("error",this._onSBUpdateError),this.tracks[w]={buffer:G,codec:P,id:C.id,container:C.container,levelCodec:C.levelCodec}}catch(K){_.logger.error("error while trying to add sourceBuffer:"+K.message),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:K,mimeType:M})}}this.hls.trigger(m.default.BUFFER_CREATED,{tracks:this.tracks})},v.onBufferAppending=function(a){this._needsFlush||(this.segments?this.segments.push(a):this.segments=[a],this.doAppending())},v.onBufferEos=function(a){for(var f in this.sourceBuffer)if(!a.type||a.type===f){var y=this.sourceBuffer[f];y&&!y.ended&&(y.ended=!0,_.logger.log(f+" sourceBuffer now EOS"))}this.checkEos()},v.checkEos=function(){var a=this.sourceBuffer,f=this.mediaSource;if(!f||f.readyState!=="open"){this._needsEos=!1;return}for(var y in a){var w=a[y];if(w){if(!w.ended)return;if(w.updating){this._needsEos=!0;return}}}_.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{f.endOfStream()}catch{_.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},v.onBufferFlushing=function(a){a.type?this.flushRange.push({start:a.startOffset,end:a.endOffset,type:a.type}):(this.flushRange.push({start:a.startOffset,end:a.endOffset,type:"video"}),this.flushRange.push({start:a.startOffset,end:a.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},v.flushLiveBackBuffer=function(){if(this._live){var a=this.config.liveBackBufferLength;if(!(!isFinite(a)||a<0)){if(!this.media){_.logger.error("flushLiveBackBuffer called without attaching media");return}for(var f=this.media.currentTime,y=this.sourceBuffer,w=Object.keys(y),C=f-Math.max(a,this._levelTargetDuration),P=w.length-1;P>=0;P--){var M=w[P],G=y[M];if(G){var K=G.buffered;K.length>0&&C>K.start(0)&&this.removeBufferRange(M,G,0,C)&&this.hls.trigger(m.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:C})}}}}},v.onLevelUpdated=function(a){var f=a.details;f.fragments.length>0&&(this._levelDuration=f.totalduration+f.fragments[0].start,this._levelTargetDuration=f.averagetargetduration||f.targetduration||10,this._live=f.live,this.updateMediaElementDuration())},v.updateMediaElementDuration=function(){var a=this.config,f;if(!(this._levelDuration===null||!this.media||!this.mediaSource||!this.sourceBuffer||this.media.readyState===0||this.mediaSource.readyState!=="open")){for(var y in this.sourceBuffer){var w=this.sourceBuffer[y];if(w&&w.updating===!0)return}f=this.media.duration,this._msDuration===null&&(this._msDuration=this.mediaSource.duration),this._live===!0&&a.liveDurationInfinity===!0?(_.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>f||!Object(T.isFiniteNumber)(f))&&(_.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},v.doFlush=function(){for(;this.flushRange.length;){var a=this.flushRange[0];if(this.flushBuffer(a.start,a.end,a.type))this.flushRange.shift(),this.flushBufferCounter=0;else{this._needsFlush=!0;return}}if(this.flushRange.length===0){this._needsFlush=!1;var f=0,y=this.sourceBuffer;try{for(var w in y){var C=y[w];C&&(f+=C.buffered.length)}}catch{_.logger.error("error while accessing sourceBuffer.buffered")}this.appended=f,this.hls.trigger(m.default.BUFFER_FLUSHED)}},v.doAppending=function(){var a=this.config,f=this.hls,y=this.segments,w=this.sourceBuffer;if(Object.keys(w).length){if(!this.media||this.media.error){this.segments=[],_.logger.error("trying to append although a media error occured, flush segment and abort");return}if(!this.appending){var C=y.shift();if(C)try{var P=w[C.type];if(!P){this._onSBUpdateEnd();return}if(P.updating){y.unshift(C);return}P.ended=!1,this.parent=C.parent,P.appendBuffer(C.data),this.appendError=0,this.appended++,this.appending=!0}catch(G){_.logger.error("error while trying to append buffer:"+G.message),y.unshift(C);var M={type:g.ErrorTypes.MEDIA_ERROR,parent:C.parent,details:"",fatal:!1};G.code===22?(this.segments=[],M.details=g.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,M.details=g.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>a.appendErrorMaxRetry&&(_.logger.log("fail "+a.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],M.fatal=!0)),f.trigger(m.default.ERROR,M)}}}},v.flushBuffer=function(a,f,y){var w=this.sourceBuffer;if(!Object.keys(w).length)return!0;var C="null";if(this.media&&(C=this.media.currentTime.toFixed(3)),_.logger.log("flushBuffer,pos/start/end: "+C+"/"+a+"/"+f),this.flushBufferCounter>=this.appended)return _.logger.warn("abort flushing too many retries"),!0;var P=w[y];if(P){if(P.ended=!1,P.updating)return _.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(y,P,a,f))return this.flushBufferCounter++,!1}return _.logger.log("buffer flushed"),!0},v.removeBufferRange=function(a,f,y,w){try{for(var C=0;C<f.buffered.length;C++){var P=f.buffered.start(C),M=f.buffered.end(C),G=Math.max(P,y),K=Math.min(M,w);if(Math.min(K,M)-G>.5){var ie="null";return this.media&&(ie=this.media.currentTime.toString()),_.logger.log("sb remove "+a+" ["+G+","+K+"], of ["+P+","+M+"], pos:"+ie),f.remove(G,K),!0}}}catch(Ee){_.logger.warn("removeBufferRange failed",Ee)}return!1},x}(D),ya=va;function Oo(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function No(R,x,v){return x&&Oo(R.prototype,x),v&&Oo(R,v),R}function li(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var zr=function(R){li(x,R);function x(d){var a;return a=R.call(this,d,m.default.FPS_DROP_LEVEL_CAPPING,m.default.MEDIA_ATTACHING,m.default.MANIFEST_PARSED,m.default.LEVELS_UPDATED,m.default.BUFFER_CODECS,m.default.MEDIA_DETACHING)||this,a.autoLevelCapping=Number.POSITIVE_INFINITY,a.firstLevel=null,a.levels=[],a.media=null,a.restrictedLevels=[],a.timer=null,a.clientRect=null,a}var v=x.prototype;return v.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},v.onFpsDropLevelCapping=function(a){x.isLevelAllowed(a.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(a.droppedLevel)},v.onMediaAttaching=function(a){this.media=a.media instanceof window.HTMLVideoElement?a.media:null},v.onManifestParsed=function(a){var f=this.hls;this.restrictedLevels=[],this.levels=a.levels,this.firstLevel=a.firstLevel,f.config.capLevelToPlayerSize&&a.video&&this.startCapping()},v.onBufferCodecs=function(a){var f=this.hls;f.config.capLevelToPlayerSize&&a.video&&this.startCapping()},v.onLevelsUpdated=function(a){this.levels=a.levels},v.onMediaDetaching=function(){this.stopCapping()},v.detectPlayerSize=function(){if(this.media){var a=this.levels?this.levels.length:0;if(a){var f=this.hls;f.autoLevelCapping=this.getMaxLevel(a-1),f.autoLevelCapping>this.autoLevelCapping&&f.streamController.nextLevelSwitch(),this.autoLevelCapping=f.autoLevelCapping}}},v.getMaxLevel=function(a){var f=this;if(!this.levels)return-1;var y=this.levels.filter(function(w,C){return x.isLevelAllowed(C,f.restrictedLevels)&&C<=a});return this.clientRect=null,x.getMaxLevelByMediaSize(y,this.mediaWidth,this.mediaHeight)},v.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},v.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},v.getDimensions=function(){if(this.clientRect)return this.clientRect;var a=this.media,f={width:0,height:0};if(a){var y=a.getBoundingClientRect();f.width=y.width,f.height=y.height,!f.width&&!f.height&&(f.width=y.right-y.left||a.width||0,f.height=y.bottom-y.top||a.height||0)}return this.clientRect=f,f},x.isLevelAllowed=function(a,f){return f===void 0&&(f=[]),f.indexOf(a)===-1},x.getMaxLevelByMediaSize=function(a,f,y){if(!a||a&&!a.length)return-1;for(var w=function(K,ie){return ie?K.width!==ie.width||K.height!==ie.height:!0},C=a.length-1,P=0;P<a.length;P+=1){var M=a[P];if((M.width>=f||M.height>=y)&&w(M,a[P+1])){C=P;break}}return C},No(x,[{key:"mediaWidth",get:function(){return this.getDimensions().width*x.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*x.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var a=1;try{a=window.devicePixelRatio}catch{}return a}}]),x}(D),Wn=zr;function qn(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var Qi=window,Ln=Qi.performance,ui=function(R){qn(x,R);function x(d){return R.call(this,d,m.default.MEDIA_ATTACHING)||this}var v=x.prototype;return v.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},v.onMediaAttaching=function(a){var f=this.hls.config;if(f.capLevelOnFPSDrop){var y=this.video=a.media instanceof window.HTMLVideoElement?a.media:null;typeof y.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),f.fpsDroppedMonitoringPeriod)}},v.checkFPS=function(a,f,y){var w=Ln.now();if(f){if(this.lastTime){var C=w-this.lastTime,P=y-this.lastDroppedFrames,M=f-this.lastDecodedFrames,G=1e3*P/C,K=this.hls;if(K.trigger(m.default.FPS_DROP,{currentDropped:P,currentDecoded:M,totalDroppedFrames:y}),G>0&&P>K.config.fpsDroppedMonitoringThreshold*M){var ie=K.currentLevel;_.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+ie),ie>0&&(K.autoLevelCapping===-1||K.autoLevelCapping>=ie)&&(ie=ie-1,K.trigger(m.default.FPS_DROP_LEVEL_CAPPING,{level:ie,droppedLevel:K.currentLevel}),K.autoLevelCapping=ie,K.streamController.nextLevelSwitch())}}this.lastTime=w,this.lastDroppedFrames=y,this.lastDecodedFrames=f}},v.checkFPSInterval=function(){var a=this.video;if(a)if(this.isVideoPlaybackQualityAvailable){var f=a.getVideoPlaybackQuality();this.checkFPS(a,f.totalVideoFrames,f.droppedVideoFrames)}else this.checkFPS(a,a.webkitDecodedFrameCount,a.webkitDroppedFrameCount)},x}(D),_l=ui,_a=function(){function R(v){v&&v.xhrSetup&&(this.xhrSetup=v.xhrSetup)}var x=R.prototype;return x.destroy=function(){this.abort(),this.loader=null},x.abort=function(){var d=this.loader;d&&d.readyState!==4&&(this.stats.aborted=!0,d.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},x.load=function(d,a,f){this.context=d,this.config=a,this.callbacks=f,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=a.retryDelay,this.loadInternal()},x.loadInternal=function(){var d,a=this.context;d=this.loader=new window.XMLHttpRequest;var f=this.stats;f.tfirst=0,f.loaded=0;var y=this.xhrSetup;try{if(y)try{y(d,a.url)}catch{d.open("GET",a.url,!0),y(d,a.url)}d.readyState||d.open("GET",a.url,!0)}catch(w){this.callbacks.onError({code:d.status,text:w.message},a,d);return}a.rangeEnd&&d.setRequestHeader("Range","bytes="+a.rangeStart+"-"+(a.rangeEnd-1)),d.onreadystatechange=this.readystatechange.bind(this),d.onprogress=this.loadprogress.bind(this),d.responseType=a.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),d.send()},x.readystatechange=function(d){var a=d.currentTarget,f=a.readyState,y=this.stats,w=this.context,C=this.config;if(!y.aborted&&f>=2)if(window.clearTimeout(this.requestTimeout),y.tfirst===0&&(y.tfirst=Math.max(window.performance.now(),y.trequest)),f===4){var P=a.status;if(P>=200&&P<300){y.tload=Math.max(y.tfirst,window.performance.now());var M,G;w.responseType==="arraybuffer"?(M=a.response,G=M.byteLength):(M=a.responseText,G=M.length),y.loaded=y.total=G;var K={url:a.responseURL,data:M};this.callbacks.onSuccess(K,y,w,a)}else y.retry>=C.maxRetry||P>=400&&P<499?(_.logger.error(P+" while loading "+w.url),this.callbacks.onError({code:P,text:a.statusText},w,a)):(_.logger.warn(P+" while loading "+w.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,C.maxRetryDelay),y.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),C.timeout)},x.loadtimeout=function(){_.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},x.loadprogress=function(d){var a=d.currentTarget,f=this.stats;f.loaded=d.loaded,d.lengthComputable&&(f.total=d.total);var y=this.callbacks.onProgress;y&&y(f,this.context,null,a)},R}(),hn=_a;function El(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function Ea(R,x,v){return x&&El(R.prototype,x),R}function Ri(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var ms=function(R){Ri(x,R);function x(d){var a;return a=R.call(this,d,m.default.MANIFEST_LOADING,m.default.MANIFEST_PARSED,m.default.AUDIO_TRACK_LOADED,m.default.AUDIO_TRACK_SWITCHED,m.default.LEVEL_LOADED,m.default.ERROR)||this,a._trackId=-1,a._selectDefaultTrack=!0,a.tracks=[],a.trackIdBlacklist=Object.create(null),a.audioGroupId=null,a}var v=x.prototype;return v.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},v.onManifestParsed=function(a){var f=this.tracks=a.audioTracks||[];this.hls.trigger(m.default.AUDIO_TRACKS_UPDATED,{audioTracks:f}),this._selectAudioGroup(this.hls.nextLoadLevel)},v.onAudioTrackLoaded=function(a){if(a.id>=this.tracks.length){_.logger.warn("Invalid audio track id:",a.id);return}if(_.logger.log("audioTrack "+a.id+" loaded"),this.tracks[a.id].details=a.details,a.details.live&&!this.hasInterval()){var f=a.details.targetduration*1e3;this.setInterval(f)}!a.details.live&&this.hasInterval()&&this.clearInterval()},v.onAudioTrackSwitched=function(a){var f=this.tracks[a.id].groupId;f&&this.audioGroupId!==f&&(this.audioGroupId=f)},v.onLevelLoaded=function(a){this._selectAudioGroup(a.level)},v.onError=function(a){a.type===g.ErrorTypes.NETWORK_ERROR&&(a.fatal&&this.clearInterval(),a.details===g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(_.logger.warn("Network failure on audio-track id:",a.context.id),this._handleLoadError()))},v._setAudioTrack=function(a){if(this._trackId===a&&this.tracks[this._trackId].details){_.logger.debug("Same id as current audio-track passed, and track details available -> no-op");return}if(a<0||a>=this.tracks.length){_.logger.warn("Invalid id passed to audio-track controller");return}var f=this.tracks[a];_.logger.log("Now switching to audio-track index "+a),this.clearInterval(),this._trackId=a;var y=f.url,w=f.type,C=f.id;this.hls.trigger(m.default.AUDIO_TRACK_SWITCHING,{id:C,type:w,url:y}),this._loadTrackDetailsIfNeeded(f)},v.doTick=function(){this._updateTrack(this._trackId)},v._selectAudioGroup=function(a){var f=this.hls.levels[a];if(!(!f||!f.audioGroupIds)){var y=f.audioGroupIds[f.urlId];this.audioGroupId!==y&&(this.audioGroupId=y,this._selectInitialAudioTrack())}},v._selectInitialAudioTrack=function(){var a=this,f=this.tracks;if(f.length){var y=this.tracks[this._trackId],w=null;if(y&&(w=y.name),this._selectDefaultTrack){var C=f.filter(function(G){return G.default});C.length?f=C:_.logger.warn("No default audio tracks defined")}var P=!1,M=function(){f.forEach(function(K){P||(!a.audioGroupId||K.groupId===a.audioGroupId)&&(!w||w===K.name)&&(a._setAudioTrack(K.id),P=!0)})};M(),P||(w=null,M()),P||(_.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},v._needsTrackLoading=function(a){var f=a.details,y=a.url;return!f||f.live?!!y:!1},v._loadTrackDetailsIfNeeded=function(a){if(this._needsTrackLoading(a)){var f=a.url,y=a.id;_.logger.log("loading audio-track playlist for id: "+y),this.hls.trigger(m.default.AUDIO_TRACK_LOADING,{url:f,id:y})}},v._updateTrack=function(a){if(!(a<0||a>=this.tracks.length)){this.clearInterval(),this._trackId=a,_.logger.log("trying to update audio-track "+a);var f=this.tracks[a];this._loadTrackDetailsIfNeeded(f)}},v._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var a=this._trackId,f=this.tracks[a],y=f.name,w=f.language,C=f.groupId;_.logger.warn("Loading failed on audio track id: "+a+", group-id: "+C+', name/language: "'+y+'" / "'+w+'"');for(var P=a,M=0;M<this.tracks.length;M++)if(!this.trackIdBlacklist[M]){var G=this.tracks[M];if(G.name===y){P=M;break}}if(P===a){_.logger.warn('No fallback audio-track found for name/language: "'+y+'" / "'+w+'"');return}_.logger.log("Attempting audio-track fallback id:",P,"group-id:",this.tracks[P].groupId),this._setAudioTrack(P)},Ea(x,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(a){this._setAudioTrack(a),this._selectDefaultTrack=!1}}]),x}(Er),Ta=ms;function Yn(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function Qn(R,x,v){return x&&Yn(R.prototype,x),R}function Ii(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var Xi=window,Qt=Xi.performance,xa=100,Fo=function(R){Ii(x,R);function x(d,a){var f;return f=R.call(this,d,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.AUDIO_TRACKS_UPDATED,m.default.AUDIO_TRACK_SWITCHING,m.default.AUDIO_TRACK_LOADED,m.default.KEY_LOADED,m.default.FRAG_LOADED,m.default.FRAG_PARSING_INIT_SEGMENT,m.default.FRAG_PARSING_DATA,m.default.FRAG_PARSED,m.default.ERROR,m.default.BUFFER_RESET,m.default.BUFFER_CREATED,m.default.BUFFER_APPENDED,m.default.BUFFER_FLUSHED,m.default.INIT_PTS_FOUND)||this,f.fragmentTracker=a,f.config=d.config,f.audioCodecSwap=!1,f._state=Se.STOPPED,f.initPTS=[],f.waitingFragment=null,f.videoTrackCC=null,f.waitingVideoCC=null,f}var v=x.prototype;return v.onInitPtsFound=function(a){var f=a.id,y=a.frag.cc,w=a.initPTS;f==="main"&&(this.initPTS[y]=w,this.videoTrackCC=y,_.logger.log("InitPTS for cc: "+y+" found from main: "+w),this.state===Se.WAITING_INIT_PTS&&this.tick())},v.startLoad=function(a){if(this.tracks){var f=this.lastCurrentTime;this.stopLoad(),this.setInterval(xa),this.fragLoadError=0,f>0&&a===-1?(_.logger.log("audio:override startPosition with lastCurrentTime @"+f.toFixed(3)),this.state=Se.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:a,this.state=Se.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=a,this.state=Se.STOPPED},v.doTick=function(){var a,f,y,w=this.hls,C=w.config;switch(this.state){case Se.ERROR:case Se.PAUSED:case Se.BUFFER_FLUSHING:break;case Se.STARTING:this.state=Se.WAITING_TRACK,this.loadedmetadata=!1;break;case Se.IDLE:var P=this.tracks;if(!P||!this.media&&(this.startFragRequested||!C.startFragPrefetch))break;if(this.loadedmetadata)a=this.media.currentTime;else if(a=this.nextLoadPosition,a===void 0)break;var M=this.mediaBuffer?this.mediaBuffer:this.media,G=this.videoBuffer?this.videoBuffer:this.media,K=a<C.maxBufferHole?Math.max(Dr,C.maxBufferHole):C.maxBufferHole,ie=W.bufferInfo(M,a,K),Ee=W.bufferInfo(G,a,K),be=ie.len,Fe=ie.end,Xe=this.fragPrevious,We=Math.min(C.maxBufferLength,C.maxMaxBufferLength),ot=Math.max(We,Ee.len),ut=this.audioSwitch,It=this.trackId;if((be<ot||ut)&&It<P.length){if(y=P[It].details,typeof y>"u"){this.state=Se.WAITING_TRACK;break}if(!ut&&this._streamEnded(ie,y)){this.hls.trigger(m.default.BUFFER_EOS,{type:"audio"}),this.state=Se.ENDED;return}var ur=y.fragments,pn=ur.length,Mr=ur[0].start,Vt=ur[pn-1].start+ur[pn-1].duration,rt;if(ut){if(y.live&&!y.PTSKnown)_.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),Fe=0;else if(Fe=a,y.PTSKnown&&a<Mr)if(ie.end>Mr||ie.nextStart)_.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=Mr+.05;else return}if(y.initSegment&&!y.initSegment.data)rt=y.initSegment;else if(Fe<=Mr){if(rt=ur[0],this.videoTrackCC!==null&&rt.cc!==this.videoTrackCC&&(rt=kt(ur,this.videoTrackCC)),y.live&&rt.loadIdx&&rt.loadIdx===this.fragLoadIdx){var Tt=ie.nextStart?ie.nextStart:Mr;_.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(Tt+.05)),this.media.currentTime=Tt+.05;return}}else{var ir,xs=C.maxFragLookUpTolerance,es=Xe?ur[Xe.sn-ur[0].sn+1]:void 0;Fe<Vt?(Fe>Vt-xs&&(xs=0),es&&!Ht(Fe,xs,es)?ir=es:ir=ue.search(ur,function(ka){return Ht(Fe,xs,ka)})):ir=ur[pn-1],ir&&(rt=ir,Mr=ir.start,Xe&&rt.level===Xe.level&&rt.sn===Xe.sn&&(rt.sn<y.endSN?(rt=ur[rt.sn+1-y.startSN],this.fragmentTracker.getState(rt)!==dr.OK&&_.logger.log("SN just loaded, load next one: "+rt.sn)):rt=null))}rt&&(rt.encrypted?(_.logger.log("Loading key for "+rt.sn+" of ["+y.startSN+" ,"+y.endSN+"],track "+It),this.state=Se.KEY_LOADING,w.trigger(m.default.KEY_LOADING,{frag:rt})):(this.fragCurrent=rt,(ut||this.fragmentTracker.getState(rt)===dr.NOT_LOADED)&&(_.logger.log("Loading "+rt.sn+", cc: "+rt.cc+" of ["+y.startSN+" ,"+y.endSN+"],track "+It+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+a+", bufferEnd: "+Fe.toFixed(3)),rt.sn!=="initSegment"&&(this.startFragRequested=!0),Object(T.isFiniteNumber)(rt.sn)&&(this.nextLoadPosition=rt.start+rt.duration),w.trigger(m.default.FRAG_LOADING,{frag:rt}),this.state=Se.FRAG_LOADING)))}break;case Se.WAITING_TRACK:f=this.tracks[this.trackId],f&&f.details&&(this.state=Se.IDLE);break;case Se.FRAG_LOADING_WAITING_RETRY:var Ci=Qt.now(),ws=this.retryDate;M=this.media;var to=M&&M.seeking;(!ws||Ci>=ws||to)&&(_.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=Se.IDLE);break;case Se.WAITING_INIT_PTS:var ro=this.waitingFragment;if(ro){var Al=ro.frag.cc;if(this.initPTS[Al]!==void 0)this.waitingFragment=null,this.state=Se.FRAG_LOADING,this.onFragLoaded(ro);else if(this.videoTrackCC!==this.waitingVideoCC)_.logger.log("Waiting fragment cc ("+Al+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var Du=W.bufferInfo(this.mediaBuffer,this.media.currentTime,C.maxBufferHole),Lu=Ht(Du.end,C.maxFragLookUpTolerance,ro.frag);Lu<0&&(_.logger.log("Waiting fragment cc ("+Al+") @ "+ro.frag.start+" cancelled because another fragment at "+Du.end+" is needed"),this.clearWaitingFragment())}}else this.state=Se.IDLE;break}},v.clearWaitingFragment=function(){var a=this.waitingFragment;a&&(this.fragmentTracker.removeFragment(a.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=Se.IDLE)},v.onMediaAttached=function(a){var f=this.media=this.mediaBuffer=a.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),f.addEventListener("seeking",this.onvseeking),f.addEventListener("ended",this.onvended);var y=this.config;this.tracks&&y.autoStartLoad&&this.startLoad(y.startPosition)},v.onMediaDetaching=function(){var a=this.media;a&&a.ended&&(_.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),a&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},v.onAudioTracksUpdated=function(a){_.logger.log("audio tracks updated"),this.tracks=a.audioTracks},v.onAudioTrackSwitching=function(a){var f=!!a.url;this.trackId=a.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state=Se.PAUSED,f?this.setInterval(xa):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),f&&(this.audioSwitch=!0,this.state=Se.IDLE),this.tick()},v.onAudioTrackLoaded=function(a){var f=a.details,y=a.id,w=this.tracks[y],C=w.details,P=f.totalduration,M=0;if(_.logger.log("track "+y+" loaded ["+f.startSN+","+f.endSN+"],duration:"+P),f.live||C&&C.live?C&&f.fragments.length>0?(Qe(C,f),M=f.fragments[0].start,f.PTSKnown?_.logger.log("live audio playlist sliding:"+M.toFixed(3)):_.logger.log("live audio playlist - outdated PTS, unknown sliding")):(f.PTSKnown=!1,_.logger.log("live audio playlist - first load, unknown sliding")):f.PTSKnown=!1,w.details=f,!this.startFragRequested){if(this.startPosition===-1){var G=f.startTimeOffset;Object(T.isFiniteNumber)(G)?(_.logger.log("start time offset found in playlist, adjust startPosition to "+G),this.startPosition=G):f.live?(this.startPosition=this.computeLivePosition(M,f),_.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===Se.WAITING_TRACK&&(this.state=Se.IDLE),this.tick()},v.onKeyLoaded=function(){this.state===Se.KEY_LOADING&&(this.state=Se.IDLE,this.tick())},v.onFragLoaded=function(a){var f=this.fragCurrent,y=a.frag;if(this.state===Se.FRAG_LOADING&&f&&y.type==="audio"&&y.level===f.level&&y.sn===f.sn){var w=this.tracks[this.trackId],C=w.details,P=C.totalduration,M=f.level,G=f.sn,K=f.cc,ie=this.config.defaultAudioCodec||w.audioCodec||"mp4a.40.2",Ee=this.stats=a.stats;if(G==="initSegment")this.state=Se.IDLE,Ee.tparsed=Ee.tbuffered=Qt.now(),C.initSegment.data=a.payload,this.hls.trigger(m.default.FRAG_BUFFERED,{stats:Ee,frag:f,id:"audio"}),this.tick();else{this.state=Se.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new Ne(this.hls,"audio"));var be=this.initPTS[K],Fe=C.initSegment?C.initSegment.data:[];if(be!==void 0){this.pendingBuffering=!0,_.logger.log("Demuxing "+G+" of ["+C.startSN+" ,"+C.endSN+"],track "+M);var Xe=!1;this.demuxer.push(a.payload,Fe,ie,null,f,P,Xe,be)}else _.logger.log("Unknown video PTS for cc "+K+", waiting for video PTS before demuxing audio frag "+G+" of ["+C.startSN+" ,"+C.endSN+"],track "+M),this.waitingFragment=a,this.waitingVideoCC=this.videoTrackCC,this.state=Se.WAITING_INIT_PTS}}this.fragLoadError=0},v.onFragParsingInitSegment=function(a){var f=this.fragCurrent,y=a.frag;if(f&&a.id==="audio"&&y.sn===f.sn&&y.level===f.level&&this.state===Se.PARSING){var w=a.tracks,C;if(w.video&&delete w.video,C=w.audio,C){C.levelCodec=C.codec,C.id=a.id,this.hls.trigger(m.default.BUFFER_CODECS,w),_.logger.log("audio track:audio,container:"+C.container+",codecs[level/parsed]=["+C.levelCodec+"/"+C.codec+"]");var P=C.initSegment;if(P){var M={type:"audio",data:P,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[M]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(m.default.BUFFER_APPENDING,M))}this.tick()}}},v.onFragParsingData=function(a){var f=this,y=this.fragCurrent,w=a.frag;if(y&&a.id==="audio"&&a.type==="audio"&&w.sn===y.sn&&w.level===y.level&&this.state===Se.PARSING){var C=this.trackId,P=this.tracks[C],M=this.hls;Object(T.isFiniteNumber)(a.endPTS)||(a.endPTS=a.startPTS+y.duration,a.endDTS=a.startDTS+y.duration),y.addElementaryStream(we.AUDIO),_.logger.log("parsed "+a.type+",PTS:["+a.startPTS.toFixed(3)+","+a.endPTS.toFixed(3)+"],DTS:["+a.startDTS.toFixed(3)+"/"+a.endDTS.toFixed(3)+"],nb:"+a.nb),De(P.details,y,a.startPTS,a.endPTS);var G=this.media,K=!1;if(this.audioSwitch)if(G&&G.readyState){var ie=G.currentTime;_.logger.log("switching audio track : currentTime:"+ie),ie>=a.startPTS&&(_.logger.log("switching audio track : flushing all audio"),this.state=Se.BUFFER_FLUSHING,M.trigger(m.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),K=!0,this.audioSwitch=!1,M.trigger(m.default.AUDIO_TRACK_SWITCHED,{id:C}))}else this.audioSwitch=!1,M.trigger(m.default.AUDIO_TRACK_SWITCHED,{id:C});var Ee=this.pendingData;if(!Ee){_.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),M.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});return}this.audioSwitch||([a.data1,a.data2].forEach(function(be){be&&be.length&&Ee.push({type:a.type,data:be,parent:"audio",content:"data"})}),!K&&Ee.length&&(Ee.forEach(function(be){f.state===Se.PARSING&&(f.pendingBuffering=!0,f.hls.trigger(m.default.BUFFER_APPENDING,be))}),this.pendingData=[],this.appended=!0)),this.tick()}},v.onFragParsed=function(a){var f=this.fragCurrent,y=a.frag;f&&a.id==="audio"&&y.sn===f.sn&&y.level===f.level&&this.state===Se.PARSING&&(this.stats.tparsed=Qt.now(),this.state=Se.PARSED,this._checkAppendedParsed())},v.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},v.onBufferCreated=function(a){var f=a.tracks.audio;f&&(this.mediaBuffer=f.buffer,this.loadedmetadata=!0),a.tracks.video&&(this.videoBuffer=a.tracks.video.buffer)},v.onBufferAppended=function(a){if(a.parent==="audio"){var f=this.state;(f===Se.PARSING||f===Se.PARSED)&&(this.pendingBuffering=a.pending>0,this._checkAppendedParsed())}},v._checkAppendedParsed=function(){if(this.state===Se.PARSED&&(!this.appended||!this.pendingBuffering)){var a=this.fragCurrent,f=this.stats,y=this.hls;if(a){this.fragPrevious=a,f.tbuffered=Qt.now(),y.trigger(m.default.FRAG_BUFFERED,{stats:f,frag:a,id:"audio"});var w=this.mediaBuffer?this.mediaBuffer:this.media;w&&_.logger.log("audio buffered : "+Pt.toString(w.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,y.trigger(m.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=Se.IDLE}this.tick()}},v.onError=function(a){var f=a.frag;if(!(f&&f.type!=="audio"))switch(a.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:var y=a.frag;if(y&&y.type!=="audio")break;if(!a.fatal){var w=this.fragLoadError;w?w++:w=1;var C=this.config;if(w<=C.fragLoadingMaxRetry){this.fragLoadError=w;var P=Math.min(Math.pow(2,w-1)*C.fragLoadingRetryDelay,C.fragLoadingMaxRetryTimeout);_.logger.warn("AudioStreamController: frag loading failed, retry in "+P+" ms"),this.retryDate=Qt.now()+P,this.state=Se.FRAG_LOADING_WAITING_RETRY}else _.logger.error("AudioStreamController: "+a.details+" reaches max retry, redispatch as fatal ..."),a.fatal=!0,this.state=Se.ERROR}break;case g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==Se.ERROR&&(this.state=a.fatal?Se.ERROR:Se.IDLE,_.logger.warn("AudioStreamController: "+a.details+" while loading frag, now switching to "+this.state+" state ..."));break;case g.ErrorDetails.BUFFER_FULL_ERROR:if(a.parent==="audio"&&(this.state===Se.PARSING||this.state===Se.PARSED)){var M=this.mediaBuffer,G=this.media.currentTime,K=M&&W.isBuffered(M,G)&&W.isBuffered(M,G+.5);if(K){var ie=this.config;ie.maxMaxBufferLength>=ie.maxBufferLength&&(ie.maxMaxBufferLength/=2,_.logger.warn("AudioStreamController: reduce max buffer length to "+ie.maxMaxBufferLength+"s")),this.state=Se.IDLE}else _.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Se.BUFFER_FLUSHING,this.hls.trigger(m.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}break}},v.onBufferFlushed=function(){var a=this,f=this.pendingData;f&&f.length?(_.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),f.forEach(function(y){a.hls.trigger(m.default.BUFFER_APPENDING,y)}),this.appended=!0,this.pendingData=[],this.state=Se.PARSED):(this.state=Se.IDLE,this.fragPrevious=null,this.tick())},Qn(x,[{key:"state",set:function(a){if(this.state!==a){var f=this.state;this._state=a,_.logger.log("audio stream:"+f+"->"+a)}},get:function(){return this._state}}]),x}(Tr),vs=Fo,ys=function(){if(typeof window<"u"&&window.VTTCue)return window.VTTCue;var R="auto",x={"":!0,lr:!0,rl:!0},v={start:!0,middle:!0,end:!0,left:!0,right:!0};function d(w){if(typeof w!="string")return!1;var C=x[w.toLowerCase()];return C?w.toLowerCase():!1}function a(w){if(typeof w!="string")return!1;var C=v[w.toLowerCase()];return C?w.toLowerCase():!1}function f(w){for(var C=1;C<arguments.length;C++){var P=arguments[C];for(var M in P)w[M]=P[M]}return w}function y(w,C,P){var M=this,G={};G.enumerable=!0,M.hasBeenReset=!1;var K="",ie=!1,Ee=w,be=C,Fe=P,Xe=null,We="",ot=!0,ut="auto",It="start",ur=50,pn="middle",Mr=50,Vt="middle";Object.defineProperty(M,"id",f({},G,{get:function(){return K},set:function(Tt){K=""+Tt}})),Object.defineProperty(M,"pauseOnExit",f({},G,{get:function(){return ie},set:function(Tt){ie=!!Tt}})),Object.defineProperty(M,"startTime",f({},G,{get:function(){return Ee},set:function(Tt){if(typeof Tt!="number")throw new TypeError("Start time must be set to a number.");Ee=Tt,this.hasBeenReset=!0}})),Object.defineProperty(M,"endTime",f({},G,{get:function(){return be},set:function(Tt){if(typeof Tt!="number")throw new TypeError("End time must be set to a number.");be=Tt,this.hasBeenReset=!0}})),Object.defineProperty(M,"text",f({},G,{get:function(){return Fe},set:function(Tt){Fe=""+Tt,this.hasBeenReset=!0}})),Object.defineProperty(M,"region",f({},G,{get:function(){return Xe},set:function(Tt){Xe=Tt,this.hasBeenReset=!0}})),Object.defineProperty(M,"vertical",f({},G,{get:function(){return We},set:function(Tt){var ir=d(Tt);if(ir===!1)throw new SyntaxError("An invalid or illegal string was specified.");We=ir,this.hasBeenReset=!0}})),Object.defineProperty(M,"snapToLines",f({},G,{get:function(){return ot},set:function(Tt){ot=!!Tt,this.hasBeenReset=!0}})),Object.defineProperty(M,"line",f({},G,{get:function(){return ut},set:function(Tt){if(typeof Tt!="number"&&Tt!==R)throw new SyntaxError("An invalid number or illegal string was specified.");ut=Tt,this.hasBeenReset=!0}})),Object.defineProperty(M,"lineAlign",f({},G,{get:function(){return It},set:function(Tt){var ir=a(Tt);if(!ir)throw new SyntaxError("An invalid or illegal string was specified.");It=ir,this.hasBeenReset=!0}})),Object.defineProperty(M,"position",f({},G,{get:function(){return ur},set:function(Tt){if(Tt<0||Tt>100)throw new Error("Position must be between 0 and 100.");ur=Tt,this.hasBeenReset=!0}})),Object.defineProperty(M,"positionAlign",f({},G,{get:function(){return pn},set:function(Tt){var ir=a(Tt);if(!ir)throw new SyntaxError("An invalid or illegal string was specified.");pn=ir,this.hasBeenReset=!0}})),Object.defineProperty(M,"size",f({},G,{get:function(){return Mr},set:function(Tt){if(Tt<0||Tt>100)throw new Error("Size must be between 0 and 100.");Mr=Tt,this.hasBeenReset=!0}})),Object.defineProperty(M,"align",f({},G,{get:function(){return Vt},set:function(Tt){var ir=a(Tt);if(!ir)throw new SyntaxError("An invalid or illegal string was specified.");Vt=ir,this.hasBeenReset=!0}})),M.displayState=void 0}return y.prototype.getCueAsHTML=function(){var w=window.WebVTT;return w.convertCueToDOMTree(window,this.text)},y}(),Mo=function(){return{decode:function(v){if(!v)return"";if(typeof v!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(v))}}};function dn(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new Mo,this.regionList=[]}function Gs(R){function x(d,a,f,y){return(d|0)*3600+(a|0)*60+(f|0)+(y|0)/1e3}var v=R.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return v?v[3]?x(v[1],v[2],v[3].replace(":",""),v[4]):v[1]>59?x(v[1],v[2],0,v[4]):x(0,v[1],v[2],v[4]):null}function nn(){this.values=Object.create(null)}nn.prototype={set:function(x,v){!this.get(x)&&v!==""&&(this.values[x]=v)},get:function(x,v,d){return d?this.has(x)?this.values[x]:v[d]:this.has(x)?this.values[x]:v},has:function(x){return x in this.values},alt:function(x,v,d){for(var a=0;a<d.length;++a)if(v===d[a]){this.set(x,v);break}},integer:function(x,v){/^-?\d+$/.test(v)&&this.set(x,parseInt(v,10))},percent:function(x,v){return v.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(v=parseFloat(v),v>=0&&v<=100)?(this.set(x,v),!0):!1}};function Ks(R,x,v,d){var a=d?R.split(d):[R];for(var f in a)if(typeof a[f]=="string"){var y=a[f].split(v);if(y.length===2){var w=y[0],C=y[1];x(w,C)}}}var Ji=new ys(0,0,0),An=Ji.align==="middle"?"middle":"center";function Uo(R,x,v){var d=R;function a(){var w=Gs(R);if(w===null)throw new Error("Malformed timestamp: "+d);return R=R.replace(/^[^\sa-zA-Z-]+/,""),w}function f(w,C){var P=new nn;Ks(w,function(K,ie){switch(K){case"region":for(var Ee=v.length-1;Ee>=0;Ee--)if(v[Ee].id===ie){P.set(K,v[Ee].region);break}break;case"vertical":P.alt(K,ie,["rl","lr"]);break;case"line":var be=ie.split(","),Fe=be[0];P.integer(K,Fe),P.percent(K,Fe)&&P.set("snapToLines",!1),P.alt(K,Fe,["auto"]),be.length===2&&P.alt("lineAlign",be[1],["start",An,"end"]);break;case"position":be=ie.split(","),P.percent(K,be[0]),be.length===2&&P.alt("positionAlign",be[1],["start",An,"end","line-left","line-right","auto"]);break;case"size":P.percent(K,ie);break;case"align":P.alt(K,ie,["start",An,"end","left","right"]);break}},/:/,/\s/),C.region=P.get("region",null),C.vertical=P.get("vertical","");var M=P.get("line","auto");M==="auto"&&Ji.line===-1&&(M=-1),C.line=M,C.lineAlign=P.get("lineAlign","start"),C.snapToLines=P.get("snapToLines",!0),C.size=P.get("size",100),C.align=P.get("align",An);var G=P.get("position","auto");G==="auto"&&Ji.position===50&&(G=C.align==="start"||C.align==="left"?0:C.align==="end"||C.align==="right"?100:50),C.position=G}function y(){R=R.replace(/^\s+/,"")}if(y(),x.startTime=a(),y(),R.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+d);R=R.substr(3),y(),x.endTime=a(),y(),f(R,x)}function Nr(R){return R.replace(/<br(?: \/)?>/gi,`
`)}dn.prototype={parse:function(x){var v=this;x&&(v.buffer+=v.decoder.decode(x,{stream:!0}));function d(){var P=v.buffer,M=0;for(P=Nr(P);M<P.length&&P[M]!=="\r"&&P[M]!==`
`;)++M;var G=P.substr(0,M);return P[M]==="\r"&&++M,P[M]===`
`&&++M,v.buffer=P.substr(M),G}function a(P){Ks(P,function(M,G){},/:/)}try{var f;if(v.state==="INITIAL"){if(!/\r\n|\n/.test(v.buffer))return this;f=d();var y=f.match(/^()?WEBVTT([ \t].*)?$/);if(!y||!y[0])throw new Error("Malformed WebVTT signature.");v.state="HEADER"}for(var w=!1;v.buffer;){if(!/\r\n|\n/.test(v.buffer))return this;switch(w?w=!1:f=d(),v.state){case"HEADER":/:/.test(f)?a(f):f||(v.state="ID");continue;case"NOTE":f||(v.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(f)){v.state="NOTE";break}if(!f)continue;if(v.cue=new ys(0,0,""),v.state="CUE",f.indexOf("-->")===-1){v.cue.id=f;continue}case"CUE":try{Uo(f,v.cue,v.regionList)}catch{v.cue=null,v.state="BADCUE";continue}v.state="CUETEXT";continue;case"CUETEXT":var C=f.indexOf("-->")!==-1;if(!f||C&&(w=!0)){v.oncue&&v.oncue(v.cue),v.cue=null,v.state="ID";continue}v.cue.text&&(v.cue.text+=`
`),v.cue.text+=f;continue;case"BADCUE":f||(v.state="ID");continue}}}catch{v.state==="CUETEXT"&&v.cue&&v.oncue&&v.oncue(v.cue),v.cue=null,v.state=v.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var x=this;try{if(x.buffer+=x.decoder.decode(),(x.cue||x.state==="HEADER")&&(x.buffer+=`

`,x.parse()),x.state==="INITIAL")throw new Error("Malformed WebVTT signature.")}catch(v){throw v}return x.onflush&&x.onflush(),this}};var Xn=dn;function Hs(R,x,v,d){for(var a=[],f,y,w,C,P,M=window.VTTCue||TextTrackCue,G=0;G<d.rows.length;G++)if(f=d.rows[G],w=!0,C=0,P="",!f.isEmpty()){for(var K=0;K<f.chars.length;K++)f.chars[K].uchar.match(/\s/)&&w?C++:(P+=f.chars[K].uchar,w=!1);f.cueStartTime=x,x===v&&(v+=1e-4),y=new M(x,v,Nr(P.trim())),C>=16?C--:C++,navigator.userAgent.match(/Firefox\//)?y.line=G+1:y.line=G>7?G-2:G+1,y.align="left",y.position=Math.max(0,Math.min(100,100*(C/32))),a.push(y),R&&R.addCue(y)}return a}var Jn={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},wa=function(x){var v=x;return Jn.hasOwnProperty(x)&&(v=Jn[x]),String.fromCharCode(v)},Qr=15,Gr=100,Zi={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},_s={17:2,18:4,21:6,22:8,23:10,19:13,20:15},$s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Vo={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Sa=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Et;(function(R){R[R.ERROR=0]="ERROR",R[R.TEXT=1]="TEXT",R[R.WARNING=2]="WARNING",R[R.INFO=2]="INFO",R[R.DEBUG=3]="DEBUG",R[R.DATA=3]="DATA"})(Et||(Et={}));var Ws=function(){function R(){this.time=null,this.verboseLevel=Et.ERROR}var x=R.prototype;return x.log=function(d,a){this.verboseLevel>=d&&_.logger.log(this.time+" ["+d+"] "+a)},R}(),ci=function(x){for(var v=[],d=0;d<x.length;d++)v.push(x[d].toString(16));return v},fi=function(){function R(v,d,a,f,y){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=v||"white",this.underline=d||!1,this.italics=a||!1,this.background=f||"black",this.flash=y||!1}var x=R.prototype;return x.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},x.setStyles=function(d){for(var a=["foreground","underline","italics","background","flash"],f=0;f<a.length;f++){var y=a[f];d.hasOwnProperty(y)&&(this[y]=d[y])}},x.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},x.equals=function(d){return this.foreground===d.foreground&&this.underline===d.underline&&this.italics===d.italics&&this.background===d.background&&this.flash===d.flash},x.copy=function(d){this.foreground=d.foreground,this.underline=d.underline,this.italics=d.italics,this.background=d.background,this.flash=d.flash},x.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},R}(),Aa=function(){function R(v,d,a,f,y,w){this.uchar=void 0,this.penState=void 0,this.uchar=v||" ",this.penState=new fi(d,a,f,y,w)}var x=R.prototype;return x.reset=function(){this.uchar=" ",this.penState.reset()},x.setChar=function(d,a){this.uchar=d,this.penState.copy(a)},x.setPenState=function(d){this.penState.copy(d)},x.equals=function(d){return this.uchar===d.uchar&&this.penState.equals(d.penState)},x.copy=function(d){this.uchar=d.uchar,this.penState.copy(d.penState)},x.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},R}(),Ra=function(){function R(v){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var d=0;d<Gr;d++)this.chars.push(new Aa);this.logger=v,this.pos=0,this.currPenState=new fi}var x=R.prototype;return x.equals=function(d){for(var a=!0,f=0;f<Gr;f++)if(!this.chars[f].equals(d.chars[f])){a=!1;break}return a},x.copy=function(d){for(var a=0;a<Gr;a++)this.chars[a].copy(d.chars[a])},x.isEmpty=function(){for(var d=!0,a=0;a<Gr;a++)if(!this.chars[a].isEmpty()){d=!1;break}return d},x.setCursor=function(d){this.pos!==d&&(this.pos=d),this.pos<0?(this.logger.log(Et.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>Gr&&(this.logger.log(Et.DEBUG,"Too large cursor position "+this.pos),this.pos=Gr)},x.moveCursor=function(d){var a=this.pos+d;if(d>1)for(var f=this.pos+1;f<a+1;f++)this.chars[f].setPenState(this.currPenState);this.setCursor(a)},x.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},x.insertChar=function(d){d>=144&&this.backSpace();var a=wa(d);if(this.pos>=Gr){this.logger.log(Et.ERROR,"Cannot insert "+d.toString(16)+" ("+a+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(a,this.currPenState),this.moveCursor(1)},x.clearFromPos=function(d){var a;for(a=d;a<Gr;a++)this.chars[a].reset()},x.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},x.clearToEndOfRow=function(){this.clearFromPos(this.pos)},x.getTextString=function(){for(var d=[],a=!0,f=0;f<Gr;f++){var y=this.chars[f].uchar;y!==" "&&(a=!1),d.push(y)}return a?"":d.join("")},x.setPenStyles=function(d){this.currPenState.setStyles(d);var a=this.chars[this.pos];a.setPenState(this.currPenState)},R}(),qs=function(){function R(v){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var d=0;d<Qr;d++)this.rows.push(new Ra(v));this.logger=v,this.currRow=Qr-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var x=R.prototype;return x.reset=function(){for(var d=0;d<Qr;d++)this.rows[d].clear();this.currRow=Qr-1},x.equals=function(d){for(var a=!0,f=0;f<Qr;f++)if(!this.rows[f].equals(d.rows[f])){a=!1;break}return a},x.copy=function(d){for(var a=0;a<Qr;a++)this.rows[a].copy(d.rows[a])},x.isEmpty=function(){for(var d=!0,a=0;a<Qr;a++)if(!this.rows[a].isEmpty()){d=!1;break}return d},x.backSpace=function(){var d=this.rows[this.currRow];d.backSpace()},x.clearToEndOfRow=function(){var d=this.rows[this.currRow];d.clearToEndOfRow()},x.insertChar=function(d){var a=this.rows[this.currRow];a.insertChar(d)},x.setPen=function(d){var a=this.rows[this.currRow];a.setPenStyles(d)},x.moveCursor=function(d){var a=this.rows[this.currRow];a.moveCursor(d)},x.setCursor=function(d){this.logger.log(Et.INFO,"setCursor: "+d);var a=this.rows[this.currRow];a.setCursor(d)},x.setPAC=function(d){this.logger.log(Et.INFO,"pacData = "+JSON.stringify(d));var a=d.row-1;if(this.nrRollUpRows&&a<this.nrRollUpRows-1&&(a=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==a){for(var f=0;f<Qr;f++)this.rows[f].clear();var y=this.currRow+1-this.nrRollUpRows,w=this.lastOutputScreen;if(w){var C=w.rows[y].cueStartTime,P=this.logger.time;if(C&&P!==null&&C<P)for(var M=0;M<this.nrRollUpRows;M++)this.rows[a-this.nrRollUpRows+M+1].copy(w.rows[y+M])}}this.currRow=a;var G=this.rows[this.currRow];if(d.indent!==null){var K=d.indent,ie=Math.max(K-1,0);G.setCursor(d.indent),d.color=G.chars[ie].penState.foreground}var Ee={foreground:d.color,underline:d.underline,italics:d.italics,background:"black",flash:!1};this.setPen(Ee)},x.setBkgData=function(d){this.logger.log(Et.INFO,"bkgData = "+JSON.stringify(d)),this.backSpace(),this.setPen(d),this.insertChar(32)},x.setRollUpRows=function(d){this.nrRollUpRows=d},x.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(Et.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(Et.TEXT,this.getDisplayText());var d=this.currRow+1-this.nrRollUpRows,a=this.rows.splice(d,1)[0];a.clear(),this.rows.splice(this.currRow,0,a),this.logger.log(Et.INFO,"Rolling up")},x.getDisplayText=function(d){d=d||!1;for(var a=[],f="",y=-1,w=0;w<Qr;w++){var C=this.rows[w].getTextString();C&&(y=w+1,d?a.push("Row "+y+": '"+C+"'"):a.push(C.trim()))}return a.length>0&&(d?f="["+a.join(" | ")+"]":f=a.join(`
`)),f},x.getTextAndFormat=function(){return this.rows},R}(),Ys=function(){function R(v,d,a){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=v,this.outputFilter=d,this.mode=null,this.verbose=0,this.displayedMemory=new qs(a),this.nonDisplayedMemory=new qs(a),this.lastOutputScreen=new qs(a),this.currRollUpRow=this.displayedMemory.rows[Qr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=a}var x=R.prototype;return x.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Qr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},x.getHandler=function(){return this.outputFilter},x.setHandler=function(d){this.outputFilter=d},x.setPAC=function(d){this.writeScreen.setPAC(d)},x.setBkgData=function(d){this.writeScreen.setBkgData(d)},x.setMode=function(d){d!==this.mode&&(this.mode=d,this.logger.log(Et.INFO,"MODE="+d),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=d)},x.insertChars=function(d){for(var a=0;a<d.length;a++)this.writeScreen.insertChar(d[a]);var f=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(Et.INFO,f+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(Et.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},x.ccRCL=function(){this.logger.log(Et.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},x.ccBS=function(){this.logger.log(Et.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},x.ccAOF=function(){},x.ccAON=function(){},x.ccDER=function(){this.logger.log(Et.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},x.ccRU=function(d){this.logger.log(Et.INFO,"RU("+d+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(d)},x.ccFON=function(){this.logger.log(Et.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},x.ccRDC=function(){this.logger.log(Et.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},x.ccTR=function(){this.logger.log(Et.INFO,"TR"),this.setMode("MODE_TEXT")},x.ccRTD=function(){this.logger.log(Et.INFO,"RTD"),this.setMode("MODE_TEXT")},x.ccEDM=function(){this.logger.log(Et.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},x.ccCR=function(){this.logger.log(Et.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},x.ccENM=function(){this.logger.log(Et.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},x.ccEOC=function(){if(this.logger.log(Et.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var d=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=d,this.writeScreen=this.nonDisplayedMemory,this.logger.log(Et.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},x.ccTO=function(d){this.logger.log(Et.INFO,"TO("+d+") - Tab Offset"),this.writeScreen.moveCursor(d)},x.ccMIDROW=function(d){var a={flash:!1};if(a.underline=d%2===1,a.italics=d>=46,a.italics)a.foreground="white";else{var f=Math.floor(d/2)-16,y=["white","green","blue","cyan","red","yellow","magenta"];a.foreground=y[f]}this.logger.log(Et.INFO,"MIDROW: "+JSON.stringify(a)),this.writeScreen.setPen(a)},x.outputDataUpdate=function(d){d===void 0&&(d=!1);var a=this.logger.time;a!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=a:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,a,this.lastOutputScreen),d&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:a),this.lastOutputScreen.copy(this.displayedMemory))},x.cueSplitAtTime=function(d){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,d,this.displayedMemory),this.cueStartTime=d))},R}(),Qs=function(){function R(v,d,a){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var f=new Ws;this.channels=[null,new Ys(v,d,f),new Ys(v+1,a,f)],this.cmdHistory=jo(),this.logger=f}var x=R.prototype;return x.getHandler=function(d){return this.channels[d].getHandler()},x.setHandler=function(d,a){this.channels[d].setHandler(a)},x.addData=function(d,a){var f,y,w,C=!1;this.logger.time=d;for(var P=0;P<a.length;P+=2)if(y=a[P]&127,w=a[P+1]&127,!(y===0&&w===0)){if(this.logger.log(Et.DATA,"["+ci([a[P],a[P+1]])+"] -> ("+ci([y,w])+")"),f=this.parseCmd(y,w),f||(f=this.parseMidrow(y,w)),f||(f=this.parsePAC(y,w)),f||(f=this.parseBackgroundAttributes(y,w)),!f&&(C=this.parseChars(y,w),C)){var M=this.currentChannel;if(M&&M>0){var G=this.channels[M];G.insertChars(C)}else this.logger.log(Et.WARNING,"No channel found yet. TEXT-MODE?")}!f&&!C&&this.logger.log(Et.WARNING,"Couldn't parse cleaned data "+ci([y,w])+" orig: "+ci([a[P],a[P+1]]))}},x.parseCmd=function(d,a){var f=this.cmdHistory,y=(d===20||d===28||d===21||d===29)&&a>=32&&a<=47,w=(d===23||d===31)&&a>=33&&a<=35;if(!(y||w))return!1;if(Bo(d,a,f))return xr(null,null,f),this.logger.log(Et.DEBUG,"Repeated command ("+ci([d,a])+") is dropped"),!0;var C=d===20||d===21||d===23?1:2,P=this.channels[C];return d===20||d===21||d===28||d===29?a===32?P.ccRCL():a===33?P.ccBS():a===34?P.ccAOF():a===35?P.ccAON():a===36?P.ccDER():a===37?P.ccRU(2):a===38?P.ccRU(3):a===39?P.ccRU(4):a===40?P.ccFON():a===41?P.ccRDC():a===42?P.ccTR():a===43?P.ccRTD():a===44?P.ccEDM():a===45?P.ccCR():a===46?P.ccENM():a===47&&P.ccEOC():P.ccTO(a-32),xr(d,a,f),this.currentChannel=C,!0},x.parseMidrow=function(d,a){var f=0;if((d===17||d===25)&&a>=32&&a<=47){if(d===17?f=1:f=2,f!==this.currentChannel)return this.logger.log(Et.ERROR,"Mismatch channel in midrow parsing"),!1;var y=this.channels[f];return y?(y.ccMIDROW(a),this.logger.log(Et.DEBUG,"MIDROW ("+ci([d,a])+")"),!0):!1}return!1},x.parsePAC=function(d,a){var f,y=this.cmdHistory,w=(d>=17&&d<=23||d>=25&&d<=31)&&a>=64&&a<=127,C=(d===16||d===24)&&a>=64&&a<=95;if(!(w||C))return!1;if(Bo(d,a,y))return xr(null,null,y),!0;var P=d<=23?1:2;a>=64&&a<=95?f=P===1?Zi[d]:$s[d]:f=P===1?_s[d]:Vo[d];var M=this.channels[P];return M?(M.setPAC(this.interpretPAC(f,a)),xr(d,a,y),this.currentChannel=P,!0):!1},x.interpretPAC=function(d,a){var f=a,y={color:null,italics:!1,indent:null,underline:!1,row:d};return a>95?f=a-96:f=a-64,y.underline=(f&1)===1,f<=13?y.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(f/2)]:f<=15?(y.italics=!0,y.color="white"):y.indent=Math.floor((f-16)/2)*4,y},x.parseChars=function(d,a){var f,y=null,w=null;if(d>=25?(f=2,w=d-8):(f=1,w=d),w>=17&&w<=19){var C=a;w===17?C=a+80:w===18?C=a+112:C=a+144,this.logger.log(Et.INFO,"Special char '"+wa(C)+"' in channel "+f),y=[C]}else d>=32&&d<=127&&(y=a===0?[d]:[d,a]);if(y){var P=ci(y);this.logger.log(Et.DEBUG,"Char codes =  "+P.join(",")),xr(d,a,this.cmdHistory)}return y},x.parseBackgroundAttributes=function(d,a){var f=(d===16||d===24)&&a>=32&&a<=47,y=(d===23||d===31)&&a>=45&&a<=47;if(!(f||y))return!1;var w,C={};d===16||d===24?(w=Math.floor((a-32)/2),C.background=Sa[w],a%2===1&&(C.background=C.background+"_semi")):a===45?C.background="transparent":(C.foreground="black",a===47&&(C.underline=!0));var P=d<=23?1:2,M=this.channels[P];return M.setBkgData(C),xr(d,a,this.cmdHistory),!0},x.reset=function(){for(var d=0;d<Object.keys(this.channels).length;d++){var a=this.channels[d];a&&a.reset()}this.cmdHistory=jo()},x.cueSplitAtTime=function(d){for(var a=0;a<this.channels.length;a++){var f=this.channels[a];f&&f.cueSplitAtTime(d)}},R}();function xr(R,x,v){v.a=R,v.b=x}function Bo(R,x,v){return v.a===R&&v.b===x}function jo(){return{a:null,b:null}}var Zn=Qs,c=function(){function R(v,d){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=v,this.trackName=d}var x=R.prototype;return x.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},x.newCue=function(d,a,f){(this.startTime===null||this.startTime>d)&&(this.startTime=d),this.endTime=a,this.screen=f,this.timelineController.createCaptionsTrack(this.trackName)},x.reset=function(){this.cueRanges=[]},R}(),S=function(x,v,d){return x.substr(0,v.length)===v},b=function(x){var v=parseInt(x.substr(-3)),d=parseInt(x.substr(-6,2)),a=parseInt(x.substr(-9,2)),f=x.length>9?parseInt(x.substr(0,x.indexOf(":"))):0;if(!Object(T.isFiniteNumber)(v)||!Object(T.isFiniteNumber)(d)||!Object(T.isFiniteNumber)(a)||!Object(T.isFiniteNumber)(f))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+x);return v+=1e3*d,v+=60*1e3*a,v+=60*60*1e3*f,v},V=function(x){for(var v=5381,d=x.length;d;)v=v*33^x.charCodeAt(--d);return(v>>>0).toString()},de=function(x,v,d){var a=x[v],f=x[a.prevCC];if(!f||!f.new&&a.new){x.ccOffset=x.presentationOffset=a.start,a.new=!1;return}for(;f&&f.new;)x.ccOffset+=a.start-f.start,a.new=!1,a=f,f=x[a.prevCC];x.presentationOffset=d},xe={parse:function(x,v,d,a,f,y){var w=/\r\n|\n\r|\n|\r/g,C=Object($n.utf8ArrayToStr)(new Uint8Array(x)).trim().replace(w,`
`).split(`
`),P="00:00.000",M=0,G=0,K=0,ie=[],Ee,be=!0,Fe=!1,Xe=new Xn;Xe.oncue=function(We){var ot=d[a],ut=d.ccOffset;ot&&ot.new&&(G!==void 0?ut=d.ccOffset=ot.start:de(d,a,K)),K&&(ut=K-d.presentationOffset),Fe&&(We.startTime+=ut-G,We.endTime+=ut-G),We.id=V(We.startTime.toString())+V(We.endTime.toString())+V(We.text),We.text=decodeURIComponent(encodeURIComponent(We.text)),We.endTime>0&&ie.push(We)},Xe.onparsingerror=function(We){Ee=We},Xe.onflush=function(){if(Ee&&y){y(Ee);return}f(ie)},C.forEach(function(We){if(be)if(S(We,"X-TIMESTAMP-MAP=")){be=!1,Fe=!0,We.substr(16).split(",").forEach(function(ot){S(ot,"LOCAL:")?P=ot.substr(6):S(ot,"MPEGTS:")&&(M=parseInt(ot.substr(7)))});try{v+(d[a].start*9e4||0)<0&&(v+=8589934592),M-=v,G=b(P)/1e3,K=M/9e4}catch(ot){Fe=!1,Ee=ot}return}else We===""&&(be=!1);Xe.parse(We+`
`)}),Xe.flush()}},Ge=xe;function jt(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function Rr(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var Mt=function(R){Rr(x,R);function x(d){var a;if(a=R.call(this,d,m.default.MEDIA_ATTACHING,m.default.MEDIA_DETACHING,m.default.FRAG_PARSING_USERDATA,m.default.FRAG_DECRYPTED,m.default.MANIFEST_LOADING,m.default.MANIFEST_LOADED,m.default.FRAG_LOADED,m.default.INIT_PTS_FOUND)||this,a.media=null,a.config=void 0,a.enabled=!0,a.Cues=void 0,a.textTracks=[],a.tracks=[],a.initPTS=[],a.unparsedVttFrags=[],a.captionsTracks={},a.nonNativeCaptionsTracks={},a.captionsProperties=void 0,a.cea608Parser1=void 0,a.cea608Parser2=void 0,a.lastSn=-1,a.prevCC=-1,a.vttCCs=Rn(),a.hls=d,a.config=d.config,a.Cues=d.config.cueHandler,a.captionsProperties={textTrack1:{label:a.config.captionsTextTrack1Label,languageCode:a.config.captionsTextTrack1LanguageCode},textTrack2:{label:a.config.captionsTextTrack2Label,languageCode:a.config.captionsTextTrack2LanguageCode},textTrack3:{label:a.config.captionsTextTrack3Label,languageCode:a.config.captionsTextTrack3LanguageCode},textTrack4:{label:a.config.captionsTextTrack4Label,languageCode:a.config.captionsTextTrack4LanguageCode}},a.config.enableCEA708Captions){var f=new c(jt(a),"textTrack1"),y=new c(jt(a),"textTrack2"),w=new c(jt(a),"textTrack3"),C=new c(jt(a),"textTrack4");a.cea608Parser1=new Zn(1,f,y),a.cea608Parser2=new Zn(3,w,C)}return a}var v=x.prototype;return v.addCues=function(a,f,y,w,C){for(var P=!1,M=C.length;M--;){var G=C[M],K=wr(G[0],G[1],f,y);if(K>=0&&(G[0]=Math.min(G[0],f),G[1]=Math.max(G[1],y),P=!0,K/(y-f)>.5))return}if(P||C.push([f,y]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[a],f,y,w);else{var ie=this.Cues.newCue(null,f,y,w);this.hls.trigger(m.default.CUES_PARSED,{type:"captions",cues:ie,track:a})}},v.onInitPtsFound=function(a){var f=this,y=a.frag,w=a.id,C=a.initPTS,P=this.unparsedVttFrags;w==="main"&&(this.initPTS[y.cc]=C),P.length&&(this.unparsedVttFrags=[],P.forEach(function(M){f.onFragLoaded(M)}))},v.getExistingTrack=function(a){var f=this.media;if(f)for(var y=0;y<f.textTracks.length;y++){var w=f.textTracks[y];if(w[a])return w}return null},v.createCaptionsTrack=function(a){this.config.renderTextTracksNatively?this.createNativeTrack(a):this.createNonNativeTrack(a)},v.createNativeTrack=function(a){if(!this.captionsTracks[a]){var f=this.captionsProperties,y=this.captionsTracks,w=this.media,C=f[a],P=C.label,M=C.languageCode,G=this.getExistingTrack(a);if(G)y[a]=G,ai(y[a]),Lr(y[a],w);else{var K=this.createTextTrack("captions",P,M);K&&(K[a]=!0,y[a]=K)}}},v.createNonNativeTrack=function(a){if(!this.nonNativeCaptionsTracks[a]){var f=this.captionsProperties[a];if(f){var y=f.label,w={_id:a,label:y,kind:"captions",default:f.media?!!f.media.default:!1,closedCaptions:f.media};this.nonNativeCaptionsTracks[a]=w,this.hls.trigger(m.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[w]})}}},v.createTextTrack=function(a,f,y){var w=this.media;if(w)return w.addTextTrack(a,f,y)},v.destroy=function(){R.prototype.destroy.call(this)},v.onMediaAttaching=function(a){this.media=a.media,this._cleanTracks()},v.onMediaDetaching=function(){var a=this.captionsTracks;Object.keys(a).forEach(function(f){ai(a[f]),delete a[f]}),this.nonNativeCaptionsTracks={}},v.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs=Rn(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},v._cleanTracks=function(){var a=this.media;if(a){var f=a.textTracks;if(f)for(var y=0;y<f.length;y++)ai(f[y])}},v.onManifestLoaded=function(a){var f=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var y=a.subtitles||[],w=this.tracks&&y&&this.tracks.length===y.length;if(this.tracks=a.subtitles||[],this.config.renderTextTracksNatively){var C=this.media?this.media.textTracks:[];this.tracks.forEach(function(M,G){var K;if(G<C.length){for(var ie=null,Ee=0;Ee<C.length;Ee++)if(Fr(C[Ee],M)){ie=C[Ee];break}ie&&(K=ie)}K||(K=f.createTextTrack("subtitles",M.name,M.lang)),M.default?K.mode=f.hls.subtitleDisplay?"showing":"hidden":K.mode="disabled",f.textTracks.push(K)})}else if(!w&&this.tracks&&this.tracks.length){var P=this.tracks.map(function(M){return{label:M.name,kind:M.type.toLowerCase(),default:M.default,subtitleTrack:M}});this.hls.trigger(m.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:P})}}this.config.enableCEA708Captions&&a.captions&&a.captions.forEach(function(M){var G=/(?:CC|SERVICE)([1-4])/.exec(M.instreamId);if(G){var K="textTrack"+G[1],ie=f.captionsProperties[K];ie&&(ie.label=M.name,M.lang&&(ie.languageCode=M.lang),ie.media=M)}})},v.onFragLoaded=function(a){var f=a.frag,y=a.payload,w=this.cea608Parser1,C=this.cea608Parser2,P=this.initPTS,M=this.lastSn,G=this.unparsedVttFrags;if(f.type==="main"){var K=f.sn;f.sn!==M+1&&w&&C&&(w.reset(),C.reset()),this.lastSn=K}else if(f.type==="subtitle")if(y.byteLength){if(!Object(T.isFiniteNumber)(P[f.cc])){G.push(a),P.length&&this.hls.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f});return}var ie=f.decryptdata;(ie==null||ie.key==null||ie.method!=="AES-128")&&this._parseVTTs(f,y)}else this.hls.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f})},v._parseVTTs=function(a,f){var y=this,w=this.hls,C=this.prevCC,P=this.textTracks,M=this.vttCCs;M[a.cc]||(M[a.cc]={start:a.start,prevCC:C,new:!0},this.prevCC=a.cc),Ge.parse(f,this.initPTS[a.cc],M,a.cc,function(G){if(y.config.renderTextTracksNatively){var K=P[a.level];if(K.mode==="disabled"){w.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a});return}G.forEach(function(Ee){if(!K.cues.getCueById(Ee.id))try{if(K.addCue(Ee),!K.cues.getCueById(Ee.id))throw new Error("addCue is failed for: "+Ee)}catch(Fe){_.logger.debug("Failed occurred on adding cues: "+Fe);var be=new window.TextTrackCue(Ee.startTime,Ee.endTime,Ee.text);be.id=Ee.id,K.addCue(be)}})}else{var ie=y.tracks[a.level].default?"default":"subtitles"+a.level;w.trigger(m.default.CUES_PARSED,{type:"subtitles",cues:G,track:ie})}w.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:a})},function(G){_.logger.log("Failed to parse VTT cue: "+G),w.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a})})},v.onFragDecrypted=function(a){var f=a.frag,y=a.payload;if(f.type==="subtitle"){if(!Object(T.isFiniteNumber)(this.initPTS[f.cc])){this.unparsedVttFrags.push(a);return}this._parseVTTs(f,y)}},v.onFragParsingUserdata=function(a){var f=this.cea608Parser1,y=this.cea608Parser2;if(!(!this.enabled||!(f&&y)))for(var w=0;w<a.samples.length;w++){var C=a.samples[w].bytes;if(C){var P=this.extractCea608Data(C);f.addData(a.samples[w].pts,P[0]),y.addData(a.samples[w].pts,P[1])}}},v.extractCea608Data=function(a){for(var f=a[0]&31,y=2,w=[[],[]],C=0;C<f;C++){var P=a[y++],M=127&a[y++],G=127&a[y++],K=(4&P)!==0,ie=3&P;M===0&&G===0||K&&(ie===0||ie===1)&&(w[ie].push(M),w[ie].push(G))}return w},x}(D);function Fr(R,x){return R&&R.label===x.name&&!(R.textTrack1||R.textTrack2)}function wr(R,x,v,d){return Math.min(x,d)-Math.max(R,v)}function Rn(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}var In=Mt;function Es(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function Xs(R,x,v){return x&&Es(R.prototype,x),R}function Tu(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var xu=function(R){Tu(x,R);function x(d){var a;return a=R.call(this,d,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.MANIFEST_LOADED,m.default.SUBTITLE_TRACK_LOADED)||this,a.tracks=[],a.trackId=-1,a.media=null,a.stopped=!0,a.subtitleDisplay=!0,a.queuedDefaultTrack=null,a}var v=x.prototype;return v.destroy=function(){D.prototype.destroy.call(this)},v.onMediaAttached=function(a){var f=this;this.media=a.media,this.media&&(Object(T.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){f.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},v.onMediaDetaching=function(){if(this.media){this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(T.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack);var a=Ia(this.media.textTracks);a.forEach(function(f){ai(f)}),this.subtitleTrack=-1,this.media=null}},v.onManifestLoaded=function(a){var f=this,y=a.subtitles||[];this.tracks=y,this.hls.trigger(m.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:y}),y.forEach(function(w){w.default&&(f.media?f.subtitleTrack=w.id:f.queuedDefaultTrack=w.id)})},v.onSubtitleTrackLoaded=function(a){var f=this,y=a.id,w=a.details,C=this.trackId,P=this.tracks,M=P[C];if(y>=P.length||y!==C||!M||this.stopped){this._clearReloadTimer();return}if(_.logger.log("subtitle track "+y+" loaded"),w.live){var G=st(M.details,w,a.stats.trequest);_.logger.log("Reloading live subtitle playlist in "+G+"ms"),this.timer=setTimeout(function(){f._loadCurrentTrack()},G)}else this._clearReloadTimer()},v.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},v.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},v._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},v._loadCurrentTrack=function(){var a=this.trackId,f=this.tracks,y=this.hls,w=f[a];a<0||!w||w.details&&!w.details.live||(_.logger.log("Loading subtitle track "+a),y.trigger(m.default.SUBTITLE_TRACK_LOADING,{url:w.url,id:a}))},v._toggleTrackModes=function(a){var f=this.media,y=this.subtitleDisplay,w=this.trackId;if(f){var C=Ia(f.textTracks);if(a===-1)[].slice.call(C).forEach(function(G){G.mode="disabled"});else{var P=C[w];P&&(P.mode="disabled")}var M=C[a];M&&(M.mode=y?"showing":"hidden")}},v._setSubtitleTrackInternal=function(a){var f=this.hls,y=this.tracks;!Object(T.isFiniteNumber)(a)||a<-1||a>=y.length||(this.trackId=a,_.logger.log("Switching to subtitle track "+a),f.trigger(m.default.SUBTITLE_TRACK_SWITCH,{id:a}),this._loadCurrentTrack())},v._onTextTracksChanged=function(){if(!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var a=-1,f=Ia(this.media.textTracks),y=0;y<f.length;y++)if(f[y].mode==="hidden")a=y;else if(f[y].mode==="showing"){a=y;break}this.subtitleTrack=a}},Xs(x,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(a){this.trackId!==a&&(this._toggleTrackModes(a),this._setSubtitleTrackInternal(a))}}]),x}(D);function Ia(R){for(var x=[],v=0;v<R.length;v++){var d=R[v];d.kind==="subtitles"&&d.label&&x.push(R[v])}return x}var Js=xu,Mf=o("./src/crypt/decrypter.js");function Uf(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function Vf(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var wu=window,Tl=wu.performance,Ts=500,zo=function(R){Vf(x,R);function x(d,a){var f;return f=R.call(this,d,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.ERROR,m.default.KEY_LOADED,m.default.FRAG_LOADED,m.default.SUBTITLE_TRACKS_UPDATED,m.default.SUBTITLE_TRACK_SWITCH,m.default.SUBTITLE_TRACK_LOADED,m.default.SUBTITLE_FRAG_PROCESSED,m.default.LEVEL_UPDATED)||this,f.fragmentTracker=a,f.config=d.config,f.state=Se.STOPPED,f.tracks=[],f.tracksBuffered=[],f.currentTrackId=-1,f.decrypter=new Mf.default(d,d.config),f.lastAVStart=0,f._onMediaSeeking=f.onMediaSeeking.bind(Uf(f)),f}var v=x.prototype;return v.startLoad=function(){this.stopLoad(),this.state=Se.IDLE;var a=this.tracks[this.currentTrackId];a&&a.details&&(this.setInterval(Ts),this.tick())},v.onSubtitleFragProcessed=function(a){var f=a.frag,y=a.success;if(this.fragPrevious=f,this.state=Se.IDLE,!!y){var w=this.tracksBuffered[this.currentTrackId];if(w){for(var C,P=f.start,M=0;M<w.length;M++)if(P>=w[M].start&&P<=w[M].end){C=w[M];break}var G=f.start+f.duration;C?C.end=G:(C={start:P,end:G},w.push(C))}}},v.onMediaAttached=function(a){var f=a.media;this.media=f,f.addEventListener("seeking",this._onMediaSeeking),this.state=Se.IDLE},v.onMediaDetaching=function(){var a=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach(function(f){a.tracksBuffered[f.id]=[]}),this.media=null,this.state=Se.STOPPED)},v.onError=function(a){var f=a.frag;!f||f.type!=="subtitle"||(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=Se.IDLE)},v.onSubtitleTracksUpdated=function(a){var f=this;_.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=a.subtitleTracks,this.tracks.forEach(function(y){f.tracksBuffered[y.id]=[]})},v.onSubtitleTrackSwitch=function(a){if(this.currentTrackId=a.id,!this.tracks||!this.tracks.length||this.currentTrackId===-1){this.clearInterval();return}var f=this.tracks[this.currentTrackId];f&&f.details&&this.setInterval(Ts)},v.onSubtitleTrackLoaded=function(a){var f=a.id,y=a.details,w=this.currentTrackId,C=this.tracks,P=C[w];f>=C.length||f!==w||!P||(y.live&&$e(P.details,y,this.lastAVStart),P.details=y,this.setInterval(Ts))},v.onKeyLoaded=function(){this.state===Se.KEY_LOADING&&(this.state=Se.IDLE)},v.onFragLoaded=function(a){var f=this.fragCurrent,y=a.frag.decryptdata,w=a.frag,C=this.hls;if(this.state===Se.FRAG_LOADING&&f&&a.frag.type==="subtitle"&&f.sn===a.frag.sn&&a.payload.byteLength>0&&y&&y.key&&y.method==="AES-128"){var P=Tl.now();this.decrypter.decrypt(a.payload,y.key.buffer,y.iv.buffer,function(M){var G=Tl.now();C.trigger(m.default.FRAG_DECRYPTED,{frag:w,payload:M,stats:{tstart:P,tdecrypt:G}})})}},v.onLevelUpdated=function(a){var f=a.details,y=f.fragments;this.lastAVStart=y.length?y[0].start:0},v.doTick=function(){if(!this.media){this.state=Se.IDLE;return}switch(this.state){case Se.IDLE:{var a=this.config,f=this.currentTrackId,y=this.fragmentTracker,w=this.media,C=this.tracks;if(!C||!C[f]||!C[f].details)break;var P=a.maxBufferHole,M=a.maxFragLookUpTolerance,G=Math.min(a.maxBufferLength,a.maxMaxBufferLength),K=W.bufferedInfo(this._getBuffered(),w.currentTime,P),ie=K.end,Ee=K.len,be=C[f].details,Fe=be.fragments,Xe=Fe.length,We=Fe[Xe-1].start+Fe[Xe-1].duration;if(Ee>G)return;var ot,ut=this.fragPrevious;ie<We?(ut&&be.hasProgramDateTime&&(ot=rr(Fe,ut.endProgramDateTime,M)),ot||(ot=tr(ut,Fe,ie,M))):ot=Fe[Xe-1],ot&&ot.encrypted?(_.logger.log("Loading key for "+ot.sn),this.state=Se.KEY_LOADING,this.hls.trigger(m.default.KEY_LOADING,{frag:ot})):ot&&y.getState(ot)===dr.NOT_LOADED&&(this.fragCurrent=ot,this.state=Se.FRAG_LOADING,this.hls.trigger(m.default.FRAG_LOADING,{frag:ot}))}}},v.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,R.prototype.stopLoad.call(this)},v._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},v.onMediaSeeking=function(){if(this.fragCurrent){var a=this.media?this.media.currentTime:0,f=this.config.maxFragLookUpTolerance,y=this.fragCurrent.start-f,w=this.fragCurrent.start+this.fragCurrent.duration+f;(a<y||a>w)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=Se.IDLE,this.tick())}},x}(Tr),Zs;(function(R){R.WIDEVINE="com.widevine.alpha",R.PLAYREADY="com.microsoft.playready"})(Zs||(Zs={}));var Ca=function(){return typeof window<"u"&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null}();function Bf(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function Su(R,x,v){return x&&Bf(R.prototype,x),R}function xl(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var Pa=3,Au=function(x,v,d){var a={audioCapabilities:[],videoCapabilities:[]};return x.forEach(function(f){a.audioCapabilities.push({contentType:'audio/mp4; codecs="'+f+'"',robustness:d.audioRobustness||""})}),v.forEach(function(f){a.videoCapabilities.push({contentType:'video/mp4; codecs="'+f+'"',robustness:d.videoRobustness||""})}),[a]},Ru=function(x,v,d,a){switch(x){case Zs.WIDEVINE:return Au(v,d,a);default:throw new Error("Unknown key-system: "+x)}},Iu=function(R){xl(x,R);function x(d){var a;return a=R.call(this,d,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHED,m.default.MANIFEST_PARSED)||this,a._widevineLicenseUrl=void 0,a._licenseXhrSetup=void 0,a._emeEnabled=void 0,a._requestMediaKeySystemAccess=void 0,a._drmSystemOptions=void 0,a._config=void 0,a._mediaKeysList=[],a._media=null,a._hasSetMediaKeys=!1,a._requestLicenseFailureCount=0,a.mediaKeysPromise=null,a._onMediaEncrypted=function(f){if(_.logger.log('Media is encrypted using "'+f.initDataType+'" init data type'),!a.mediaKeysPromise){_.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),a.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var y=function(C){a._media&&(a._attemptSetMediaKeys(C),a._generateRequestWithPreferredKeySession(f.initDataType,f.initData))};a.mediaKeysPromise.then(y).catch(y)},a._config=d.config,a._widevineLicenseUrl=a._config.widevineLicenseUrl,a._licenseXhrSetup=a._config.licenseXhrSetup,a._emeEnabled=a._config.emeEnabled,a._requestMediaKeySystemAccess=a._config.requestMediaKeySystemAccessFunc,a._drmSystemOptions=d.config.drmSystemOptions,a}var v=x.prototype;return v.getLicenseServerUrl=function(a){switch(a){case Zs.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+a+'"')},v._attemptKeySystemAccess=function(a,f,y){var w=this,C=Ru(a,f,y,this._drmSystemOptions);_.logger.log("Requesting encrypted media key-system access");var P=this.requestMediaKeySystemAccess(a,C);this.mediaKeysPromise=P.then(function(M){return w._onMediaKeySystemAccessObtained(a,M)}),P.catch(function(M){_.logger.error('Failed to obtain key-system "'+a+'" access:',M)})},v._onMediaKeySystemAccessObtained=function(a,f){var y=this;_.logger.log('Access for key-system "'+a+'" obtained');var w={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:f,mediaKeySystemDomain:a};this._mediaKeysList.push(w);var C=Promise.resolve().then(function(){return f.createMediaKeys()}).then(function(P){return w.mediaKeys=P,_.logger.log('Media-keys created for key-system "'+a+'"'),y._onMediaKeysCreated(),P});return C.catch(function(P){_.logger.error("Failed to create media-keys:",P)}),C},v._onMediaKeysCreated=function(){var a=this;this._mediaKeysList.forEach(function(f){f.mediaKeysSession||(f.mediaKeysSession=f.mediaKeys.createSession(),a._onNewMediaKeySession(f.mediaKeysSession))})},v._onNewMediaKeySession=function(a){var f=this;_.logger.log("New key-system session "+a.sessionId),a.addEventListener("message",function(y){f._onKeySessionMessage(a,y.message)},!1)},v._onKeySessionMessage=function(a,f){_.logger.log("Got EME message event, creating license request"),this._requestLicense(f,function(y){_.logger.log("Received license data (length: "+(y&&y.byteLength)+"), updating key-session"),a.update(y)})},v._attemptSetMediaKeys=function(a){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var f=this._mediaKeysList[0];if(!f||!f.mediaKeys){_.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}_.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(f.mediaKeys),this._hasSetMediaKeys=!0}},v._generateRequestWithPreferredKeySession=function(a,f){var y=this,w=this._mediaKeysList[0];if(!w){_.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(w.mediaKeysSessionInitialized){_.logger.warn("Key-Session already initialized but requested again");return}var C=w.mediaKeysSession;if(!C){_.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!f){_.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}_.logger.log('Generating key-session request for "'+a+'" init data type'),w.mediaKeysSessionInitialized=!0,C.generateRequest(a,f).then(function(){_.logger.debug("Key-session generation succeeded")}).catch(function(P){_.logger.error("Error generating key-session request:",P),y.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},v._createLicenseXhr=function(a,f,y){var w=new XMLHttpRequest,C=this._licenseXhrSetup;try{if(C)try{C(w,a)}catch{w.open("POST",a,!0),C(w,a)}w.readyState||w.open("POST",a,!0)}catch(P){throw new Error("issue setting up KeySystem license XHR "+P)}return w.responseType="arraybuffer",w.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,w,a,f,y),w},v._onLicenseRequestReadyStageChange=function(a,f,y,w){switch(a.readyState){case 4:if(a.status===200)this._requestLicenseFailureCount=0,_.logger.log("License request succeeded"),a.responseType!=="arraybuffer"&&_.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),w(a.response);else{if(_.logger.error("License Request XHR failed ("+f+"). Status: "+a.status+" ("+a.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>Pa){this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var C=Pa-this._requestLicenseFailureCount+1;_.logger.warn("Retrying license request, "+C+" attempts left"),this._requestLicense(y,w)}break}},v._generateLicenseRequestChallenge=function(a,f){switch(a.mediaKeySystemDomain){case Zs.WIDEVINE:return f}throw new Error("unsupported key-system: "+a.mediaKeySystemDomain)},v._requestLicense=function(a,f){_.logger.log("Requesting content license for key-system");var y=this._mediaKeysList[0];if(!y){_.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var w=this.getLicenseServerUrl(y.mediaKeySystemDomain),C=this._createLicenseXhr(w,a,f);_.logger.log("Sending license request to URL: "+w);var P=this._generateLicenseRequestChallenge(y,a);C.send(P)}catch(M){_.logger.error("Failure requesting DRM license: "+M),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},v.onMediaAttached=function(a){if(this._emeEnabled){var f=a.media;this._media=f,f.addEventListener("encrypted",this._onMediaEncrypted)}},v.onMediaDetached=function(){var a=this._media,f=this._mediaKeysList;a&&(a.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(f.map(function(y){if(y.mediaKeysSession)return y.mediaKeysSession.close().catch(function(){})})).then(function(){return a.setMediaKeys(null)}).catch(function(){}))},v.onManifestParsed=function(a){if(this._emeEnabled){var f=a.levels.map(function(w){return w.audioCodec}),y=a.levels.map(function(w){return w.videoCodec});this._attemptKeySystemAccess(Zs.WIDEVINE,f,y)}},Su(x,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),x}(D),jf=Iu;function Cu(R,x){var v=Object.keys(R);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(R);x&&(d=d.filter(function(a){return Object.getOwnPropertyDescriptor(R,a).enumerable})),v.push.apply(v,d)}return v}function Pu(R){for(var x=1;x<arguments.length;x++){var v=arguments[x]!=null?arguments[x]:{};x%2?Cu(Object(v),!0).forEach(function(d){zf(R,d,v[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(v)):Cu(Object(v)).forEach(function(d){Object.defineProperty(R,d,Object.getOwnPropertyDescriptor(v,d))})}return R}function zf(R,x,v){return x in R?Object.defineProperty(R,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):R[x]=v,R}var Gf=Pu(Pu({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:hn,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Yi,bufferController:ya,capLevelController:Wn,fpsController:_l,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ca,testBandwidth:!0},ei()),{},{subtitleStreamController:zo,subtitleTrackController:Js,timelineController:In,audioStreamController:vs,audioTrackController:Ta,emeController:jf});function ei(){return{cueHandler:u,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function eo(R,x){var v=Object.keys(R);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(R);x&&(d=d.filter(function(a){return Object.getOwnPropertyDescriptor(R,a).enumerable})),v.push.apply(v,d)}return v}function wl(R){for(var x=1;x<arguments.length;x++){var v=arguments[x]!=null?arguments[x]:{};x%2?eo(Object(v),!0).forEach(function(d){bu(R,d,v[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(v)):eo(Object(v)).forEach(function(d){Object.defineProperty(R,d,Object.getOwnPropertyDescriptor(v,d))})}return R}function bu(R,x,v){return x in R?Object.defineProperty(R,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):R[x]=v,R}function Ir(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function Sl(R,x){for(var v=0;v<x.length;v++){var d=x[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(R,d.key,d)}}function ba(R,x,v){return x&&Sl(R.prototype,x),v&&Sl(R,v),R}function Kf(R,x){R.prototype=Object.create(x.prototype),R.prototype.constructor=R,R.__proto__=x}var ku=function(R){Kf(x,R),x.isSupported=function(){return Gi()},ba(x,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return m.default}},{key:"ErrorTypes",get:function(){return g.ErrorTypes}},{key:"ErrorDetails",get:function(){return g.ErrorDetails}},{key:"DefaultConfig",get:function(){return x.defaultConfig?x.defaultConfig:Gf},set:function(a){x.defaultConfig=a}}]);function x(d){var a;d===void 0&&(d={}),a=R.call(this)||this,a.config=void 0,a._autoLevelCapping=void 0,a.abrController=void 0,a.capLevelController=void 0,a.levelController=void 0,a.streamController=void 0,a.networkControllers=void 0,a.audioTrackController=void 0,a.subtitleTrackController=void 0,a.emeController=void 0,a.coreComponents=void 0,a.media=null,a.url=null;var f=x.DefaultConfig;if((d.liveSyncDurationCount||d.liveMaxLatencyDurationCount)&&(d.liveSyncDuration||d.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");a.config=wl(wl({},f),d);var y=Ir(a),w=y.config;if(w.liveMaxLatencyDurationCount!==void 0&&w.liveMaxLatencyDurationCount<=w.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(w.liveMaxLatencyDuration!==void 0&&(w.liveSyncDuration===void 0||w.liveMaxLatencyDuration<=w.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(_.enableLogs)(w.debug),a._autoLevelCapping=-1;var C=a.abrController=new w.abrController(Ir(a)),P=new w.bufferController(Ir(a)),M=a.capLevelController=new w.capLevelController(Ir(a)),G=new w.fpsController(Ir(a)),K=new Kt(Ir(a)),ie=new or(Ir(a)),Ee=new Gn(Ir(a)),be=new zi(Ir(a)),Fe=a.levelController=new zs(Ir(a)),Xe=new Vi(Ir(a)),We=a.streamController=new ds(Ir(a),Xe),ot=[Fe,We],ut=w.audioStreamController;ut&&ot.push(new ut(Ir(a),Xe)),a.networkControllers=ot;var It=[K,ie,Ee,C,P,M,G,be,Xe];if(ut=w.audioTrackController,ut){var ur=new ut(Ir(a));a.audioTrackController=ur,It.push(ur)}if(ut=w.subtitleTrackController,ut){var pn=new ut(Ir(a));a.subtitleTrackController=pn,ot.push(pn)}if(ut=w.emeController,ut){var Mr=new ut(Ir(a));a.emeController=Mr,It.push(Mr)}return ut=w.subtitleStreamController,ut&&ot.push(new ut(Ir(a),Xe)),ut=w.timelineController,ut&&It.push(new ut(Ir(a))),a.coreComponents=It,a}var v=x.prototype;return v.destroy=function(){_.logger.log("destroy"),this.trigger(m.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(a){a.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},v.attachMedia=function(a){_.logger.log("attachMedia"),this.media=a,this.trigger(m.default.MEDIA_ATTACHING,{media:a})},v.detachMedia=function(){_.logger.log("detachMedia"),this.trigger(m.default.MEDIA_DETACHING),this.media=null},v.loadSource=function(a){a=h.buildAbsoluteURL(window.location.href,a,{alwaysNormalize:!0}),_.logger.log("loadSource:"+a),this.url=a,this.trigger(m.default.MANIFEST_LOADING,{url:a})},v.startLoad=function(a){a===void 0&&(a=-1),_.logger.log("startLoad("+a+")"),this.networkControllers.forEach(function(f){f.startLoad(a)})},v.stopLoad=function(){_.logger.log("stopLoad"),this.networkControllers.forEach(function(a){a.stopLoad()})},v.swapAudioCodec=function(){_.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},v.recoverMediaError=function(){_.logger.log("recoverMediaError");var a=this.media;this.detachMedia(),a&&this.attachMedia(a)},v.removeLevel=function(a,f){f===void 0&&(f=0),this.levelController.removeLevel(a,f)},ba(x,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(a){_.logger.log("set currentLevel:"+a),this.loadLevel=a,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(a){_.logger.log("set nextLevel:"+a),this.levelController.manualLevel=a,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(a){_.logger.log("set loadLevel:"+a),this.levelController.manualLevel=a}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(a){this.levelController.nextLoadLevel=a}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(a){_.logger.log("set firstLevel:"+a),this.levelController.firstLevel=a}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(a){_.logger.log("set startLevel:"+a),a!==-1&&(a=Math.max(a,this.minAutoLevel)),this.levelController.startLevel=a}},{key:"capLevelToPlayerSize",set:function(a){var f=!!a;f!==this.config.capLevelToPlayerSize&&(f?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=f)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(a){_.logger.log("set autoLevelCapping:"+a),this._autoLevelCapping=a}},{key:"bandwidthEstimate",get:function(){var a=this.abrController._bwEstimator;return a?a.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var a=this.levels,f=this.config.minAutoBitrate,y=a?a.length:0,w=0;w<y;w++){var C=a[w].realBitrate?Math.max(a[w].realBitrate,a[w].bitrate):a[w].bitrate;if(C>f)return w}return 0}},{key:"maxAutoLevel",get:function(){var a=this.levels,f=this.autoLevelCapping,y;return f===-1&&a&&a.length?y=a.length-1:y=f,y}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(a){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,a)}},{key:"audioTracks",get:function(){var a=this.audioTrackController;return a?a.audioTracks:[]}},{key:"audioTrack",get:function(){var a=this.audioTrackController;return a?a.audioTrack:-1},set:function(a){var f=this.audioTrackController;f&&(f.audioTrack=a)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var a=this.subtitleTrackController;return a?a.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var a=this.subtitleTrackController;return a?a.subtitleTrack:-1},set:function(a){var f=this.subtitleTrackController;f&&(f.subtitleTrack=a)}},{key:"subtitleDisplay",get:function(){var a=this.subtitleTrackController;return a?a.subtitleDisplay:!1},set:function(a){var f=this.subtitleTrackController;f&&(f.subtitleDisplay=a)}}]),x}(_e);ku.defaultConfig=void 0},"./src/polyfills/number.js":function(t,i,o){o.r(i),o.d(i,"isFiniteNumber",function(){return u}),o.d(i,"MAX_SAFE_INTEGER",function(){return h});var u=Number.isFinite||function(g){return typeof g=="number"&&isFinite(g)},h=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(t,i,o){o.r(i),o.d(i,"getSelfScope",function(){return u});function u(){return typeof window>"u"?self:window}},"./src/utils/logger.js":function(t,i,o){o.r(i),o.d(i,"enableLogs",function(){return D}),o.d(i,"logger",function(){return F});var u=o("./src/utils/get-self-scope.js");function h(){}var g={trace:h,debug:h,log:h,warn:h,info:h,error:h},T=g;function m(N,U){return U="["+N+"] > "+U,U}var _=Object(u.getSelfScope)();function L(N){var U=_.console[N];return U?function(){for(var Y=arguments.length,X=new Array(Y),ce=0;ce<Y;ce++)X[ce]=arguments[ce];X[0]&&(X[0]=m(N,X[0])),U.apply(_.console,X)}:h}function I(N){for(var U=arguments.length,Y=new Array(U>1?U-1:0),X=1;X<U;X++)Y[X-1]=arguments[X];Y.forEach(function(ce){T[ce]=N[ce]?N[ce].bind(N):L(ce)})}var D=function(U){if(_.console&&U===!0||typeof U=="object"){I(U,"debug","log","info","warn","error");try{T.log()}catch{T=g}}else T=g},F=T}}).default})}(Kc)),Kc.exports}var Ub=Mb();const vo=vv(Ub);var ru=function(){return ru=Object.assign||function(r){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},ru.apply(this,arguments)},Vb=function(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(r);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(r,i[o])&&(t[i[o]]=r[i[o]]);return t};function Bb(r){var e=r.hlsConfig,t=r.playerRef,i=t===void 0?Ql.createRef():t,o=r.src,u=r.autoPlay,h=Vb(r,["hlsConfig","playerRef","src","autoPlay"]);return pe.useEffect(function(){var g;function T(){g!=null&&g.destroy();var m=new vo(ru({enableWorker:!1},e));i.current!=null&&m.attachMedia(i.current),m.on(vo.Events.MEDIA_ATTACHED,function(){m.loadSource(o),m.on(vo.Events.MANIFEST_PARSED,function(){var _;u&&((_=i==null?void 0:i.current)===null||_===void 0||_.play().catch(function(){return console.log("Unable to autoplay prior to user interaction with the dom.")}))})}),m.on(vo.Events.ERROR,function(_,L){if(L.fatal)switch(L.type){case vo.ErrorTypes.NETWORK_ERROR:m.startLoad();break;case vo.ErrorTypes.MEDIA_ERROR:m.recoverMediaError();break;default:T();break}}),g=m}return vo.isSupported()&&T(),function(){g!=null&&g.destroy()}},[u,e,i,o]),vo.isSupported()?Ql.createElement("video",ru({ref:i},h)):Ql.createElement("video",ru({ref:i,src:o,autoPlay:u},h))}function jb(){const{stream_id:r}=yS(),[e,t]=pe.useState(0),[i,o]=pe.useState(0),[u,h]=pe.useState(!0),[g,T]=pe.useState(null);async function m(){const _=await nP(F_(Xp,"streams",r));_.exists()&&T(_.data())}return pe.useEffect(()=>{m()},[]),he.jsxs("div",{children:[he.jsx("h1",{children:r}),he.jsx("input",{className:"input input-bordered input-primary w-20 m-2",type:"number",name:"MaxLoadingDelay",value:e,min:"1",max:"5",onChange:_=>t(_.target.value)}),he.jsx("input",{className:"input input-bordered input-primary w-20 m-2",type:"number",name:"MinAudioBitrate",value:i,min:"1",max:"5",onChange:_=>o(_.target.value)}),he.jsx("input",{type:"checkbox",className:"toggle ",defaultChecked:!0,onChange:_=>h(_.target.checked)}),g?he.jsx(Bb,{src:`http://127.0.0.1:3200/hls/hls_${g.userId}/playlist.m3u8`,autoPlay:!0,controls:!0,width:"100%",height:"auto",hlsConfig:{maxLoadingDelay:e,minAutoBitrate:i,lowLatencyMode:u,xhrSetup:(_,L)=>{_.withCredentials=!0}}}):""]})}const zb=()=>{const{authUser:r,checkAuth:e,isCheckingAuth:t}=pu();return pe.useEffect(()=>{e()},[e]),console.log({authUser:r}),t&&!r?he.jsx("div",{className:"flex items-center justify-center h-screen",children:he.jsx(Vw,{className:"size-10 animate-spin"})}):he.jsxs("div",{children:[he.jsx(g1,{})," ",he.jsxs(LS,{children:[he.jsx(yo,{path:"/",element:r?he.jsx(Cb,{}):he.jsx(qa,{to:"/login"})})," ",he.jsx(yo,{path:"/signup",element:r?he.jsx(qa,{to:"/"}):he.jsx(Pb,{})})," ",he.jsx(yo,{path:"/start-stream",element:r?he.jsx(Nb,{}):he.jsx(qa,{to:"/login"})}),he.jsx(yo,{path:"/login",element:r?he.jsx(qa,{to:"/"}):he.jsx(bb,{})}),he.jsx(yo,{path:"/settings",element:he.jsx(kb,{})}),he.jsx(yo,{path:"/profile",element:r?he.jsx(Db,{}):he.jsx(qa,{to:"/login"})}),he.jsx(yo,{path:"/streams/:stream_id",element:r?he.jsx(jb,{}):he.jsx(qa,{to:"/login"})})]}),he.jsx(Ow,{})]})};fT.createRoot(document.getElementById("root")).render(he.jsx(pe.StrictMode,{children:he.jsxs(i1,{children:[" ",he.jsx(zb,{})]})}));
